"use strict";(self.webpackChunkPhotoApplication=self.webpackChunkPhotoApplication||[]).push([[179],{2011:(ct,Te,V)=>{V.d(Te,{Dh:()=>pe,GT:()=>fe,cc:()=>Me,hO:()=>Ve,on:()=>$,pX:()=>se,xv:()=>ge});var f=V(4650),te=V(127),F=V(5813);ct=V.hmd(ct);const ue=["ngOnDestroy"],se=(me,Je,ut,Re={})=>new Proxy(me,{get:(we,be)=>ut.runOutsideAngular(()=>{var Be;if(me[be])return!(null===(Be=Re?.spy)||void 0===Be)&&Be.get&&Re.spy.get(be,me[be]),me[be];if(ue.indexOf(be)>-1)return()=>{};const je=Je.toPromise().then(H=>{const _e=H&&H[be];return"function"==typeof _e?_e.bind(H):_e&&_e.then?_e.then(K=>ut.run(()=>K)):ut.run(()=>_e)});return new Proxy(()=>{},{get:(H,_e)=>je[_e],apply:(H,_e,K)=>je.then(X=>{var ie;const re=X&&X(...K);return!(null===(ie=Re?.spy)||void 0===ie)&&ie.apply&&Re.spy.apply(be,K,re),re})})})}),fe=(me,Je)=>{Je.forEach(ut=>{Object.getOwnPropertyNames(ut.prototype||ut).forEach(Re=>{Object.defineProperty(me.prototype,Re,Object.getOwnPropertyDescriptor(ut.prototype||ut,Re))})})};class ce{constructor(Je){return Je}}const pe=new f.OlP("angularfire2.app.options"),ge=new f.OlP("angularfire2.app.name");function $(me,Je,ut){const we="object"==typeof ut&&ut||{};we.name=we.name||"string"==typeof ut&&ut||"[DEFAULT]";const Be=te.Z.apps.filter(je=>je&&je.name===we.name)[0]||Je.runOutsideAngular(()=>te.Z.initializeApp(me,we));try{JSON.stringify(me)!==JSON.stringify(Be.options)&&G("error",`${Be.name} Firebase App already initialized with different options${ct.hot?", you may need to reload as Firebase is not HMR aware.":"."}`)}catch{}return new ce(Be)}const G=(me,...Je)=>{(0,f.X6Q)()&&typeof console<"u"&&console[me](...Je)},Y={provide:ce,useFactory:$,deps:[pe,f.R0b,[new f.FiY,ge]]};let Ve=(()=>{class me{constructor(ut){te.Z.registerVersion("angularfire",F.q4.full,"core"),te.Z.registerVersion("angularfire",F.q4.full,"app-compat"),te.Z.registerVersion("angular",f.q4F.full,ut.toString())}static initializeApp(ut,Re){return{ngModule:me,providers:[{provide:pe,useValue:ut},{provide:ge,useValue:Re}]}}}return me.\u0275fac=function(ut){return new(ut||me)(f.LFG(f.Lbi))},me.\u0275mod=f.oAB({type:me}),me.\u0275inj=f.cJS({providers:[Y]}),me})();function Me(me,Je,ut,Re,we){const[,be,Be]=globalThis.\u0275AngularfireInstanceCache.find(je=>je[0]===me)||[];if(be)return function Ce(me,Je){try{return me.toString()===Je.toString()}catch{return me===Je}}(we,Be)||(ye("error",`${Je} was already initialized on the ${ut} Firebase App with different settings.${rt?" You may need to reload as Firebase is not HMR aware.":""}`),ye("warn",{is:we,was:Be})),be;{const je=Re();return globalThis.\u0275AngularfireInstanceCache.push([me,je,we]),je}}const rt=!!ct.hot,ye=(me,...Je)=>{(0,f.X6Q)()&&typeof console<"u"&&console[me](...Je)};globalThis.\u0275AngularfireInstanceCache||(globalThis.\u0275AngularfireInstanceCache=[])},5813:(ct,Te,V)=>{V.d(Te,{q4:()=>ci,iC:()=>vs,fc:()=>Rl,HU:()=>la,vb:()=>Ao,JM:()=>ua});var f=V(4650),te=V(5867),F=V(5861),ue=V(9681),se=V(2090),fe=V(4859),ce=V(1877),pe=V(8766);const ge="@firebase/installations",$="0.5.16",Y=`w:${$}`,Ve="FIS_v2",Je=new se.LL("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function ut(b){return b instanceof se.ZR&&b.code.includes("request-failed")}function Re({projectId:b}){return`https://firebaseinstallations.googleapis.com/v1/projects/${b}/installations`}function we(b){return{token:b.token,requestStatus:2,expiresIn:X(b.expiresIn),creationTime:Date.now()}}function be(b,T){return Be.apply(this,arguments)}function Be(){return(Be=(0,F.Z)(function*(b,T){const U=(yield T.json()).error;return Je.create("request-failed",{requestName:b,serverCode:U.code,serverMessage:U.message,serverStatus:U.status})})).apply(this,arguments)}function je({apiKey:b}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":b})}function H(b,{refreshToken:T}){const R=je(b);return R.append("Authorization",function ie(b){return`${Ve} ${b}`}(T)),R}function _e(b){return K.apply(this,arguments)}function K(){return(K=(0,F.Z)(function*(b){const T=yield b();return T.status>=500&&T.status<600?b():T})).apply(this,arguments)}function X(b){return Number(b.replace("s","000"))}function re(b,T){return Fe.apply(this,arguments)}function Fe(){return(Fe=(0,F.Z)(function*({appConfig:b,heartbeatServiceProvider:T},{fid:R}){const U=Re(b),Q=je(b),oe=T.getImmediate({optional:!0});if(oe){const It=yield oe.getHeartbeatsHeader();It&&Q.append("x-firebase-client",It)}const He={method:"POST",headers:Q,body:JSON.stringify({fid:R,authVersion:Ve,appId:b.appId,sdkVersion:Y})},_t=yield _e(()=>fetch(U,He));if(_t.ok){const It=yield _t.json();return{fid:It.fid||R,registrationStatus:2,refreshToken:It.refreshToken,authToken:we(It.authToken)}}throw yield be("Create Installation",_t)})).apply(this,arguments)}function Pe(b){return new Promise(T=>{setTimeout(T,b)})}const tn=/^[cdef][\w-]{21}$/;function Ze(){try{const b=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(b),b[0]=112+b[0]%16;const R=function cn(b){return function dt(b){return btoa(String.fromCharCode(...b)).replace(/\+/g,"-").replace(/\//g,"_")}(b).substr(0,22)}(b);return tn.test(R)?R:""}catch{return""}}function In(b){return`${b.appName}!${b.appId}`}const Qt=new Map;function nn(b,T){const R=In(b);dn(R,T),function ss(b,T){const R=function Gr(){return!Ai&&"BroadcastChannel"in self&&(Ai=new BroadcastChannel("[Firebase] FID Change"),Ai.onmessage=b=>{dn(b.data.key,b.data.fid)}),Ai}();R&&R.postMessage({key:b,fid:T}),function Wr(){0===Qt.size&&Ai&&(Ai.close(),Ai=null)}()}(R,T)}function dn(b,T){const R=Qt.get(b);if(R)for(const U of R)U(T)}let Ai=null;const ri="firebase-installations-store";let mi=null;function zo(){return mi||(mi=(0,pe.X3)("firebase-installations-database",1,{upgrade:(b,T)=>{0===T&&b.createObjectStore(ri)}})),mi}function Ye(b,T){return Rr.apply(this,arguments)}function Rr(){return(Rr=(0,F.Z)(function*(b,T){const R=In(b),Q=(yield zo()).transaction(ri,"readwrite"),oe=Q.objectStore(ri),xe=yield oe.get(R);return yield oe.put(T,R),yield Q.done,(!xe||xe.fid!==T.fid)&&nn(b,T.fid),T})).apply(this,arguments)}function Os(b){return rr.apply(this,arguments)}function rr(){return(rr=(0,F.Z)(function*(b){const T=In(b),U=(yield zo()).transaction(ri,"readwrite");yield U.objectStore(ri).delete(T),yield U.done})).apply(this,arguments)}function _i(b,T){return $i.apply(this,arguments)}function $i(){return($i=(0,F.Z)(function*(b,T){const R=In(b),Q=(yield zo()).transaction(ri,"readwrite"),oe=Q.objectStore(ri),xe=yield oe.get(R),He=T(xe);return void 0===He?yield oe.delete(R):yield oe.put(He,R),yield Q.done,He&&(!xe||xe.fid!==He.fid)&&nn(b,He.fid),He})).apply(this,arguments)}function Nn(b){return qn.apply(this,arguments)}function qn(){return(qn=(0,F.Z)(function*(b){let T;const R=yield _i(b.appConfig,U=>{const Q=yn(U),oe=yt(b,Q);return T=oe.registrationPromise,oe.installationEntry});return""===R.fid?{installationEntry:yield T}:{installationEntry:R,registrationPromise:T}})).apply(this,arguments)}function yn(b){return At(b||{fid:Ze(),registrationStatus:0})}function yt(b,T){if(0===T.registrationStatus){if(!navigator.onLine)return{installationEntry:T,registrationPromise:Promise.reject(Je.create("app-offline"))};const R={fid:T.fid,registrationStatus:1,registrationTime:Date.now()},U=function lt(b,T){return ln.apply(this,arguments)}(b,R);return{installationEntry:R,registrationPromise:U}}return 1===T.registrationStatus?{installationEntry:T,registrationPromise:hr(b)}:{installationEntry:T}}function ln(){return(ln=(0,F.Z)(function*(b,T){try{const R=yield re(b,T);return Ye(b.appConfig,R)}catch(R){throw ut(R)&&409===R.customData.serverCode?yield Os(b.appConfig):yield Ye(b.appConfig,{fid:T.fid,registrationStatus:0}),R}})).apply(this,arguments)}function hr(b){return jn.apply(this,arguments)}function jn(){return(jn=(0,F.Z)(function*(b){let T=yield ii(b.appConfig);for(;1===T.registrationStatus;)yield Pe(100),T=yield ii(b.appConfig);if(0===T.registrationStatus){const{installationEntry:R,registrationPromise:U}=yield Nn(b);return U||R}return T})).apply(this,arguments)}function ii(b){return _i(b,T=>{if(!T)throw Je.create("installation-not-found");return At(T)})}function At(b){return function os(b){return 1===b.registrationStatus&&b.registrationTime+1e4<Date.now()}(b)?{fid:b.fid,registrationStatus:0}:b}function rn(b,T){return Ri.apply(this,arguments)}function Ri(){return(Ri=(0,F.Z)(function*({appConfig:b,heartbeatServiceProvider:T},R){const U=an(b,R),Q=H(b,R),oe=T.getImmediate({optional:!0});if(oe){const It=yield oe.getHeartbeatsHeader();It&&Q.append("x-firebase-client",It)}const He={method:"POST",headers:Q,body:JSON.stringify({installation:{sdkVersion:Y,appId:b.appId}})},_t=yield _e(()=>fetch(U,He));if(_t.ok)return we(yield _t.json());throw yield be("Generate Auth Token",_t)})).apply(this,arguments)}function an(b,{fid:T}){return`${Re(b)}/${T}/authTokens:generate`}function ir(b){return zr.apply(this,arguments)}function zr(){return(zr=(0,F.Z)(function*(b,T=!1){let R;const U=yield _i(b.appConfig,oe=>{if(!Ft(oe))throw Je.create("not-registered");const xe=oe.authToken;if(!T&&W(xe))return oe;if(1===xe.requestStatus)return R=tt(b,T),oe;{if(!navigator.onLine)throw Je.create("app-offline");const He=Z(oe);return R=bt(b,He),He}});return R?yield R:U.authToken})).apply(this,arguments)}function tt(b,T){return Se.apply(this,arguments)}function Se(){return(Se=(0,F.Z)(function*(b,T){let R=yield Xe(b.appConfig);for(;1===R.authToken.requestStatus;)yield Pe(100),R=yield Xe(b.appConfig);const U=R.authToken;return 0===U.requestStatus?ir(b,T):U})).apply(this,arguments)}function Xe(b){return _i(b,T=>{if(!Ft(T))throw Je.create("not-registered");return function Ie(b){return 1===b.requestStatus&&b.requestTime+1e4<Date.now()}(T.authToken)?Object.assign(Object.assign({},T),{authToken:{requestStatus:0}}):T})}function bt(b,T){return Et.apply(this,arguments)}function Et(){return(Et=(0,F.Z)(function*(b,T){try{const R=yield rn(b,T),U=Object.assign(Object.assign({},T),{authToken:R});return yield Ye(b.appConfig,U),R}catch(R){if(!ut(R)||401!==R.customData.serverCode&&404!==R.customData.serverCode){const U=Object.assign(Object.assign({},T),{authToken:{requestStatus:0}});yield Ye(b.appConfig,U)}else yield Os(b.appConfig);throw R}})).apply(this,arguments)}function Ft(b){return void 0!==b&&2===b.registrationStatus}function W(b){return 2===b.requestStatus&&!function B(b){const T=Date.now();return T<b.creationTime||b.creationTime+b.expiresIn<T+36e5}(b)}function Z(b){const T={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},b),{authToken:T})}function ze(){return(ze=(0,F.Z)(function*(b){const T=b,{installationEntry:R,registrationPromise:U}=yield Nn(T);return U?U.catch(console.error):ir(T).catch(console.error),R.fid})).apply(this,arguments)}function Jt(){return(Jt=(0,F.Z)(function*(b,T=!1){const R=b;return yield mn(R),(yield ir(R,T)).token})).apply(this,arguments)}function mn(b){return qt.apply(this,arguments)}function qt(){return(qt=(0,F.Z)(function*(b){const{registrationPromise:T}=yield Nn(b);T&&(yield T)})).apply(this,arguments)}function Fs(b){return Je.create("missing-app-config-values",{valueName:b})}const qo="installations",Sn=b=>{const T=b.getProvider("app").getImmediate(),R=function Cn(b){if(!b||!b.options)throw Fs("App Configuration");if(!b.name)throw Fs("App Name");const T=["projectId","apiKey","appId"];for(const R of T)if(!b.options[R])throw Fs(R);return{appName:b.name,projectId:b.options.projectId,apiKey:b.options.apiKey,appId:b.options.appId}}(T);return{app:T,appConfig:R,heartbeatServiceProvider:(0,ue._getProvider)(T,"heartbeat"),_delete:()=>Promise.resolve()}},ho=b=>{const T=b.getProvider("app").getImmediate(),R=(0,ue._getProvider)(T,qo).getImmediate();return{getId:()=>function J(b){return ze.apply(this,arguments)}(R),getToken:Q=>function ht(b){return Jt.apply(this,arguments)}(R,Q)}};(function Zu(){(0,ue._registerComponent)(new fe.wA(qo,Sn,"PUBLIC")),(0,ue._registerComponent)(new fe.wA("installations-internal",ho,"PRIVATE"))})(),(0,ue.registerVersion)(ge,$),(0,ue.registerVersion)(ge,$,"esm2017");const Gi="@firebase/remote-config",Zn=new se.LL("remoteconfig","Remote Config",{"registration-window":"Undefined window object. This SDK only supports usage in a browser environment.","registration-project-id":"Undefined project identifier. Check Firebase app initialization.","registration-api-key":"Undefined API key. Check Firebase app initialization.","registration-app-id":"Undefined app identifier. Check Firebase app initialization.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","storage-delete":"Error thrown when deleting from storage. Original error: {$originalErrorMessage}.","fetch-client-network":"Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-timeout":'The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',"fetch-throttle":'The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',"fetch-client-parse":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","indexed-db-unavailable":"Indexed DB is not supported by current browser"});class Zf{constructor(T,R,U,Q){this.client=T,this.storage=R,this.storageCache=U,this.logger=Q}isCachedDataFresh(T,R){if(!R)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;const U=Date.now()-R,Q=U<=T;return this.logger.debug(`Config fetch cache check. Cache age millis: ${U}. Cache max age millis (minimumFetchIntervalMillis setting): ${T}. Is cache hit: ${Q}.`),Q}fetch(T){var R=this;return(0,F.Z)(function*(){const[U,Q]=yield Promise.all([R.storage.getLastSuccessfulFetchTimestampMillis(),R.storage.getLastSuccessfulFetchResponse()]);if(Q&&R.isCachedDataFresh(T.cacheMaxAgeMillis,U))return Q;T.eTag=Q&&Q.eTag;const oe=yield R.client.fetch(T),xe=[R.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())];return 200===oe.status&&xe.push(R.storage.setLastSuccessfulFetchResponse(oe)),yield Promise.all(xe),oe})()}}function bc(b=navigator){return b.languages&&b.languages[0]||b.language}class Dc{constructor(T,R,U,Q,oe,xe){this.firebaseInstallations=T,this.sdkVersion=R,this.namespace=U,this.projectId=Q,this.apiKey=oe,this.appId=xe}fetch(T){var R=this;return(0,F.Z)(function*(){var U,Q,oe;const[xe,He]=yield Promise.all([R.firebaseInstallations.getId(),R.firebaseInstallations.getToken()]),It=`${window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com"}/v1/projects/${R.projectId}/namespaces/${R.namespace}:fetch?key=${R.apiKey}`,kt={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":T.eTag||"*"},pt={sdk_version:R.sdkVersion,app_instance_id:xe,app_instance_id_token:He,app_id:R.appId,language_code:bc()},Dn={method:"POST",headers:kt,body:JSON.stringify(pt)},_r=fetch(It,Dn),da=new Promise((ha,fa)=>{T.signal.addEventListener(()=>{const op=new Error("The operation was aborted.");op.name="AbortError",fa(op)})});let Ks;try{yield Promise.race([_r,da]),Ks=yield _r}catch(ha){let fa="fetch-client-network";throw"AbortError"===(null===(U=ha)||void 0===U?void 0:U.name)&&(fa="fetch-timeout"),Zn.create(fa,{originalErrorMessage:null===(Q=ha)||void 0===Q?void 0:Q.message})}let xo=Ks.status;const fu=Ks.headers.get("ETag")||void 0;let Ro,Mo;if(200===Ks.status){let ha;try{ha=yield Ks.json()}catch(fa){throw Zn.create("fetch-client-parse",{originalErrorMessage:null===(oe=fa)||void 0===oe?void 0:oe.message})}Ro=ha.entries,Mo=ha.state}if("INSTANCE_STATE_UNSPECIFIED"===Mo?xo=500:"NO_CHANGE"===Mo?xo=304:("NO_TEMPLATE"===Mo||"EMPTY_CONFIG"===Mo)&&(Ro={}),304!==xo&&200!==xo)throw Zn.create("fetch-status",{httpStatus:xo});return{status:xo,eTag:fu,config:Ro}})()}}class dm{constructor(T,R){this.client=T,this.storage=R}fetch(T){var R=this;return(0,F.Z)(function*(){const U=(yield R.storage.getThrottleMetadata())||{backoffCount:0,throttleEndTimeMillis:Date.now()};return R.attemptFetch(T,U)})()}attemptFetch(T,{throttleEndTimeMillis:R,backoffCount:U}){var Q=this;return(0,F.Z)(function*(){yield function ar(b,T){return new Promise((R,U)=>{const Q=Math.max(T-Date.now(),0),oe=setTimeout(R,Q);b.addEventListener(()=>{clearTimeout(oe),U(Zn.create("fetch-throttle",{throttleEndTimeMillis:T}))})})}(T.signal,R);try{const oe=yield Q.client.fetch(T);return yield Q.storage.deleteThrottleMetadata(),oe}catch(oe){if(!function ih(b){if(!(b instanceof se.ZR&&b.customData))return!1;const T=Number(b.customData.httpStatus);return 429===T||500===T||503===T||504===T}(oe))throw oe;const xe={throttleEndTimeMillis:Date.now()+(0,se.$s)(U),backoffCount:U+1};return yield Q.storage.setThrottleMetadata(xe),Q.attemptFetch(T,xe)}})()}}class sh{constructor(T,R,U,Q,oe){this.app=T,this._client=R,this._storageCache=U,this._storage=Q,this._logger=oe,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}get fetchTimeMillis(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1}get lastFetchStatus(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"}}function Tc(b,T){var R;const U=b.target.error||void 0;return Zn.create(T,{originalErrorMessage:U&&(null===(R=U)||void 0===R?void 0:R.message)})}const Bs="app_namespace_store";class gm{constructor(T,R,U,Q=function pm(){return new Promise((b,T)=>{var R;try{const U=indexedDB.open("firebase_remote_config",1);U.onerror=Q=>{T(Tc(Q,"storage-open"))},U.onsuccess=Q=>{b(Q.target.result)},U.onupgradeneeded=Q=>{0===Q.oldVersion&&Q.target.result.createObjectStore(Bs,{keyPath:"compositeKey"})}}catch(U){T(Zn.create("storage-open",{originalErrorMessage:null===(R=U)||void 0===R?void 0:R.message}))}})}()){this.appId=T,this.appName=R,this.namespace=U,this.openDbPromise=Q}getLastFetchStatus(){return this.get("last_fetch_status")}setLastFetchStatus(T){return this.set("last_fetch_status",T)}getLastSuccessfulFetchTimestampMillis(){return this.get("last_successful_fetch_timestamp_millis")}setLastSuccessfulFetchTimestampMillis(T){return this.set("last_successful_fetch_timestamp_millis",T)}getLastSuccessfulFetchResponse(){return this.get("last_successful_fetch_response")}setLastSuccessfulFetchResponse(T){return this.set("last_successful_fetch_response",T)}getActiveConfig(){return this.get("active_config")}setActiveConfig(T){return this.set("active_config",T)}getActiveConfigEtag(){return this.get("active_config_etag")}setActiveConfigEtag(T){return this.set("active_config_etag",T)}getThrottleMetadata(){return this.get("throttle_metadata")}setThrottleMetadata(T){return this.set("throttle_metadata",T)}deleteThrottleMetadata(){return this.delete("throttle_metadata")}get(T){var R=this;return(0,F.Z)(function*(){const U=yield R.openDbPromise;return new Promise((Q,oe)=>{var xe;const _t=U.transaction([Bs],"readonly").objectStore(Bs),It=R.createCompositeKey(T);try{const kt=_t.get(It);kt.onerror=pt=>{oe(Tc(pt,"storage-get"))},kt.onsuccess=pt=>{const Dn=pt.target.result;Q(Dn?Dn.value:void 0)}}catch(kt){oe(Zn.create("storage-get",{originalErrorMessage:null===(xe=kt)||void 0===xe?void 0:xe.message}))}})})()}set(T,R){var U=this;return(0,F.Z)(function*(){const Q=yield U.openDbPromise;return new Promise((oe,xe)=>{var He;const It=Q.transaction([Bs],"readwrite").objectStore(Bs),kt=U.createCompositeKey(T);try{const pt=It.put({compositeKey:kt,value:R});pt.onerror=Dn=>{xe(Tc(Dn,"storage-set"))},pt.onsuccess=()=>{oe()}}catch(pt){xe(Zn.create("storage-set",{originalErrorMessage:null===(He=pt)||void 0===He?void 0:He.message}))}})})()}delete(T){var R=this;return(0,F.Z)(function*(){const U=yield R.openDbPromise;return new Promise((Q,oe)=>{var xe;const _t=U.transaction([Bs],"readwrite").objectStore(Bs),It=R.createCompositeKey(T);try{const kt=_t.delete(It);kt.onerror=pt=>{oe(Tc(pt,"storage-delete"))},kt.onsuccess=()=>{Q()}}catch(kt){oe(Zn.create("storage-delete",{originalErrorMessage:null===(xe=kt)||void 0===xe?void 0:xe.message}))}})})()}createCompositeKey(T){return[this.appId,this.appName,this.namespace,T].join()}}class ah{constructor(T){this.storage=T}getLastFetchStatus(){return this.lastFetchStatus}getLastSuccessfulFetchTimestampMillis(){return this.lastSuccessfulFetchTimestampMillis}getActiveConfig(){return this.activeConfig}loadFromStorage(){var T=this;return(0,F.Z)(function*(){const R=T.storage.getLastFetchStatus(),U=T.storage.getLastSuccessfulFetchTimestampMillis(),Q=T.storage.getActiveConfig(),oe=yield R;oe&&(T.lastFetchStatus=oe);const xe=yield U;xe&&(T.lastSuccessfulFetchTimestampMillis=xe);const He=yield Q;He&&(T.activeConfig=He)})()}setLastFetchStatus(T){return this.lastFetchStatus=T,this.storage.setLastFetchStatus(T)}setLastSuccessfulFetchTimestampMillis(T){return this.lastSuccessfulFetchTimestampMillis=T,this.storage.setLastSuccessfulFetchTimestampMillis(T)}setActiveConfig(T){return this.activeConfig=T,this.storage.setActiveConfig(T)}}function Qu(){return Yf.apply(this,arguments)}function Yf(){return(Yf=(0,F.Z)(function*(){if(!(0,se.hl)())return!1;try{return yield(0,se.eu)()}catch{return!1}})).apply(this,arguments)}!function js(){(0,ue._registerComponent)(new fe.wA("remote-config",function b(T,{instanceIdentifier:R}){const U=T.getProvider("app").getImmediate(),Q=T.getProvider("installations-internal").getImmediate();if(typeof window>"u")throw Zn.create("registration-window");if(!(0,se.hl)())throw Zn.create("indexed-db-unavailable");const{projectId:oe,apiKey:xe,appId:He}=U.options;if(!oe)throw Zn.create("registration-project-id");if(!xe)throw Zn.create("registration-api-key");if(!He)throw Zn.create("registration-app-id");const _t=new gm(He,U.name,R=R||"firebase"),It=new ah(_t),kt=new ce.Yd(Gi);kt.logLevel=ce.in.ERROR;const pt=new Dc(Q,ue.SDK_VERSION,R,oe,xe,He),Dn=new dm(pt,_t),_r=new Zf(Dn,_t,It,kt),da=new sh(U,_r,It,_t,kt);return function or(b){const T=(0,se.m9)(b);T._initializePromise||(T._initializePromise=T._storageCache.loadFromStorage().then(()=>{T._isInitializationComplete=!0}))}(da),da},"PUBLIC").setMultipleInstances(!0)),(0,ue.registerVersion)(Gi,"0.3.15"),(0,ue.registerVersion)(Gi,"0.3.15","esm2017")}();const Wi="/firebase-messaging-sw.js",us="/firebase-cloud-messaging-push-scope",ls="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",za="google.c.a.c_id",Ju="google.c.a.c_l",Sc="google.c.a.ts",Qf="google.c.a.e";var cs=(()=>{return(b=cs||(cs={})).PUSH_RECEIVED="push-received",b.NOTIFICATION_CLICKED="notification-clicked",cs;var b})();function yi(b){const T=new Uint8Array(b);return btoa(String.fromCharCode(...T)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function oi(b){const R=(b+"=".repeat((4-b.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),U=atob(R),Q=new Uint8Array(U.length);for(let oe=0;oe<U.length;++oe)Q[oe]=U.charCodeAt(oe);return Q}const Ko="fcm_token_details_db",Dr="fcm_token_object_Store";function Jf(b){return Xf.apply(this,arguments)}function Xf(){return Xf=(0,F.Z)(function*(b){if("databases"in indexedDB&&!(yield indexedDB.databases()).map(oe=>oe.name).includes(Ko))return null;let T=null;return(yield(0,pe.X3)(Ko,5,{upgrade:(U=(0,F.Z)(function*(Q,oe,xe,He){var _t;if(oe<2||!Q.objectStoreNames.contains(Dr))return;const It=He.objectStore(Dr),kt=yield It.index("fcmSenderId").get(b);if(yield It.clear(),kt)if(2===oe){const pt=kt;if(!pt.auth||!pt.p256dh||!pt.endpoint)return;T={token:pt.fcmToken,createTime:null!==(_t=pt.createTime)&&void 0!==_t?_t:Date.now(),subscriptionOptions:{auth:pt.auth,p256dh:pt.p256dh,endpoint:pt.endpoint,swScope:pt.swScope,vapidKey:"string"==typeof pt.vapidKey?pt.vapidKey:yi(pt.vapidKey)}}}else if(3===oe){const pt=kt;T={token:pt.fcmToken,createTime:pt.createTime,subscriptionOptions:{auth:yi(pt.auth),p256dh:yi(pt.p256dh),endpoint:pt.endpoint,swScope:pt.swScope,vapidKey:yi(pt.vapidKey)}}}else if(4===oe){const pt=kt;T={token:pt.fcmToken,createTime:pt.createTime,subscriptionOptions:{auth:yi(pt.auth),p256dh:yi(pt.p256dh),endpoint:pt.endpoint,swScope:pt.swScope,vapidKey:yi(pt.vapidKey)}}}}),function(oe,xe,He,_t){return U.apply(this,arguments)})})).close(),yield(0,pe.Lj)(Ko),yield(0,pe.Lj)("fcm_vapid_details_db"),yield(0,pe.Lj)("undefined"),kn(T)?T:null;var U}),Xf.apply(this,arguments)}function kn(b){if(!b||!b.subscriptionOptions)return!1;const{subscriptionOptions:T}=b;return"number"==typeof b.createTime&&b.createTime>0&&"string"==typeof b.token&&b.token.length>0&&"string"==typeof T.auth&&T.auth.length>0&&"string"==typeof T.p256dh&&T.p256dh.length>0&&"string"==typeof T.endpoint&&T.endpoint.length>0&&"string"==typeof T.swScope&&T.swScope.length>0&&"string"==typeof T.vapidKey&&T.vapidKey.length>0}const vi="firebase-messaging-store";let Kr=null;function el(){return Kr||(Kr=(0,pe.X3)("firebase-messaging-database",1,{upgrade:(b,T)=>{0===T&&b.createObjectStore(vi)}})),Kr}function mo(b){return ds.apply(this,arguments)}function ds(){return(ds=(0,F.Z)(function*(b){const T=Ni(b),U=yield(yield el()).transaction(vi).objectStore(vi).get(T);if(U)return U;{const Q=yield Jf(b.appConfig.senderId);if(Q)return yield Kt(b,Q),Q}})).apply(this,arguments)}function Kt(b,T){return tl.apply(this,arguments)}function tl(){return(tl=(0,F.Z)(function*(b,T){const R=Ni(b),Q=(yield el()).transaction(vi,"readwrite");return yield Q.objectStore(vi).put(T,R),yield Q.done,T})).apply(this,arguments)}function _o(b){return nl.apply(this,arguments)}function nl(){return(nl=(0,F.Z)(function*(b){const T=Ni(b),U=(yield el()).transaction(vi,"readwrite");yield U.objectStore(vi).delete(T),yield U.done})).apply(this,arguments)}function Ni({appConfig:b}){return b.appId}const xn=new se.LL("messaging","Messaging",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."});function xt(b,T){return il.apply(this,arguments)}function il(){return(il=(0,F.Z)(function*(b,T){var R;const U=yield xc(b),Q=Ae(T),oe={method:"POST",headers:U,body:JSON.stringify(Q)};let xe;try{xe=yield(yield fetch(hs(b.appConfig),oe)).json()}catch(He){throw xn.create("token-subscribe-failed",{errorInfo:null===(R=He)||void 0===R?void 0:R.toString()})}if(xe.error)throw xn.create("token-subscribe-failed",{errorInfo:xe.error.message});if(!xe.token)throw xn.create("token-subscribe-no-token");return xe.token})).apply(this,arguments)}function tp(b,T){return sl.apply(this,arguments)}function sl(){return(sl=(0,F.Z)(function*(b,T){var R;const U=yield xc(b),Q=Ae(T.subscriptionOptions),oe={method:"PATCH",headers:U,body:JSON.stringify(Q)};let xe;try{xe=yield(yield fetch(`${hs(b.appConfig)}/${T.token}`,oe)).json()}catch(He){throw xn.create("token-update-failed",{errorInfo:null===(R=He)||void 0===R?void 0:R.toString()})}if(xe.error)throw xn.create("token-update-failed",{errorInfo:xe.error.message});if(!xe.token)throw xn.create("token-update-no-token");return xe.token})).apply(this,arguments)}function ol(b,T){return Ac.apply(this,arguments)}function Ac(){return(Ac=(0,F.Z)(function*(b,T){var R;const Q={method:"DELETE",headers:yield xc(b)};try{const xe=yield(yield fetch(`${hs(b.appConfig)}/${T}`,Q)).json();if(xe.error)throw xn.create("token-unsubscribe-failed",{errorInfo:xe.error.message})}catch(oe){throw xn.create("token-unsubscribe-failed",{errorInfo:null===(R=oe)||void 0===R?void 0:R.toString()})}})).apply(this,arguments)}function hs({projectId:b}){return`https://fcmregistrations.googleapis.com/v1/projects/${b}/registrations`}function xc(b){return Ka.apply(this,arguments)}function Ka(){return(Ka=(0,F.Z)(function*({appConfig:b,installations:T}){const R=yield T.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":b.apiKey,"x-goog-firebase-installations-auth":`FIS ${R}`})})).apply(this,arguments)}function Ae({p256dh:b,auth:T,endpoint:R,vapidKey:U}){const Q={web:{endpoint:R,auth:T,p256dh:b}};return U!==ls&&(Q.web.applicationPubKey=U),Q}const Wt=6048e5;function al(b){return ul.apply(this,arguments)}function ul(){return(ul=(0,F.Z)(function*(b){const T=yield Rc(b.swRegistration,b.vapidKey),R={vapidKey:b.vapidKey,swScope:b.swRegistration.scope,endpoint:T.endpoint,auth:yi(T.getKey("auth")),p256dh:yi(T.getKey("p256dh"))},U=yield mo(b.firebaseDependencies);if(U){if(dh(U.subscriptionOptions,R))return Date.now()>=U.createTime+Wt?Zo(b,{token:U.token,createTime:Date.now(),subscriptionOptions:R}):U.token;try{yield ol(b.firebaseDependencies,U.token)}catch(Q){console.warn(Q)}return Za(b.firebaseDependencies,R)}return Za(b.firebaseDependencies,R)})).apply(this,arguments)}function Pn(b){return ll.apply(this,arguments)}function ll(){return(ll=(0,F.Z)(function*(b){const T=yield mo(b.firebaseDependencies);T&&(yield ol(b.firebaseDependencies,T.token),yield _o(b.firebaseDependencies));const R=yield b.swRegistration.pushManager.getSubscription();return!R||R.unsubscribe()})).apply(this,arguments)}function Zo(b,T){return wi.apply(this,arguments)}function wi(){return(wi=(0,F.Z)(function*(b,T){try{const R=yield tp(b.firebaseDependencies,T),U=Object.assign(Object.assign({},T),{token:R,createTime:Date.now()});return yield Kt(b.firebaseDependencies,U),R}catch(R){throw yield Pn(b),R}})).apply(this,arguments)}function Za(b,T){return Ya.apply(this,arguments)}function Ya(){return(Ya=(0,F.Z)(function*(b,T){const U={token:yield xt(b,T),createTime:Date.now(),subscriptionOptions:T};return yield Kt(b,U),U.token})).apply(this,arguments)}function Rc(b,T){return Mc.apply(this,arguments)}function Mc(){return(Mc=(0,F.Z)(function*(b,T){return(yield b.pushManager.getSubscription())||b.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:oi(T)})})).apply(this,arguments)}function dh(b,T){return T.vapidKey===b.vapidKey&&T.endpoint===b.endpoint&&T.auth===b.auth&&T.p256dh===b.p256dh}function Qa(b){const T={from:b.from,collapseKey:b.collapse_key,messageId:b.fcmMessageId};return function On(b,T){if(!T.notification)return;b.notification={};const R=T.notification.title;R&&(b.notification.title=R);const U=T.notification.body;U&&(b.notification.body=U);const Q=T.notification.image;Q&&(b.notification.image=Q);const oe=T.notification.icon;oe&&(b.notification.icon=oe)}(T,b),function zi(b,T){!T.data||(b.data=T.data)}(T,b),function Nc(b,T){var R,U,Q,oe,xe;if(!(T.fcmOptions||null!==(R=T.notification)&&void 0!==R&&R.click_action))return;b.fcmOptions={};const He=null!==(Q=null===(U=T.fcmOptions)||void 0===U?void 0:U.link)&&void 0!==Q?Q:null===(oe=T.notification)||void 0===oe?void 0:oe.click_action;He&&(b.fcmOptions.link=He);const _t=null===(xe=T.fcmOptions)||void 0===xe?void 0:xe.analytics_label;_t&&(b.fcmOptions.analyticsLabel=_t)}(T,b),T}function yo(b){return"object"==typeof b&&!!b&&za in b}function fs(b,T){const R=[];for(let U=0;U<b.length;U++)R.push(b.charAt(U)),U<T.length&&R.push(T.charAt(U));return R.join("")}function Ja(b){return xn.create("missing-app-config-values",{valueName:b})}fs("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),fs("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class _m{constructor(T,R,U){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const Q=function mm(b){if(!b||!b.options)throw Ja("App Configuration Object");if(!b.name)throw Ja("App Name");const T=["projectId","apiKey","appId","messagingSenderId"],{options:R}=b;for(const U of T)if(!R[U])throw Ja(U);return{appName:b.name,projectId:R.projectId,apiKey:R.apiKey,appId:R.appId,senderId:R.messagingSenderId}}(T);this.firebaseDependencies={app:T,appConfig:Q,installations:R,analyticsProvider:U}}_delete(){return Promise.resolve()}}function kc(b){return cl.apply(this,arguments)}function cl(){return(cl=(0,F.Z)(function*(b){var T;try{b.swRegistration=yield navigator.serviceWorker.register(Wi,{scope:us}),b.swRegistration.update().catch(()=>{})}catch(R){throw xn.create("failed-service-worker-registration",{browserErrorMessage:null===(T=R)||void 0===T?void 0:T.message})}})).apply(this,arguments)}function Xa(b,T){return Pc.apply(this,arguments)}function Pc(){return(Pc=(0,F.Z)(function*(b,T){if(!T&&!b.swRegistration&&(yield kc(b)),T||!b.swRegistration){if(!(T instanceof ServiceWorkerRegistration))throw xn.create("invalid-sw-registration");b.swRegistration=T}})).apply(this,arguments)}function eu(b,T){return Oc.apply(this,arguments)}function Oc(){return(Oc=(0,F.Z)(function*(b,T){T?b.vapidKey=T:b.vapidKey||(b.vapidKey=ls)})).apply(this,arguments)}function hl(){return(hl=(0,F.Z)(function*(b,T){if(!navigator)throw xn.create("only-available-in-window");if("default"===Notification.permission&&(yield Notification.requestPermission()),"granted"!==Notification.permission)throw xn.create("permission-blocked");return yield eu(b,T?.vapidKey),yield Xa(b,T?.serviceWorkerRegistration),al(b)})).apply(this,arguments)}function Fc(b,T,R){return Lc.apply(this,arguments)}function Lc(){return(Lc=(0,F.Z)(function*(b,T,R){const U=Vc(T);(yield b.firebaseDependencies.analyticsProvider.get()).logEvent(U,{message_id:R[za],message_name:R[Ju],message_time:R[Sc],message_device_time:Math.floor(Date.now()/1e3)})})).apply(this,arguments)}function Vc(b){switch(b){case cs.NOTIFICATION_CLICKED:return"notification_open";case cs.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}function vo(){return(vo=(0,F.Z)(function*(b,T){const R=T.data;if(!R.isFirebaseMessaging)return;b.onMessageHandler&&R.messageType===cs.PUSH_RECEIVED&&("function"==typeof b.onMessageHandler?b.onMessageHandler(Qa(R)):b.onMessageHandler.next(Qa(R)));const U=R.data;yo(U)&&"1"===U[Qf]&&(yield Fc(b,R.messageType,U))})).apply(this,arguments)}const wo="@firebase/messaging",ur=b=>{const T=new _m(b.getProvider("app").getImmediate(),b.getProvider("installations-internal").getImmediate(),b.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",R=>function hh(b,T){return vo.apply(this,arguments)}(T,R)),T},ai=b=>{const T=b.getProvider("messaging").getImmediate();return{getToken:U=>function dl(b,T){return hl.apply(this,arguments)}(T,U)}};function fh(){return Uc.apply(this,arguments)}function Uc(){return(Uc=(0,F.Z)(function*(){try{yield(0,se.eu)()}catch{return!1}return typeof window<"u"&&(0,se.hl)()&&(0,se.zI)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")})).apply(this,arguments)}!function bn(){(0,ue._registerComponent)(new fe.wA("messaging",ur,"PUBLIC")),(0,ue._registerComponent)(new fe.wA("messaging-internal",ai,"PRIVATE")),(0,ue.registerVersion)(wo,"0.11.0"),(0,ue.registerVersion)(wo,"0.11.0","esm2017")}();const Qo="analytics",mh="firebase_id",Io="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",ml="https://www.googletagmanager.com/gtag/js",Fn=new ce.Yd("@firebase/analytics");function _l(b){return Promise.all(b.map(T=>T.catch(R=>R)))}function yl(b,T){const R=document.createElement("script");R.src=`${ml}?l=${b}&id=${T}`,R.async=!0,document.head.appendChild(R)}function rp(b,T,R,U,Q,oe){return Jo.apply(this,arguments)}function Jo(){return(Jo=(0,F.Z)(function*(b,T,R,U,Q,oe){const xe=U[Q];try{if(xe)yield T[xe];else{const _t=(yield _l(R)).find(It=>It.measurementId===Q);_t&&(yield T[_t.appId])}}catch(He){Fn.error(He)}b("config",Q,oe)})).apply(this,arguments)}function Xo(b,T,R,U,Q){return Co.apply(this,arguments)}function Co(){return(Co=(0,F.Z)(function*(b,T,R,U,Q){try{let oe=[];if(Q&&Q.send_to){let xe=Q.send_to;Array.isArray(xe)||(xe=[xe]);const He=yield _l(R);for(const _t of xe){const It=He.find(pt=>pt.measurementId===_t),kt=It&&T[It.appId];if(!kt){oe=[];break}oe.push(kt)}}0===oe.length&&(oe=Object.values(T)),yield Promise.all(oe),b("event",U,Q||{})}catch(oe){Fn.error(oe)}})).apply(this,arguments)}function yh(b){const T=window.document.getElementsByTagName("script");for(const R of Object.values(T))if(R.src&&R.src.includes(ml)&&R.src.includes(b))return R;return null}const gr=new se.LL("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),iu=new class qi{constructor(T={},R=1e3){this.throttleMetadata=T,this.intervalMillis=R}getThrottleMetadata(T){return this.throttleMetadata[T]}setThrottleMetadata(T,R){this.throttleMetadata[T]=R}deleteThrottleMetadata(T){delete this.throttleMetadata[T]}};function wh(b){return new Headers({Accept:"application/json","x-goog-api-key":b})}function su(b){return jc.apply(this,arguments)}function jc(){return(jc=(0,F.Z)(function*(b){var T;const{appId:R,apiKey:U}=b,Q={method:"GET",headers:wh(U)},oe=Io.replace("{app-id}",R),xe=yield fetch(oe,Q);if(200!==xe.status&&304!==xe.status){let He="";try{const _t=yield xe.json();null!==(T=_t.error)&&void 0!==T&&T.message&&(He=_t.error.message)}catch{}throw gr.create("config-fetch-failed",{httpStatus:xe.status,responseMessage:He})}return xe.json()})).apply(this,arguments)}function Hn(b){return ki.apply(this,arguments)}function ki(){return(ki=(0,F.Z)(function*(b,T=iu,R){const{appId:U,apiKey:Q,measurementId:oe}=b.options;if(!U)throw gr.create("no-app-id");if(!Q){if(oe)return{measurementId:oe,appId:U};throw gr.create("no-api-key")}const xe=T.getThrottleMetadata(U)||{backoffCount:0,throttleEndTimeMillis:Date.now()},He=new Il;return setTimeout((0,F.Z)(function*(){He.abort()}),void 0!==R?R:6e4),wl({appId:U,apiKey:Q,measurementId:oe},xe,He,T)})).apply(this,arguments)}function wl(b,T,R){return bo.apply(this,arguments)}function bo(){return(bo=(0,F.Z)(function*(b,{throttleEndTimeMillis:T,backoffCount:R},U,Q=iu){var oe,xe;const{appId:He,measurementId:_t}=b;try{yield ou(U,T)}catch(It){if(_t)return Fn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${_t} provided in the "measurementId" field in the local Firebase config. [${null===(oe=It)||void 0===oe?void 0:oe.message}]`),{appId:He,measurementId:_t};throw It}try{const It=yield su(b);return Q.deleteThrottleMetadata(He),It}catch(It){const kt=It;if(!El(kt)){if(Q.deleteThrottleMetadata(He),_t)return Fn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${_t} provided in the "measurementId" field in the local Firebase config. [${kt?.message}]`),{appId:He,measurementId:_t};throw It}const pt=503===Number(null===(xe=kt?.customData)||void 0===xe?void 0:xe.httpStatus)?(0,se.$s)(R,Q.intervalMillis,30):(0,se.$s)(R,Q.intervalMillis),Dn={throttleEndTimeMillis:Date.now()+pt,backoffCount:R+1};return Q.setThrottleMetadata(He,Dn),Fn.debug(`Calling attemptFetch again in ${pt} millis`),wl(b,Dn,U,Q)}})).apply(this,arguments)}function ou(b,T){return new Promise((R,U)=>{const Q=Math.max(T-Date.now(),0),oe=setTimeout(R,Q);b.addEventListener(()=>{clearTimeout(oe),U(gr.create("fetch-throttle",{throttleEndTimeMillis:T}))})})}function El(b){if(!(b instanceof se.ZR&&b.customData))return!1;const T=Number(b.customData.httpStatus);return 429===T||500===T||503===T||504===T}class Il{constructor(){this.listeners=[]}addEventListener(T){this.listeners.push(T)}abort(){this.listeners.forEach(T=>T())}}let Gs,uu;function Ws(){return(Ws=(0,F.Z)(function*(b,T,R,U,Q){if(Q&&Q.global)b("event",R,U);else{const oe=yield T;b("event",R,Object.assign(Object.assign({},U),{send_to:oe}))}})).apply(this,arguments)}function To(b){uu=b}function Gc(b){Gs=b}function gs(){return bl.apply(this,arguments)}function bl(){return(bl=(0,F.Z)(function*(){var b;if(!(0,se.hl)())return Fn.warn(gr.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{yield(0,se.eu)()}catch(T){return Fn.warn(gr.create("indexeddb-unavailable",{errorInfo:null===(b=T)||void 0===b?void 0:b.toString()}).message),!1}return!0})).apply(this,arguments)}function na(){return(na=(0,F.Z)(function*(b,T,R,U,Q,oe,xe){var He;const _t=Hn(b);_t.then(_r=>{R[_r.measurementId]=_r.appId,b.options.measurementId&&_r.measurementId!==b.options.measurementId&&Fn.warn(`The measurement ID in the local Firebase config (${b.options.measurementId}) does not match the measurement ID fetched from the server (${_r.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(_r=>Fn.error(_r)),T.push(_t);const It=gs().then(_r=>{if(_r)return U.getId()}),[kt,pt]=yield Promise.all([_t,It]);yh(oe)||yl(oe,kt.measurementId),uu&&(Q("consent","default",uu),To(void 0)),Q("js",new Date);const Dn=null!==(He=xe?.config)&&void 0!==He?He:{};return Dn.origin="firebase",Dn.update=!0,null!=pt&&(Dn[mh]=pt),Q("config",kt.measurementId,Dn),Gs&&(Q("set",Gs),Gc(void 0)),kt.measurementId})).apply(this,arguments)}class Dl{constructor(T){this.app=T}_delete(){return delete ui[this.app.options.appId],Promise.resolve()}}let ui={},zs=[];const ra={};let sa,So,ia="dataLayer",lu=!1;function Fy(b,T,R){!function ym(){const b=[];if((0,se.ru)()&&b.push("This is a browser extension environment."),(0,se.zI)()||b.push("Cookies are not available."),b.length>0){const T=b.map((U,Q)=>`(${Q+1}) ${U}`).join(" "),R=gr.create("invalid-analytics-context",{errorInfo:T});Fn.warn(R.message)}}();const U=b.options.appId;if(!U)throw gr.create("no-app-id");if(!b.options.apiKey){if(!b.options.measurementId)throw gr.create("no-api-key");Fn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${b.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=ui[U])throw gr.create("already-exists",{id:U});if(!lu){!function _h(b){let T=[];Array.isArray(window[b])?T=window[b]:window[b]=T}(ia);const{wrappedGtag:oe,gtagCore:xe}=function tu(b,T,R,U,Q){let oe=function(...xe){window[U].push(arguments)};return window[Q]&&"function"==typeof window[Q]&&(oe=window[Q]),window[Q]=function vl(b,T,R,U){function oe(){return(oe=(0,F.Z)(function*(xe,He,_t){try{"event"===xe?yield Xo(b,T,R,He,_t):"config"===xe?yield rp(b,T,R,U,He,_t):"consent"===xe?b("consent","update",_t):b("set",He)}catch(It){Fn.error(It)}})).apply(this,arguments)}return function Q(xe,He,_t){return oe.apply(this,arguments)}}(oe,b,T,R),{gtagCore:oe,wrappedGtag:window[Q]}}(ui,zs,ra,ia,"gtag");So=oe,sa=xe,lu=!0}return ui[U]=function ta(b,T,R,U,Q,oe,xe){return na.apply(this,arguments)}(b,zs,ra,T,sa,ia,R),new Dl(b)}function Vy(){return ip.apply(this,arguments)}function ip(){return(ip=(0,F.Z)(function*(){if((0,se.ru)()||!(0,se.zI)()||!(0,se.hl)())return!1;try{return yield(0,se.eu)()}catch{return!1}})).apply(this,arguments)}const it="@firebase/analytics";!function fn(){(0,ue._registerComponent)(new fe.wA(Qo,(T,{options:R})=>Fy(T.getProvider("app").getImmediate(),T.getProvider("installations-internal").getImmediate(),R),"PUBLIC")),(0,ue._registerComponent)(new fe.wA("analytics-internal",function b(T){try{const R=T.getProvider(Qo).getImmediate();return{logEvent:(U,Q,oe)=>function ms(b,T,R,U){b=(0,se.m9)(b),function Eh(b,T,R,U,Q){return Ws.apply(this,arguments)}(So,ui[b.app.options.appId],T,R,U).catch(Q=>Fn.error(Q))}(R,U,Q,oe)}}catch(R){throw gr.create("interop-component-reg-failed",{reason:R})}},"PRIVATE")),(0,ue.registerVersion)(it,"0.8.4"),(0,ue.registerVersion)(it,"0.8.4","esm2017")}();var li=V(4408),An=V(7565);const kr=new class pn extends An.v{}(class _s extends li.o{constructor(T,R){super(T,R),this.scheduler=T,this.work=R}schedule(T,R=0){return R>0?super.schedule(T,R):(this.delay=R,this.state=T,this.scheduler.flush(this),this)}execute(T,R){return R>0||this.closed?super.execute(T,R):this._execute(T,R)}requestAsyncId(T,R,U=0){return null!=U&&U>0||null==U&&this.delay>0?super.requestAsyncId(T,R,U):(T.flush(this),0)}});var Sl=V(4986),cu=V(8505),Pr=V(5363),zc=V(9468);const ci=new f.GfV("7.4.1"),du="__angularfire_symbol__analyticsIsSupportedValue",qs="__angularfire_symbol__analyticsIsSupported",Al="__angularfire_symbol__remoteConfigIsSupportedValue",oa="__angularfire_symbol__remoteConfigIsSupported",aa="__angularfire_symbol__messagingIsSupportedValue",Ki="__angularfire_symbol__messagingIsSupported";function ua(b,T,R){if(T){if(1===T.length)return T[0];const oe=T.filter(xe=>xe.app===R);if(1===oe.length)return oe[0]}return R.container.getProvider(b).getImmediate({optional:!0})}globalThis[qs]||(globalThis[qs]=Vy().then(b=>globalThis[du]=b).catch(()=>globalThis[du]=!1)),globalThis[Ki]||(globalThis[Ki]=fh().then(b=>globalThis[aa]=b).catch(()=>globalThis[aa]=!1)),globalThis[oa]||(globalThis[oa]=Qu().then(b=>globalThis[Al]=b).catch(()=>globalThis[Al]=!1));const Ao=(b,T)=>{const R=T?[T]:(0,te.C6)(),U=[];return R.forEach(Q=>{Q.container.getProvider(b).instances.forEach(xe=>{U.includes(xe)||U.push(xe)})}),U};function hu(){}class Zr{constructor(T,R=kr){this.zone=T,this.delegate=R}now(){return this.delegate.now()}schedule(T,R,U){const Q=this.zone;return this.delegate.schedule(function(xe){Q.runGuarded(()=>{T.apply(this,[xe])})},R,U)}}class Rn{constructor(T){this.zone=T,this.task=null}call(T,R){const U=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",hu,{},hu,hu)),R.pipe((0,cu.b)({next:U,complete:U,error:U})).subscribe(T).add(U)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let la=(()=>{class b{constructor(R){this.ngZone=R,this.outsideAngular=R.runOutsideAngular(()=>new Zr(Zone.current)),this.insideAngular=R.run(()=>new Zr(Zone.current,Sl.z)),globalThis.\u0275AngularFireScheduler||(globalThis.\u0275AngularFireScheduler=this)}}return b.\u0275fac=function(R){return new(R||b)(f.LFG(f.R0b))},b.\u0275prov=f.Yz7({token:b,factory:b.\u0275fac,providedIn:"root"}),b})();function Pi(){const b=globalThis.\u0275AngularFireScheduler;if(!b)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return b}function Rl(b){return b.pipe((0,Pr.Q)(Pi().outsideAngular))}function vs(b){return Pi(),function qc(b){return function(R){return(R=R.lift(new Rn(b.ngZone))).pipe((0,zc.R)(b.outsideAngular),(0,Pr.Q)(b.insideAngular))}}(Pi())(b)}},2090:(ct,Te,V)=>{V.d(Te,{$s:()=>Xe,BH:()=>jt,DV:()=>ri,Dv:()=>hr,G6:()=>be,GJ:()=>Ps,L:()=>pe,LL:()=>Qt,Pz:()=>tn,Sg:()=>Ze,UG:()=>Ce,UI:()=>zo,US:()=>fe,Wj:()=>At,Wl:()=>dn,Yr:()=>we,ZB:()=>G,ZR:()=>In,aH:()=>dt,b$:()=>me,cI:()=>Nt,dS:()=>rn,eu:()=>je,g5:()=>F,gK:()=>jn,gQ:()=>Nn,h$:()=>ce,hl:()=>Be,hu:()=>te,jU:()=>rt,lb:()=>os,m9:()=>Ft,ne:()=>qn,p$:()=>$,pd:()=>$i,r3:()=>xi,ru:()=>ye,tV:()=>ge,uI:()=>Me,ug:()=>Ri,vZ:()=>Ye,w1:()=>ut,w9:()=>Wr,xO:()=>rr,xb:()=>mi,z$:()=>Ve,zI:()=>H,zd:()=>_i});const te=function(W,B){if(!W)throw F(B)},F=function(W){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+W)},ue=function(W){const B=[];let Z=0;for(let Ie=0;Ie<W.length;Ie++){let J=W.charCodeAt(Ie);J<128?B[Z++]=J:J<2048?(B[Z++]=J>>6|192,B[Z++]=63&J|128):55296==(64512&J)&&Ie+1<W.length&&56320==(64512&W.charCodeAt(Ie+1))?(J=65536+((1023&J)<<10)+(1023&W.charCodeAt(++Ie)),B[Z++]=J>>18|240,B[Z++]=J>>12&63|128,B[Z++]=J>>6&63|128,B[Z++]=63&J|128):(B[Z++]=J>>12|224,B[Z++]=J>>6&63|128,B[Z++]=63&J|128)}return B},fe={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(W,B){if(!Array.isArray(W))throw Error("encodeByteArray takes an array as a parameter");this.init_();const Z=B?this.byteToCharMapWebSafe_:this.byteToCharMap_,Ie=[];for(let J=0;J<W.length;J+=3){const ze=W[J],ht=J+1<W.length,Jt=ht?W[J+1]:0,mn=J+2<W.length,qt=mn?W[J+2]:0;let Bt=(15&Jt)<<2|qt>>6,fr=63&qt;mn||(fr=64,ht||(Bt=64)),Ie.push(Z[ze>>2],Z[(3&ze)<<4|Jt>>4],Z[Bt],Z[fr])}return Ie.join("")},encodeString(W,B){return this.HAS_NATIVE_SUPPORT&&!B?btoa(W):this.encodeByteArray(ue(W),B)},decodeString(W,B){return this.HAS_NATIVE_SUPPORT&&!B?atob(W):function(W){const B=[];let Z=0,Ie=0;for(;Z<W.length;){const J=W[Z++];if(J<128)B[Ie++]=String.fromCharCode(J);else if(J>191&&J<224){const ze=W[Z++];B[Ie++]=String.fromCharCode((31&J)<<6|63&ze)}else if(J>239&&J<365){const mn=((7&J)<<18|(63&W[Z++])<<12|(63&W[Z++])<<6|63&W[Z++])-65536;B[Ie++]=String.fromCharCode(55296+(mn>>10)),B[Ie++]=String.fromCharCode(56320+(1023&mn))}else{const ze=W[Z++],ht=W[Z++];B[Ie++]=String.fromCharCode((15&J)<<12|(63&ze)<<6|63&ht)}}return B.join("")}(this.decodeStringToByteArray(W,B))},decodeStringToByteArray(W,B){this.init_();const Z=B?this.charToByteMapWebSafe_:this.charToByteMap_,Ie=[];for(let J=0;J<W.length;){const ze=Z[W.charAt(J++)],Jt=J<W.length?Z[W.charAt(J)]:0;++J;const qt=J<W.length?Z[W.charAt(J)]:64;++J;const Ge=J<W.length?Z[W.charAt(J)]:64;if(++J,null==ze||null==Jt||null==qt||null==Ge)throw Error();Ie.push(ze<<2|Jt>>4),64!==qt&&(Ie.push(Jt<<4&240|qt>>2),64!==Ge&&Ie.push(qt<<6&192|Ge))}return Ie},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let W=0;W<this.ENCODED_VALS.length;W++)this.byteToCharMap_[W]=this.ENCODED_VALS.charAt(W),this.charToByteMap_[this.byteToCharMap_[W]]=W,this.byteToCharMapWebSafe_[W]=this.ENCODED_VALS_WEBSAFE.charAt(W),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[W]]=W,W>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(W)]=W,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(W)]=W)}}},ce=function(W){const B=ue(W);return fe.encodeByteArray(B,!0)},pe=function(W){return ce(W).replace(/\./g,"")},ge=function(W){try{return fe.decodeString(W,!0)}catch(B){console.error("base64Decode failed: ",B)}return null};function $(W){return G(void 0,W)}function G(W,B){if(!(B instanceof Object))return B;switch(B.constructor){case Date:return new Date(B.getTime());case Object:void 0===W&&(W={});break;case Array:W=[];break;default:return B}for(const Z in B)!B.hasOwnProperty(Z)||!Y(Z)||(W[Z]=G(W[Z],B[Z]));return W}function Y(W){return"__proto__"!==W}function Ve(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Me(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ve())}function Ce(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function rt(){return"object"==typeof self&&self.self===self}function ye(){const W="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof W&&void 0!==W.id}function me(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function ut(){const W=Ve();return W.indexOf("MSIE ")>=0||W.indexOf("Trident/")>=0}function we(){return!1}function be(){return!Ce()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Be(){return"object"==typeof indexedDB}function je(){return new Promise((W,B)=>{try{let Z=!0;const Ie="validate-browser-context-for-indexeddb-analytics-module",J=self.indexedDB.open(Ie);J.onsuccess=()=>{J.result.close(),Z||self.indexedDB.deleteDatabase(Ie),W(!0)},J.onupgradeneeded=()=>{Z=!1},J.onerror=()=>{var ze;B((null===(ze=J.error)||void 0===ze?void 0:ze.message)||"")}}catch(Z){B(Z)}})}function H(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}const re=()=>{try{return function _e(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const W=process.env.__FIREBASE_DEFAULTS__;return W?JSON.parse(W):void 0})()||(()=>{if(typeof document>"u")return;let W;try{W=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const B=W&&ge(W[1]);return B&&JSON.parse(B)})()}catch(W){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${W}`)}},dt=()=>{var W;return null===(W=re())||void 0===W?void 0:W.config},tn=W=>{var B;return null===(B=re())||void 0===B?void 0:B[`_${W}`]};class jt{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((B,Z)=>{this.resolve=B,this.reject=Z})}wrapCallback(B){return(Z,Ie)=>{Z?this.reject(Z):this.resolve(Ie),"function"==typeof B&&(this.promise.catch(()=>{}),1===B.length?B(Z):B(Z,Ie))}}}function Ze(W,B){if(W.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const Ie=B||"demo-project",J=W.iat||0,ze=W.sub||W.user_id;if(!ze)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const ht=Object.assign({iss:`https://securetoken.google.com/${Ie}`,aud:Ie,iat:J,exp:J+3600,auth_time:J,sub:ze,user_id:ze,firebase:{sign_in_provider:"custom",identities:{}}},W);return[pe(JSON.stringify({alg:"none",type:"JWT"})),pe(JSON.stringify(ht)),""].join(".")}class In extends Error{constructor(B,Z,Ie){super(Z),this.code=B,this.customData=Ie,this.name="FirebaseError",Object.setPrototypeOf(this,In.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qt.prototype.create)}}class Qt{constructor(B,Z,Ie){this.service=B,this.serviceName=Z,this.errors=Ie}create(B,...Z){const Ie=Z[0]||{},J=`${this.service}/${B}`,ze=this.errors[B],ht=ze?function nn(W,B){return W.replace($r,(Z,Ie)=>{const J=B[Ie];return null!=J?String(J):`<${Ie}?>`})}(ze,Ie):"Error";return new In(J,`${this.serviceName}: ${ht} (${J}).`,Ie)}}const $r=/\{\$([^}]+)}/g;function Nt(W){return JSON.parse(W)}function dn(W){return JSON.stringify(W)}const ss=function(W){let B={},Z={},Ie={},J="";try{const ze=W.split(".");B=Nt(ge(ze[0])||""),Z=Nt(ge(ze[1])||""),J=ze[2],Ie=Z.d||{},delete Z.d}catch{}return{header:B,claims:Z,data:Ie,signature:J}},Wr=function(W){const Z=ss(W).claims;return!!Z&&"object"==typeof Z&&Z.hasOwnProperty("iat")},Ps=function(W){const B=ss(W).claims;return"object"==typeof B&&!0===B.admin};function xi(W,B){return Object.prototype.hasOwnProperty.call(W,B)}function ri(W,B){if(Object.prototype.hasOwnProperty.call(W,B))return W[B]}function mi(W){for(const B in W)if(Object.prototype.hasOwnProperty.call(W,B))return!1;return!0}function zo(W,B,Z){const Ie={};for(const J in W)Object.prototype.hasOwnProperty.call(W,J)&&(Ie[J]=B.call(Z,W[J],J,W));return Ie}function Ye(W,B){if(W===B)return!0;const Z=Object.keys(W),Ie=Object.keys(B);for(const J of Z){if(!Ie.includes(J))return!1;const ze=W[J],ht=B[J];if(Rr(ze)&&Rr(ht)){if(!Ye(ze,ht))return!1}else if(ze!==ht)return!1}for(const J of Ie)if(!Z.includes(J))return!1;return!0}function Rr(W){return null!==W&&"object"==typeof W}function rr(W){const B=[];for(const[Z,Ie]of Object.entries(W))Array.isArray(Ie)?Ie.forEach(J=>{B.push(encodeURIComponent(Z)+"="+encodeURIComponent(J))}):B.push(encodeURIComponent(Z)+"="+encodeURIComponent(Ie));return B.length?"&"+B.join("&"):""}function _i(W){const B={};return W.replace(/^\?/,"").split("&").forEach(Ie=>{if(Ie){const[J,ze]=Ie.split("=");B[decodeURIComponent(J)]=decodeURIComponent(ze)}}),B}function $i(W){const B=W.indexOf("?");if(!B)return"";const Z=W.indexOf("#",B);return W.substring(B,Z>0?Z:void 0)}class Nn{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let B=1;B<this.blockSize;++B)this.pad_[B]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(B,Z){Z||(Z=0);const Ie=this.W_;if("string"==typeof B)for(let Ge=0;Ge<16;Ge++)Ie[Ge]=B.charCodeAt(Z)<<24|B.charCodeAt(Z+1)<<16|B.charCodeAt(Z+2)<<8|B.charCodeAt(Z+3),Z+=4;else for(let Ge=0;Ge<16;Ge++)Ie[Ge]=B[Z]<<24|B[Z+1]<<16|B[Z+2]<<8|B[Z+3],Z+=4;for(let Ge=16;Ge<80;Ge++){const Bt=Ie[Ge-3]^Ie[Ge-8]^Ie[Ge-14]^Ie[Ge-16];Ie[Ge]=4294967295&(Bt<<1|Bt>>>31)}let qt,Ue,J=this.chain_[0],ze=this.chain_[1],ht=this.chain_[2],Jt=this.chain_[3],mn=this.chain_[4];for(let Ge=0;Ge<80;Ge++){Ge<40?Ge<20?(qt=Jt^ze&(ht^Jt),Ue=1518500249):(qt=ze^ht^Jt,Ue=1859775393):Ge<60?(qt=ze&ht|Jt&(ze|ht),Ue=2400959708):(qt=ze^ht^Jt,Ue=3395469782);const Bt=(J<<5|J>>>27)+qt+mn+Ue+Ie[Ge]&4294967295;mn=Jt,Jt=ht,ht=4294967295&(ze<<30|ze>>>2),ze=J,J=Bt}this.chain_[0]=this.chain_[0]+J&4294967295,this.chain_[1]=this.chain_[1]+ze&4294967295,this.chain_[2]=this.chain_[2]+ht&4294967295,this.chain_[3]=this.chain_[3]+Jt&4294967295,this.chain_[4]=this.chain_[4]+mn&4294967295}update(B,Z){if(null==B)return;void 0===Z&&(Z=B.length);const Ie=Z-this.blockSize;let J=0;const ze=this.buf_;let ht=this.inbuf_;for(;J<Z;){if(0===ht)for(;J<=Ie;)this.compress_(B,J),J+=this.blockSize;if("string"==typeof B){for(;J<Z;)if(ze[ht]=B.charCodeAt(J),++ht,++J,ht===this.blockSize){this.compress_(ze),ht=0;break}}else for(;J<Z;)if(ze[ht]=B[J],++ht,++J,ht===this.blockSize){this.compress_(ze),ht=0;break}}this.inbuf_=ht,this.total_+=Z}digest(){const B=[];let Z=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let J=this.blockSize-1;J>=56;J--)this.buf_[J]=255&Z,Z/=256;this.compress_(this.buf_);let Ie=0;for(let J=0;J<5;J++)for(let ze=24;ze>=0;ze-=8)B[Ie]=this.chain_[J]>>ze&255,++Ie;return B}}function qn(W,B){const Z=new yn(W,B);return Z.subscribe.bind(Z)}class yn{constructor(B,Z){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=Z,this.task.then(()=>{B(this)}).catch(Ie=>{this.error(Ie)})}next(B){this.forEachObserver(Z=>{Z.next(B)})}error(B){this.forEachObserver(Z=>{Z.error(B)}),this.close(B)}complete(){this.forEachObserver(B=>{B.complete()}),this.close()}subscribe(B,Z,Ie){let J;if(void 0===B&&void 0===Z&&void 0===Ie)throw new Error("Missing Observer.");J=function lt(W,B){if("object"!=typeof W||null===W)return!1;for(const Z of B)if(Z in W&&"function"==typeof W[Z])return!0;return!1}(B,["next","error","complete"])?B:{next:B,error:Z,complete:Ie},void 0===J.next&&(J.next=ln),void 0===J.error&&(J.error=ln),void 0===J.complete&&(J.complete=ln);const ze=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?J.error(this.finalError):J.complete()}catch{}}),this.observers.push(J),ze}unsubscribeOne(B){void 0===this.observers||void 0===this.observers[B]||(delete this.observers[B],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(B){if(!this.finalized)for(let Z=0;Z<this.observers.length;Z++)this.sendOne(Z,B)}sendOne(B,Z){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[B])try{Z(this.observers[B])}catch(Ie){typeof console<"u"&&console.error&&console.error(Ie)}})}close(B){this.finalized||(this.finalized=!0,void 0!==B&&(this.finalError=B),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ln(){}const hr=function(W,B,Z,Ie){let J;if(Ie<B?J="at least "+B:Ie>Z&&(J=0===Z?"none":"no more than "+Z),J)throw new Error(W+" failed: Was called with "+Ie+(1===Ie?" argument.":" arguments.")+" Expects "+J+".")};function jn(W,B){return`${W} failed: ${B} argument `}function At(W,B,Z,Ie){if((!Ie||Z)&&"function"!=typeof Z)throw new Error(jn(W,B)+"must be a valid function.")}function os(W,B,Z,Ie){if((!Ie||Z)&&("object"!=typeof Z||null===Z))throw new Error(jn(W,B)+"must be a valid context object.")}const rn=function(W){const B=[];let Z=0;for(let Ie=0;Ie<W.length;Ie++){let J=W.charCodeAt(Ie);if(J>=55296&&J<=56319){const ze=J-55296;Ie++,te(Ie<W.length,"Surrogate pair missing trail surrogate."),J=65536+(ze<<10)+(W.charCodeAt(Ie)-56320)}J<128?B[Z++]=J:J<2048?(B[Z++]=J>>6|192,B[Z++]=63&J|128):J<65536?(B[Z++]=J>>12|224,B[Z++]=J>>6&63|128,B[Z++]=63&J|128):(B[Z++]=J>>18|240,B[Z++]=J>>12&63|128,B[Z++]=J>>6&63|128,B[Z++]=63&J|128)}return B},Ri=function(W){let B=0;for(let Z=0;Z<W.length;Z++){const Ie=W.charCodeAt(Z);Ie<128?B++:Ie<2048?B+=2:Ie>=55296&&Ie<=56319?(B+=4,Z++):B+=3}return B};function Xe(W,B=1e3,Z=2){const Ie=B*Math.pow(Z,W),J=Math.round(.5*Ie*(Math.random()-.5)*2);return Math.min(144e5,Ie+J)}function Ft(W){return W&&W._delegate?W._delegate:W}},4435:(ct,Te,V)=>{var f=V(4650);let te=null;function F(){return te}const ce=new f.OlP("DocumentToken");let pe=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:function(){return function ge(){return(0,f.LFG)(G)}()},providedIn:"platform"}),n})();const $=new f.OlP("Location Initialized");let G=(()=>{class n extends pe{constructor(t){super(),this._doc=t,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return F().getBaseHref(this._doc)}onPopState(t){const r=F().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){const r=F().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(t){this.location.pathname=t}pushState(t,r,i){Y()?this._history.pushState(t,r,i):this.location.hash=i}replaceState(t,r,i){Y()?this._history.replaceState(t,r,i):this.location.hash=i}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(ce))},n.\u0275prov=f.Yz7({token:n,factory:function(){return function Ve(){return new G((0,f.LFG)(ce))}()},providedIn:"platform"}),n})();function Y(){return!!window.history.pushState}function Me(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function Ce(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function rt(n){return n&&"?"!==n[0]?"?"+n:n}let ye=(()=>{class n{historyGo(t){throw new Error("Not implemented")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:function(){return(0,f.f3M)(Je)},providedIn:"root"}),n})();const me=new f.OlP("appBaseHref");let Je=(()=>{class n extends ye{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??(0,f.f3M)(ce).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Me(this._baseHref,t)}path(t=!1){const r=this._platformLocation.pathname+rt(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,a){const l=this.prepareExternalUrl(i+rt(a));this._platformLocation.pushState(t,r,l)}replaceState(t,r,i,a){const l=this.prepareExternalUrl(i+rt(a));this._platformLocation.replaceState(t,r,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(pe),f.LFG(me,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),ut=(()=>{class n extends ye{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(t){const r=Me(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,a){let l=this.prepareExternalUrl(i+rt(a));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.pushState(t,r,l)}replaceState(t,r,i,a){let l=this.prepareExternalUrl(i+rt(a));0==l.length&&(l=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(pe),f.LFG(me,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})(),Re=(()=>{class n{constructor(t){this._subject=new f.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const r=this._locationStrategy.getBaseHref();this._baseHref=Ce(Be(r)),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+rt(r))}normalize(t){return n.stripTrailingSlash(function be(n,e){return n&&e.startsWith(n)?e.substring(n.length):e}(this._baseHref,Be(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+rt(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+rt(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}}return n.normalizeQueryParams=rt,n.joinWithSlash=Me,n.stripTrailingSlash=Ce,n.\u0275fac=function(t){return new(t||n)(f.LFG(ye))},n.\u0275prov=f.Yz7({token:n,factory:function(){return function we(){return new Re((0,f.LFG)(ye))}()},providedIn:"root"}),n})();function Be(n){return n.replace(/\/index.html$/,"")}function $a(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const r=t.indexOf("="),[i,a]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(a)}return null}class Ga{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let po=(()=>{class n{constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const r=this._viewContainer;t.forEachOperation((i,a,l)=>{if(null==i.previousIndex)r.createEmbeddedView(this._template,new Ga(i.item,this._ngForOf,-1,-1),null===l?void 0:l);else if(null==l)r.remove(null===a?void 0:a);else if(null!==a){const d=r.get(a);r.move(d,l),Us(d,i)}});for(let i=0,a=r.length;i<a;i++){const d=r.get(i).context;d.index=i,d.count=a,d.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{Us(r.get(i.currentIndex),i)})}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(f.s_b),f.Y36(f.Rgc),f.Y36(f.ZZ4))},n.\u0275dir=f.lG2({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),n})();function Us(n,e){n.context.$implicit=e.item}let or=(()=>{class n{constructor(t,r){this._viewContainer=t,this._context=new Ic,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){pr("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){pr("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(f.s_b),f.Y36(f.Rgc))},n.\u0275dir=f.lG2({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),n})();class Ic{constructor(){this.$implicit=null,this.ngIf=null}}function pr(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${(0,f.AaK)(e)}'.`)}let qa=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({}),n})();function Dr(n){return"server"===n}let Xu=(()=>{class n{}return n.\u0275prov=(0,f.Yz7)({token:n,providedIn:"root",factory:()=>new ep((0,f.LFG)(ce),window)}),n})();class ep{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function Kr(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&(n.body.createShadowRoot||n.body.attachShadow)){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const a=i.shadowRoot;if(a){const l=a.getElementById(e)||a.querySelector(`[name="${e}"]`);if(l)return l}i=r.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=e)}}scrollToElement(e){const t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,a=this.offset();this.window.scrollTo(r-a[0],i-a[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=vi(this.window.history)||vi(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function vi(n){return Object.getOwnPropertyDescriptor(n,"scrollRestoration")}class mo{}class vo extends class hh extends class fe{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function se(n){te||(te=n)}(new vo)}onAndCancel(e,t,r){return e.addEventListener(t,r,!1),()=>{e.removeEventListener(t,r,!1)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function fl(){return wo=wo||document.querySelector("base"),wo?wo.getAttribute("href"):null}();return null==t?null:function ai(n){ur=ur||document.createElement("a"),ur.setAttribute("href",n);const e=ur.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){wo=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return $a(document.cookie,e)}}let ur,wo=null;const bn=new f.OlP("TRANSITION_ID"),Uc=[{provide:f.ip1,useFactory:function fh(n,e,t){return()=>{t.get(f.CZH).donePromise.then(()=>{const r=F(),i=e.querySelectorAll(`style[ng-transition="${n}"]`);for(let a=0;a<i.length;a++)r.remove(i[a])})}},deps:[bn,ce,f.zs3],multi:!0}];let Bc=(()=>{class n{build(){return new XMLHttpRequest}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();const pl=new f.OlP("EventManagerPlugins");let ph=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>i.manager=this),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}addGlobalEventListener(t,r,i){return this._findPluginFor(r).addGlobalEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){const r=this._eventNameToPlugin.get(t);if(r)return r;const i=this._plugins;for(let a=0;a<i.length;a++){const l=i[a];if(l.supports(t))return this._eventNameToPlugin.set(t,l),l}throw new Error(`No event manager plugin found for event ${t}`)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(pl),f.LFG(f.R0b))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();class gl{constructor(e){this._doc=e}addGlobalEventListener(e,t,r){const i=F().getGlobalEventTarget(this._doc,e);if(!i)throw new Error(`Unsupported event target ${i} for event ${t}`);return this.addEventListener(i,t,r)}}let Eo=(()=>{class n{constructor(){this._stylesSet=new Set}addStyles(t){const r=new Set;t.forEach(i=>{this._stylesSet.has(i)||(this._stylesSet.add(i),r.add(i))}),this.onStylesAdded(r)}onStylesAdded(t){}getAllStyles(){return Array.from(this._stylesSet)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})(),Yo=(()=>{class n extends Eo{constructor(t){super(),this._doc=t,this._hostNodes=new Map,this._hostNodes.set(t.head,[])}_addStylesToHost(t,r,i){t.forEach(a=>{const l=this._doc.createElement("style");l.textContent=a,i.push(r.appendChild(l))})}addHost(t){const r=[];this._addStylesToHost(this._stylesSet,t,r),this._hostNodes.set(t,r)}removeHost(t){const r=this._hostNodes.get(t);r&&r.forEach(gh),this._hostNodes.delete(t)}onStylesAdded(t){this._hostNodes.forEach((r,i)=>{this._addStylesToHost(t,i,r)})}ngOnDestroy(){this._hostNodes.forEach(t=>t.forEach(gh))}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(ce))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();function gh(n){F().remove(n)}const Qo={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},mh=/%COMP%/g;function yl(n,e,t){for(let r=0;r<e.length;r++){let i=e[r];Array.isArray(i)?yl(n,i,t):(i=i.replace(mh,n),t.push(i))}return t}function _h(n){return e=>{if("__ngUnwrap__"===e)return n;!1===n(e)&&(e.preventDefault(),e.returnValue=!1)}}let Jo=(()=>{class n{constructor(t,r,i){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new Xo(t)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;switch(r.encapsulation){case f.ifc.Emulated:{let i=this.rendererByCompId.get(r.id);return i||(i=new yh(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,i)),i.applyToHost(t),i}case 1:case f.ifc.ShadowDom:return new vh(this.eventManager,this.sharedStylesHost,t,r);default:if(!this.rendererByCompId.has(r.id)){const i=yl(r.id,r.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(ph),f.LFG(Yo),f.LFG(f.AFp))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();class Xo{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?document.createElementNS(Qo[t]||t,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,t){(tu(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(tu(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;const a=Qo[i];a?e.setAttributeNS(a,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){const i=Qo[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(f.JOm.DashCase|f.JOm.Important)?e.style.setProperty(t,r,i&f.JOm.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&f.JOm.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e[t]=r}setValue(e,t){e.nodeValue=t}listen(e,t,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,_h(r)):this.eventManager.addEventListener(e,t,_h(r))}}function tu(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class yh extends Xo{constructor(e,t,r,i){super(e),this.component=r;const a=yl(i+"-"+r.id,r.styles,[]);t.addStyles(a),this.contentAttr=function Fn(n){return"_ngcontent-%COMP%".replace(mh,n)}(i+"-"+r.id),this.hostAttr=function _l(n){return"_nghost-%COMP%".replace(mh,n)}(i+"-"+r.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,t){const r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}}class vh extends Xo{constructor(e,t,r,i){super(e),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const a=yl(i.id,i.styles,[]);for(let l=0;l<a.length;l++){const d=document.createElement("style");d.textContent=a[l],this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let gr=(()=>{class n extends gl{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(ce))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();const nu=["alt","control","meta","shift"],ru={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},qi={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let iu=(()=>{class n extends gl{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,r,i){const a=n.parseEventName(r),l=n.eventCallback(a.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>F().onAndCancel(t,a.domEventName,l))}static parseEventName(t){const r=t.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const a=n._normalizeKey(r.pop());let l="",d=r.indexOf("code");if(d>-1&&(r.splice(d,1),l="code."),nu.forEach(w=>{const D=r.indexOf(w);D>-1&&(r.splice(D,1),l+=w+".")}),l+=a,0!=r.length||0===a.length)return null;const _={};return _.domEventName=i,_.fullKey=l,_}static matchEventFullKeyCode(t,r){let i=ru[t.key]||t.key,a="";return r.indexOf("code.")>-1&&(i=t.code,a="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),nu.forEach(l=>{l!==i&&(0,qi[l])(t)&&(a+=l+".")}),a+=i,a===r)}static eventCallback(t,r,i){return a=>{n.matchEventFullKeyCode(a,t)&&i.runGuarded(()=>r(a))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(ce))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();const Il=(0,f.eFA)(f._c5,"browser",[{provide:f.Lbi,useValue:"browser"},{provide:f.g9A,useValue:function wl(){vo.makeCurrent()},multi:!0},{provide:ce,useFactory:function ou(){return(0,f.RDi)(document),document},deps:[]}]),Gs=new f.OlP(""),Eh=[{provide:f.rWj,useClass:class np{addToWindow(e){f.dqk.getAngularTestability=(r,i=!0)=>{const a=e.findTestabilityInTree(r,i);if(null==a)throw new Error("Could not find testability for element.");return a},f.dqk.getAllAngularTestabilities=()=>e.getAllTestabilities(),f.dqk.getAllAngularRootElements=()=>e.getAllRootElements(),f.dqk.frameworkStabilizers||(f.dqk.frameworkStabilizers=[]),f.dqk.frameworkStabilizers.push(r=>{const i=f.dqk.getAllAngularTestabilities();let a=i.length,l=!1;const d=function(_){l=l||_,a--,0==a&&r(l)};i.forEach(function(_){_.whenStable(d)})})}findTestabilityInTree(e,t,r){return null==t?null:e.getTestability(t)??(r?F().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:f.lri,useClass:f.dDg,deps:[f.R0b,f.eoX,f.rWj]},{provide:f.dDg,useClass:f.dDg,deps:[f.R0b,f.eoX,f.rWj]}],Ws=[{provide:f.zSh,useValue:"root"},{provide:f.qLn,useFactory:function bo(){return new f.qLn},deps:[]},{provide:pl,useClass:gr,multi:!0,deps:[ce,f.R0b,f.Lbi]},{provide:pl,useClass:iu,multi:!0,deps:[ce]},{provide:Jo,useClass:Jo,deps:[ph,Yo,f.AFp]},{provide:f.FYo,useExisting:Jo},{provide:Eo,useExisting:Yo},{provide:Yo,useClass:Yo,deps:[ce]},{provide:ph,useClass:ph,deps:[pl,f.R0b]},{provide:mo,useClass:Bc,deps:[]},[]];let Hc=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:f.AFp,useValue:t.appId},{provide:bn,useExisting:f.AFp},Uc]}}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Gs,12))},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[...Ws,...Eh],imports:[qa,f.hGG]}),n})(),ps=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(ce))},n.\u0275prov=f.Yz7({token:n,factory:function(t){let r=null;return r=t?new t:function ea(){return new ps((0,f.LFG)(ce))}(),r},providedIn:"root"}),n})();typeof window<"u"&&window;var ms=V(7669),zt=V(8996);function it(...n){const e=(0,ms.yG)(n);return(0,zt.D)(n,e)}var Nr=V(9751),fn=V(5577),li=V(576);function _s(n,e){return(0,li.m)(e)?(0,fn.z)(n,e,1):(0,fn.z)(n,1)}var An=V(4482),pn=V(5403);function kr(n,e){return(0,An.e)((t,r)=>{let i=0;t.subscribe((0,pn.x)(r,a=>n.call(e,a,i++)&&r.next(a)))})}var ft=V(4004);class Sl{}class cu{}class Pr{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?this.lazyInit="string"==typeof e?()=>{this.headers=new Map,e.split("\n").forEach(t=>{const r=t.indexOf(":");if(r>0){const i=t.slice(0,r),a=i.toLowerCase(),l=t.slice(r+1).trim();this.maybeSetNormalizedName(i,a),this.headers.has(a)?this.headers.get(a).push(l):this.headers.set(a,[l])}})}:()=>{this.headers=new Map,Object.keys(e).forEach(t=>{let r=e[t];const i=t.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(i,r),this.maybeSetNormalizedName(t,i))})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Pr?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Pr;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Pr?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(e.name,t);const i=("a"===e.op?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":const a=e.value;if(a){let l=this.headers.get(t);if(!l)return;l=l.filter(d=>-1===a.indexOf(d)),0===l.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,l)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class ci{encodeKey(e){return oa(e)}encodeValue(e){return oa(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const qs=/%(\d[a-f0-9])/gi,Al={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function oa(n){return encodeURIComponent(n).replace(qs,(e,t)=>Al[t]??e)}function aa(n){return`${n}`}class Ki{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new ci,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function du(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{const a=i.indexOf("="),[l,d]=-1==a?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,a)),e.decodeValue(i.slice(a+1))],_=t.get(l)||[];_.push(d),t.set(l,_)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const r=e.fromObject[t],i=Array.isArray(r)?r.map(aa):[aa(r)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(r=>{const i=e[r];Array.isArray(i)?i.forEach(a=>{t.push({param:r,value:a,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new Ki({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(aa(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let r=this.map.get(e.param)||[];const i=r.indexOf(aa(e.value));-1!==i&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class wm{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function sp(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function ua(n){return typeof Blob<"u"&&n instanceof Blob}function Ao(n){return typeof FormData<"u"&&n instanceof FormData}class Zr{constructor(e,t,r,i){let a;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function Ch(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,a=i):a=r,a&&(this.reportProgress=!!a.reportProgress,this.withCredentials=!!a.withCredentials,a.responseType&&(this.responseType=a.responseType),a.headers&&(this.headers=a.headers),a.context&&(this.context=a.context),a.params&&(this.params=a.params)),this.headers||(this.headers=new Pr),this.context||(this.context=new wm),this.params){const l=this.params.toString();if(0===l.length)this.urlWithParams=t;else{const d=t.indexOf("?");this.urlWithParams=t+(-1===d?"?":d<t.length-1?"&":"")+l}}else this.params=new Ki,this.urlWithParams=t}serializeBody(){return null===this.body?null:sp(this.body)||ua(this.body)||Ao(this.body)||function hu(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Ki?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Ao(this.body)?null:ua(this.body)?this.body.type||null:sp(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Ki?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,a=void 0!==e.body?e.body:this.body,l=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,d=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let _=e.headers||this.headers,w=e.params||this.params;const D=e.context??this.context;return void 0!==e.setHeaders&&(_=Object.keys(e.setHeaders).reduce((S,M)=>S.set(M,e.setHeaders[M]),_)),e.setParams&&(w=Object.keys(e.setParams).reduce((S,M)=>S.set(M,e.setParams[M]),w)),new Zr(t,r,a,{params:w,headers:_,context:D,reportProgress:d,responseType:i,withCredentials:l})}}var Rn=(()=>((Rn=Rn||{})[Rn.Sent=0]="Sent",Rn[Rn.UploadProgress=1]="UploadProgress",Rn[Rn.ResponseHeader=2]="ResponseHeader",Rn[Rn.DownloadProgress=3]="DownloadProgress",Rn[Rn.Response=4]="Response",Rn[Rn.User=5]="User",Rn))();class la{constructor(e,t=200,r="OK"){this.headers=e.headers||new Pr,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class Pi extends la{constructor(e={}){super(e),this.type=Rn.ResponseHeader}clone(e={}){return new Pi({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class ca extends la{constructor(e={}){super(e),this.type=Rn.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new ca({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class Zi extends la{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function Rl(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let ys=(()=>{class n{constructor(t){this.handler=t}request(t,r,i={}){let a;if(t instanceof Zr)a=t;else{let _,w;_=i.headers instanceof Pr?i.headers:new Pr(i.headers),i.params&&(w=i.params instanceof Ki?i.params:new Ki({fromObject:i.params})),a=new Zr(t,r,void 0!==i.body?i.body:null,{headers:_,context:i.context,params:w,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials})}const l=it(a).pipe(_s(_=>this.handler.handle(_)));if(t instanceof Zr||"events"===i.observe)return l;const d=l.pipe(kr(_=>_ instanceof ca));switch(i.observe||"body"){case"body":switch(a.responseType){case"arraybuffer":return d.pipe((0,ft.U)(_=>{if(null!==_.body&&!(_.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return _.body}));case"blob":return d.pipe((0,ft.U)(_=>{if(null!==_.body&&!(_.body instanceof Blob))throw new Error("Response is not a Blob.");return _.body}));case"text":return d.pipe((0,ft.U)(_=>{if(null!==_.body&&"string"!=typeof _.body)throw new Error("Response is not a string.");return _.body}));default:return d.pipe((0,ft.U)(_=>_.body))}case"response":return d;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:(new Ki).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,i={}){return this.request("PATCH",t,Rl(i,r))}post(t,r,i={}){return this.request("POST",t,Rl(i,r))}put(t,r,i={}){return this.request("PUT",t,Rl(i,r))}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Sl))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();class vs{constructor(e,t){this.next=e,this.interceptor=t}handle(e){return this.interceptor.intercept(e,this.next)}}const qc=new f.OlP("HTTP_INTERCEPTORS");let $n=(()=>{class n{intercept(t,r){return r.handle(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();const _t=/^\)\]\}',?\n/;let kt=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Nr.y(r=>{const i=this.xhrFactory.build();if(i.open(t.method,t.urlWithParams),t.withCredentials&&(i.withCredentials=!0),t.headers.forEach((O,j)=>i.setRequestHeader(O,j.join(","))),t.headers.has("Accept")||i.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const O=t.detectContentTypeHeader();null!==O&&i.setRequestHeader("Content-Type",O)}if(t.responseType){const O=t.responseType.toLowerCase();i.responseType="json"!==O?O:"text"}const a=t.serializeBody();let l=null;const d=()=>{if(null!==l)return l;const O=i.statusText||"OK",j=new Pr(i.getAllResponseHeaders()),ae=function It(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(i)||t.url;return l=new Pi({headers:j,status:i.status,statusText:O,url:ae}),l},_=()=>{let{headers:O,status:j,statusText:ae,url:he}=d(),$e=null;204!==j&&($e=typeof i.response>"u"?i.responseText:i.response),0===j&&(j=$e?200:0);let nt=j>=200&&j<300;if("json"===t.responseType&&"string"==typeof $e){const et=$e;$e=$e.replace(_t,"");try{$e=""!==$e?JSON.parse($e):null}catch(at){$e=et,nt&&(nt=!1,$e={error:at,text:$e})}}nt?(r.next(new ca({body:$e,headers:O,status:j,statusText:ae,url:he||void 0})),r.complete()):r.error(new Zi({error:$e,headers:O,status:j,statusText:ae,url:he||void 0}))},w=O=>{const{url:j}=d(),ae=new Zi({error:O,status:i.status||0,statusText:i.statusText||"Unknown Error",url:j||void 0});r.error(ae)};let D=!1;const S=O=>{D||(r.next(d()),D=!0);let j={type:Rn.DownloadProgress,loaded:O.loaded};O.lengthComputable&&(j.total=O.total),"text"===t.responseType&&!!i.responseText&&(j.partialText=i.responseText),r.next(j)},M=O=>{let j={type:Rn.UploadProgress,loaded:O.loaded};O.lengthComputable&&(j.total=O.total),r.next(j)};return i.addEventListener("load",_),i.addEventListener("error",w),i.addEventListener("timeout",w),i.addEventListener("abort",w),t.reportProgress&&(i.addEventListener("progress",S),null!==a&&i.upload&&i.upload.addEventListener("progress",M)),i.send(a),r.next({type:Rn.Sent}),()=>{i.removeEventListener("error",w),i.removeEventListener("abort",w),i.removeEventListener("load",_),i.removeEventListener("timeout",w),t.reportProgress&&(i.removeEventListener("progress",S),null!==a&&i.upload&&i.upload.removeEventListener("progress",M)),i.readyState!==i.DONE&&i.abort()}})}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(mo))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();const pt=new f.OlP("XSRF_COOKIE_NAME"),Dn=new f.OlP("XSRF_HEADER_NAME");class _r{}let da=(()=>{class n{constructor(t,r,i){this.doc=t,this.platform=r,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=$a(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(ce),f.LFG(f.Lbi),f.LFG(pt))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})(),Ks=(()=>{class n{constructor(t,r){this.tokenService=t,this.headerName=r}intercept(t,r){const i=t.url.toLowerCase();if("GET"===t.method||"HEAD"===t.method||i.startsWith("http://")||i.startsWith("https://"))return r.handle(t);const a=this.tokenService.getToken();return null!==a&&!t.headers.has(this.headerName)&&(t=t.clone({headers:t.headers.set(this.headerName,a)})),r.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(_r),f.LFG(Dn))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})(),xo=(()=>{class n{constructor(t,r){this.backend=t,this.injector=r,this.chain=null}handle(t){if(null===this.chain){const r=this.injector.get(qc,[]);this.chain=r.reduceRight((i,a)=>new vs(i,a),this.backend)}return this.chain.handle(t)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(cu),f.LFG(f.zs3))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})(),Mo=(()=>{class n{static disable(){return{ngModule:n,providers:[{provide:Ks,useClass:$n}]}}static withOptions(t={}){return{ngModule:n,providers:[t.cookieName?{provide:pt,useValue:t.cookieName}:[],t.headerName?{provide:Dn,useValue:t.headerName}:[]]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[Ks,{provide:qc,useExisting:Ks,multi:!0},{provide:_r,useClass:da},{provide:pt,useValue:"XSRF-TOKEN"},{provide:Dn,useValue:"X-XSRF-TOKEN"}]}),n})(),ha=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[ys,{provide:Sl,useClass:xo},kt,{provide:cu,useExisting:kt}],imports:[Mo.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]}),n})();var Zs=V(7579);class ws extends Zs.x{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}const Kc=(0,V(3888).d)(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:bh}=Array,{getPrototypeOf:Zc,prototype:Hy,keys:Im}=Object;function $y(n){if(1===n.length){const e=n[0];if(bh(e))return{args:e,keys:null};if(function Cm(n){return n&&"object"==typeof n&&Zc(n)===Hy}(e)){const t=Im(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}var Yc=V(4671);const{isArray:ap}=Array;function up(n){return(0,ft.U)(e=>function Gy(n,e){return ap(e)?n(...e):n(e)}(n,e))}function pu(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}var lp=V(9672);function gu(...n){const e=(0,ms.yG)(n),t=(0,ms.jO)(n),{args:r,keys:i}=$y(n);if(0===r.length)return(0,zt.D)([],e);const a=new Nr.y(function Wy(n,e,t=Yc.y){return r=>{bm(e,()=>{const{length:i}=n,a=new Array(i);let l=i,d=i;for(let _=0;_<i;_++)bm(e,()=>{const w=(0,zt.D)(n[_],e);let D=!1;w.subscribe((0,pn.x)(r,S=>{a[_]=S,D||(D=!0,d--),d||r.next(t(a.slice()))},()=>{--l||r.complete()}))},r)},r)}}(r,e,i?l=>pu(i,l):Yc.y));return t?a.pipe(up(t)):a}function bm(n,e,t){n?(0,lp.f)(t,n,e):e()}var Dh=V(8189);function Jc(...n){return function Qc(){return(0,Dh.J)(1)}()((0,zt.D)(n,(0,ms.yG)(n)))}var Ml=V(8421);function cp(n){return new Nr.y(e=>{(0,Ml.Xf)(n()).subscribe(e)})}var Dm=V(9635);function pa(n,e){const t=(0,li.m)(n)?n:()=>n,r=i=>i.error(t());return new Nr.y(e?i=>e.schedule(r,0,i):r)}var mu=V(515),Th=V(727);function dp(){return(0,An.e)((n,e)=>{let t=null;n._refCount++;const r=(0,pn.x)(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const i=n._connection,a=t;t=null,i&&(!a||i===a)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}class hp extends Nr.y{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,(0,An.A)(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Th.w0;const t=this.getSubject();e.add(this.source.subscribe((0,pn.x)(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Th.w0.EMPTY)}return e}refCount(){return dp()(this)}}function Yn(n,e){return(0,An.e)((t,r)=>{let i=null,a=0,l=!1;const d=()=>l&&!i&&r.complete();t.subscribe((0,pn.x)(r,_=>{i?.unsubscribe();let w=0;const D=a++;(0,Ml.Xf)(n(_,D)).subscribe(i=(0,pn.x)(r,S=>r.next(e?e(_,S,D,w++):S),()=>{i=null,d()}))},()=>{l=!0,d()}))})}function Ei(n){return n<=0?()=>mu.E:(0,An.e)((e,t)=>{let r=0;e.subscribe((0,pn.x)(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function ga(...n){const e=(0,ms.yG)(n);return(0,An.e)((t,r)=>{(e?Jc(n,t,e):Jc(n,t)).subscribe(r)})}function Xc(n){return(0,An.e)((e,t)=>{let r=!1;e.subscribe((0,pn.x)(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function Tm(n=hI){return(0,An.e)((e,t)=>{let r=!1;e.subscribe((0,pn.x)(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function hI(){return new Kc}function ma(n,e){const t=arguments.length>=2;return r=>r.pipe(n?kr((i,a)=>n(i,a,r)):Yc.y,Ei(1),t?Xc(e):Tm(()=>new Kc))}var di=V(8505);function _u(n){return(0,An.e)((e,t)=>{let a,r=null,i=!1;r=e.subscribe((0,pn.x)(t,void 0,void 0,l=>{a=(0,Ml.Xf)(n(l,_u(n)(e))),r?(r.unsubscribe(),r=null,a.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,a.subscribe(t))})}function Sm(n,e,t,r,i){return(a,l)=>{let d=t,_=e,w=0;a.subscribe((0,pn.x)(l,D=>{const S=w++;_=d?n(_,D,S):(d=!0,D),r&&l.next(_)},i&&(()=>{d&&l.next(_),l.complete()})))}}function _a(n,e){return(0,An.e)(Sm(n,e,arguments.length>=2,!0))}function fp(n){return n<=0?()=>mu.E:(0,An.e)((e,t)=>{let r=[];e.subscribe((0,pn.x)(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(const i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function zy(n,e){const t=arguments.length>=2;return r=>r.pipe(n?kr((i,a)=>n(i,a,r)):Yc.y,fp(1),t?Xc(e):Tm(()=>new Kc))}function Es(n){return(0,An.e)((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const Mt="primary",Nl=Symbol("RouteTitle");class Sh{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function vu(n){return new Sh(n)}function fI(n,e,t){const r=t.path.split("/");if(r.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||r.length<n.length))return null;const i={};for(let a=0;a<r.length;a++){const l=r[a],d=n[a];if(l.startsWith(":"))i[l.substring(1)]=d;else if(l!==d.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function No(n,e){const t=n?Object.keys(n):void 0,r=e?Object.keys(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let a=0;a<t.length;a++)if(i=t[a],!Ah(n[i],e[i]))return!1;return!0}function Ah(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),r=[...e].sort();return t.every((i,a)=>r[a]===i)}return n===e}function kl(n){return Array.prototype.concat.apply([],n)}function qy(n){return n.length>0?n[n.length-1]:null}function Tr(n,e){for(const t in n)n.hasOwnProperty(t)&&e(n[t],t)}function ya(n){return(0,f.CqO)(n)?n:(0,f.QGY)(n)?(0,zt.D)(Promise.resolve(n)):it(n)}const mp={exact:function Pl(n,e,t){if(!wu(n.segments,e.segments)||!xh(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!n.children[r]||!Pl(n.children[r],e.children[r],t))return!1;return!0},subset:Qn},_p={exact:function yp(n,e){return No(n,e)},subset:function Ky(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Ah(n[t],e[t]))},ignored:()=>!0};function ed(n,e,t){return mp[t.paths](n.root,e.root,t.matrixParams)&&_p[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function Qn(n,e,t){return td(n,e,e.segments,t)}function td(n,e,t,r){if(n.segments.length>t.length){const i=n.segments.slice(0,t.length);return!(!wu(i,t)||e.hasChildren()||!xh(i,t,r))}if(n.segments.length===t.length){if(!wu(n.segments,t)||!xh(n.segments,t,r))return!1;for(const i in e.children)if(!n.children[i]||!Qn(n.children[i],e.children[i],r))return!1;return!0}{const i=t.slice(0,n.segments.length),a=t.slice(n.segments.length);return!!(wu(n.segments,i)&&xh(n.segments,i,r)&&n.children[Mt])&&td(n.children[Mt],e,a,r)}}function xh(n,e,t){return e.every((r,i)=>_p[t](n[i].parameters,r.parameters))}class ko{constructor(e,t,r){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=vu(this.queryParams)),this._queryParamMap}toString(){return pI.serialize(this)}}class $t{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Tr(t,(r,i)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Po(this)}}class Ol{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=vu(this.parameters)),this._parameterMap}toString(){return id(this)}}function wu(n,e){return n.length===e.length&&n.every((t,r)=>t.path===e[r].path)}let Rm=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:function(){return new Fl},providedIn:"root"}),n})();class Fl{parse(e){const t=new Vl(e);return new ko(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${Eu(e.root,!0)}`,r=function wp(n){const e=Object.keys(n).map(t=>{const r=n[t];return Array.isArray(r)?r.map(i=>`${nd(t)}=${nd(i)}`).join("&"):`${nd(t)}=${nd(r)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${r}${"string"==typeof e.fragment?`#${function Mm(n){return encodeURI(n)}(e.fragment)}`:""}`}}const pI=new Fl;function Po(n){return n.segments.map(e=>id(e)).join("/")}function Eu(n,e){if(!n.hasChildren())return Po(n);if(e){const t=n.children[Mt]?Eu(n.children[Mt],!1):"",r=[];return Tr(n.children,(i,a)=>{a!==Mt&&r.push(`${a}:${Eu(i,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}{const t=function Yy(n,e){let t=[];return Tr(n.children,(r,i)=>{i===Mt&&(t=t.concat(e(r,i)))}),Tr(n.children,(r,i)=>{i!==Mt&&(t=t.concat(e(r,i)))}),t}(n,(r,i)=>i===Mt?[Eu(n.children[Mt],!1)]:[`${i}:${Eu(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[Mt]?`${Po(n)}/${t[0]}`:`${Po(n)}/(${t.join("//")})`}}function vp(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function nd(n){return vp(n).replace(/%3B/gi,";")}function Rh(n){return vp(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Iu(n){return decodeURIComponent(n)}function rd(n){return Iu(n.replace(/\+/g,"%20"))}function id(n){return`${Rh(n.path)}${function gI(n){return Object.keys(n).map(e=>`;${Rh(e)}=${Rh(n[e])}`).join("")}(n.parameters)}`}const Ep=/^[^\/()?;=#]+/;function Or(n){const e=n.match(Ep);return e?e[0]:""}const Ll=/^[^=?&#]+/,Qy=/^[^&#]+/;class Vl{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new $t([],{}):new $t([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[Mt]=new $t(e,t)),r}parseSegment(){const e=Or(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new f.vHH(4009,!1);return this.capture(e),new Ol(Iu(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=Or(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const i=Or(this.remaining);i&&(r=i,this.capture(r))}e[Iu(t)]=Iu(r)}parseQueryParam(e){const t=function va(n){const e=n.match(Ll);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const l=function sd(n){const e=n.match(Qy);return e?e[0]:""}(this.remaining);l&&(r=l,this.capture(r))}const i=rd(t),a=rd(r);if(e.hasOwnProperty(i)){let l=e[i];Array.isArray(l)||(l=[l],e[i]=l),l.push(a)}else e[i]=a}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=Or(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new f.vHH(4010,!1);let a;r.indexOf(":")>-1?(a=r.slice(0,r.indexOf(":")),this.capture(a),this.capture(":")):e&&(a=Mt);const l=this.parseChildren();t[a]=1===Object.keys(l).length?l[Mt]:new $t([],l),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new f.vHH(4011,!1)}}function Ip(n){return n.segments.length>0?new $t([],{[Mt]:n}):n}function Cu(n){const e={};for(const r of Object.keys(n.children)){const a=Cu(n.children[r]);(a.segments.length>0||a.hasChildren())&&(e[r]=a)}return function Mh(n){if(1===n.numberOfChildren&&n.children[Mt]){const e=n.children[Mt];return new $t(n.segments.concat(e.segments),e.children)}return n}(new $t(n.segments,e))}function lr(n){return n instanceof ko}function Cp(n,e,t,r,i){if(0===t.length)return wa(e.root,e.root,e.root,r,i);const a=function Ea(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new Ys(!0,0,n);let e=0,t=!1;const r=n.reduce((i,a,l)=>{if("object"==typeof a&&null!=a){if(a.outlets){const d={};return Tr(a.outlets,(_,w)=>{d[w]="string"==typeof _?_.split("/"):_}),[...i,{outlets:d}]}if(a.segmentPath)return[...i,a.segmentPath]}return"string"!=typeof a?[...i,a]:0===l?(a.split("/").forEach((d,_)=>{0==_&&"."===d||(0==_&&""===d?t=!0:".."===d?e++:""!=d&&i.push(d))}),i):[...i,a]},[]);return new Ys(t,e,r)}(t);return a.toRoot()?wa(e.root,e.root,new $t([],{}),r,i):function l(_){const w=function ev(n,e,t,r){if(n.isAbsolute)return new Du(e.root,!0,0);if(-1===r)return new Du(t,t===e.root,0);return function ad(n,e,t){let r=n,i=e,a=t;for(;a>i;){if(a-=i,r=r.parent,!r)throw new f.vHH(4005,!1);i=r.segments.length}return new Du(r,!1,i-a)}(t,r+(Ln(n.commands[0])?0:1),n.numberOfDoubleDots)}(a,e,n.snapshot?._urlSegment,_),D=w.processChildren?Oo(w.segmentGroup,w.index,a.commands):Dp(w.segmentGroup,w.index,a.commands);return wa(e.root,w.segmentGroup,D,r,i)}(n.snapshot?._lastPathIndex)}function Ln(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function bu(n){return"object"==typeof n&&null!=n&&n.outlets}function wa(n,e,t,r,i){let l,a={};r&&Tr(r,(_,w)=>{a[w]=Array.isArray(_)?_.map(D=>`${D}`):`${_}`}),l=n===e?t:km(n,e,t);const d=Ip(Cu(l));return new ko(d,a,i)}function km(n,e,t){const r={};return Tr(n.children,(i,a)=>{r[a]=i===e?t:km(i,e,t)}),new $t(n.segments,r)}class Ys{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&Ln(r[0]))throw new f.vHH(4003,!1);const i=r.find(bu);if(i&&i!==qy(r))throw new f.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Du{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}}function Dp(n,e,t){if(n||(n=new $t([],{})),0===n.segments.length&&n.hasChildren())return Oo(n,e,t);const r=function tv(n,e,t){let r=0,i=e;const a={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return a;const l=n.segments[i],d=t[r];if(bu(d))break;const _=`${d}`,w=r<t.length-1?t[r+1]:null;if(i>0&&void 0===_)break;if(_&&w&&"object"==typeof w&&void 0===w.outlets){if(!E(_,w,l))return a;r+=2}else{if(!E(_,{},l))return a;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const a=new $t(n.segments.slice(0,r.pathIndex),{});return a.children[Mt]=new $t(n.segments.slice(r.pathIndex),n.children),Oo(a,0,i)}return r.match&&0===i.length?new $t(n.segments,{}):r.match&&!n.hasChildren()?y(n,e,t):r.match?Oo(n,0,i):y(n,e,t)}function Oo(n,e,t){if(0===t.length)return new $t(n.segments,{});{const r=function mI(n){return bu(n[0])?n[0].outlets:{[Mt]:n}}(t),i={};return Tr(r,(a,l)=>{"string"==typeof a&&(a=[a]),null!==a&&(i[l]=Dp(n.children[l],e,a))}),Tr(n.children,(a,l)=>{void 0===r[l]&&(i[l]=a)}),new $t(n.segments,i)}}function y(n,e,t){const r=n.segments.slice(0,e);let i=0;for(;i<t.length;){const a=t[i];if(bu(a)){const _=p(a.outlets);return new $t(r,_)}if(0===i&&Ln(t[0])){r.push(new Ol(n.segments[e].path,m(t[0]))),i++;continue}const l=bu(a)?a.outlets[Mt]:`${a}`,d=i<t.length-1?t[i+1]:null;l&&d&&Ln(d)?(r.push(new Ol(l,m(d))),i+=2):(r.push(new Ol(l,{})),i++)}return new $t(r,{})}function p(n){const e={};return Tr(n,(t,r)=>{"string"==typeof t&&(t=[t]),null!==t&&(e[r]=y(new $t([],{}),0,t))}),e}function m(n){const e={};return Tr(n,(t,r)=>e[r]=`${t}`),e}function E(n,e,t){return n==t.path&&No(e,t.parameters)}class x{constructor(e,t){this.id=e,this.url=t}}class k extends x{constructor(e,t,r="imperative",i=null){super(e,t),this.type=0,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class q extends x{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class le extends x{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Le extends x{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Qe extends x{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class wt extends x{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class vt extends x{constructor(e,t,r,i,a){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=a,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class yr extends x{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Oi extends x{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Tp{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class nv{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class ud{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class rv{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class iv{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Pm{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Om{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Nh{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=ld(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){const t=ld(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=cd(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return cd(e,this._root).map(t=>t.value)}}function ld(n,e){if(n===e.value)return e;for(const t of e.children){const r=ld(n,t);if(r)return r}return null}function cd(n,e){if(n===e.value)return[e];for(const t of e.children){const r=cd(n,t);if(r.length)return r.unshift(e),r}return[]}class Yi{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Tu(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class ov extends Nh{constructor(e,t){super(e),this.snapshot=t,Vm(this,e)}toString(){return this.snapshot.toString()}}function Fm(n,e){const t=function qT(n,e){const l=new Lm([],{},{},"",{},Mt,e,null,n.root,-1,{});return new _I("",new Yi(l,[]))}(n,e),r=new ws([new Ol("",{})]),i=new ws({}),a=new ws({}),l=new ws({}),d=new ws(""),_=new Fo(r,i,l,d,a,Mt,e,t.root);return _.snapshot=t.root,new ov(new Yi(_,[]),t)}class Fo{constructor(e,t,r,i,a,l,d,_){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=l,this.component=d,this.title=this.data?.pipe((0,ft.U)(w=>w[Nl]))??it(void 0),this._futureSnapshot=_}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,ft.U)(e=>vu(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,ft.U)(e=>vu(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function kh(n,e="emptyOnly"){const t=n.pathFromRoot;let r=0;if("always"!==e)for(r=t.length-1;r>=1;){const i=t[r],a=t[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(a.component)break;r--}}return function KT(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(r))}class Lm{constructor(e,t,r,i,a,l,d,_,w,D,S,M){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=a,this.outlet=l,this.component=d,this.title=this.data?.[Nl],this.routeConfig=_,this._urlSegment=w,this._lastPathIndex=D,this._correctedLastPathIndex=M??D,this._resolve=S}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=vu(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=vu(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class _I extends Nh{constructor(e,t){super(t),this.url=e,Vm(this,t)}toString(){return yI(this._root)}}function Vm(n,e){e.value._routerState=n,e.children.forEach(t=>Vm(n,t))}function yI(n){const e=n.children.length>0?` { ${n.children.map(yI).join(", ")} } `:"";return`${n.value}${e}`}function av(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,No(e.queryParams,t.queryParams)||n.queryParams.next(t.queryParams),e.fragment!==t.fragment&&n.fragment.next(t.fragment),No(e.params,t.params)||n.params.next(t.params),function Am(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!No(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.url.next(t.url),No(e.data,t.data)||n.data.next(t.data)}else n.snapshot=n._futureSnapshot,n.data.next(n._futureSnapshot.data)}function uv(n,e){const t=No(n.params,e.params)&&function Zy(n,e){return wu(n,e)&&n.every((t,r)=>No(t.parameters,e[r].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||uv(n.parent,e.parent))}function dd(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const r=t.value;r._futureSnapshot=e.value;const i=function YT(n,e,t){return e.children.map(r=>{for(const i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return dd(n,r,i);return dd(n,r)})}(n,e,t);return new Yi(r,i)}{if(n.shouldAttach(e.value)){const a=n.retrieve(e.value);if(null!==a){const l=a.route;return l.value._futureSnapshot=e.value,l.children=e.children.map(d=>dd(n,d)),l}}const r=function QT(n){return new Fo(new ws(n.url),new ws(n.params),new ws(n.queryParams),new ws(n.fragment),new ws(n.data),n.outlet,n.component,n)}(e.value),i=e.children.map(a=>dd(n,a));return new Yi(r,i)}}const lv="ngNavigationCancelingError";function cv(n,e){const{redirectTo:t,navigationBehaviorOptions:r}=lr(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=vI(!1,0,e);return i.url=t,i.navigationBehaviorOptions=r,i}function vI(n,e,t){const r=new Error("NavigationCancelingError: "+(n||""));return r[lv]=!0,r.cancellationCode=e,t&&(r.url=t),r}function wI(n){return Ii(n)&&lr(n.url)}function Ii(n){return n&&n[lv]}class dv{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Ph,this.attachRef=null}}let Ph=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,r){const i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){const r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new dv,this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Oh=!1;let Yr=(()=>{class n{constructor(t,r,i,a,l){this.parentContexts=t,this.location=r,this.changeDetector=a,this.environmentInjector=l,this.activated=null,this._activatedRoute=null,this.activateEvents=new f.vpe,this.deactivateEvents=new f.vpe,this.attachEvents=new f.vpe,this.detachEvents=new f.vpe,this.name=i||Mt,t.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.getContext(this.name)?.outlet===this&&this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const t=this.parentContexts.getContext(this.name);t&&t.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new f.vHH(4012,Oh);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new f.vHH(4012,Oh);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new f.vHH(4012,Oh);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new f.vHH(4013,Oh);this._activatedRoute=t;const i=this.location,l=t._futureSnapshot.component,d=this.parentContexts.getOrCreateContext(this.name).children,_=new Sp(t,d,i.injector);if(r&&function EI(n){return!!n.resolveComponentFactory}(r)){const w=r.resolveComponentFactory(l);this.activated=i.createComponent(w,i.length,_)}else this.activated=i.createComponent(l,{index:i.length,injector:_,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(Ph),f.Y36(f.s_b),f.$8M("name"),f.Y36(f.sBO),f.Y36(f.lqb))},n.\u0275dir=f.lG2({type:n,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0}),n})();class Sp{constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Fo?this.route:e===Ph?this.childContexts:this.parent.get(e,t)}}let hv=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=f.Xpm({type:n,selectors:[["ng-component"]],standalone:!0,features:[f.jDz],decls:1,vars:0,template:function(t,r){1&t&&f._UZ(0,"router-outlet")},dependencies:[Yr],encapsulation:2}),n})();function II(n,e){return n.providers&&!n._injector&&(n._injector=(0,f.MMx)(n.providers,e,`Route: ${n.path}`)),n._injector??e}function fv(n){const e=n.children&&n.children.map(fv),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Mt&&(t.component=hv),t}function Qs(n){return n.outlet||Mt}function hd(n,e){const t=n.filter(r=>Qs(r)===e);return t.push(...n.filter(r=>Qs(r)!==e)),t}function Is(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class iS{constructor(e,t,r,i){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i}activate(e){const t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),av(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){const i=Tu(t);e.children.forEach(a=>{const l=a.value.outlet;this.deactivateRoutes(a,i[l],r),delete i[l]}),Tr(i,(a,l)=>{this.deactivateRouteAndItsChildren(a,r)})}deactivateRoutes(e,t,r){const i=e.value,a=t?t.value:null;if(i===a)if(i.component){const l=r.getContext(i.outlet);l&&this.deactivateChildRoutes(e,t,l.children)}else this.deactivateChildRoutes(e,t,r);else a&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,a=Tu(e);for(const l of Object.keys(a))this.deactivateRouteAndItsChildren(a[l],i);if(r&&r.outlet){const l=r.outlet.detach(),d=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:l,route:e,contexts:d})}}deactivateRouteAndOutlet(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,a=Tu(e);for(const l of Object.keys(a))this.deactivateRouteAndItsChildren(a[l],i);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(e,t,r){const i=Tu(t);e.children.forEach(a=>{this.activateRoutes(a,i[a.value.outlet],r),this.forwardEvent(new Pm(a.value.snapshot))}),e.children.length&&this.forwardEvent(new rv(e.value.snapshot))}activateRoutes(e,t,r){const i=e.value,a=t?t.value:null;if(av(i),i===a)if(i.component){const l=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,l.children)}else this.activateChildRoutes(e,t,r);else if(i.component){const l=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const d=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),l.children.onOutletReAttached(d.contexts),l.attachRef=d.componentRef,l.route=d.route.value,l.outlet&&l.outlet.attach(d.componentRef,d.route.value),av(d.route.value),this.activateChildRoutes(e,null,l.children)}else{const d=Is(i.snapshot),_=d?.get(f._Vd)??null;l.attachRef=null,l.route=i,l.resolver=_,l.injector=d,l.outlet&&l.outlet.activateWith(i,l.injector),this.activateChildRoutes(e,null,l.children)}}else this.activateChildRoutes(e,null,r)}}class sS{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class pv{constructor(e,t){this.component=e,this.route=t}}function CI(n,e,t){const r=n._root;return fd(r,e?e._root:null,t,[r.value])}function Fi(n,e){const t=Symbol(),r=e.get(n,t);return r===t?"function"!=typeof n||(0,f.Z0I)(n)?e.get(n):n:r}function fd(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const a=Tu(e);return n.children.forEach(l=>{(function gv(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const a=n.value,l=e?e.value:null,d=t?t.getContext(n.value.outlet):null;if(l&&a.routeConfig===l.routeConfig){const _=function oS(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!wu(n.url,e.url);case"pathParamsOrQueryParamsChange":return!wu(n.url,e.url)||!No(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!uv(n,e)||!No(n.queryParams,e.queryParams);default:return!uv(n,e)}}(l,a,a.routeConfig.runGuardsAndResolvers);_?i.canActivateChecks.push(new sS(r)):(a.data=l.data,a._resolvedData=l._resolvedData),fd(n,e,a.component?d?d.children:null:t,r,i),_&&d&&d.outlet&&d.outlet.isActivated&&i.canDeactivateChecks.push(new pv(d.outlet.component,l))}else l&&Fh(e,d,i),i.canActivateChecks.push(new sS(r)),fd(n,null,a.component?d?d.children:null:t,r,i)})(l,a[l.value.outlet],t,r.concat([l.value]),i),delete a[l.value.outlet]}),Tr(a,(l,d)=>Fh(l,t.getContext(d),i)),i}function Fh(n,e,t){const r=Tu(n),i=n.value;Tr(r,(a,l)=>{Fh(a,i.component?e?e.children.getContext(l):null:e,t)}),t.canDeactivateChecks.push(new pv(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function Ap(n){return"function"==typeof n}function Rp(n){return n instanceof Kc||"EmptyError"===n?.name}const Mp=Symbol("INITIAL_VALUE");function Vh(){return Yn(n=>gu(n.map(e=>e.pipe(Ei(1),ga(Mp)))).pipe((0,ft.U)(e=>{for(const t of e)if(!0!==t){if(t===Mp)return Mp;if(!1===t||t instanceof ko)return t}return!0}),kr(e=>e!==Mp),Ei(1)))}function wv(n){return(0,Dm.z)((0,di.b)(e=>{if(lr(e))throw cv(0,e)}),(0,ft.U)(e=>!0===e))}const Iv={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function TI(n,e,t,r,i){const a=Bm(n,e,t);return a.matched?function Ev(n,e,t,r){const i=e.canMatch;return i&&0!==i.length?it(i.map(l=>{const d=Fi(l,n);return ya(function bI(n){return n&&Ap(n.canMatch)}(d)?d.canMatch(e,t):n.runInContext(()=>d(e,t)))})).pipe(Vh(),wv()):it(!0)}(r=II(e,r),e,t).pipe((0,ft.U)(l=>!0===l?a:{...Iv})):it(a)}function Bm(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...Iv}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const i=(e.matcher||fI)(t,n,e);if(!i)return{...Iv};const a={};Tr(i.posParams,(d,_)=>{a[_]=d.path});const l=i.consumed.length>0?{...a,...i.consumed[i.consumed.length-1].parameters}:a;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:l,positionalParamSegments:i.posParams??{}}}function Np(n,e,t,r,i="corrected"){if(t.length>0&&function AI(n,e,t){return t.some(r=>Cv(n,e,r)&&Qs(r)!==Mt)}(n,t,r)){const l=new $t(e,function SI(n,e,t,r){const i={};i[Mt]=r,r._sourceSegment=n,r._segmentIndexShift=e.length;for(const a of t)if(""===a.path&&Qs(a)!==Mt){const l=new $t([],{});l._sourceSegment=n,l._segmentIndexShift=e.length,i[Qs(a)]=l}return i}(n,e,r,new $t(t,n.children)));return l._sourceSegment=n,l._segmentIndexShift=e.length,{segmentGroup:l,slicedSegments:[]}}if(0===t.length&&function gS(n,e,t){return t.some(r=>Cv(n,e,r))}(n,t,r)){const l=new $t(n.segments,function pd(n,e,t,r,i,a){const l={};for(const d of r)if(Cv(n,t,d)&&!i[Qs(d)]){const _=new $t([],{});_._sourceSegment=n,_._segmentIndexShift="legacy"===a?n.segments.length:e.length,l[Qs(d)]=_}return{...i,...l}}(n,e,t,r,n.children,i));return l._sourceSegment=n,l._segmentIndexShift=e.length,{segmentGroup:l,slicedSegments:t}}const a=new $t(n.segments,n.children);return a._sourceSegment=n,a._segmentIndexShift=e.length,{segmentGroup:a,slicedSegments:t}}function Cv(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}function kp(n,e,t,r){return!!(Qs(n)===r||r!==Mt&&Cv(e,t,n))&&("**"===n.path||Bm(e,n,t).matched)}function xI(n,e,t){return 0===e.length&&!n.children[t]}const Pp=!1;class Op{constructor(e){this.segmentGroup=e||null}}class bv{constructor(e){this.urlTree=e}}function gd(n){return pa(new Op(n))}function Dv(n){return pa(new bv(n))}class Tv{constructor(e,t,r,i,a){this.injector=e,this.configLoader=t,this.urlSerializer=r,this.urlTree=i,this.config=a,this.allowRedirects=!0}apply(){const e=Np(this.urlTree.root,[],[],this.config).segmentGroup,t=new $t(e.segments,e.children);return this.expandSegmentGroup(this.injector,this.config,t,Mt).pipe((0,ft.U)(a=>this.createUrlTree(Cu(a),this.urlTree.queryParams,this.urlTree.fragment))).pipe(_u(a=>{if(a instanceof bv)return this.allowRedirects=!1,this.match(a.urlTree);throw a instanceof Op?this.noMatchError(a):a}))}match(e){return this.expandSegmentGroup(this.injector,this.config,e.root,Mt).pipe((0,ft.U)(i=>this.createUrlTree(Cu(i),e.queryParams,e.fragment))).pipe(_u(i=>{throw i instanceof Op?this.noMatchError(i):i}))}noMatchError(e){return new f.vHH(4002,Pp)}createUrlTree(e,t,r){const i=Ip(e);return new ko(i,t,r)}expandSegmentGroup(e,t,r,i){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(e,t,r).pipe((0,ft.U)(a=>new $t([],a))):this.expandSegment(e,r,t,r.segments,i,!0)}expandChildren(e,t,r){const i=[];for(const a of Object.keys(r.children))"primary"===a?i.unshift(a):i.push(a);return(0,zt.D)(i).pipe(_s(a=>{const l=r.children[a],d=hd(t,a);return this.expandSegmentGroup(e,d,l,a).pipe((0,ft.U)(_=>({segment:_,outlet:a})))}),_a((a,l)=>(a[l.outlet]=l.segment,a),{}),zy())}expandSegment(e,t,r,i,a,l){return(0,zt.D)(r).pipe(_s(d=>this.expandSegmentAgainstRoute(e,t,r,d,i,a,l).pipe(_u(w=>{if(w instanceof Op)return it(null);throw w}))),ma(d=>!!d),_u((d,_)=>{if(Rp(d))return xI(t,i,a)?it(new $t([],{})):gd(t);throw d}))}expandSegmentAgainstRoute(e,t,r,i,a,l,d){return kp(i,t,a,l)?void 0===i.redirectTo?this.matchSegmentAgainstRoute(e,t,i,a,l):d&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l):gd(t):gd(t)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,i,l):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,r,i){const a=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?Dv(a):this.lineralizeSegments(r,a).pipe((0,fn.z)(l=>{const d=new $t(l,{});return this.expandSegment(e,d,t,l,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,a,l){const{matched:d,consumedSegments:_,remainingSegments:w,positionalParamSegments:D}=Bm(t,i,a);if(!d)return gd(t);const S=this.applyRedirectCommands(_,i.redirectTo,D);return i.redirectTo.startsWith("/")?Dv(S):this.lineralizeSegments(i,S).pipe((0,fn.z)(M=>this.expandSegment(e,t,r,M.concat(w),l,!1)))}matchSegmentAgainstRoute(e,t,r,i,a){return"**"===r.path?(e=II(r,e),r.loadChildren?(r._loadedRoutes?it({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(e,r)).pipe((0,ft.U)(d=>(r._loadedRoutes=d.routes,r._loadedInjector=d.injector,new $t(i,{})))):it(new $t(i,{}))):TI(t,r,i,e).pipe(Yn(({matched:l,consumedSegments:d,remainingSegments:_})=>l?this.getChildConfig(e=r._injector??e,r,i).pipe((0,fn.z)(D=>{const S=D.injector??e,M=D.routes,{segmentGroup:O,slicedSegments:j}=Np(t,d,_,M),ae=new $t(O.segments,O.children);if(0===j.length&&ae.hasChildren())return this.expandChildren(S,M,ae).pipe((0,ft.U)(et=>new $t(d,et)));if(0===M.length&&0===j.length)return it(new $t(d,{}));const he=Qs(r)===a;return this.expandSegment(S,ae,M,j,he?Mt:a,!0).pipe((0,ft.U)(nt=>new $t(d.concat(nt.segments),nt.children)))})):gd(t)))}getChildConfig(e,t,r){return t.children?it({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?it({routes:t._loadedRoutes,injector:t._loadedInjector}):function vv(n,e,t,r){const i=e.canLoad;return void 0===i||0===i.length?it(!0):it(i.map(l=>{const d=Fi(l,n);return ya(function aS(n){return n&&Ap(n.canLoad)}(d)?d.canLoad(e,t):n.runInContext(()=>d(e,t)))})).pipe(Vh(),wv())}(e,t,r).pipe((0,fn.z)(i=>i?this.configLoader.loadChildren(e,t).pipe((0,di.b)(a=>{t._loadedRoutes=a.routes,t._loadedInjector=a.injector})):function Hm(n){return pa(vI(Pp,3))}())):it({routes:[],injector:e})}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return it(r);if(i.numberOfChildren>1||!i.children[Mt])return pa(new f.vHH(4e3,Pp));i=i.children[Mt]}}applyRedirectCommands(e,t,r){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r)}applyRedirectCreateUrlTree(e,t,r,i){const a=this.createSegmentGroup(e,t.root,r,i);return new ko(a,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const r={};return Tr(e,(i,a)=>{if("string"==typeof i&&i.startsWith(":")){const d=i.substring(1);r[a]=t[d]}else r[a]=i}),r}createSegmentGroup(e,t,r,i){const a=this.createSegments(e,t.segments,r,i);let l={};return Tr(t.children,(d,_)=>{l[_]=this.createSegmentGroup(e,d,r,i)}),new $t(a,l)}createSegments(e,t,r,i){return t.map(a=>a.path.startsWith(":")?this.findPosParam(e,a,i):this.findOrReturn(a,r))}findPosParam(e,t,r){const i=r[t.path.substring(1)];if(!i)throw new f.vHH(4001,Pp);return i}findOrReturn(e,t){let r=0;for(const i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}}class Fp{}class _S{constructor(e,t,r,i,a,l,d,_){this.injector=e,this.rootComponentType=t,this.config=r,this.urlTree=i,this.url=a,this.paramsInheritanceStrategy=l,this.relativeLinkResolution=d,this.urlSerializer=_}recognize(){const e=Np(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo),this.relativeLinkResolution).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,Mt).pipe((0,ft.U)(t=>{if(null===t)return null;const r=new Lm([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Mt,this.rootComponentType,null,this.urlTree.root,-1,{}),i=new Yi(r,t),a=new _I(this.url,i);return this.inheritParamsAndData(a._root),a}))}inheritParamsAndData(e){const t=e.value,r=kh(t,this.paramsInheritanceStrategy);t.params=Object.freeze(r.params),t.data=Object.freeze(r.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,r,i){return 0===r.segments.length&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i)}processChildren(e,t,r){return(0,zt.D)(Object.keys(r.children)).pipe(_s(i=>{const a=r.children[i],l=hd(t,i);return this.processSegmentGroup(e,l,a,i)}),_a((i,a)=>i&&a?(i.push(...a),i):null),function yu(n,e=!1){return(0,An.e)((t,r)=>{let i=0;t.subscribe((0,pn.x)(r,a=>{const l=n(a,i++);(l||e)&&r.next(a),!l&&r.complete()}))})}(i=>null!==i),Xc(null),zy(),(0,ft.U)(i=>{if(null===i)return null;const a=Av(i);return function yS(n){n.sort((e,t)=>e.value.outlet===Mt?-1:t.value.outlet===Mt?1:e.value.outlet.localeCompare(t.value.outlet))}(a),a}))}processSegment(e,t,r,i,a){return(0,zt.D)(t).pipe(_s(l=>this.processSegmentAgainstRoute(l._injector??e,l,r,i,a)),ma(l=>!!l),_u(l=>{if(Rp(l))return xI(r,i,a)?it([]):it(null);throw l}))}processSegmentAgainstRoute(e,t,r,i,a){if(t.redirectTo||!kp(t,r,i,a))return it(null);let l;if("**"===t.path){const d=i.length>0?qy(i).parameters:{},_=PI(r)+i.length;l=it({snapshot:new Lm(i,d,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,OI(t),Qs(t),t.component??t._loadedComponent??null,t,xv(r),_,FI(t),_),consumedSegments:[],remainingSegments:[]})}else l=TI(r,t,i,e).pipe((0,ft.U)(({matched:d,consumedSegments:_,remainingSegments:w,parameters:D})=>{if(!d)return null;const S=PI(r)+_.length;return{snapshot:new Lm(_,D,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,OI(t),Qs(t),t.component??t._loadedComponent??null,t,xv(r),S,FI(t),S),consumedSegments:_,remainingSegments:w}}));return l.pipe(Yn(d=>{if(null===d)return it(null);const{snapshot:_,consumedSegments:w,remainingSegments:D}=d;e=t._injector??e;const S=t._loadedInjector??e,M=function kI(n){return n.children?n.children:n.loadChildren?n._loadedRoutes:[]}(t),{segmentGroup:O,slicedSegments:j}=Np(r,w,D,M.filter(he=>void 0===he.redirectTo),this.relativeLinkResolution);if(0===j.length&&O.hasChildren())return this.processChildren(S,M,O).pipe((0,ft.U)(he=>null===he?null:[new Yi(_,he)]));if(0===M.length&&0===j.length)return it([new Yi(_,[])]);const ae=Qs(t)===a;return this.processSegment(S,M,O,j,ae?Mt:a).pipe((0,ft.U)(he=>null===he?null:[new Yi(_,he)]))}))}}function Sv(n){const e=n.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function Av(n){const e=[],t=new Set;for(const r of n){if(!Sv(r)){e.push(r);continue}const i=e.find(a=>r.value.routeConfig===a.value.routeConfig);void 0!==i?(i.children.push(...r.children),t.add(i)):e.push(r)}for(const r of t){const i=Av(r.children);e.push(new Yi(r.value,i))}return e.filter(r=>!t.has(r))}function xv(n){let e=n;for(;e._sourceSegment;)e=e._sourceSegment;return e}function PI(n){let e=n,t=e._segmentIndexShift??0;for(;e._sourceSegment;)e=e._sourceSegment,t+=e._segmentIndexShift??0;return t-1}function OI(n){return n.data||{}}function FI(n){return n.resolve||{}}function VI(n){return"string"==typeof n.title||null===n.title}function $m(n){return Yn(e=>{const t=n(e);return t?(0,zt.D)(t).pipe((0,ft.U)(()=>e)):it(e)})}let UI=(()=>{class n{buildTitle(t){let r,i=t.root;for(;void 0!==i;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(a=>a.outlet===Mt);return r}getResolvedTitleForRoute(t){return t.data[Nl]}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=f.Yz7({token:n,factory:function(){return(0,f.f3M)(BI)},providedIn:"root"}),n})(),BI=(()=>{class n extends UI{constructor(t){super(),this.title=t}updateTitle(t){const r=this.buildTitle(t);void 0!==r&&this.title.setTitle(r)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(ps))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class Vt{}class HI extends class jI{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}{}const Gm=new f.OlP("",{providedIn:"root",factory:()=>({})}),Wm=new f.OlP("ROUTES");let Mv=(()=>{class n{constructor(t,r){this.injector=t,this.compiler=r,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return it(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const r=ya(t.loadComponent()).pipe((0,di.b)(a=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=a}),Es(()=>{this.componentLoaders.delete(t)})),i=new hp(r,()=>new Zs.x).pipe(dp());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return it({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const a=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe((0,ft.U)(d=>{this.onLoadEndListener&&this.onLoadEndListener(r);let _,w,D=!1;Array.isArray(d)?w=d:(_=d.create(t).injector,w=kl(_.get(Wm,[],f.XFs.Self|f.XFs.Optional)));return{routes:w.map(fv),injector:_}}),Es(()=>{this.childrenLoaders.delete(r)})),l=new hp(a,()=>new Zs.x).pipe(dp());return this.childrenLoaders.set(r,l),l}loadModuleFactoryOrRoutes(t){return ya(t()).pipe((0,fn.z)(r=>r instanceof f.YKP||Array.isArray(r)?it(r):(0,zt.D)(this.compiler.compileModuleAsync(r))))}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(f.zs3),f.LFG(f.Sil))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class WI{}class CS{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,t){return e}}function IN(n){throw n}function zI(n,e,t){return e.parse("/")}const qI={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},md={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};function qm(){const n=(0,f.f3M)(Rm),e=(0,f.f3M)(Ph),t=(0,f.f3M)(Re),r=(0,f.f3M)(f.zs3),i=(0,f.f3M)(f.Sil),a=(0,f.f3M)(Wm,{optional:!0})??[],l=(0,f.f3M)(Gm,{optional:!0})??{},d=(0,f.f3M)(BI),_=(0,f.f3M)(UI,{optional:!0}),w=(0,f.f3M)(WI,{optional:!0}),D=(0,f.f3M)(Vt,{optional:!0}),S=new Sr(null,n,e,t,r,i,kl(a));return w&&(S.urlHandlingStrategy=w),D&&(S.routeReuseStrategy=D),S.titleStrategy=_??d,function bS(n,e){n.errorHandler&&(e.errorHandler=n.errorHandler),n.malformedUriErrorHandler&&(e.malformedUriErrorHandler=n.malformedUriErrorHandler),n.onSameUrlNavigation&&(e.onSameUrlNavigation=n.onSameUrlNavigation),n.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=n.paramsInheritanceStrategy),n.relativeLinkResolution&&(e.relativeLinkResolution=n.relativeLinkResolution),n.urlUpdateStrategy&&(e.urlUpdateStrategy=n.urlUpdateStrategy),n.canceledNavigationResolution&&(e.canceledNavigationResolution=n.canceledNavigationResolution)}(l,S),S}let Sr=(()=>{class n{constructor(t,r,i,a,l,d,_){this.rootComponentType=t,this.urlSerializer=r,this.rootContexts=i,this.location=a,this.config=_,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Zs.x,this.errorHandler=IN,this.malformedUriErrorHandler=zI,this.navigated=!1,this.lastSuccessfulId=-1,this.afterPreactivation=()=>it(void 0),this.urlHandlingStrategy=new CS,this.routeReuseStrategy=new HI,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.configLoader=l.get(Mv),this.configLoader.onLoadEndListener=M=>this.triggerEvent(new nv(M)),this.configLoader.onLoadStartListener=M=>this.triggerEvent(new Tp(M)),this.ngModule=l.get(f.h0i),this.console=l.get(f.c2e);const S=l.get(f.R0b);this.isNgZoneEnabled=S instanceof f.R0b&&f.R0b.isInAngularZone(),this.resetConfig(_),this.currentUrlTree=function xm(){return new ko(new $t([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=Fm(this.currentUrlTree,this.rootComponentType),this.transitions=new ws({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(t){const r=this.events;return t.pipe(kr(i=>0!==i.id),(0,ft.U)(i=>({...i,extractedUrl:this.urlHandlingStrategy.extract(i.rawUrl)})),Yn(i=>{let a=!1,l=!1;return it(i).pipe((0,di.b)(d=>{this.currentNavigation={id:d.id,initialUrl:d.rawUrl,extractedUrl:d.extractedUrl,trigger:d.source,extras:d.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),Yn(d=>{const _=this.browserUrlTree.toString(),w=!this.navigated||d.extractedUrl.toString()!==_||_!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||w)&&this.urlHandlingStrategy.shouldProcessUrl(d.rawUrl))return TS(d.source)&&(this.browserUrlTree=d.extractedUrl),it(d).pipe(Yn(S=>{const M=this.transitions.getValue();return r.next(new k(S.id,this.serializeUrl(S.extractedUrl),S.source,S.restoredState)),M!==this.transitions.getValue()?mu.E:Promise.resolve(S)}),function MI(n,e,t,r){return Yn(i=>function RI(n,e,t,r,i){return new Tv(n,e,t,r,i).apply()}(n,e,t,i.extractedUrl,r).pipe((0,ft.U)(a=>({...i,urlAfterRedirects:a}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),(0,di.b)(S=>{this.currentNavigation={...this.currentNavigation,finalUrl:S.urlAfterRedirects},i.urlAfterRedirects=S.urlAfterRedirects}),function Lo(n,e,t,r,i,a){return(0,fn.z)(l=>function NI(n,e,t,r,i,a,l="emptyOnly",d="legacy"){return new _S(n,e,t,r,i,l,d,a).recognize().pipe(Yn(_=>null===_?function mS(n){return new Nr.y(e=>e.error(n))}(new Fp):it(_)))}(n,e,t,l.urlAfterRedirects,r.serialize(l.urlAfterRedirects),r,i,a).pipe((0,ft.U)(d=>({...l,targetSnapshot:d}))))}(this.ngModule.injector,this.rootComponentType,this.config,this.urlSerializer,this.paramsInheritanceStrategy,this.relativeLinkResolution),(0,di.b)(S=>{if(i.targetSnapshot=S.targetSnapshot,"eager"===this.urlUpdateStrategy){if(!S.extras.skipLocationChange){const O=this.urlHandlingStrategy.merge(S.urlAfterRedirects,S.rawUrl);this.setBrowserUrl(O,S)}this.browserUrlTree=S.urlAfterRedirects}const M=new Qe(S.id,this.serializeUrl(S.extractedUrl),this.serializeUrl(S.urlAfterRedirects),S.targetSnapshot);r.next(M)}));if(w&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:M,extractedUrl:O,source:j,restoredState:ae,extras:he}=d,$e=new k(M,this.serializeUrl(O),j,ae);r.next($e);const nt=Fm(O,this.rootComponentType).snapshot;return it(i={...d,targetSnapshot:nt,urlAfterRedirects:O,extras:{...he,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=d.rawUrl,d.resolve(null),mu.E}),(0,di.b)(d=>{const _=new wt(d.id,this.serializeUrl(d.extractedUrl),this.serializeUrl(d.urlAfterRedirects),d.targetSnapshot);this.triggerEvent(_)}),(0,ft.U)(d=>i={...d,guards:CI(d.targetSnapshot,d.currentSnapshot,this.rootContexts)}),function yv(n,e){return(0,fn.z)(t=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:a,canDeactivateChecks:l}}=t;return 0===l.length&&0===a.length?it({...t,guardsResult:!0}):function lS(n,e,t,r){return(0,zt.D)(n).pipe((0,fn.z)(i=>function DI(n,e,t,r,i){const a=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return a&&0!==a.length?it(a.map(d=>{const _=Is(e)??i,w=Fi(d,_);return ya(function _v(n){return n&&Ap(n.canDeactivate)}(w)?w.canDeactivate(n,e,t,r):_.runInContext(()=>w(n,e,t,r))).pipe(ma())})).pipe(Vh()):it(!0)}(i.component,i.route,t,e,r)),ma(i=>!0!==i,!0))}(l,r,i,n).pipe((0,fn.z)(d=>d&&function xp(n){return"boolean"==typeof n}(d)?function cS(n,e,t,r){return(0,zt.D)(e).pipe(_s(i=>Jc(function hS(n,e){return null!==n&&e&&e(new ud(n)),it(!0)}(i.route.parent,r),function dS(n,e){return null!==n&&e&&e(new iv(n)),it(!0)}(i.route,r),function pS(n,e,t){const r=e[e.length-1],a=e.slice(0,e.length-1).reverse().map(l=>function vN(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(l)).filter(l=>null!==l).map(l=>cp(()=>it(l.guards.map(_=>{const w=Is(l.node)??t,D=Fi(_,w);return ya(function mv(n){return n&&Ap(n.canActivateChild)}(D)?D.canActivateChild(r,n):w.runInContext(()=>D(r,n))).pipe(ma())})).pipe(Vh())));return it(a).pipe(Vh())}(n,i.path,t),function fS(n,e,t){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return it(!0);const i=r.map(a=>cp(()=>{const l=Is(e)??t,d=Fi(a,l);return ya(function uS(n){return n&&Ap(n.canActivate)}(d)?d.canActivate(e,n):l.runInContext(()=>d(e,n))).pipe(ma())}));return it(i).pipe(Vh())}(n,i.route,t))),ma(i=>!0!==i,!0))}(r,a,n,e):it(d)),(0,ft.U)(d=>({...t,guardsResult:d})))})}(this.ngModule.injector,d=>this.triggerEvent(d)),(0,di.b)(d=>{if(i.guardsResult=d.guardsResult,lr(d.guardsResult))throw cv(0,d.guardsResult);const _=new vt(d.id,this.serializeUrl(d.extractedUrl),this.serializeUrl(d.urlAfterRedirects),d.targetSnapshot,!!d.guardsResult);this.triggerEvent(_)}),kr(d=>!!d.guardsResult||(this.restoreHistory(d),this.cancelNavigationTransition(d,"",3),!1)),$m(d=>{if(d.guards.canActivateChecks.length)return it(d).pipe((0,di.b)(_=>{const w=new yr(_.id,this.serializeUrl(_.extractedUrl),this.serializeUrl(_.urlAfterRedirects),_.targetSnapshot);this.triggerEvent(w)}),Yn(_=>{let w=!1;return it(_).pipe(function vS(n,e){return(0,fn.z)(t=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return it(t);let a=0;return(0,zt.D)(i).pipe(_s(l=>function LI(n,e,t,r){const i=n.routeConfig,a=n._resolve;return void 0!==i?.title&&!VI(i)&&(a[Nl]=i.title),function wS(n,e,t,r){const i=function ES(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===i.length)return it({});const a={};return(0,zt.D)(i).pipe((0,fn.z)(l=>function IS(n,e,t,r){const i=Is(e)??r,a=Fi(n,i);return ya(a.resolve?a.resolve(e,t):i.runInContext(()=>a(e,t)))}(n[l],e,t,r).pipe(ma(),(0,di.b)(d=>{a[l]=d}))),fp(1),function pp(n){return(0,ft.U)(()=>n)}(a),_u(l=>Rp(l)?mu.E:pa(l)))}(a,n,e,r).pipe((0,ft.U)(l=>(n._resolvedData=l,n.data=kh(n,t).resolve,i&&VI(i)&&(n.data[Nl]=i.title),null)))}(l.route,r,n,e)),(0,di.b)(()=>a++),fp(1),(0,fn.z)(l=>a===i.length?it(t):mu.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),(0,di.b)({next:()=>w=!0,complete:()=>{w||(this.restoreHistory(_),this.cancelNavigationTransition(_,"",2))}}))}),(0,di.b)(_=>{const w=new Oi(_.id,this.serializeUrl(_.extractedUrl),this.serializeUrl(_.urlAfterRedirects),_.targetSnapshot);this.triggerEvent(w)}))}),$m(d=>{const _=w=>{const D=[];w.routeConfig?.loadComponent&&!w.routeConfig._loadedComponent&&D.push(this.configLoader.loadComponent(w.routeConfig).pipe((0,di.b)(S=>{w.component=S}),(0,ft.U)(()=>{})));for(const S of w.children)D.push(..._(S));return D};return gu(_(d.targetSnapshot.root)).pipe(Xc(),Ei(1))}),$m(()=>this.afterPreactivation()),(0,ft.U)(d=>{const _=function ZT(n,e,t){const r=dd(n,e._root,t?t._root:void 0);return new ov(r,e)}(this.routeReuseStrategy,d.targetSnapshot,d.currentRouterState);return i={...d,targetRouterState:_}}),(0,di.b)(d=>{this.currentUrlTree=d.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(d.urlAfterRedirects,d.rawUrl),this.routerState=d.targetRouterState,"deferred"===this.urlUpdateStrategy&&(d.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,d),this.browserUrlTree=d.urlAfterRedirects)}),((n,e,t)=>(0,ft.U)(r=>(new iS(e,r.targetRouterState,r.currentRouterState,t).activate(n),r)))(this.rootContexts,this.routeReuseStrategy,d=>this.triggerEvent(d)),(0,di.b)({next(){a=!0},complete(){a=!0}}),Es(()=>{a||l||this.cancelNavigationTransition(i,"",1),this.currentNavigation?.id===i.id&&(this.currentNavigation=null)}),_u(d=>{if(l=!0,Ii(d)){wI(d)||(this.navigated=!0,this.restoreHistory(i,!0));const _=new le(i.id,this.serializeUrl(i.extractedUrl),d.message,d.cancellationCode);if(r.next(_),wI(d)){const w=this.urlHandlingStrategy.merge(d.url,this.rawUrlTree),D={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||TS(i.source)};this.scheduleNavigation(w,"imperative",null,D,{resolve:i.resolve,reject:i.reject,promise:i.promise})}else i.resolve(!1)}else{this.restoreHistory(i,!0);const _=new Le(i.id,this.serializeUrl(i.extractedUrl),d,i.targetSnapshot??void 0);r.next(_);try{i.resolve(this.errorHandler(d))}catch(w){i.reject(w)}}return mu.E}))}))}resetRootComponentType(t){this.rootComponentType=t,this.routerState.root.component=this.rootComponentType}setTransition(t){this.transitions.next({...this.transitions.value,...t})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const r="popstate"===t.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{const i={replaceUrl:!0},a=t.state?.navigationId?t.state:null;if(a){const d={...a};delete d.navigationId,delete d.\u0275routerPageId,0!==Object.keys(d).length&&(i.state=d)}const l=this.parseUrl(t.url);this.scheduleNavigation(l,r,a,i)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(t){this.events.next(t)}resetConfig(t){this.config=t.map(fv),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,r={}){const{relativeTo:i,queryParams:a,fragment:l,queryParamsHandling:d,preserveFragment:_}=r,w=i||this.routerState.root,D=_?this.currentUrlTree.fragment:l;let S=null;switch(d){case"merge":S={...this.currentUrlTree.queryParams,...a};break;case"preserve":S=this.currentUrlTree.queryParams;break;default:S=a||null}return null!==S&&(S=this.removeEmptyProps(S)),Cp(w,this.currentUrlTree,t,S,D??null)}navigateByUrl(t,r={skipLocationChange:!1}){const i=lr(t)?t:this.parseUrl(t),a=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(a,"imperative",null,r)}navigate(t,r={skipLocationChange:!1}){return function DS(n){for(let e=0;e<n.length;e++){if(null==n[e])throw new f.vHH(4008,false)}}(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let r;try{r=this.urlSerializer.parse(t)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,t)}return r}isActive(t,r){let i;if(i=!0===r?{...qI}:!1===r?{...md}:r,lr(t))return ed(this.currentUrlTree,t,i);const a=this.parseUrl(t);return ed(this.currentUrlTree,a,i)}removeEmptyProps(t){return Object.keys(t).reduce((r,i)=>{const a=t[i];return null!=a&&(r[i]=a),r},{})}processNavigations(){this.navigations.subscribe(t=>{this.navigated=!0,this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId,this.events.next(new q(t.id,this.serializeUrl(t.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,this.titleStrategy?.updateTitle(this.routerState.snapshot),t.resolve(!0)},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}scheduleNavigation(t,r,i,a,l){if(this.disposed)return Promise.resolve(!1);let d,_,w;l?(d=l.resolve,_=l.reject,w=l.promise):w=new Promise((M,O)=>{d=M,_=O});const D=++this.navigationId;let S;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(i=this.location.getState()),S=i&&i.\u0275routerPageId?i.\u0275routerPageId:a.replaceUrl||a.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):S=0,this.setTransition({id:D,targetPageId:S,source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:t,extras:a,resolve:d,reject:_,promise:w,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),w.catch(M=>Promise.reject(M))}setBrowserUrl(t,r){const i=this.urlSerializer.serialize(t),a={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl?this.location.replaceState(i,"",a):this.location.go(i,"",a)}restoreHistory(t,r=!1){if("computed"===this.canceledNavigationResolution){const i=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===i?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===i&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(i)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(t,r,i){const a=new le(t.id,this.serializeUrl(t.extractedUrl),r,i);this.triggerEvent(a),t.resolve(!1)}generateNgRouterState(t,r){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}}return n.\u0275fac=function(t){f.$Z()},n.\u0275prov=f.Yz7({token:n,factory:function(){return qm()},providedIn:"root"}),n})();function TS(n){return"imperative"!==n}let Nv=(()=>{class n{constructor(t,r,i,a,l){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=a,this.el=l,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.onChanges=new Zs.x,this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(t){this._preserveFragment=(0,f.D6c)(t)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(t){this._skipLocationChange=(0,f.D6c)(t)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(t){this._replaceUrl=(0,f.D6c)(t)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(t){if(null!=this.tabIndexAttribute)return;const r=this.renderer,i=this.el.nativeElement;null!==t?r.setAttribute(i,"tabindex",t):r.removeAttribute(i,"tabindex")}ngOnChanges(t){this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){return null===this.urlTree||this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(Sr),f.Y36(Fo),f.$8M("tabindex"),f.Y36(f.Qsj),f.Y36(f.SBq))},n.\u0275dir=f.lG2({type:n,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(t,r){1&t&&f.NdJ("click",function(){return r.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[f.TTD]}),n})(),Bh=(()=>{class n{constructor(t,r,i){this.router=t,this.route=r,this.locationStrategy=i,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.commands=null,this.href=null,this.onChanges=new Zs.x,this.subscription=t.events.subscribe(a=>{a instanceof q&&this.updateTargetUrlAndHref()})}set preserveFragment(t){this._preserveFragment=(0,f.D6c)(t)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(t){this._skipLocationChange=(0,f.D6c)(t)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(t){this._replaceUrl=(0,f.D6c)(t)}get replaceUrl(){return this._replaceUrl}set routerLink(t){this.commands=null!=t?Array.isArray(t)?t:[t]:null}ngOnChanges(t){this.updateTargetUrlAndHref(),this.onChanges.next(this)}ngOnDestroy(){this.subscription.unsubscribe()}onClick(t,r,i,a,l){return!!(0!==t||r||i||a||l||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!1)}updateTargetUrlAndHref(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(Sr),f.Y36(Fo),f.Y36(ye))},n.\u0275dir=f.lG2({type:n,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(t,r){1&t&&f.NdJ("click",function(a){return r.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),2&t&&f.uIk("target",r.target)("href",r.href,f.LSH)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[f.TTD]}),n})();class AS{}let xS=(()=>{class n{constructor(t,r,i,a,l){this.router=t,this.injector=i,this.preloadingStrategy=a,this.loader=l}setUpPreloading(){this.subscription=this.router.events.pipe(kr(t=>t instanceof q),_s(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){const i=[];for(const a of r){a.providers&&!a._injector&&(a._injector=(0,f.MMx)(a.providers,t,`Route: ${a.path}`));const l=a._injector??t,d=a._loadedInjector??l;a.loadChildren&&!a._loadedRoutes&&void 0===a.canLoad||a.loadComponent&&!a._loadedComponent?i.push(this.preloadConfig(l,a)):(a.children||a._loadedRoutes)&&i.push(this.processRoutes(d,a.children??a._loadedRoutes))}return(0,zt.D)(i).pipe((0,Dh.J)())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;i=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(t,r):it(null);const a=i.pipe((0,fn.z)(l=>null===l?it(void 0):(r._loadedRoutes=l.routes,r._loadedInjector=l.injector,this.processRoutes(l.injector??t,l.routes))));if(r.loadComponent&&!r._loadedComponent){const l=this.loader.loadComponent(r);return(0,zt.D)([a,l]).pipe((0,Dh.J)())}return a})}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Sr),f.LFG(f.Sil),f.LFG(f.lqb),f.LFG(AS),f.LFG(Mv))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const Km=new f.OlP("");let Vp=(()=>{class n{constructor(t,r,i={}){this.router=t,this.viewportScroller=r,this.options=i,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},i.scrollPositionRestoration=i.scrollPositionRestoration||"disabled",i.anchorScrolling=i.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(t=>{t instanceof k?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof q&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.router.parseUrl(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(t=>{t instanceof Om&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.router.triggerEvent(new Om(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return n.\u0275fac=function(t){f.$Z()},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac}),n})();function jh(n,e){return{\u0275kind:n,\u0275providers:e}}function kv(n){return[{provide:Wm,multi:!0,useValue:n}]}function YI(){const n=(0,f.f3M)(f.zs3);return e=>{const t=n.get(f.z2F);if(e!==t.components[0])return;const r=n.get(Sr),i=n.get(Pv);1===n.get(Ov)&&r.initialNavigation(),n.get(MS,null,f.XFs.Optional)?.setUpPreloading(),n.get(Km,null,f.XFs.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.next(),i.complete()}}const Pv=new f.OlP("",{factory:()=>new Zs.x}),Ov=new f.OlP("",{providedIn:"root",factory:()=>1});const MS=new f.OlP("");function Lv(n){return jh(0,[{provide:MS,useExisting:xS},{provide:AS,useExisting:n}])}const Uv=new f.OlP("ROUTER_FORROOT_GUARD"),XI=[Re,{provide:Rm,useClass:Fl},{provide:Sr,useFactory:qm},Ph,{provide:Fo,useFactory:function ZI(n){return n.routerState.root},deps:[Sr]},Mv];function Ym(){return new f.PXZ("Router",Sr)}let Js=(()=>{class n{constructor(t){}static forRoot(t,r){return{ngModule:n,providers:[XI,[],kv(t),{provide:Uv,useFactory:Su,deps:[[Sr,new f.FiY,new f.tp0]]},{provide:Gm,useValue:r||{}},r?.useHash?{provide:ye,useClass:ut}:{provide:ye,useClass:Je},{provide:Km,useFactory:()=>{const n=(0,f.f3M)(Sr),e=(0,f.f3M)(Xu),t=(0,f.f3M)(Gm);return t.scrollOffset&&e.setOffset(t.scrollOffset),new Vp(n,e,t)}},r?.preloadingStrategy?Lv(r.preloadingStrategy).\u0275providers:[],{provide:f.PXZ,multi:!0,useFactory:Ym},r?.initialNavigation?jv(r):[],[{provide:Hv,useFactory:YI},{provide:f.tb,multi:!0,useExisting:Hv}]]}}static forChild(t){return{ngModule:n,providers:[kv(t)]}}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Uv,8))},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({imports:[hv]}),n})();function Su(n){return"guarded"}function jv(n){return["disabled"===n.initialNavigation?jh(3,[{provide:f.ip1,multi:!0,useFactory:()=>{const e=(0,f.f3M)(Sr);return()=>{e.setUpLocationChangeListener()}}},{provide:Ov,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?jh(2,[{provide:Ov,useValue:0},{provide:f.ip1,multi:!0,deps:[f.zs3],useFactory:e=>{const t=e.get($,Promise.resolve());let r=!1;return()=>t.then(()=>new Promise(a=>{const l=e.get(Sr),d=e.get(Pv);(function i(a){e.get(Sr).events.pipe(kr(d=>d instanceof q||d instanceof le||d instanceof Le),(0,ft.U)(d=>d instanceof q||d instanceof le&&(0===d.code||1===d.code)&&null),kr(d=>null!==d),Ei(1)).subscribe(()=>{a()})})(()=>{a(!0),r=!0}),l.afterPreactivation=()=>(a(!0),r||d.closed?it(void 0):d),l.initialNavigation()}))}}]).\u0275providers:[]]}const Hv=new f.OlP(""),tC=function(n){return["/upload",n]};let TN=(()=>{class n{constructor(t){this.route=t}ngOnInit(){this.route.paramMap.subscribe(t=>{this.albumId=t.get("albumId"),console.log("Got album Id: ",this.albumId)})}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(Fo))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-album-details"]],decls:7,vars:4,consts:[[1,"float-end",2,"padding-right","30px"],[1,"btn","btn-outline-info",3,"routerLink"]],template:function(t,r){1&t&&(f.TgZ(0,"div",0)(1,"a",1),f._uU(2,"Upload a Photo"),f.qZA()(),f.TgZ(3,"h3"),f._uU(4,"Album Details"),f.qZA(),f.TgZ(5,"p"),f._uU(6),f.qZA()),2&t&&(f.xp6(1),f.Q6J("routerLink",f.VKq(2,tC,r.albumId)),f.xp6(5),f.hij("The albumID is ",r.albumId," "))},dependencies:[Bh]}),n})(),Qm=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-create-album"]],decls:2,vars:0,template:function(t,r){1&t&&(f.TgZ(0,"p"),f._uU(1,"create-album works!"),f.qZA())}}),n})();var Hh=V(5867);const Ul_firebaseConfig={apiKey:"AIzaSyCsCqksho4IV3Rpj1xv6ZOseiUt_Li2Hug",authDomain:"gmh-photoapplication.firebaseapp.com",projectId:"gmh-photoapplication",storageBucket:"gmh-photoapplication.appspot.com",messagingSenderId:"832642895454",appId:"1:832642895454:web:a74227d93292e7ade8eecf"},Ul_API_BASE_URL="http://ec2-52-14-71-31.us-east-2.compute.amazonaws.com:8080";(0,Hh.ZF)(Ul_firebaseConfig);var Bp=V(4986),gn=V(5813);function Gv(){return(0,An.e)((n,e)=>{let t,r=!1;n.subscribe((0,pn.x)(e,i=>{const a=t;t=i,r&&e.next([a,i]),r=!0}))})}function rC(n,e=Yc.y){return n=n??kS,(0,An.e)((t,r)=>{let i,a=!0;t.subscribe((0,pn.x)(r,l=>{const d=e(l);(a||!n(i,d))&&(a=!1,i=d,r.next(l))}))})}function kS(n,e){return n===e}var gt,Fr=V(2011),iC=(V(1277),V(3942)),ve=V(5861),Qi=V(9681),Xs=V(4859),eo=V(1877),P=V(2090),Wv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Bl={},sC=sC||{},Ut=Wv||self;function zv(){}function qv(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function Jm(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var oC="closure_uid_"+(1e9*Math.random()>>>0),AN=0;function jl(n,e,t){return n.call.apply(n.bind,arguments)}function Kv(n,e,t){if(!n)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),n.apply(e,i)}}return function(){return n.apply(e,arguments)}}function Ci(n,e,t){return(Ci=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?jl:Kv).apply(null,arguments)}function jp(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var r=t.slice();return r.push.apply(r,arguments),n.apply(this,r)}}function Lr(n,e){function t(){}t.prototype=e.prototype,n.X=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Wb=function(r,i,a){for(var l=Array(arguments.length-2),d=2;d<arguments.length;d++)l[d-2]=arguments[d];return e.prototype[i].apply(r,l)}}function Au(){this.s=this.s,this.o=this.o}Au.prototype.s=!1,Au.prototype.na=function(){!this.s&&(this.s=!0,this.M(),0)&&function SN(n){Object.prototype.hasOwnProperty.call(n,oC)&&n[oC]||(n[oC]=++AN)}(this)},Au.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const aC=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1};function Ia(n){const e=n.length;if(0<e){const t=Array(e);for(let r=0;r<e;r++)t[r]=n[r];return t}return[]}function Yv(n,e){for(let t=1;t<arguments.length;t++){const r=arguments[t];if(qv(r)){const i=n.length||0,a=r.length||0;n.length=i+a;for(let l=0;l<a;l++)n[i+l]=r[l]}else n.push(r)}}function bi(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}bi.prototype.h=function(){this.defaultPrevented=!0};var OS=function(){if(!Ut.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{Ut.addEventListener("test",zv,e),Ut.removeEventListener("test",zv,e)}catch{}return n}();function Hp(n){return/^[\s\xa0]*$/.test(n)}var uC=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function Qv(n,e){return n<e?-1:n>e?1:0}function _d(){var n=Ut.navigator;return n&&(n=n.userAgent)?n:""}function Li(n){return-1!=_d().indexOf(n)}function $p(n){return $p[" "](n),n}$p[" "]=zv;var Gh,n,Jv=Li("Opera"),xu=Li("Trident")||Li("MSIE"),Xv=Li("Edge"),Xm=Xv||xu,e_=Li("Gecko")&&!(-1!=_d().toLowerCase().indexOf("webkit")&&!Li("Edge"))&&!(Li("Trident")||Li("MSIE"))&&!Li("Edge"),ew=-1!=_d().toLowerCase().indexOf("webkit")&&!Li("Edge");function tw(){var n=Ut.document;return n?n.documentMode:void 0}e:{var nw="",lC=(n=_d(),e_?/rv:([^\);]+)(\)|;)/.exec(n):Xv?/Edge\/([\d\.]+)/.exec(n):xu?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):ew?/WebKit\/(\S+)/.exec(n):Jv?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(lC&&(nw=lC?lC[1]:""),xu){var rw=tw();if(null!=rw&&rw>parseFloat(nw)){Gh=String(rw);break e}}Gh=nw}var cC={};var LS=Ut.document&&xu&&(tw()||parseInt(Gh,10))||void 0;function hi(n,e){if(bi.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,r=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(e_){e:{try{$p(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:dC[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&hi.X.h.call(this)}}Lr(hi,bi);var dC={2:"touch",3:"pen",4:"mouse"};hi.prototype.h=function(){hi.X.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var Gp="closure_listenable_"+(1e6*Math.random()|0),xN=0;function VS(n,e,t,r,i){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!r,this.ha=i,this.key=++xN,this.ba=this.ea=!1}function Wh(n){n.ba=!0,n.listener=null,n.proxy=null,n.src=null,n.ha=null}function n_(n,e,t){for(const r in n)e.call(t,n[r],r,n)}function hC(n){const e={};for(const t in n)e[t]=n[t];return e}const fC="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function pC(n,e){let t,r;for(let i=1;i<arguments.length;i++){for(t in r=arguments[i],r)n[t]=r[t];for(let a=0;a<fC.length;a++)t=fC[a],Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}}function Wp(n){this.src=n,this.g={},this.h=0}function sw(n,e){var t=e.type;if(t in n.g){var a,r=n.g[t],i=aC(r,e);(a=0<=i)&&Array.prototype.splice.call(r,i,1),a&&(Wh(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function r_(n,e,t,r){for(var i=0;i<n.length;++i){var a=n[i];if(!a.ba&&a.listener==e&&a.capture==!!t&&a.ha==r)return i}return-1}Wp.prototype.add=function(n,e,t,r,i){var a=n.toString();(n=this.g[a])||(n=this.g[a]=[],this.h++);var l=r_(n,e,r,i);return-1<l?(e=n[l],t||(e.ea=!1)):((e=new VS(e,this.src,a,!!r,i)).ea=t,n.push(e)),e};var ow="closure_lm_"+(1e6*Math.random()|0),aw={};function uw(n,e,t,r,i){if(r&&r.once)return Vo(n,e,t,r,i);if(Array.isArray(e)){for(var a=0;a<e.length;a++)uw(n,e[a],t,r,i);return null}return t=hw(t),n&&n[Gp]?n.N(e,t,Jm(r)?!!r.capture:!!r,i):lw(n,e,t,!1,r,i)}function lw(n,e,t,r,i,a){if(!e)throw Error("Invalid event type");var l=Jm(i)?!!i.capture:!!i,d=s_(n);if(d||(n[ow]=d=new Wp(n)),(t=d.add(e,t,r,l,a)).proxy)return t;if(r=function US(){const e=RN;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=r,r.src=n,r.listener=t,n.addEventListener)OS||(i=l),void 0===i&&(i=!1),n.addEventListener(e.toString(),r,i);else if(n.attachEvent)n.attachEvent(gC(e.toString()),r);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(r)}return t}function Vo(n,e,t,r,i){if(Array.isArray(e)){for(var a=0;a<e.length;a++)Vo(n,e[a],t,r,i);return null}return t=hw(t),n&&n[Gp]?n.O(e,t,Jm(r)?!!r.capture:!!r,i):lw(n,e,t,!0,r,i)}function i_(n,e,t,r,i){if(Array.isArray(e))for(var a=0;a<e.length;a++)i_(n,e[a],t,r,i);else r=Jm(r)?!!r.capture:!!r,t=hw(t),n&&n[Gp]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=r_(a=n.g[e],t,r,i))&&(Wh(a[t]),Array.prototype.splice.call(a,t,1),0==a.length&&(delete n.g[e],n.h--))):n&&(n=s_(n))&&(e=n.g[e.toString()],n=-1,e&&(n=r_(e,t,r,i)),(t=-1<n?e[n]:null)&&cw(t))}function cw(n){if("number"!=typeof n&&n&&!n.ba){var e=n.src;if(e&&e[Gp])sw(e.i,n);else{var t=n.type,r=n.proxy;e.removeEventListener?e.removeEventListener(t,r,n.capture):e.detachEvent?e.detachEvent(gC(t),r):e.addListener&&e.removeListener&&e.removeListener(r),(t=s_(e))?(sw(t,n),0==t.h&&(t.src=null,e[ow]=null)):Wh(n)}}}function gC(n){return n in aw?aw[n]:aw[n]="on"+n}function RN(n,e){if(n.ba)n=!0;else{e=new hi(e,this);var t=n.listener,r=n.ha||n.src;n.ea&&cw(n),n=t.call(r,e)}return n}function s_(n){return(n=n[ow])instanceof Wp?n:null}var dw="__closure_events_fn_"+(1e9*Math.random()>>>0);function hw(n){return"function"==typeof n?n:(n[dw]||(n[dw]=function(e){return n.handleEvent(e)}),n[dw])}function Qr(){Au.call(this),this.i=new Wp(this),this.P=this,this.I=null}function Vr(n,e){var t,r=n.I;if(r)for(t=[];r;r=r.I)t.push(r);if(n=n.P,r=e.type||e,"string"==typeof e)e=new bi(e,n);else if(e instanceof bi)e.target=e.target||n;else{var i=e;pC(e=new bi(r,n),i)}if(i=!0,t)for(var a=t.length-1;0<=a;a--){var l=e.g=t[a];i=o_(l,r,!0,e)&&i}if(i=o_(l=e.g=n,r,!0,e)&&i,i=o_(l,r,!1,e)&&i,t)for(a=0;a<t.length;a++)i=o_(l=e.g=t[a],r,!1,e)&&i}function o_(n,e,t,r){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var i=!0,a=0;a<e.length;++a){var l=e[a];if(l&&!l.ba&&l.capture==t){var d=l.listener,_=l.ha||l.src;l.ea&&sw(n.i,l),i=!1!==d.call(_,r)&&i}}return i&&!r.defaultPrevented}Lr(Qr,Au),Qr.prototype[Gp]=!0,Qr.prototype.removeEventListener=function(n,e,t,r){i_(this,n,e,t,r)},Qr.prototype.M=function(){if(Qr.X.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],r=0;r<t.length;r++)Wh(t[r]);delete n.g[e],n.h--}}this.I=null},Qr.prototype.N=function(n,e,t,r){return this.i.add(String(n),e,!1,t,r)},Qr.prototype.O=function(n,e,t,r){return this.i.add(String(n),e,!0,t,r)};var fw=Ut.JSON.stringify;function a_(){var n=mw;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var u_,zp=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new MN,n=>n.reset());class MN{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function gw(n){Ut.setTimeout(()=>{throw n},0)}function BS(n,e){u_||function mC(){var n=Ut.Promise.resolve(void 0);u_=function(){n.then(_w)}}(),l_||(u_(),l_=!0),mw.add(n,e)}var l_=!1,mw=new class pw{constructor(){this.h=this.g=null}add(e,t){const r=zp.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}};function _w(){for(var n;n=a_();){try{n.h.call(n.g)}catch(t){gw(t)}var e=zp;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}l_=!1}function to(n,e){Qr.call(this),this.h=n||1,this.g=e||Ut,this.j=Ci(this.lb,this),this.l=Date.now()}function zh(n){n.ca=!1,n.R&&(n.g.clearTimeout(n.R),n.R=null)}function qh(n,e,t){if("function"==typeof n)t&&(n=Ci(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=Ci(n.handleEvent,n)}return 2147483647<Number(e)?-1:Ut.setTimeout(n,e||0)}function Kh(n){n.g=qh(()=>{n.g=null,n.i&&(n.i=!1,Kh(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}Lr(to,Qr),(gt=to.prototype).ca=!1,gt.R=null,gt.lb=function(){if(this.ca){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-n):(this.R&&(this.g.clearTimeout(this.R),this.R=null),Vr(this,"tick"),this.ca&&(zh(this),this.start()))}},gt.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},gt.M=function(){to.X.M.call(this),zh(this),delete this.g};class jS extends Au{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Kh(this)}M(){super.M(),this.g&&(Ut.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function yd(n){Au.call(this),this.h=n,this.g={}}Lr(yd,Au);var yw=[];function _C(n,e,t,r){Array.isArray(t)||(t&&(yw[0]=t.toString()),t=yw);for(var i=0;i<t.length;i++){var a=uw(e,t[i],r||n.handleEvent,!1,n.h||n);if(!a)break;n.g[a.key]=a}}function yC(n){n_(n.g,function(e,t){this.g.hasOwnProperty(t)&&cw(e)},n),n.g={}}function Hl(){this.g=!0}function Zh(n,e,t,r){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function $S(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var r=t[n];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var a=i[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var l=1;l<i.length;l++)i[l]=""}}}return fw(t)}catch{return e}}(n,t)+(r?" "+r:"")})}yd.prototype.M=function(){yd.X.M.call(this),yC(this)},yd.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Hl.prototype.Aa=function(){this.g=!1},Hl.prototype.info=function(){};var vd={},vC=null;function qp(){return vC=vC||new Qr}function c_(n){bi.call(this,vd.Pa,n)}function Kp(n){const e=qp();Vr(e,new c_(e))}function d_(n,e){bi.call(this,vd.STAT_EVENT,n),this.stat=e}function Vi(n){const e=qp();Vr(e,new d_(e,n))}function wC(n,e){bi.call(this,vd.Qa,n),this.size=e}function Zp(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return Ut.setTimeout(function(){n()},e)}vd.Pa="serverreachability",Lr(c_,bi),vd.STAT_EVENT="statevent",Lr(d_,bi),vd.Qa="timingevent",Lr(wC,bi);var h_={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},EC={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function vw(){}function $l(){}vw.prototype.h=null;var Ew,f_={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function wd(){bi.call(this,"d")}function ww(){bi.call(this,"c")}function Yh(){}function Qp(n,e,t,r){this.l=n,this.j=e,this.m=t,this.U=r||1,this.S=new yd(this),this.O=Jp,this.T=new to(n=Xm?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new Uo}function Uo(){this.i=null,this.g="",this.h=!1}Lr(wd,bi),Lr(ww,bi),Lr(Yh,vw),Yh.prototype.g=function(){return new XMLHttpRequest},Yh.prototype.i=function(){return{}},Ew=new Yh;var Jp=45e3,Jr={},Ca={};function Qh(n,e,t){n.K=1,n.v=g_(Ta(e)),n.s=t,n.P=!0,Cs(n,null)}function Cs(n,e){n.F=Date.now(),ba(n),n.A=Ta(n.v);var t=n.A,r=n.U;Array.isArray(r)||(r=[String(r)]),Tw(t.i,"t",r),n.C=0,t=n.l.H,n.h=new Uo,n.g=VC(n.l,t?e:null,!n.s),0<n.N&&(n.L=new jS(Ci(n.La,n,n.g),n.N)),_C(n.S,n.g,"readystatechange",n.ib),e=n.H?hC(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.da(n.A,n.u,n.s,e)):(n.u="GET",n.g.da(n.A,n.u,null,e)),Kp(),function HS(n,e,t,r,i,a){n.info(function(){if(n.g)if(a)for(var l="",d=a.split("&"),_=0;_<d.length;_++){var w=d[_].split("=");if(1<w.length){var D=w[0];w=w[1];var S=D.split("_");l=2<=S.length&&"type"==S[1]?l+(D+"=")+w+"&":l+(D+"=redacted&")}}else l=null;else l=a;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+t+"\n"+l})}(n.j,n.u,n.A,n.m,n.U,n.s)}function p_(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Da}function Ed(n,e,t){let i,r=!0;for(;!n.I&&n.C<t.length;){if(i=Jh(n,t),i==Ca){4==e&&(n.o=4,Vi(14),r=!1),Zh(n.j,n.m,null,"[Incomplete Response]");break}if(i==Jr){n.o=4,Vi(15),Zh(n.j,n.m,t,"[Invalid Chunk]"),r=!1;break}Zh(n.j,n.m,i,null),Gl(n,i)}p_(n)&&i!=Ca&&i!=Jr&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,Vi(16),r=!1),n.i=n.i&&r,r?0<t.length&&!n.$&&(n.$=!0,(e=n.l).g==n&&e.$&&!e.K&&(e.j.info("Great, no buffering proxy detected. Bytes received: "+t.length),ro(e),e.K=!0,Vi(11))):(Zh(n.j,n.m,t,"[Invalid Chunked Response]"),no(n),Da(n))}function Jh(n,e){var t=n.C,r=e.indexOf("\n",t);return-1==r?Ca:(t=Number(e.substring(t,r)),isNaN(t)?Jr:(r+=1)+t>e.length?Ca:(e=e.substr(r,t),n.C=r+t,e))}function ba(n){n.V=Date.now()+n.O,Id(n,n.O)}function Id(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=Zp(Ci(n.gb,n),e)}function Ru(n){n.B&&(Ut.clearTimeout(n.B),n.B=null)}function Da(n){0==n.l.G||n.I||Bw(n.l,n)}function no(n){Ru(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,zh(n.T),yC(n.S),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function Gl(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||E_(t.h,n)))if(!n.J&&E_(t.h,n)&&3==t.G){try{var r=t.Fa.g.parse(e)}catch{r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!t.u){if(t.g){if(!(t.g.F+3e3<n.F))break e;Ji(t),rg(t)}Uw(t),Vi(18)}}else t.Ba=i[1],0<t.Ba-t.T&&37500>i[2]&&t.L&&0==t.A&&!t.v&&(t.v=Zp(Ci(t.cb,t),6e3));if(1>=TC(t.h)&&t.ja){try{t.ja()}catch{}t.ja=void 0}}else Td(t,11)}else if((n.J||t.g==n)&&Ji(t),!Hp(e))for(i=t.Fa.g.parse(e),e=0;e<i.length;e++){let w=i[e];if(t.T=w[0],w=w[1],2==t.G)if("c"==w[0]){t.I=w[1],t.ka=w[2];const D=w[3];null!=D&&(t.ma=D,t.j.info("VER="+t.ma));const S=w[4];null!=S&&(t.Ca=S,t.j.info("SVER="+t.Ca));const M=w[5];null!=M&&"number"==typeof M&&0<M&&(t.J=r=1.5*M,t.j.info("backChannelRequestTimeoutMs_="+r)),r=t;const O=n.g;if(O){const j=O.g?O.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(j){var a=r.h;a.g||-1==j.indexOf("spdy")&&-1==j.indexOf("quic")&&-1==j.indexOf("h2")||(a.j=a.l,a.g=new Set,a.h&&(I_(a,a.h),a.h=null))}if(r.D){const ae=O.g?O.g.getResponseHeader("X-HTTP-Session-Id"):null;ae&&(r.za=ae,Gn(r.F,r.D,ae))}}t.G=3,t.l&&t.l.xa(),t.$&&(t.P=Date.now()-n.F,t.j.info("Handshake RTT: "+t.P+"ms"));var l=n;if((r=t).sa=LC(r,r.H?r.ka:null,r.V),l.J){Mw(r.h,l);var d=l,_=r.J;_&&d.setTimeout(_),d.B&&(Ru(d),ba(d)),r.g=l}else OC(r);0<t.i.length&&ig(t)}else"stop"!=w[0]&&"close"!=w[0]||Td(t,7);else 3==t.G&&("stop"==w[0]||"close"==w[0]?"stop"==w[0]?Td(t,7):Lw(t):"noop"!=w[0]&&t.l&&t.l.wa(w),t.A=0)}Kp()}catch{}}function Iw(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(qv(n)||"string"==typeof n)Array.prototype.forEach.call(n,e,void 0);else for(var t=function IC(n){if(n.oa&&"function"==typeof n.oa)return n.oa();if(!n.W||"function"!=typeof n.W){if(typeof Map<"u"&&n instanceof Map)return Array.from(n.keys());if(!(typeof Set<"u"&&n instanceof Set)){if(qv(n)||"string"==typeof n){var e=[];n=n.length;for(var t=0;t<n;t++)e.push(t);return e}e=[],t=0;for(const r in n)e[t++]=r;return e}}}(n),r=function Xh(n){if(n.W&&"function"==typeof n.W)return n.W();if(typeof Map<"u"&&n instanceof Map||typeof Set<"u"&&n instanceof Set)return Array.from(n.values());if("string"==typeof n)return n.split("");if(qv(n)){for(var e=[],t=n.length,r=0;r<t;r++)e.push(n[r]);return e}for(r in e=[],t=0,n)e[t++]=n[r];return e}(n),i=r.length,a=0;a<i;a++)e.call(void 0,r[a],t&&t[a],n)}(gt=Qp.prototype).setTimeout=function(n){this.O=n},gt.ib=function(n){n=n.target;const e=this.L;e&&3==Sa(n)?e.l():this.La(n)},gt.La=function(n){try{if(n==this.g)e:{const D=Sa(this.g);var e=this.g.Ea();if(this.g.aa(),!(3>D)&&(3!=D||Xm||this.g&&(this.h.h||this.g.fa()||NC(this.g)))){this.I||4!=D||7==e||Kp(),Ru(this);var t=this.g.aa();this.Y=t;t:if(p_(this)){var r=NC(this.g);n="";var i=r.length,a=4==Sa(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){no(this),Da(this);var l="";break t}this.h.i=new Ut.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,n+=this.h.i.decode(r[e],{stream:a&&e==i-1});r.splice(0,i),this.h.g+=n,this.C=0,l=this.h.g}else l=this.g.fa();if(this.i=200==t,function NN(n,e,t,r,i,a,l){n.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+t+"\n"+a+" "+l})}(this.j,this.u,this.A,this.m,this.U,D,t),this.i){if(this.Z&&!this.J){t:{if(this.g){var d,_=this.g;if((d=_.g?_.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Hp(d)){var w=d;break t}}w=null}if(!(t=w)){this.i=!1,this.o=3,Vi(12),no(this),Da(this);break e}Zh(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Gl(this,t)}this.P?(Ed(this,D,l),Xm&&this.i&&3==D&&(_C(this.S,this.T,"tick",this.hb),this.T.start())):(Zh(this.j,this.m,l,null),Gl(this,l)),4==D&&no(this),this.i&&!this.I&&(4==D?Bw(this.l,this):(this.i=!1,ba(this)))}else 400==t&&0<l.indexOf("Unknown SID")?(this.o=3,Vi(12)):(this.o=0,Vi(13)),no(this),Da(this)}}}catch{}},gt.hb=function(){if(this.g){var n=Sa(this.g),e=this.g.fa();this.C<e.length&&(Ru(this),Ed(this,n,e),this.i&&4!=n&&ba(this))}},gt.cancel=function(){this.I=!0,no(this)},gt.gb=function(){this.B=null;const n=Date.now();0<=n-this.V?(function kN(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(Kp(),Vi(17)),no(this),this.o=2,Da(this)):Id(this,this.V-n)};var Cw=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Wl(n,e){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,n instanceof Wl){this.h=void 0!==e?e:n.h,Xp(this,n.j),this.s=n.s,this.g=n.g,eg(this,n.m),this.l=n.l,e=n.i;var t=new Cd;t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),bw(this,t),this.o=n.o}else n&&(t=String(n).match(Cw))?(this.h=!!e,Xp(this,t[1]||"",!0),this.s=ef(t[2]||""),this.g=ef(t[3]||"",!0),eg(this,t[4]),this.l=ef(t[5]||"",!0),bw(this,t[6]||"",!0),this.o=ef(t[7]||"")):(this.h=!!e,this.i=new Cd(null,this.h))}function Ta(n){return new Wl(n)}function Xp(n,e,t){n.j=t?ef(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function eg(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function bw(n,e,t){e instanceof Cd?(n.i=e,function Sw(n,e){e&&!n.j&&(zl(n),n.i=null,n.g.forEach(function(t,r){var i=r.toLowerCase();r!=i&&(v_(this,r),Tw(this,i,t))},n)),n.j=e}(n.i,n.h)):(t||(e=tg(e,__)),n.i=new Cd(e,n.h))}function Gn(n,e,t){n.i.set(e,t)}function g_(n){return Gn(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function ef(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function tg(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,bC),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function bC(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}Wl.prototype.toString=function(){var n=[],e=this.j;e&&n.push(tg(e,m_,!0),":");var t=this.g;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(tg(e,m_,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.g&&"/"!=t.charAt(0)&&n.push("/"),n.push(tg(t,"/"==t.charAt(0)?GS:Dw,!0))),(t=this.i.toString())&&n.push("?",t),(t=this.o)&&n.push("#",tg(t,y_)),n.join("")};var m_=/[#\/\?@]/g,Dw=/[#\?:]/g,GS=/[#\?]/g,__=/[#\?@]/g,y_=/#/g;function Cd(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function zl(n){n.g||(n.g=new Map,n.h=0,n.i&&function CC(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var r=n[t].indexOf("="),i=null;if(0<=r){var a=n[t].substring(0,r);i=n[t].substring(r+1)}else a=n[t];e(a,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function v_(n,e){zl(n),e=bd(n,e),n.g.has(e)&&(n.i=null,n.h-=n.g.get(e).length,n.g.delete(e))}function w_(n,e){return zl(n),e=bd(n,e),n.g.has(e)}function Tw(n,e,t){v_(n,e),0<t.length&&(n.i=null,n.g.set(bd(n,e),Ia(t)),n.h+=t.length)}function bd(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function Aw(n){this.l=n||xw,n=Ut.PerformanceNavigationTiming?0<(n=Ut.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(Ut.g&&Ut.g.Ga&&Ut.g.Ga()&&Ut.g.Ga().$b),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(gt=Cd.prototype).add=function(n,e){zl(this),this.i=null,n=bd(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},gt.forEach=function(n,e){zl(this),this.g.forEach(function(t,r){t.forEach(function(i){n.call(e,i,r,this)},this)},this)},gt.oa=function(){zl(this);const n=Array.from(this.g.values()),e=Array.from(this.g.keys()),t=[];for(let r=0;r<e.length;r++){const i=n[r];for(let a=0;a<i.length;a++)t.push(e[r])}return t},gt.W=function(n){zl(this);let e=[];if("string"==typeof n)w_(this,n)&&(e=e.concat(this.g.get(bd(this,n))));else{n=Array.from(this.g.values());for(let t=0;t<n.length;t++)e=e.concat(n[t])}return e},gt.set=function(n,e){return zl(this),this.i=null,w_(this,n=bd(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},gt.get=function(n,e){return n&&0<(n=this.W(n)).length?String(n[0]):e},gt.toString=function(){if(this.i)return this.i;if(!this.g)return"";const n=[],e=Array.from(this.g.keys());for(var t=0;t<e.length;t++){var r=e[t];const a=encodeURIComponent(String(r)),l=this.W(r);for(r=0;r<l.length;r++){var i=a;""!==l[r]&&(i+="="+encodeURIComponent(String(l[r]))),n.push(i)}}return this.i=n.join("&")};var xw=10;function Rw(n){return!!n.h||!!n.g&&n.g.size>=n.j}function TC(n){return n.h?1:n.g?n.g.size:0}function E_(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function I_(n,e){n.g?n.g.add(e):n.h=e}function Mw(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function Nw(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return Ia(n.i)}function kw(){}function WS(){this.g=new kw}function zS(n,e,t){const r=t||"";try{Iw(n,function(i,a){let l=i;Jm(i)&&(l=fw(i)),e.push(r+a+"="+encodeURIComponent(l))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function tf(n,e,t,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function nf(n){this.l=n.ac||null,this.j=n.jb||!1}function ng(n,e){Qr.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=C_,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Aw.prototype.cancel=function(){if(this.i=Nw(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},kw.prototype.stringify=function(n){return Ut.JSON.stringify(n,void 0)},kw.prototype.parse=function(n){return Ut.JSON.parse(n,void 0)},Lr(nf,vw),nf.prototype.g=function(){return new ng(this.l,this.j)},nf.prototype.i=function(n){return function(){return n}}({}),Lr(ng,Qr);var C_=0;function Pw(n){n.j.read().then(n.Ta.bind(n)).catch(n.ga.bind(n))}function rf(n){n.readyState=4,n.l=null,n.j=null,n.A=null,sf(n)}function sf(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(gt=ng.prototype).open=function(n,e){if(this.readyState!=C_)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,sf(this)},gt.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||Ut).fetch(new Request(this.B,e)).then(this.Wa.bind(this),this.ga.bind(this))},gt.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,rf(this)),this.readyState=C_},gt.Wa=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,sf(this)),this.g&&(this.readyState=3,sf(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(typeof Ut.ReadableStream<"u"&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Pw(this)}else n.text().then(this.Va.bind(this),this.ga.bind(this))},gt.Ta=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?rf(this):sf(this),3==this.readyState&&Pw(this)}},gt.Va=function(n){this.g&&(this.response=this.responseText=n,rf(this))},gt.Ua=function(n){this.g&&(this.response=n,rf(this))},gt.ga=function(){this.g&&rf(this)},gt.setRequestHeader=function(n,e){this.v.append(n,e)},gt.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},gt.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(ng.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var AC=Ut.JSON.parse;function Jn(n){Qr.call(this),this.headers=new Map,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=qS,this.K=this.L=!1}Lr(Jn,Qr);var qS="",KS=/^https?$/i,ZS=["POST","PUT"];function RC(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,Ar(n),b_(n)}function Ar(n){n.D||(n.D=!0,Vr(n,"complete"),Vr(n,"error"))}function Ow(n){if(n.h&&typeof sC<"u"&&(!n.C[1]||4!=Sa(n)||2!=n.aa()))if(n.v&&4==Sa(n))qh(n.Ha,0,n);else if(Vr(n,"readystatechange"),4==Sa(n)){n.h=!1;try{const d=n.aa();e:switch(d){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var r;if(r=0===d){var i=String(n.H).match(Cw)[1]||null;if(!i&&Ut.self&&Ut.self.location){var a=Ut.self.location.protocol;i=a.substr(0,a.length-1)}r=!KS.test(i?i.toLowerCase():"")}t=r}if(t)Vr(n,"complete"),Vr(n,"success");else{n.m=6;try{var l=2<Sa(n)?n.g.statusText:""}catch{l=""}n.j=l+" ["+n.aa()+"]",Ar(n)}}finally{b_(n)}}}function b_(n,e){if(n.g){MC(n);const t=n.g,r=n.C[0]?zv:null;n.g=null,n.C=null,e||Vr(n,"ready");try{t.onreadystatechange=r}catch{}}}function MC(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(Ut.clearTimeout(n.A),n.A=null)}function Sa(n){return n.g?n.g.readyState:0}function NC(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case qS:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch{return null}}function Fw(n){let e="";return n_(n,function(t,r){e+=r,e+=":",e+=t,e+="\r\n"}),e}function D_(n,e,t){e:{for(r in t){var r=!1;break e}r=!0}r||(t=Fw(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):Gn(n,e,t))}function Aa(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function kC(n){this.Ca=0,this.i=[],this.j=new Hl,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=Aa("failFast",!1,n),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=Aa("baseRetryDelayMs",5e3,n),this.bb=Aa("retryDelaySeedMs",1e4,n),this.$a=Aa("forwardChannelMaxRetries",2,n),this.ta=Aa("forwardChannelRequestTimeoutMs",2e4,n),this.ra=n&&n.xmlHttpFactory||void 0,this.Da=n&&n.Zb||!1,this.J=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.I="",this.h=new Aw(n&&n.concurrentRequestLimit),this.Fa=new WS,this.O=n&&n.fastHandshake||!1,this.N=n&&n.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=n&&n.Xb||!1,n&&n.Aa&&this.j.Aa(),n&&n.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&n&&n.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function Lw(n){if(PC(n),3==n.G){var e=n.U++,t=Ta(n.F);Gn(t,"SID",n.I),Gn(t,"RID",e),Gn(t,"TYPE","terminate"),Dd(n,t),(e=new Qp(n,n.j,e,void 0)).K=2,e.v=g_(Ta(t)),t=!1,Ut.navigator&&Ut.navigator.sendBeacon&&(t=Ut.navigator.sendBeacon(e.v.toString(),"")),!t&&Ut.Image&&((new Image).src=e.v,t=!0),t||(e.g=VC(e.l,null),e.g.da(e.v)),e.F=Date.now(),ba(e)}FC(n)}function rg(n){n.g&&(ro(n),n.g.cancel(),n.g=null)}function PC(n){rg(n),n.u&&(Ut.clearTimeout(n.u),n.u=null),Ji(n),n.h.cancel(),n.m&&("number"==typeof n.m&&Ut.clearTimeout(n.m),n.m=null)}function ig(n){Rw(n.h)||n.m||(n.m=!0,BS(n.Ja,n),n.C=0)}function Vw(n,e){var t;t=e?e.m:n.U++;const r=Ta(n.F);Gn(r,"SID",n.I),Gn(r,"RID",t),Gn(r,"AID",n.T),Dd(n,r),n.o&&n.s&&D_(r,n.o,n.s),t=new Qp(n,n.j,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.i=e.D.concat(n.i)),e=Bo(n,t,1e3),t.setTimeout(Math.round(.5*n.ta)+Math.round(.5*n.ta*Math.random())),I_(n.h,t),Qh(t,r,e)}function Dd(n,e){n.ia&&n_(n.ia,function(t,r){Gn(e,r,t)}),n.l&&Iw({},function(t,r){Gn(e,r,t)})}function Bo(n,e,t){t=Math.min(n.i.length,t);var r=n.l?Ci(n.l.Ra,n.l,n):null;e:{var i=n.i;let a=-1;for(;;){const l=["count="+t];-1==a?0<t?(a=i[0].h,l.push("ofs="+a)):a=0:l.push("ofs="+a);let d=!0;for(let _=0;_<t;_++){let w=i[_].h;const D=i[_].g;if(w-=a,0>w)a=Math.max(0,i[_].h-100),d=!1;else try{zS(D,l,"req"+w+"_")}catch{r&&r(D)}}if(d){r=l.join("&");break e}}}return n=n.i.splice(0,t),e.D=n,r}function OC(n){n.g||n.u||(n.Z=1,BS(n.Ia,n),n.A=0)}function Uw(n){return!(n.g||n.u||3<=n.A||(n.Z++,n.u=Zp(Ci(n.Ia,n),jw(n,n.A)),n.A++,0))}function ro(n){null!=n.B&&(Ut.clearTimeout(n.B),n.B=null)}function io(n){n.g=new Qp(n,n.j,"rpc",n.Z),null===n.o&&(n.g.H=n.s),n.g.N=0;var e=Ta(n.sa);Gn(e,"RID","rpc"),Gn(e,"SID",n.I),Gn(e,"CI",n.L?"0":"1"),Gn(e,"AID",n.T),Gn(e,"TYPE","xmlhttp"),Dd(n,e),n.o&&n.s&&D_(e,n.o,n.s),n.J&&n.g.setTimeout(n.J);var t=n.g;n=n.ka,t.K=1,t.v=g_(Ta(e)),t.s=null,t.P=!0,Cs(t,n)}function Ji(n){null!=n.v&&(Ut.clearTimeout(n.v),n.v=null)}function Bw(n,e){var t=null;if(n.g==e){Ji(n),ro(n),n.g=null;var r=2}else{if(!E_(n.h,e))return;t=e.D,Mw(n.h,e),r=1}if(0!=n.G)if(n.pa=e.Y,e.i)if(1==r){t=e.s?e.s.length:0,e=Date.now()-e.F;var i=n.C;Vr(r=qp(),new wC(r,t)),ig(n)}else OC(n);else if(3==(i=e.o)||0==i&&0<n.pa||!(1==r&&function PN(n,e){return!(TC(n.h)>=n.h.j-(n.m?1:0)||(n.m?(n.i=e.D.concat(n.i),0):1==n.G||2==n.G||n.C>=(n.Za?0:n.$a)||(n.m=Zp(Ci(n.Ja,n,e),jw(n,n.C)),n.C++,0)))}(n,e)||2==r&&Uw(n)))switch(t&&0<t.length&&(e=n.h,e.i=e.i.concat(t)),i){case 1:Td(n,5);break;case 4:Td(n,10);break;case 3:Td(n,6);break;default:Td(n,2)}}function jw(n,e){let t=n.Xa+Math.floor(Math.random()*n.bb);return n.l||(t*=2),t*e}function Td(n,e){if(n.j.info("Error code "+e),2==e){var t=null;n.l&&(t=null);var r=Ci(n.kb,n);t||(t=new Wl("//www.google.com/images/cleardot.gif"),Ut.location&&"http"==Ut.location.protocol||Xp(t,"https"),g_(t)),function SC(n,e){const t=new Hl;if(Ut.Image){const r=new Image;r.onload=jp(tf,t,r,"TestLoadImage: loaded",!0,e),r.onerror=jp(tf,t,r,"TestLoadImage: error",!1,e),r.onabort=jp(tf,t,r,"TestLoadImage: abort",!1,e),r.ontimeout=jp(tf,t,r,"TestLoadImage: timeout",!1,e),Ut.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=n}else e(!1)}(t.toString(),r)}else Vi(2);n.G=0,n.l&&n.l.va(e),FC(n),PC(n)}function FC(n){if(n.G=0,n.la=[],n.l){const e=Nw(n.h);(0!=e.length||0!=n.i.length)&&(Yv(n.la,e),Yv(n.la,n.i),n.h.i.length=0,Ia(n.i),n.i.length=0),n.l.ua()}}function LC(n,e,t){var r=t instanceof Wl?Ta(t):new Wl(t,void 0);if(""!=r.g)e&&(r.g=e+"."+r.g),eg(r,r.m);else{var i=Ut.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var a=new Wl(null,void 0);r&&Xp(a,r),e&&(a.g=e),i&&eg(a,i),t&&(a.l=t),r=a}return e=n.za,(t=n.D)&&e&&Gn(r,t,e),Gn(r,"VER",n.ma),Dd(n,r),r}function VC(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Jn(t&&n.Da&&!n.ra?new nf({jb:!0}):n.ra)).Ka(n.H),e}function T_(){}function ql(){if(xu&&!(10<=Number(LS)))throw Error("Environmental error: no available transport.")}function bs(n,e){Qr.call(this),this.g=new kC(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.S=n,(n=e&&e.Yb)&&!Hp(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Hp(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new Sd(this)}function Hw(n){wd.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function UC(){ww.call(this),this.status=1}function Sd(n){this.g=n}(gt=Jn.prototype).Ka=function(n){this.L=n},gt.da=function(n,e,t,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():Ew.g(),this.C=function Yp(n){return n.h||(n.h=n.i())}(this.u?this.u:Ew),this.g.onreadystatechange=Ci(this.Ha,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(a){return void RC(this,a)}if(n=t||"",t=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)t.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const a of r.keys())t.set(a,r.get(a))}r=Array.from(t.keys()).find(a=>"content-type"==a.toLowerCase()),i=Ut.FormData&&n instanceof Ut.FormData,!(0<=aC(ZS,e))||r||i||t.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[a,l]of t)this.g.setRequestHeader(a,l);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{MC(this),0<this.B&&((this.K=function xC(n){return xu&&function FS(){return function $h(n){var e=cC;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=n(9)}(function(){let n=0;const e=uC(String(Gh)).split("."),t=uC("9").split("."),r=Math.max(e.length,t.length);for(let l=0;0==n&&l<r;l++){var i=e[l]||"",a=t[l]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],0==i[0].length&&0==a[0].length)break;n=Qv(0==i[1].length?0:parseInt(i[1],10),0==a[1].length?0:parseInt(a[1],10))||Qv(0==i[2].length,0==a[2].length)||Qv(i[2],a[2]),i=i[3],a=a[3]}while(0==n)}return 0<=n})}()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Ci(this.qa,this)):this.A=qh(this.qa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(a){RC(this,a)}},gt.qa=function(){typeof sC<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Vr(this,"timeout"),this.abort(8))},gt.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,Vr(this,"complete"),Vr(this,"abort"),b_(this))},gt.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),b_(this,!0)),Jn.X.M.call(this)},gt.Ha=function(){this.s||(this.F||this.v||this.l?Ow(this):this.fb())},gt.fb=function(){Ow(this)},gt.aa=function(){try{return 2<Sa(this)?this.g.status:-1}catch{return-1}},gt.fa=function(){try{return this.g?this.g.responseText:""}catch{return""}},gt.Sa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),AC(e)}},gt.Ea=function(){return this.m},gt.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(gt=kC.prototype).ma=8,gt.G=1,gt.Ja=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.U=Math.floor(1e5*Math.random()),n=this.U++;const i=new Qp(this,this.j,n,void 0);let a=this.s;if(this.S&&(a?(a=hC(a),pC(a,this.S)):a=this.S),null!==this.o||this.N||(i.H=a,a=null),this.O)e:{for(var e=0,t=0;t<this.i.length;t++){var r=this.i[t];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(e+=r)){e=t;break e}if(4096===e||t===this.i.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=Bo(this,i,e),Gn(t=Ta(this.F),"RID",n),Gn(t,"CVER",22),this.D&&Gn(t,"X-HTTP-Session-Id",this.D),Dd(this,t),a&&(this.N?e="headers="+encodeURIComponent(String(Fw(a)))+"&"+e:this.o&&D_(t,this.o,a)),I_(this.h,i),this.Ya&&Gn(t,"TYPE","init"),this.O?(Gn(t,"$req",e),Gn(t,"SID","null"),i.Z=!0,Qh(i,t,null)):Qh(i,t,e),this.G=2}}else 3==this.G&&(n?Vw(this,n):0==this.i.length||Rw(this.h)||Vw(this))},gt.Ia=function(){if(this.u=null,io(this),this.$&&!(this.K||null==this.g||0>=this.P)){var n=2*this.P;this.j.info("BP detection timer enabled: "+n),this.B=Zp(Ci(this.eb,this),n)}},gt.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,Vi(10),rg(this),io(this))},gt.cb=function(){null!=this.v&&(this.v=null,rg(this),Uw(this),Vi(19))},gt.kb=function(n){n?(this.j.info("Successfully pinged google.com"),Vi(2)):(this.j.info("Failed to ping google.com"),Vi(1))},(gt=T_.prototype).xa=function(){},gt.wa=function(){},gt.va=function(){},gt.ua=function(){},gt.Ra=function(){},ql.prototype.g=function(n,e){return new bs(n,e)},Lr(bs,Qr),bs.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;Vi(0),n.V=e,n.ia=t||{},n.L=n.Y,n.F=LC(n,null,n.V),ig(n)},bs.prototype.close=function(){Lw(this.g)},bs.prototype.u=function(n){var e=this.g;if("string"==typeof n){var t={};t.__data__=n,n=t}else this.v&&((t={}).__data__=fw(n),n=t);e.i.push(new class{constructor(n,e){this.h=n,this.g=e}}(e.ab++,n)),3==e.G&&ig(e)},bs.prototype.M=function(){this.g.l=null,delete this.j,Lw(this.g),delete this.g,bs.X.M.call(this)},Lr(Hw,wd),Lr(UC,ww),Lr(Sd,T_),Sd.prototype.xa=function(){Vr(this.g,"a")},Sd.prototype.wa=function(n){Vr(this.g,new Hw(n))},Sd.prototype.va=function(n){Vr(this.g,new UC)},Sd.prototype.ua=function(){Vr(this.g,"b")},ql.prototype.createWebChannel=ql.prototype.g,bs.prototype.send=bs.prototype.u,bs.prototype.open=bs.prototype.m,bs.prototype.close=bs.prototype.close,h_.NO_ERROR=0,h_.TIMEOUT=8,h_.HTTP_ERROR=6,EC.COMPLETE="complete",$l.EventType=f_,f_.OPEN="a",f_.CLOSE="b",f_.ERROR="c",f_.MESSAGE="d",Qr.prototype.listen=Qr.prototype.N,Jn.prototype.listenOnce=Jn.prototype.O,Jn.prototype.getLastError=Jn.prototype.Oa,Jn.prototype.getLastErrorCode=Jn.prototype.Ea,Jn.prototype.getStatus=Jn.prototype.aa,Jn.prototype.getResponseJson=Jn.prototype.Sa,Jn.prototype.getResponseText=Jn.prototype.fa,Jn.prototype.send=Jn.prototype.da,Jn.prototype.setWithCredentials=Jn.prototype.Ka;var BC=Bl.createWebChannelTransport=function(){return new ql},S_=Bl.getStatEventTarget=function(){return qp()},$w=Bl.ErrorCode=h_,jC=Bl.EventType=EC,HC=Bl.Event=vd,A_=Bl.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},x_=Bl.FetchXmlHttpFactory=nf,sg=Bl.WebChannel=$l,$C=Bl.XhrIo=Jn;const Gw="@firebase/firestore";class Ur{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ur.UNAUTHENTICATED=new Ur(null),Ur.GOOGLE_CREDENTIALS=new Ur("google-credentials-uid"),Ur.FIRST_PARTY=new Ur("first-party-uid"),Ur.MOCK_USER=new Ur("mock-user");let Ad="9.14.0";const Mu=new eo.Yd("@firebase/firestore");function R_(){return Mu.logLevel}function ke(n,...e){if(Mu.logLevel<=eo.in.DEBUG){const t=e.map(Ww);Mu.debug(`Firestore (${Ad}): ${n}`,...t)}}function vr(n,...e){if(Mu.logLevel<=eo.in.ERROR){const t=e.map(Ww);Mu.error(`Firestore (${Ad}): ${n}`,...t)}}function xd(n,...e){if(Mu.logLevel<=eo.in.WARN){const t=e.map(Ww);Mu.warn(`Firestore (${Ad}): ${n}`,...t)}}function Ww(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function ot(n="Unexpected state"){const e=`FIRESTORE (${Ad}) INTERNAL ASSERTION FAILED: `+n;throw vr(e),new Error(e)}function Rt(n,e){n||ot()}function Ke(n,e){return n}const de={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ne extends P.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Br{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class WC{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class QS{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ur.UNAUTHENTICATED))}shutdown(){}}class JS{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class XS{constructor(e){this.t=e,this.currentUser=Ur.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;let i=this.i;const a=w=>this.i!==i?(i=this.i,t(w)):Promise.resolve();let l=new Br;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Br,e.enqueueRetryable(()=>a(this.currentUser))};const d=()=>{const w=l;e.enqueueRetryable((0,ve.Z)(function*(){yield w.promise,yield a(r.currentUser)}))},_=w=>{ke("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=w,this.auth.addAuthTokenListener(this.o),d()};this.t.onInit(w=>_(w)),setTimeout(()=>{if(!this.auth){const w=this.t.getImmediate({optional:!0});w?_(w):(ke("FirebaseAuthCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Br)}},0),d()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(ke("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Rt("string"==typeof r.accessToken),new WC(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Rt(null===e||"string"==typeof e),new Ur(e)}}class eA{constructor(e,t,r,i){this.h=e,this.l=t,this.m=r,this.g=i,this.type="FirstParty",this.user=Ur.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(Rt(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class tA{constructor(e,t,r,i){this.h=e,this.l=t,this.m=r,this.g=i}getToken(){return Promise.resolve(new eA(this.h,this.l,this.m,this.g))}start(e,t){e.enqueueRetryable(()=>t(Ur.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class zC{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class qC{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,t){const r=a=>{null!=a.error&&ke("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.A;return this.A=a.token,ke("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>r(a))};const i=a=>{ke("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.appCheck.addTokenListener(this.o)};this.T.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.T.getImmediate({optional:!0});a?i(a):ke("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Rt("string"==typeof t.token),this.A=t.token,new zC(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function KC(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class zw{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=KC(40);for(let a=0;a<i.length;++a)r.length<20&&i[a]<t&&(r+=e.charAt(i[a]%e.length))}return r}}function Pt(n,e){return n<e?-1:n>e?1:0}function Rd(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function qw(n){return n+"\0"}class Vn{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ne(de.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ne(de.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Ne(de.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ne(de.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Vn.fromMillis(Date.now())}static fromDate(e){return Vn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Vn(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Pt(this.nanoseconds,e.nanoseconds):Pt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Tt{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Tt(e)}static min(){return new Tt(new Vn(0,0))}static max(){return new Tt(new Vn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class af{constructor(e,t,r){void 0===t?t=0:t>e.length&&ot(),void 0===r?r=e.length-t:r>e.length-t&&ot(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===af.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof af?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const a=e.get(i),l=t.get(i);if(a<l)return-1;if(a>l)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class sn extends af{construct(e,t,r){return new sn(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Ne(de.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new sn(t)}static emptyPath(){return new sn([])}}const Md=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class cr extends af{construct(e,t,r){return new cr(e,t,r)}static isValidIdentifier(e){return Md.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),cr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new cr(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const a=()=>{if(0===r.length)throw new Ne(de.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let l=!1;for(;i<e.length;){const d=e[i];if("\\"===d){if(i+1===e.length)throw new Ne(de.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const _=e[i+1];if("\\"!==_&&"."!==_&&"`"!==_)throw new Ne(de.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=_,i+=2}else"`"===d?(l=!l,i++):"."!==d||l?(r+=d,i++):(a(),i++)}if(a(),l)throw new Ne(de.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new cr(t)}static emptyPath(){return new cr([])}}class qe{constructor(e){this.path=e}static fromPath(e){return new qe(sn.fromString(e))}static fromName(e){return new qe(sn.fromString(e).popFirst(5))}static empty(){return new qe(sn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===sn.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return sn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new qe(new sn(e.slice()))}}class Nu{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function ZC(n){return n.fields.find(e=>2===e.kind)}function ku(n){return n.fields.filter(e=>2!==e.kind)}Nu.UNKNOWN_ID=-1;class og{constructor(e,t){this.fieldPath=e,this.kind=t}}class M_{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new M_(0,Ds.min())}}function Ct(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=Tt.fromTimestamp(1e9===r?new Vn(t+1,0):new Vn(t,r));return new Ds(i,qe.empty(),e)}function QC(n){return new Ds(n.readTime,n.key,-1)}class Ds{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Ds(Tt.min(),qe.empty(),-1)}static max(){return new Ds(Tt.max(),qe.empty(),-1)}}function Kw(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=qe.comparator(n.documentKey,e.documentKey),0!==t?t:Pt(n.largestBatchId,e.largestBatchId))}const Nd="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class JC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function jo(n){return uf.apply(this,arguments)}function uf(){return uf=(0,ve.Z)(function*(n){if(n.code!==de.FAILED_PRECONDITION||n.message!==Nd)throw n;ke("LocalStore","Unexpectedly lost primary lease")}),uf.apply(this,arguments)}class ee{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ot(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ee((r,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ee?t:ee.resolve(t)}catch(t){return ee.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ee.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ee.reject(t)}static resolve(e){return new ee((t,r)=>{t(e)})}static reject(e){return new ee((t,r)=>{r(e)})}static waitFor(e){return new ee((t,r)=>{let i=0,a=0,l=!1;e.forEach(d=>{++i,d.next(()=>{++a,l&&a===i&&t()},_=>r(_))}),l=!0,a===i&&t()})}static or(e){let t=ee.resolve(!1);for(const r of e)t=t.next(i=>i?ee.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,a)=>{r.push(t.call(this,i,a))}),this.waitFor(r)}static mapArray(e,t){return new ee((r,i)=>{const a=e.length,l=new Array(a);let d=0;for(let _=0;_<a;_++){const w=_;t(e[w]).next(D=>{l[w]=D,++d,d===a&&r(l)},D=>i(D))}})}static doWhile(e,t){return new ee((r,i)=>{const a=()=>{!0===e()?t().next(()=>{a()},i):r()};a()})}}class Zw{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.P=new Br,this.transaction.oncomplete=()=>{this.P.resolve()},this.transaction.onabort=()=>{t.error?this.P.reject(new ag(e,t.error)):this.P.resolve()},this.transaction.onerror=r=>{const i=Qw(r.target.error);this.P.reject(new ag(e,i))}}static open(e,t,r,i){try{return new Zw(t,e.transaction(i,r))}catch(a){throw new ag(t,a)}}get v(){return this.P.promise}abort(e){e&&this.P.reject(e),this.aborted||(ke("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}V(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new eb(t)}}class so{constructor(e,t,r){this.name=e,this.version=t,this.S=r,12.2===so.D((0,P.z$)())&&vr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return ke("SimpleDb","Removing database:",e),Kl(window.indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!(0,P.hl)())return!1;if(so.N())return!0;const e=(0,P.z$)(),t=so.D(e),r=0<t&&t<10,i=so.k(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static N(){var e;return typeof process<"u"&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.O)}static M(e,t){return e.store(t)}static D(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static k(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}F(e){var t=this;return(0,ve.Z)(function*(){return t.db||(ke("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const a=indexedDB.open(t.name,t.version);a.onsuccess=l=>{r(l.target.result)},a.onblocked=()=>{i(new ag(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=l=>{const d=l.target.error;i("VersionError"===d.name?new Ne(de.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===d.name?new Ne(de.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+d):new ag(e,d))},a.onupgradeneeded=l=>{ke("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',l.oldVersion),t.S.$(l.target.result,a.transaction,l.oldVersion,t.version).next(()=>{ke("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.B&&(t.db.onversionchange=r=>t.B(r)),t.db})()}L(e){this.B=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var a=this;return(0,ve.Z)(function*(){const l="readonly"===t;let d=0;for(;;){++d;try{a.db=yield a.F(e);const _=Zw.open(a.db,e,l?"readonly":"readwrite",r),w=i(_).next(D=>(_.V(),D)).catch(D=>(_.abort(D),ee.reject(D))).toPromise();return w.catch(()=>{}),yield _.v,w}catch(_){const w=_,D="FirebaseError"!==w.name&&d<3;if(ke("SimpleDb","Transaction failed with error:",w.message,"Retrying:",D),a.close(),!D)return Promise.reject(w)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class XC{constructor(e){this.U=e,this.q=!1,this.K=null}get isDone(){return this.q}get G(){return this.K}set cursor(e){this.U=e}done(){this.q=!0}j(e){this.K=e}delete(){return Kl(this.U.delete())}}class ag extends Ne{constructor(e,t){super(de.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Pu(n){return"IndexedDbTransactionError"===n.name}class eb{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(ke("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(ke("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Kl(r)}add(e){return ke("SimpleDb","ADD",this.store.name,e,e),Kl(this.store.add(e))}get(e){return Kl(this.store.get(e)).next(t=>(void 0===t&&(t=null),ke("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return ke("SimpleDb","DELETE",this.store.name,e),Kl(this.store.delete(e))}count(){return ke("SimpleDb","COUNT",this.store.name),Kl(this.store.count())}W(e,t){const r=this.options(e,t);if(r.index||"function"!=typeof this.store.getAll){const i=this.cursor(r),a=[];return this.H(i,(l,d)=>{a.push(d)}).next(()=>a)}{const i=this.store.getAll(r.range);return new ee((a,l)=>{i.onerror=d=>{l(d.target.error)},i.onsuccess=d=>{a(d.target.result)}})}}J(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new ee((i,a)=>{r.onerror=l=>{a(l.target.error)},r.onsuccess=l=>{i(l.target.result)}})}Y(e,t){ke("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const i=this.cursor(r);return this.H(i,(a,l,d)=>d.delete())}Z(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.H(i,t)}tt(e){const t=this.cursor({});return new ee((r,i)=>{t.onerror=a=>{const l=Qw(a.target.error);i(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next(d=>{d?l.continue():r()}):r()}})}H(e,t){const r=[];return new ee((i,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const d=l.target.result;if(!d)return void i();const _=new XC(d),w=t(d.primaryKey,d.value,_);if(w instanceof ee){const D=w.catch(S=>(_.done(),ee.reject(S)));r.push(D)}_.isDone?i():null===_.G?d.continue():d.continue(_.G)}}).next(()=>ee.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Kl(n){return new ee((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=Qw(r.target.error);t(i)}})}let Yw=!1;function Qw(n){const e=so.D((0,P.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Ne("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Yw||(Yw=!0,setTimeout(()=>{throw r},0)),r}}return n}class rA{constructor(e,t){this.asyncQueue=e,this.et=t,this.task=null}start(){this.nt(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}nt(e){var t=this;ke("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,ve.Z)(function*(){t.task=null;try{ke("IndexBackiller",`Documents written: ${yield t.et.st()}`)}catch(r){Pu(r)?ke("IndexBackiller","Ignoring IndexedDB error during index backfill: ",r):yield jo(r)}yield t.nt(6e4)}))}}class iA{constructor(e,t){this.localStore=e,this.persistence=t}st(e=50){var t=this;return(0,ve.Z)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.it(r,e))})()}it(e,t){const r=new Set;let i=t,a=!0;return ee.doWhile(()=>!0===a&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(l=>{if(null!==l&&!r.has(l))return ke("IndexBackiller",`Processing collection: ${l}`),this.rt(e,l,i).next(d=>{i-=d,r.add(l)});a=!1})).next(()=>t-i)}rt(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next(()=>this.ot(i,a)).next(d=>(ke("IndexBackiller",`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d))).next(()=>l.size)}))}ot(e,t){let r=e;return t.changes.forEach((i,a)=>{const l=QC(a);Kw(l,r)>0&&(r=l)}),new Ds(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Xr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ut(r),this.ct=r=>t.writeSequenceNumber(r))}ut(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ct&&this.ct(e),e}}function tb(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function kd(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function nb(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}Xr.at=-1;class Un{constructor(e,t){this.comparator=e,this.root=t||ei.EMPTY}insert(e,t){return new Un(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ei.BLACK,null,null))}remove(e){return new Un(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ei.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ug(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ug(this.root,e,this.comparator,!1)}getReverseIterator(){return new ug(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ug(this.root,e,this.comparator,!0)}}class ug{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(0===a){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ei{constructor(e,t,r,i,a){this.key=e,this.value=t,this.color=r??ei.RED,this.left=i??ei.EMPTY,this.right=a??ei.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,a){return new ei(e??this.key,t??this.value,r??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const a=r(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===a?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ei.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return ei.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ei.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ei.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ot();const e=this.left.check();if(e!==this.right.check())throw ot();return e+(this.isRed()?0:1)}}ei.EMPTY=null,ei.RED=!0,ei.BLACK=!1,ei.EMPTY=new class{constructor(){this.size=0}get key(){throw ot()}get value(){throw ot()}get color(){throw ot()}get left(){throw ot()}get right(){throw ot()}copy(n,e,t,r,i){return this}insert(n,e,t){return new ei(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class wn{constructor(e){this.comparator=e,this.data=new Un(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new rb(this.data.getIterator())}getIteratorFrom(e){return new rb(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof wn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(0!==this.comparator(i,a))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new wn(this.comparator);return t.data=e,t}}class rb{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function xa(n){return n.hasNext()?n.getNext():void 0}class fi{constructor(e){this.fields=e,e.sort(cr.comparator)}static empty(){return new fi([])}unionWith(e){let t=new wn(cr.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new fi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Rd(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class jr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new jr(t)}static fromUint8Array(e){const t=function(r){let i="";for(let a=0;a<r.length;++a)i+=String.fromCharCode(r[a]);return i}(e);return new jr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Pt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}jr.EMPTY_BYTE_STRING=new jr("");const oA=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ou(n){if(Rt(!!n),"string"==typeof n){let e=0;const t=oA.exec(n);if(Rt(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Xn(n.seconds),nanos:Xn(n.nanos)}}function Xn(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Zl(n){return"string"==typeof n?jr.fromBase64String(n):jr.fromUint8Array(n)}function Jw(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Xw(n){const e=n.mapValue.fields.__previous_value__;return Jw(e)?Xw(e):e}function lg(n){const e=Ou(n.mapValue.fields.__local_write_time__.timestampValue);return new Vn(e.seconds,e.nanos)}class aA{constructor(e,t,r,i,a,l,d,_){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=d,this.useFetchStreams=_}}class Pd{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Pd("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Pd&&e.projectId===this.projectId&&e.database===this.database}}function N_(n){return null==n}function k_(n){return 0===n&&1/n==-1/0}function uA(n){return"number"==typeof n&&Number.isInteger(n)&&!k_(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const Fu={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Od={nullValue:"NULL_VALUE"};function Fd(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Jw(n)?4:n0(n)?9007199254740991:10:ot()}function Ra(n,e){if(n===e)return!0;const t=Fd(n);if(t!==Fd(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return lg(n).isEqual(lg(e));case 3:return function(r,i){if("string"==typeof r.timestampValue&&"string"==typeof i.timestampValue&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const a=Ou(r.timestampValue),l=Ou(i.timestampValue);return a.seconds===l.seconds&&a.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return i=e,Zl(n.bytesValue).isEqual(Zl(i.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(r,i){return Xn(r.geoPointValue.latitude)===Xn(i.geoPointValue.latitude)&&Xn(r.geoPointValue.longitude)===Xn(i.geoPointValue.longitude)}(n,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return Xn(r.integerValue)===Xn(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const a=Xn(r.doubleValue),l=Xn(i.doubleValue);return a===l?k_(a)===k_(l):isNaN(a)&&isNaN(l)}return!1}(n,e);case 9:return Rd(n.arrayValue.values||[],e.arrayValue.values||[],Ra);case 10:return function(r,i){const a=r.mapValue.fields||{},l=i.mapValue.fields||{};if(tb(a)!==tb(l))return!1;for(const d in a)if(a.hasOwnProperty(d)&&(void 0===l[d]||!Ra(a[d],l[d])))return!1;return!0}(n,e);default:return ot()}var i}function lf(n,e){return void 0!==(n.values||[]).find(t=>Ra(t,e))}function oo(n,e){if(n===e)return 0;const t=Fd(n),r=Fd(e);if(t!==r)return Pt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Pt(n.booleanValue,e.booleanValue);case 2:return function(i,a){const l=Xn(i.integerValue||i.doubleValue),d=Xn(a.integerValue||a.doubleValue);return l<d?-1:l>d?1:l===d?0:isNaN(l)?isNaN(d)?0:-1:1}(n,e);case 3:return ib(n.timestampValue,e.timestampValue);case 4:return ib(lg(n),lg(e));case 5:return Pt(n.stringValue,e.stringValue);case 6:return function(i,a){const l=Zl(i),d=Zl(a);return l.compareTo(d)}(n.bytesValue,e.bytesValue);case 7:return function(i,a){const l=i.split("/"),d=a.split("/");for(let _=0;_<l.length&&_<d.length;_++){const w=Pt(l[_],d[_]);if(0!==w)return w}return Pt(l.length,d.length)}(n.referenceValue,e.referenceValue);case 8:return function(i,a){const l=Pt(Xn(i.latitude),Xn(a.latitude));return 0!==l?l:Pt(Xn(i.longitude),Xn(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(i,a){const l=i.values||[],d=a.values||[];for(let _=0;_<l.length&&_<d.length;++_){const w=oo(l[_],d[_]);if(w)return w}return Pt(l.length,d.length)}(n.arrayValue,e.arrayValue);case 10:return function(i,a){if(i===Fu.mapValue&&a===Fu.mapValue)return 0;if(i===Fu.mapValue)return 1;if(a===Fu.mapValue)return-1;const l=i.fields||{},d=Object.keys(l),_=a.fields||{},w=Object.keys(_);d.sort(),w.sort();for(let D=0;D<d.length&&D<w.length;++D){const S=Pt(d[D],w[D]);if(0!==S)return S;const M=oo(l[d[D]],_[w[D]]);if(0!==M)return M}return Pt(d.length,w.length)}(n.mapValue,e.mapValue);default:throw ot()}}function ib(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return Pt(n,e);const t=Ou(n),r=Ou(e),i=Pt(t.seconds,r.seconds);return 0!==i?i:Pt(t.nanos,r.nanos)}function cf(n){return e0(n)}function e0(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(r){const i=Ou(r);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Zl(n.bytesValue).toBase64():"referenceValue"in n?qe.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(r){let i="[",a=!0;for(const l of r.values||[])a?a=!1:i+=",",i+=e0(l);return i+"]"}(n.arrayValue):"mapValue"in n?function(r){const i=Object.keys(r.fields||{}).sort();let a="{",l=!0;for(const d of i)l?l=!1:a+=",",a+=`${d}:${e0(r.fields[d])}`;return a+"}"}(n.mapValue):ot();var e}function Ld(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function t0(n){return!!n&&"integerValue"in n}function df(n){return!!n&&"arrayValue"in n}function sb(n){return!!n&&"nullValue"in n}function ob(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Yl(n){return!!n&&"mapValue"in n}function cg(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return kd(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=cg(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=cg(n.arrayValue.values[t]);return e}return Object.assign({},n)}function n0(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}function lA(n){return"nullValue"in n?Od:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Ld(Pd.empty(),qe.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?{mapValue:{}}:ot()}function ab(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Ld(Pd.empty(),qe.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?{mapValue:{}}:"mapValue"in n?Fu:ot()}function ub(n,e){const t=oo(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function r0(n,e){const t=oo(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class pi{constructor(e){this.value=e}static empty(){return new pi({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Yl(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=cg(t)}setAll(e){let t=cr.emptyPath(),r={},i=[];e.forEach((l,d)=>{if(!t.isImmediateParentOf(d)){const _=this.getFieldsMap(t);this.applyChanges(_,r,i),r={},i=[],t=d.popLast()}l?r[d.lastSegment()]=cg(l):i.push(d.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,r,i)}delete(e){const t=this.field(e.popLast());Yl(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ra(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Yl(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){kd(t,(i,a)=>e[i]=a);for(const i of r)delete e[i]}clone(){return new pi(cg(this.value))}}function P_(n){const e=[];return kd(n.fields,(t,r)=>{const i=new cr([t]);if(Yl(r)){const a=P_(r.mapValue).fields;if(0===a.length)e.push(i);else for(const l of a)e.push(i.child(l))}else e.push(i)}),new fi(e)}class Mn{constructor(e,t,r,i,a,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.data=a,this.documentState=l}static newInvalidDocument(e){return new Mn(e,0,Tt.min(),Tt.min(),pi.empty(),0)}static newFoundDocument(e,t,r){return new Mn(e,1,t,Tt.min(),r,0)}static newNoDocument(e,t){return new Mn(e,2,t,Tt.min(),pi.empty(),0)}static newUnknownDocument(e,t){return new Mn(e,3,t,Tt.min(),pi.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=pi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=pi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Tt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Mn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Mn(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class lb{constructor(e,t=null,r=[],i=[],a=null,l=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=a,this.startAt=l,this.endAt=d,this.ht=null}}function s0(n,e=null,t=[],r=[],i=null,a=null,l=null){return new lb(n,e,t,r,i,a,l)}function Vd(n){const e=Ke(n);if(null===e.ht){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>{return(i=r).field.canonicalString()+i.op.toString()+cf(i.value);var i}).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(i=r).field.canonicalString()+i.dir;var i}).join(","),N_(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>cf(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>cf(r)).join(",")),e.ht=t}return e.ht}function dg(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let i=0;i<n.orderBy.length;i++)if(!pb(n.orderBy[i],e.orderBy[i]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let i=0;i<n.filters.length;i++)if((t=n.filters[i]).op!==(r=e.filters[i]).op||!t.field.isEqual(r.field)||!Ra(t.value,r.value))return!1;var t,r;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!mb(n.startAt,e.startAt)&&mb(n.endAt,e.endAt)}function hf(n){return qe.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function O_(n,e){return n.filters.filter(t=>t instanceof gi&&t.field.isEqual(e))}function o0(n,e,t){let r=Od,i=!0;for(const a of O_(n,e)){let l=Od,d=!0;switch(a.op){case"<":case"<=":l=lA(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,d=!1;break;case"!=":case"not-in":l=Od}ub({value:r,inclusive:i},{value:l,inclusive:d})<0&&(r=l,i=d)}if(null!==t)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];ub({value:r,inclusive:i},{value:l,inclusive:t.inclusive})<0&&(r=l,i=t.inclusive);break}return{value:r,inclusive:i}}function cb(n,e,t){let r=Fu,i=!0;for(const a of O_(n,e)){let l=Fu,d=!0;switch(a.op){case">=":case">":l=ab(a.value),d=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,d=!1;break;case"!=":case"not-in":l=Fu}r0({value:r,inclusive:i},{value:l,inclusive:d})>0&&(r=l,i=d)}if(null!==t)for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];r0({value:r,inclusive:i},{value:l,inclusive:t.inclusive})>0&&(r=l,i=t.inclusive);break}return{value:r,inclusive:i}}class gi extends class{}{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.lt(e,t,r):new dA(e,t,r):"array-contains"===t?new pA(e,r):"in"===t?new gA(e,r):"not-in"===t?new hb(e,r):"array-contains-any"===t?new fb(e,r):new gi(e,t,r)}static lt(e,t,r){return"in"===t?new hA(e,r):new fA(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.ft(oo(t,this.value)):null!==t&&Fd(this.value)===Fd(t)&&this.ft(oo(t,this.value))}ft(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ot()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class dA extends gi{constructor(e,t,r){super(e,t,r),this.key=qe.fromName(r.referenceValue)}matches(e){const t=qe.comparator(e.key,this.key);return this.ft(t)}}class hA extends gi{constructor(e,t){super(e,"in",t),this.keys=db(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class fA extends gi{constructor(e,t){super(e,"not-in",t),this.keys=db(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function db(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>qe.fromName(r.referenceValue))}class pA extends gi{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return df(t)&&lf(t.arrayValue,this.value)}}class gA extends gi{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&lf(this.value.arrayValue,t)}}class hb extends gi{constructor(e,t){super(e,"not-in",t)}matches(e){if(lf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!lf(this.value.arrayValue,t)}}class fb extends gi{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!df(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>lf(this.value.arrayValue,r))}}class Ql{constructor(e,t){this.position=e,this.inclusive=t}}class ff{constructor(e,t="asc"){this.field=e,this.dir=t}}function pb(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}function gb(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const a=e[i],l=n.position[i];if(r=a.field.isKeyField()?qe.comparator(qe.fromName(l.referenceValue),t.key):oo(l,t.data.field(a.field)),"desc"===a.dir&&(r*=-1),0!==r)break}return r}function mb(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ra(n.position[t],e.position[t]))return!1;return!0}class Lu{constructor(e,t=null,r=[],i=[],a=null,l="F",d=null,_=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=a,this.limitType=l,this.startAt=d,this.endAt=_,this._t=null,this.wt=null}}function F_(n,e,t,r,i,a,l,d){return new Lu(n,e,t,r,i,a,l,d)}function Jl(n){return new Lu(n)}function a0(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function hg(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function u0(n){for(const e of n.filters)if(e.dt())return e.field;return null}function l0(n){return null!==n.collectionGroup}function Xl(n){const e=Ke(n);if(null===e._t){e._t=[];const t=u0(e),r=hg(e);if(null!==t&&null===r)t.isKeyField()||e._t.push(new ff(t)),e._t.push(new ff(cr.keyField(),"asc"));else{let i=!1;for(const a of e.explicitOrderBy)e._t.push(a),a.field.isKeyField()&&(i=!0);if(!i){const a=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e._t.push(new ff(cr.keyField(),a))}}}return e._t}function Ui(n){const e=Ke(n);if(!e.wt)if("F"===e.limitType)e.wt=s0(e.path,e.collectionGroup,Xl(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const a of Xl(e))t.push(new ff(a.field,"desc"===a.dir?"asc":"desc"));const r=e.endAt?new Ql(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new Ql(e.startAt.position,e.startAt.inclusive):null;e.wt=s0(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}return e.wt}function fg(n,e,t){return new Lu(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Ma(n,e){return dg(Ui(n),Ui(e))&&n.limitType===e.limitType}function c0(n){return`${Vd(Ui(n))}|lt:${n.limitType}`}function d0(n){return`Query(target=${function cA(n){let e=n.path.canonicalString();return null!==n.collectionGroup&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>{return`${(r=t).field.canonicalString()} ${r.op} ${cf(r.value)}`;var r}).join(", ")}]`),N_(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>{return`${(r=t).field.canonicalString()} (${r.dir})`;var r}).join(", ")}]`),n.startAt&&(e+=", startAt: ",e+=n.startAt.inclusive?"b:":"a:",e+=n.startAt.position.map(t=>cf(t)).join(",")),n.endAt&&(e+=", endAt: ",e+=n.endAt.inclusive?"a:":"b:",e+=n.endAt.position.map(t=>cf(t)).join(",")),`Target(${e})`}(Ui(n))}; limitType=${n.limitType})`}function _b(n,e){return e.isFoundDocument()&&function(t,r){const i=r.key.path;return null!==t.collectionGroup?r.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(i):qe.isDocumentKey(t.path)?t.path.isEqual(i):t.path.isImmediateParentOf(i)}(n,e)&&function(t,r){for(const i of t.explicitOrderBy)if(!i.field.isKeyField()&&null===r.data.field(i.field))return!1;return!0}(n,e)&&function(t,r){for(const i of t.filters)if(!i.matches(r))return!1;return!0}(n,e)&&(r=e,!((t=n).startAt&&!function(i,a,l){const d=gb(i,a,l);return i.inclusive?d<=0:d<0}(t.startAt,Xl(t),r)||t.endAt&&!function(i,a,l){const d=gb(i,a,l);return i.inclusive?d>=0:d>0}(t.endAt,Xl(t),r)));var t,r}function h0(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function L_(n){return(e,t)=>{let r=!1;for(const i of Xl(n)){const a=mA(i,e,t);if(0!==a)return a;r=r||i.field.isKeyField()}return 0}}function mA(n,e,t){const r=n.field.isKeyField()?qe.comparator(e.key,t.key):function(i,a,l){const d=a.data.field(i),_=l.data.field(i);return null!==d&&null!==_?oo(d,_):ot()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return ot()}}function V_(n,e){if(n.gt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:k_(e)?"-0":e}}function yb(n){return{integerValue:""+n}}function f0(n,e){return uA(e)?yb(e):V_(n,e)}class pf{constructor(){this._=void 0}}function vb(n,e,t){return n instanceof Ud?function(r,i){const a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&(a.fields.__previous_value__=i),{mapValue:a}}(t,e):n instanceof Bd?Eb(n,e):n instanceof jd?Ib(n,e):function(r,i){const a=p0(r,i),l=_A(a)+_A(r.yt);return t0(a)&&t0(r.yt)?yb(l):V_(r.It,l)}(n,e)}function wb(n,e,t){return n instanceof Bd?Eb(n,e):n instanceof jd?Ib(n,e):t}function p0(n,e){return n instanceof Hd?t0(t=e)||(r=t)&&"doubleValue"in r?e:{integerValue:0}:null;var r,t}class Ud extends pf{}class Bd extends pf{constructor(e){super(),this.elements=e}}function Eb(n,e){const t=g0(e);for(const r of n.elements)t.some(i=>Ra(i,r))||t.push(r);return{arrayValue:{values:t}}}class jd extends pf{constructor(e){super(),this.elements=e}}function Ib(n,e){let t=g0(e);for(const r of n.elements)t=t.filter(i=>!Ra(i,r));return{arrayValue:{values:t}}}class Hd extends pf{constructor(e,t){super(),this.It=e,this.yt=t}}function _A(n){return Xn(n.integerValue||n.doubleValue)}function g0(n){return df(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class pg{constructor(e,t){this.field=e,this.transform=t}}class FN{constructor(e,t){this.version=e,this.transformResults=t}}class er{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new er}static exists(e){return new er(void 0,e)}static updateTime(e){return new er(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function U_(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class B_{}function m0(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new Na(n.key,er.none()):new gf(n.key,n.data,er.none());{const t=n.data,r=pi.empty();let i=new wn(cr.comparator);for(let a of e.fields)if(!i.has(a)){let l=t.field(a);null===l&&a.length>1&&(a=a.popLast(),l=t.field(a)),null===l?r.delete(a):r.set(a,l),i=i.add(a)}return new Vu(n.key,r,new fi(i.toArray()),er.none())}}function Cb(n,e,t){n instanceof gf?function(r,i,a){const l=r.value.clone(),d=Tb(r.fieldTransforms,i,a.transformResults);l.setAll(d),i.convertToFoundDocument(a.version,l).setHasCommittedMutations()}(n,e,t):n instanceof Vu?function(r,i,a){if(!U_(r.precondition,i))return void i.convertToUnknownDocument(a.version);const l=Tb(r.fieldTransforms,i,a.transformResults),d=i.data;d.setAll(Db(r)),d.setAll(l),i.convertToFoundDocument(a.version,d).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function gg(n,e,t,r){return n instanceof gf?function(i,a,l,d){if(!U_(i.precondition,a))return l;const _=i.value.clone(),w=Sb(i.fieldTransforms,d,a);return _.setAll(w),a.convertToFoundDocument(a.version,_).setHasLocalMutations(),null}(n,e,t,r):n instanceof Vu?function(i,a,l,d){if(!U_(i.precondition,a))return l;const _=Sb(i.fieldTransforms,d,a),w=a.data;return w.setAll(Db(i)),w.setAll(_),a.convertToFoundDocument(a.version,w).setHasLocalMutations(),null===l?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(D=>D.field))}(n,e,t,r):(l=t,U_(n.precondition,a=e)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):l);var a,l}function vA(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),a=p0(r.transform,i||null);null!=a&&(null===t&&(t=pi.empty()),t.set(r.field,a))}return t||null}function bb(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(r=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===r||t&&r&&Rd(t,r,(i,a)=>function yA(n,e){return n.field.isEqual(e.field)&&(r=e.transform,(t=n.transform)instanceof Bd&&r instanceof Bd||t instanceof jd&&r instanceof jd?Rd(t.elements,r.elements,Ra):t instanceof Hd&&r instanceof Hd?Ra(t.yt,r.yt):t instanceof Ud&&r instanceof Ud);var t,r}(i,a))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,r}class gf extends B_{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Vu extends B_{constructor(e,t,r,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function Db(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function Tb(n,e,t){const r=new Map;Rt(n.length===t.length);for(let i=0;i<t.length;i++){const a=n[i],l=a.transform,d=e.data.field(a.field);r.set(a.field,wb(l,d,t[i]))}return r}function Sb(n,e,t){const r=new Map;for(const i of n){const a=i.transform,l=t.data.field(i.field);r.set(i.field,vb(a,l,e))}return r}class Na extends B_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class j_ extends B_{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Ab{constructor(e){this.count=e}}var wr,on;function _0(n){switch(n){default:return ot();case de.CANCELLED:case de.UNKNOWN:case de.DEADLINE_EXCEEDED:case de.RESOURCE_EXHAUSTED:case de.INTERNAL:case de.UNAVAILABLE:case de.UNAUTHENTICATED:return!1;case de.INVALID_ARGUMENT:case de.NOT_FOUND:case de.ALREADY_EXISTS:case de.PERMISSION_DENIED:case de.FAILED_PRECONDITION:case de.ABORTED:case de.OUT_OF_RANGE:case de.UNIMPLEMENTED:case de.DATA_LOSS:return!0}}function xb(n){if(void 0===n)return vr("GRPC error has no .code"),de.UNKNOWN;switch(n){case wr.OK:return de.OK;case wr.CANCELLED:return de.CANCELLED;case wr.UNKNOWN:return de.UNKNOWN;case wr.DEADLINE_EXCEEDED:return de.DEADLINE_EXCEEDED;case wr.RESOURCE_EXHAUSTED:return de.RESOURCE_EXHAUSTED;case wr.INTERNAL:return de.INTERNAL;case wr.UNAVAILABLE:return de.UNAVAILABLE;case wr.UNAUTHENTICATED:return de.UNAUTHENTICATED;case wr.INVALID_ARGUMENT:return de.INVALID_ARGUMENT;case wr.NOT_FOUND:return de.NOT_FOUND;case wr.ALREADY_EXISTS:return de.ALREADY_EXISTS;case wr.PERMISSION_DENIED:return de.PERMISSION_DENIED;case wr.FAILED_PRECONDITION:return de.FAILED_PRECONDITION;case wr.ABORTED:return de.ABORTED;case wr.OUT_OF_RANGE:return de.OUT_OF_RANGE;case wr.UNIMPLEMENTED:return de.UNIMPLEMENTED;case wr.DATA_LOSS:return de.DATA_LOSS;default:return ot()}}(on=wr||(wr={}))[on.OK=0]="OK",on[on.CANCELLED=1]="CANCELLED",on[on.UNKNOWN=2]="UNKNOWN",on[on.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",on[on.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",on[on.NOT_FOUND=5]="NOT_FOUND",on[on.ALREADY_EXISTS=6]="ALREADY_EXISTS",on[on.PERMISSION_DENIED=7]="PERMISSION_DENIED",on[on.UNAUTHENTICATED=16]="UNAUTHENTICATED",on[on.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",on[on.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",on[on.ABORTED=10]="ABORTED",on[on.OUT_OF_RANGE=11]="OUT_OF_RANGE",on[on.UNIMPLEMENTED=12]="UNIMPLEMENTED",on[on.INTERNAL=13]="INTERNAL",on[on.UNAVAILABLE=14]="UNAVAILABLE",on[on.DATA_LOSS=15]="DATA_LOSS";class ec{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,a]of r)if(this.equalsFn(i,e))return a}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){kd(this.inner,(t,r)=>{for(const[i,a]of r)e(i,a)})}isEmpty(){return nb(this.inner)}size(){return this.innerSize}}const LN=new Un(qe.comparator);function Xi(){return LN}const Rb=new Un(qe.comparator);function mg(...n){let e=Rb;for(const t of n)e=e.insert(t.key,t);return e}function Mb(n){let e=Rb;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function ka(){return _g()}function mf(){return _g()}function _g(){return new ec(n=>n.toString(),(n,e)=>n.isEqual(e))}const y0=new Un(qe.comparator),Pa=new wn(qe.comparator);function Ht(...n){let e=Pa;for(const t of n)e=e.add(t);return e}const v0=new wn(Pt);function tc(){return v0}class yg{constructor(e,t,r,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,vg.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new yg(Tt.min(),i,tc(),Xi(),Ht())}}class vg{constructor(e,t,r,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new vg(r,t,Ht(),Ht(),Ht())}}class H_{constructor(e,t,r,i){this.Tt=e,this.removedTargetIds=t,this.key=r,this.Et=i}}class wg{constructor(e,t){this.targetId=e,this.At=t}}class Eg{constructor(e,t,r=jr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class Nb{constructor(){this.Rt=0,this.bt=E0(),this.Pt=jr.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return 0!==this.Rt}get Dt(){return this.Vt}Ct(e){e.approximateByteSize()>0&&(this.Vt=!0,this.Pt=e)}xt(){let e=Ht(),t=Ht(),r=Ht();return this.bt.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:ot()}}),new vg(this.Pt,this.vt,e,t,r)}Nt(){this.Vt=!1,this.bt=E0()}kt(e,t){this.Vt=!0,this.bt=this.bt.insert(e,t)}Ot(e){this.Vt=!0,this.bt=this.bt.remove(e)}Mt(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class wA{constructor(e){this.Bt=e,this.Lt=new Map,this.Ut=Xi(),this.qt=w0(),this.Kt=new wn(Pt)}Gt(e){for(const t of e.Tt)e.Et&&e.Et.isFoundDocument()?this.Qt(t,e.Et):this.jt(t,e.key,e.Et);for(const t of e.removedTargetIds)this.jt(t,e.key,e.Et)}Wt(e){this.forEachTarget(e,t=>{const r=this.zt(t);switch(e.state){case 0:this.Ht(t)&&r.Ct(e.resumeToken);break;case 1:r.Ft(),r.St||r.Nt(),r.Ct(e.resumeToken);break;case 2:r.Ft(),r.St||this.removeTarget(t);break;case 3:this.Ht(t)&&(r.$t(),r.Ct(e.resumeToken));break;case 4:this.Ht(t)&&(this.Jt(t),r.Ct(e.resumeToken));break;default:ot()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Lt.forEach((r,i)=>{this.Ht(i)&&t(i)})}Yt(e){const t=e.targetId,r=e.At.count,i=this.Xt(t);if(i){const a=i.target;if(hf(a))if(0===r){const l=new qe(a.path);this.jt(t,l,Mn.newNoDocument(l,Tt.min()))}else Rt(1===r);else this.Zt(t)!==r&&(this.Jt(t),this.Kt=this.Kt.add(t))}}te(e){const t=new Map;this.Lt.forEach((a,l)=>{const d=this.Xt(l);if(d){if(a.current&&hf(d.target)){const _=new qe(d.target.path);null!==this.Ut.get(_)||this.ee(l,_)||this.jt(l,_,Mn.newNoDocument(_,e))}a.Dt&&(t.set(l,a.xt()),a.Nt())}});let r=Ht();this.qt.forEach((a,l)=>{let d=!0;l.forEachWhile(_=>{const w=this.Xt(_);return!w||2===w.purpose||(d=!1,!1)}),d&&(r=r.add(a))}),this.Ut.forEach((a,l)=>l.setReadTime(e));const i=new yg(e,t,this.Kt,this.Ut,r);return this.Ut=Xi(),this.qt=w0(),this.Kt=new wn(Pt),i}Qt(e,t){if(!this.Ht(e))return;const r=this.ee(e,t.key)?2:0;this.zt(e).kt(t.key,r),this.Ut=this.Ut.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ne(t.key).add(e))}jt(e,t,r){if(!this.Ht(e))return;const i=this.zt(e);this.ee(e,t)?i.kt(t,1):i.Ot(t),this.qt=this.qt.insert(t,this.ne(t).delete(e)),r&&(this.Ut=this.Ut.insert(t,r))}removeTarget(e){this.Lt.delete(e)}Zt(e){const t=this.zt(e).xt();return this.Bt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Mt(e){this.zt(e).Mt()}zt(e){let t=this.Lt.get(e);return t||(t=new Nb,this.Lt.set(e,t)),t}ne(e){let t=this.qt.get(e);return t||(t=new wn(Pt),this.qt=this.qt.insert(e,t)),t}Ht(e){const t=null!==this.Xt(e);return t||ke("WatchChangeAggregator","Detected inactive target",e),t}Xt(e){const t=this.Lt.get(e);return t&&t.St?null:this.Bt.se(e)}Jt(e){this.Lt.set(e,new Nb),this.Bt.getRemoteKeysForTarget(e).forEach(t=>{this.jt(e,t,null)})}ee(e,t){return this.Bt.getRemoteKeysForTarget(e).has(t)}}function w0(){return new Un(qe.comparator)}function E0(){return new Un(qe.comparator)}const I0={asc:"ASCENDING",desc:"DESCENDING"},kb={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class EA{constructor(e,t){this.databaseId=e,this.gt=t}}function Ig(n,e){return n.gt?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function IA(n,e){return n.gt?e.toBase64():e.toUint8Array()}function C0(n,e){return Ig(n,e.toTimestamp())}function xr(n){return Rt(!!n),Tt.fromTimestamp(function(e){const t=Ou(e);return new Vn(t.seconds,t.nanos)}(n))}function $_(n,e){return(t=n,new sn(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function G_(n){const e=sn.fromString(n);return Rt(wf(e)),e}function $d(n,e){return $_(n.databaseId,e.path)}function Oa(n,e){const t=G_(e);if(t.get(1)!==n.databaseId.projectId)throw new Ne(de.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ne(de.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new qe(D0(t))}function b0(n,e){return $_(n.databaseId,e)}function Pb(n){const e=G_(n);return 4===e.length?sn.emptyPath():D0(e)}function Cg(n){return new sn(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function D0(n){return Rt(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function W_(n,e,t){return{name:$d(n,e),fields:t.value.mapValue.fields}}function T0(n,e,t){const r=Oa(n,e.name),i=xr(e.updateTime),a=new pi({mapValue:{fields:e.fields}}),l=Mn.newFoundDocument(r,i,a);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function _f(n,e){let t;if(e instanceof gf)t={update:W_(n,e.key,e.value)};else if(e instanceof Na)t={delete:$d(n,e.key)};else if(e instanceof Vu)t={update:W_(n,e.key,e.data),updateMask:Ub(e.fieldMask)};else{if(!(e instanceof j_))return ot();t={verify:$d(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(i,a){const l=a.transform;if(l instanceof Ud)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Bd)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof jd)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Hd)return{fieldPath:a.field.canonicalString(),increment:l.yt};throw ot()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(i=e.precondition).updateTime?{updateTime:C0(n,i.updateTime)}:void 0!==i.exists?{exists:i.exists}:ot()),t;var i}function S0(n,e){const t=e.currentDocument?void 0!==(i=e.currentDocument).updateTime?er.updateTime(xr(i.updateTime)):void 0!==i.exists?er.exists(i.exists):er.none():er.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(a,l){let d=null;"setToServerValue"in l?(Rt("REQUEST_TIME"===l.setToServerValue),d=new Ud):"appendMissingElements"in l?d=new Bd(l.appendMissingElements.values||[]):"removeAllFromArray"in l?d=new jd(l.removeAllFromArray.values||[]):"increment"in l?d=new Hd(a,l.increment):ot();const _=cr.fromServerFormat(l.fieldPath);return new pg(_,d)}(n,i)):[];var i;if(e.update){const i=Oa(n,e.update.name),a=new pi({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=new fi((e.updateMask.fieldPaths||[]).map(w=>cr.fromServerFormat(w)));return new Vu(i,a,l,t,r)}return new gf(i,a,t,r)}if(e.delete){const i=Oa(n,e.delete);return new Na(i,t)}if(e.verify){const i=Oa(n,e.verify);return new j_(i,t)}return ot()}function A0(n,e){return{documents:[b0(n,e.path)]}}function x0(n,e){const t={structuredQuery:{}},r=e.path;null!==e.collectionGroup?(t.parent=b0(n,r),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=b0(n,r.popLast()),t.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(_){if(0===_.length)return;const w=_.map(D=>function(S){if("=="===S.op){if(ob(S.value))return{unaryFilter:{field:vf(S.field),op:"IS_NAN"}};if(sb(S.value))return{unaryFilter:{field:vf(S.field),op:"IS_NULL"}}}else if("!="===S.op){if(ob(S.value))return{unaryFilter:{field:vf(S.field),op:"IS_NOT_NAN"}};if(sb(S.value))return{unaryFilter:{field:vf(S.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:vf(S.field),op:bA(S.op),value:S.value}}}(D));return 1===w.length?w[0]:{compositeFilter:{op:"AND",filters:w}}}(e.filters);i&&(t.structuredQuery.where=i);const a=function(_){if(0!==_.length)return _.map(w=>{return{field:vf((D=w).field),direction:yf(D.dir)};var D})}(e.orderBy);a&&(t.structuredQuery.orderBy=a);const l=(w=e.limit,n.gt||N_(w)?w:{value:w});var w,d,_;return null!==l&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt={before:(d=e.startAt).inclusive,values:d.position}),e.endAt&&(t.structuredQuery.endAt={before:!(_=e.endAt).inclusive,values:_.position}),t}function R0(n){let e=Pb(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Rt(1===r);const D=t.from[0];D.allDescendants?i=D.collectionId:e=e.child(D.collectionId)}let a=[];t.where&&(a=Di(t.where));let l=[];t.orderBy&&(l=t.orderBy.map(D=>{return new ff(bg((S=D).field),function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(S.direction));var S}));let d=null;t.limit&&(d=function(D){let S;return S="object"==typeof D?D.value:D,N_(S)?null:S}(t.limit));let _=null;var D;t.startAt&&(_=new Ql((D=t.startAt).values||[],!!D.before));let w=null;return t.endAt&&(w=function(D){return new Ql(D.values||[],!D.before)}(t.endAt)),F_(e,i,l,a,d,"F",_,w)}function Di(n){return n?void 0!==n.unaryFilter?[Vb(n)]:void 0!==n.fieldFilter?[VN(n)]:void 0!==n.compositeFilter?n.compositeFilter.filters.map(e=>Di(e)).reduce((e,t)=>e.concat(t)):ot():[]}function yf(n){return I0[n]}function bA(n){return kb[n]}function vf(n){return{fieldPath:n.canonicalString()}}function bg(n){return cr.fromServerFormat(n.fieldPath)}function VN(n){return gi.create(bg(n.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ot()}}(n.fieldFilter.op),n.fieldFilter.value)}function Vb(n){switch(n.unaryFilter.op){case"IS_NAN":const e=bg(n.unaryFilter.field);return gi.create(e,"==",{doubleValue:NaN});case"IS_NULL":const t=bg(n.unaryFilter.field);return gi.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=bg(n.unaryFilter.field);return gi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=bg(n.unaryFilter.field);return gi.create(i,"!=",{nullValue:"NULL_VALUE"});default:return ot()}}function Ub(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function wf(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}function Bi(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=Bb(e)),e=M0(n.get(t),e);return Bb(e)}function M0(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const a=n.charAt(i);switch(a){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=a}}return t}function Bb(n){return n+"\x01\x01"}function Ho(n){const e=n.length;if(Rt(e>=2),2===e)return Rt("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),sn.emptyPath();const t=e-2,r=[];let i="";for(let a=0;a<e;){const l=n.indexOf("\x01",a);switch((l<0||l>t)&&ot(),n.charAt(l+1)){case"\x01":const d=n.substring(a,l);let _;0===i.length?_=d:(i+=d,_=i,i=""),r.push(_);break;case"\x10":i+=n.substring(a,l),i+="\0";break;case"\x11":i+=n.substring(a,l+1);break;default:ot()}a=l+2}return new sn(r)}const jb=["userId","batchId"];function z_(n,e){return[n,Bi(e)]}function Hb(n,e,t){return[n,Bi(e),t]}const N0={},$b=["prefixPath","collectionGroup","readTime","documentId"],Gb=["prefixPath","collectionGroup","documentId"],q_=["collectionGroup","readTime","prefixPath","documentId"],k0=["canonicalId","targetId"],UN=["targetId","path"],Wb=["path","targetId"],DA=["collectionId","parent"],zb=["indexId","uid"],Ef=["uid","sequenceNumber"],TA=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],qb=["indexId","uid","orderedDocumentKey"],P0=["userId","collectionPath","documentId"],BN=["userId","collectionPath","largestBatchId"],SA=["userId","collectionGroup","largestBatchId"],AA=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],xA=[...AA,"documentOverlays"],Kb=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Zb=Kb,Yb=[...Zb,"indexConfiguration","indexState","indexEntries"];class K_ extends JC{constructor(e,t){super(),this.ie=e,this.currentSequenceNumber=t}}function ti(n,e){const t=Ke(n);return so.M(t.ie,e)}class Z_{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&Cb(a,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=gg(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=gg(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=mf();return this.mutations.forEach(i=>{const a=e.get(i.key),l=a.overlayedDocument;let d=this.applyToLocalView(l,a.mutatedFields);d=t.has(i.key)?null:d;const _=m0(l,d);null!==_&&r.set(i.key,_),l.isValidDocument()||l.convertToNoDocument(Tt.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ht())}isEqual(e){return this.batchId===e.batchId&&Rd(this.mutations,e.mutations,(t,r)=>bb(t,r))&&Rd(this.baseMutations,e.baseMutations,(t,r)=>bb(t,r))}}class Y_{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Rt(e.mutations.length===r.length);let i=y0;const a=e.mutations;for(let l=0;l<a.length;l++)i=i.insert(a[l].key,r[l].version);return new Y_(e,t,r,i)}}class O0{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class nc{constructor(e,t,r,i,a=Tt.min(),l=Tt.min(),d=jr.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=d}withSequenceNumber(e){return new nc(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new nc(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new nc(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class F0{constructor(e){this.re=e}}function L0(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Dg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:$d(i=n.re,(a=e).key),fields:a.data.value.mapValue.fields,updateTime:Ig(i,a.version.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:rc(e.version)};else{if(!e.isUnknownDocument())return ot();r.unknownDocument={path:t.path.toArray(),version:rc(e.version)}}var i,a;return r}function Dg(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function rc(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ic(n){const e=new Vn(n.seconds,n.nanoseconds);return Tt.fromTimestamp(e)}function Gd(n,e){const t=(e.baseMutations||[]).map(a=>S0(n.re,a));for(let a=0;a<e.mutations.length-1;++a){const l=e.mutations[a];a+1<e.mutations.length&&void 0!==e.mutations[a+1].transform&&(l.updateTransforms=e.mutations[a+1].transform.fieldTransforms,e.mutations.splice(a+1,1),++a)}const r=e.mutations.map(a=>S0(n.re,a)),i=Vn.fromMillis(e.localWriteTimeMs);return new Z_(e.batchId,i,t,r)}function Tg(n){const e=ic(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?ic(n.lastLimboFreeSnapshotVersion):Tt.min();let r;var i;return void 0!==n.query.documents?(Rt(1===(i=n.query).documents.length),r=Ui(Jl(Pb(i.documents[0])))):r=Ui(R0(n.query)),new nc(r,n.targetId,0,n.lastListenSequenceNumber,e,t,jr.fromBase64String(n.resumeToken))}function MA(n,e){const t=rc(e.snapshotVersion),r=rc(e.lastLimboFreeSnapshotVersion);let i;i=hf(e.target)?A0(n.re,e.target):x0(n.re,e.target);const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Vd(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Q_(n){const e=R0({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?fg(e,e.limit,"L"):e}function Qb(n,e){return new O0(e.largestBatchId,S0(n.re,e.overlayMutation))}function NA(n,e){const t=e.path.lastSegment();return[n,Bi(e.path.popLast()),t]}function kA(n,e,t,r){return{indexId:n,uid:e.uid||"",sequenceNumber:t,readTime:rc(r.readTime),documentKey:Bi(r.documentKey.path),largestBatchId:r.largestBatchId}}class jN{getBundleMetadata(e,t){return PA(e).get(t).next(r=>{if(r)return{id:(i=r).bundleId,createTime:ic(i.createTime),version:i.version};var i})}saveBundleMetadata(e,t){return PA(e).put({bundleId:(r=t).id,createTime:rc(xr(r.createTime)),version:r.version});var r}getNamedQuery(e,t){return OA(e).get(t).next(r=>{if(r)return{name:(i=r).name,query:Q_(i.bundledQuery),readTime:ic(i.readTime)};var i})}saveNamedQuery(e,t){return OA(e).put({name:(r=t).name,readTime:rc(xr(r.readTime)),bundledQuery:r.bundledQuery});var r}}function PA(n){return ti(n,"bundles")}function OA(n){return ti(n,"namedQueries")}class V0{constructor(e,t){this.It=e,this.userId=t}static oe(e,t){return new V0(e,t.uid||"")}getOverlay(e,t){return J_(e).get(NA(this.userId,t)).next(r=>r?Qb(this.It,r):null)}getOverlays(e,t){const r=ka();return ee.forEach(t,i=>this.getOverlay(e,i).next(a=>{null!==a&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((a,l)=>{const d=new O0(t,l);i.push(this.ue(e,d))}),ee.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(l=>i.add(Bi(l.getCollectionPath())));const a=[];return i.forEach(l=>{const d=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,r+1],!1,!0);a.push(J_(e).Y("collectionPathOverlayIndex",d))}),ee.waitFor(a)}getOverlaysForCollection(e,t,r){const i=ka(),a=Bi(t),l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return J_(e).W("collectionPathOverlayIndex",l).next(d=>{for(const _ of d){const w=Qb(this.It,_);i.set(w.getKey(),w)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const a=ka();let l;const d=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return J_(e).Z({index:"collectionGroupOverlayIndex",range:d},(_,w,D)=>{const S=Qb(this.It,w);a.size()<i||S.largestBatchId===l?(a.set(S.getKey(),S),l=S.largestBatchId):D.done()}).next(()=>a)}ue(e,t){return J_(e).put(function(r,i,a){const[l,d,_]=NA(i,a.mutation.key);return{userId:i,collectionPath:d,documentId:_,collectionGroup:a.mutation.key.getCollectionGroup(),largestBatchId:a.largestBatchId,overlayMutation:_f(r.re,a.mutation)}}(this.It,this.userId,t))}}function J_(n){return ti(n,"documentOverlays")}class Fa{constructor(){}ce(e,t){this.ae(e,t),t.he()}ae(e,t){if("nullValue"in e)this.le(t,5);else if("booleanValue"in e)this.le(t,10),t.fe(e.booleanValue?1:0);else if("integerValue"in e)this.le(t,15),t.fe(Xn(e.integerValue));else if("doubleValue"in e){const r=Xn(e.doubleValue);isNaN(r)?this.le(t,13):(this.le(t,15),k_(r)?t.fe(0):t.fe(r))}else if("timestampValue"in e){const r=e.timestampValue;this.le(t,20),"string"==typeof r?t.de(r):(t.de(`${r.seconds||""}`),t.fe(r.nanos||0))}else if("stringValue"in e)this._e(e.stringValue,t),this.we(t);else if("bytesValue"in e)this.le(t,30),t.me(Zl(e.bytesValue)),this.we(t);else if("referenceValue"in e)this.ge(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.le(t,45),t.fe(r.latitude||0),t.fe(r.longitude||0)}else"mapValue"in e?n0(e)?this.le(t,Number.MAX_SAFE_INTEGER):(this.ye(e.mapValue,t),this.we(t)):"arrayValue"in e?(this.pe(e.arrayValue,t),this.we(t)):ot()}_e(e,t){this.le(t,25),this.Ie(e,t)}Ie(e,t){t.de(e)}ye(e,t){const r=e.fields||{};this.le(t,55);for(const i of Object.keys(r))this._e(i,t),this.ae(r[i],t)}pe(e,t){const r=e.values||[];this.le(t,50);for(const i of r)this.ae(i,t)}ge(e,t){this.le(t,37),qe.fromName(e).path.forEach(r=>{this.le(t,60),this.Ie(r,t)})}le(e,t){e.fe(t)}we(e){e.fe(2)}}function HN(n){if(0===n)return 8;let e=0;return n>>4==0&&(e+=4,n<<=4),n>>6==0&&(e+=2,n<<=2),n>>7==0&&(e+=1),e}function U0(n){const e=64-function(t){let r=0;for(let i=0;i<8;++i){const a=HN(255&t[i]);if(r+=a,8!==a)break}return r}(n);return Math.ceil(e/8)}Fa.Te=new Fa;class X_{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ee(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ae(r.value),r=t.next();this.Re()}be(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Pe(r.value),r=t.next();this.ve()}Ve(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ae(r);else if(r<2048)this.Ae(960|r>>>6),this.Ae(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ae(480|r>>>12),this.Ae(128|63&r>>>6),this.Ae(128|63&r);else{const i=t.codePointAt(0);this.Ae(240|i>>>18),this.Ae(128|63&i>>>12),this.Ae(128|63&i>>>6),this.Ae(128|63&i)}}this.Re()}Se(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Pe(r);else if(r<2048)this.Pe(960|r>>>6),this.Pe(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Pe(480|r>>>12),this.Pe(128|63&r>>>6),this.Pe(128|63&r);else{const i=t.codePointAt(0);this.Pe(240|i>>>18),this.Pe(128|63&i>>>12),this.Pe(128|63&i>>>6),this.Pe(128|63&i)}}this.ve()}De(e){const t=this.Ce(e),r=U0(t);this.xe(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Ne(e){const t=this.Ce(e),r=U0(t);this.xe(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}ke(){this.Oe(255),this.Oe(255)}Me(){this.Fe(255),this.Fe(255)}reset(){this.position=0}seed(e){this.xe(e.length),this.buffer.set(e,this.position),this.position+=e.length}$e(){return this.buffer.slice(0,this.position)}Ce(e){const t=function(i){const a=new DataView(new ArrayBuffer(8));return a.setFloat64(0,i,!1),new Uint8Array(a.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ae(e){const t=255&e;0===t?(this.Oe(0),this.Oe(255)):255===t?(this.Oe(255),this.Oe(0)):this.Oe(t)}Pe(e){const t=255&e;0===t?(this.Fe(0),this.Fe(255)):255===t?(this.Fe(255),this.Fe(0)):this.Fe(e)}Re(){this.Oe(0),this.Oe(1)}ve(){this.Fe(0),this.Fe(1)}Oe(e){this.xe(1),this.buffer[this.position++]=e}Fe(e){this.xe(1),this.buffer[this.position++]=~e}xe(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class Jb{constructor(e){this.Be=e}me(e){this.Be.Ee(e)}de(e){this.Be.Ve(e)}fe(e){this.Be.De(e)}he(){this.Be.ke()}}class Xb{constructor(e){this.Be=e}me(e){this.Be.be(e)}de(e){this.Be.Se(e)}fe(e){this.Be.Ne(e)}he(){this.Be.Me()}}class ey{constructor(){this.Be=new X_,this.Le=new Jb(this.Be),this.Ue=new Xb(this.Be)}seed(e){this.Be.seed(e)}qe(e){return 0===e?this.Le:this.Ue}$e(){return this.Be.$e()}reset(){this.Be.reset()}}class Uu{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Ke(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Uu(this.indexId,this.documentKey,this.arrayValue,r)}}function sc(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=eD(n.arrayValue,e.arrayValue),0!==t?t:(t=eD(n.directionalValue,e.directionalValue),0!==t?t:qe.comparator(n.documentKey,e.documentKey)))}function eD(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class tD{constructor(e){this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Ge=e.orderBy,this.Qe=[];for(const t of e.filters){const r=t;r.dt()?this.je=r:this.Qe.push(r)}}We(e){const t=ZC(e);if(void 0!==t&&!this.ze(t))return!1;const r=ku(e);let i=0,a=0;for(;i<r.length&&this.ze(r[i]);++i);if(i===r.length)return!0;if(void 0!==this.je){const l=r[i];if(!this.He(this.je,l)||!this.Je(this.Ge[a++],l))return!1;++i}for(;i<r.length;++i){const l=r[i];if(a>=this.Ge.length||!this.Je(this.Ge[a++],l))return!1}return!0}ze(e){for(const t of this.Qe)if(this.He(t,e))return!0;return!1}He(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}Je(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}class $N{constructor(){this.Ye=new nD}addToCollectionParentIndex(e,t){return this.Ye.add(t),ee.resolve()}getCollectionParents(e,t){return ee.resolve(this.Ye.getEntries(t))}addFieldIndex(e,t){return ee.resolve()}deleteFieldIndex(e,t){return ee.resolve()}getDocumentsMatchingTarget(e,t){return ee.resolve(null)}getIndexType(e,t){return ee.resolve(0)}getFieldIndexes(e,t){return ee.resolve([])}getNextCollectionGroupToUpdate(e){return ee.resolve(null)}getMinOffset(e,t){return ee.resolve(Ds.min())}getMinOffsetFromCollectionGroup(e,t){return ee.resolve(Ds.min())}updateCollectionGroup(e,t,r){return ee.resolve()}updateIndexEntries(e,t){return ee.resolve()}}class nD{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new wn(sn.comparator),a=!i.has(r);return this.index[t]=i.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new wn(sn.comparator)).toArray()}}const ty=new Uint8Array(0);class FA{constructor(e,t){this.user=e,this.databaseId=t,this.Xe=new nD,this.Ze=new ec(r=>Vd(r),(r,i)=>dg(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Xe.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.Xe.add(t)});const a={collectionId:r,parent:Bi(i)};return Sg(e).put(a)}return ee.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[qw(t),""],!1,!0);return Sg(e).W(i).next(a=>{for(const l of a){if(l.collectionId!==t)break;r.push(Ho(l.parent))}return r})}addFieldIndex(e,t){const r=B0(e),i={indexId:(l=t).indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(d=>[d.fieldPath.canonicalString(),d.kind])};var l;delete i.indexId;const a=r.add(i);if(t.indexState){const l=ny(e);return a.next(d=>{l.put(kA(d,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return a.next()}deleteFieldIndex(e,t){const r=B0(e),i=ny(e),a=Ag(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){const r=Ag(e);let i=!0;const a=new Map;return ee.forEach(this.tn(t),l=>this.en(e,l).next(d=>{i&&(i=!!d),a.set(l,d)})).next(()=>{if(i){let l=Ht();const d=[];return ee.forEach(a,(_,w)=>{var D;ke("IndexedDbIndexManager",`Using index ${D=_,`id=${D.indexId}|cg=${D.collectionGroup}|f=${D.fields.map(et=>`${et.fieldPath}:${et.kind}`).join(",")}`} to execute ${Vd(t)}`);const S=function(et,at){const St=ZC(at);if(void 0===St)return null;for(const Ot of O_(et,St.fieldPath))switch(Ot.op){case"array-contains-any":return Ot.value.arrayValue.values||[];case"array-contains":return[Ot.value]}return null}(w,_),M=function(et,at){const St=new Map;for(const Ot of ku(at))for(const Cr of O_(et,Ot.fieldPath))switch(Cr.op){case"==":case"in":St.set(Ot.fieldPath.canonicalString(),Cr.value);break;case"not-in":case"!=":return St.set(Ot.fieldPath.canonicalString(),Cr.value),Array.from(St.values())}return null}(w,_),O=function(et,at){const St=[];let Ot=!0;for(const Cr of ku(at)){const Ku=0===Cr.kind?o0(et,Cr.fieldPath,et.startAt):cb(et,Cr.fieldPath,et.startAt);St.push(Ku.value),Ot&&(Ot=Ku.inclusive)}return new Ql(St,Ot)}(w,_),j=function(et,at){const St=[];let Ot=!0;for(const Cr of ku(at)){const Ku=0===Cr.kind?cb(et,Cr.fieldPath,et.endAt):o0(et,Cr.fieldPath,et.endAt);St.push(Ku.value),Ot&&(Ot=Ku.inclusive)}return new Ql(St,Ot)}(w,_),ae=this.nn(_,w,O),he=this.nn(_,w,j),$e=this.sn(_,w,M),nt=this.rn(_.indexId,S,ae,O.inclusive,he,j.inclusive,$e);return ee.forEach(nt,et=>r.J(et,t.limit).next(at=>{at.forEach(St=>{const Ot=qe.fromSegments(St.documentKey);l.has(Ot)||(l=l.add(Ot),d.push(Ot))})}))}).next(()=>d)}return ee.resolve(null)})}tn(e){let t=this.Ze.get(e);return t||(t=[e],this.Ze.set(e,t),t)}rn(e,t,r,i,a,l,d){const _=(null!=t?t.length:1)*Math.max(r.length,a.length),w=_/(null!=t?t.length:1),D=[];for(let S=0;S<_;++S){const M=t?this.on(t[S/w]):ty,O=this.un(e,M,r[S%w],i),j=this.cn(e,M,a[S%w],l),ae=d.map(he=>this.un(e,M,he,!0));D.push(...this.createRange(O,j,ae))}return D}un(e,t,r,i){const a=new Uu(e,qe.empty(),t,r);return i?a:a.Ke()}cn(e,t,r,i){const a=new Uu(e,qe.empty(),t,r);return i?a.Ke():a}en(e,t){const r=new tD(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(a=>{let l=null;for(const d of a)r.We(d)&&(!l||d.fields.length>l.fields.length)&&(l=d);return l})}getIndexType(e,t){let r=2;return ee.forEach(this.tn(t),i=>this.en(e,i).next(a=>{a?0!==r&&a.fields.length<function(l){let d=new wn(cr.comparator),_=!1;for(const w of l.filters){const D=w;D.field.isKeyField()||("array-contains"===D.op||"array-contains-any"===D.op?_=!0:d=d.add(D.field))}for(const w of l.orderBy)w.field.isKeyField()||(d=d.add(w.field));return d.size+(_?1:0)}(i)&&(r=1):r=0})).next(()=>r)}an(e,t){const r=new ey;for(const i of ku(e)){const a=t.data.field(i.fieldPath);if(null==a)return null;const l=r.qe(i.kind);Fa.Te.ce(a,l)}return r.$e()}on(e){const t=new ey;return Fa.Te.ce(e,t.qe(0)),t.$e()}hn(e,t){const r=new ey;return Fa.Te.ce(Ld(this.databaseId,t),r.qe(function(i){const a=ku(i);return 0===a.length?0:a[a.length-1].kind}(e))),r.$e()}sn(e,t,r){if(null===r)return[];let i=[];i.push(new ey);let a=0;for(const l of ku(e)){const d=r[a++];for(const _ of i)if(this.ln(t,l.fieldPath)&&df(d))i=this.fn(i,l,d);else{const w=_.qe(l.kind);Fa.Te.ce(d,w)}}return this.dn(i)}nn(e,t,r){return this.sn(e,t,r.position)}dn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].$e();return t}fn(e,t,r){const i=[...e],a=[];for(const l of r.arrayValue.values||[])for(const d of i){const _=new ey;_.seed(d.$e()),Fa.Te.ce(l,_.qe(t.kind)),a.push(_)}return a}ln(e,t){return!!e.filters.find(r=>r instanceof gi&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=B0(e),i=ny(e);return(t?r.W("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.W()).next(a=>{const l=[];return ee.forEach(a,d=>i.get([d.indexId,this.uid]).next(_=>{l.push(function(w,D){const S=D?new M_(D.sequenceNumber,new Ds(ic(D.readTime),new qe(Ho(D.documentKey)),D.largestBatchId)):M_.empty(),M=w.fields.map(([O,j])=>new og(cr.fromServerFormat(O),j));return new Nu(w.indexId,w.collectionGroup,M,S)}(d,_))})).next(()=>l)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,i)=>{const a=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==a?a:Pt(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=B0(e),a=ny(e);return this._n(e).next(l=>i.W("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(d=>ee.forEach(d,_=>a.put(kA(_.indexId,this.user,l,r)))))}updateIndexEntries(e,t){const r=new Map;return ee.forEach(t,(i,a)=>{const l=r.get(i.collectionGroup);return(l?ee.resolve(l):this.getFieldIndexes(e,i.collectionGroup)).next(d=>(r.set(i.collectionGroup,d),ee.forEach(d,_=>this.wn(e,i,_).next(w=>{const D=this.mn(a,_);return w.isEqual(D)?ee.resolve():this.gn(e,a,_,w,D)}))))})}yn(e,t,r,i){return Ag(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.hn(r,t.key),documentKey:t.key.path.toArray()})}pn(e,t,r,i){return Ag(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.hn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const i=Ag(e);let a=new wn(sc);return i.Z({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.hn(r,t)])},(l,d)=>{a=a.add(new Uu(r.indexId,t,d.arrayValue,d.directionalValue))}).next(()=>a)}mn(e,t){let r=new wn(sc);const i=this.an(t,e);if(null==i)return r;const a=ZC(t);if(null!=a){const l=e.data.field(a.fieldPath);if(df(l))for(const d of l.arrayValue.values||[])r=r.add(new Uu(t.indexId,e.key,this.on(d),i))}else r=r.add(new Uu(t.indexId,e.key,ty,i));return r}gn(e,t,r,i,a){ke("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const l=[];return function(d,_,w,D,S){const M=d.getIterator(),O=_.getIterator();let j=xa(M),ae=xa(O);for(;j||ae;){let he=!1,$e=!1;if(j&&ae){const nt=w(j,ae);nt<0?$e=!0:nt>0&&(he=!0)}else null!=j?$e=!0:he=!0;he?(D(ae),ae=xa(O)):$e?(S(j),j=xa(M)):(j=xa(M),ae=xa(O))}}(i,a,sc,d=>{l.push(this.yn(e,t,r,d))},d=>{l.push(this.pn(e,t,r,d))}),ee.waitFor(l)}_n(e){let t=1;return ny(e).Z({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,a)=>{a.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((l,d)=>sc(l,d)).filter((l,d,_)=>!d||0!==sc(l,_[d-1]));const i=[];i.push(e);for(const l of r){const d=sc(l,e),_=sc(l,t);if(0===d)i[0]=e.Ke();else if(d>0&&_<0)i.push(l),i.push(l.Ke());else if(_>0)break}i.push(t);const a=[];for(let l=0;l<i.length;l+=2)a.push(IDBKeyRange.bound([i[l].indexId,this.uid,i[l].arrayValue,i[l].directionalValue,ty,[]],[i[l+1].indexId,this.uid,i[l+1].arrayValue,i[l+1].directionalValue,ty,[]]));return a}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(LA)}getMinOffset(e,t){return ee.mapArray(this.tn(t),r=>this.en(e,r).next(i=>i||ot())).next(LA)}}function Sg(n){return ti(n,"collectionParents")}function Ag(n){return ti(n,"indexEntries")}function B0(n){return ti(n,"indexConfiguration")}function ny(n){return ti(n,"indexState")}function LA(n){Rt(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;Kw(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Ds(e.readTime,e.documentKey,t)}const rD={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class es{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new es(e,es.DEFAULT_COLLECTION_PERCENTILE,es.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function iD(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),a=[],l=IDBKeyRange.only(t.batchId);let d=0;const _=r.Z({range:l},(D,S,M)=>(d++,M.delete()));a.push(_.next(()=>{Rt(1===d)}));const w=[];for(const D of t.mutations){const S=Hb(e,D.key.path,t.batchId);a.push(i.delete(S)),w.push(D.key)}return ee.waitFor(a).next(()=>w)}function j0(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw ot();e=n.noDocument}return JSON.stringify(e).length}es.DEFAULT_COLLECTION_PERCENTILE=10,es.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,es.DEFAULT=new es(41943040,es.DEFAULT_COLLECTION_PERCENTILE,es.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),es.DISABLED=new es(-1,0,0);class ry{constructor(e,t,r,i){this.userId=e,this.It=t,this.indexManager=r,this.referenceDelegate=i,this.In={}}static oe(e,t,r,i){Rt(""!==e.uid);const a=e.isAuthenticated()?e.uid:"";return new ry(a,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Bu(e).Z({index:"userMutationsIndex",range:r},(i,a,l)=>{t=!1,l.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const a=xg(e),l=Bu(e);return l.add({}).next(d=>{Rt("number"==typeof d);const _=new Z_(d,t,r,i),w=function(M,O,j){const ae=j.baseMutations.map($e=>_f(M.re,$e)),he=j.mutations.map($e=>_f(M.re,$e));return{userId:O,batchId:j.batchId,localWriteTimeMs:j.localWriteTime.toMillis(),baseMutations:ae,mutations:he}}(this.It,this.userId,_),D=[];let S=new wn((M,O)=>Pt(M.canonicalString(),O.canonicalString()));for(const M of i){const O=Hb(this.userId,M.key.path,d);S=S.add(M.key.path.popLast()),D.push(l.put(w)),D.push(a.put(O,N0))}return S.forEach(M=>{D.push(this.indexManager.addToCollectionParentIndex(e,M))}),e.addOnCommittedListener(()=>{this.In[d]=_.keys()}),ee.waitFor(D).next(()=>_)})}lookupMutationBatch(e,t){return Bu(e).get(t).next(r=>r?(Rt(r.userId===this.userId),Gd(this.It,r)):null)}Tn(e,t){return this.In[t]?ee.resolve(this.In[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.In[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return Bu(e).Z({index:"userMutationsIndex",range:i},(l,d,_)=>{d.userId===this.userId&&(Rt(d.batchId>=r),a=Gd(this.It,d)),_.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Bu(e).Z({index:"userMutationsIndex",range:t,reverse:!0},(i,a,l)=>{r=a.batchId,l.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Bu(e).W("userMutationsIndex",t).next(r=>r.map(i=>Gd(this.It,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=z_(this.userId,t.path),i=IDBKeyRange.lowerBound(r),a=[];return xg(e).Z({range:i},(l,d,_)=>{const[w,D,S]=l,M=Ho(D);if(w===this.userId&&t.path.isEqual(M))return Bu(e).get(S).next(O=>{if(!O)throw ot();Rt(O.userId===this.userId),a.push(Gd(this.It,O))});_.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new wn(Pt);const i=[];return t.forEach(a=>{const l=z_(this.userId,a.path),d=IDBKeyRange.lowerBound(l),_=xg(e).Z({range:d},(w,D,S)=>{const[M,O,j]=w,ae=Ho(O);M===this.userId&&a.path.isEqual(ae)?r=r.add(j):S.done()});i.push(_)}),ee.waitFor(i).next(()=>this.En(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,a=z_(this.userId,r),l=IDBKeyRange.lowerBound(a);let d=new wn(Pt);return xg(e).Z({range:l},(_,w,D)=>{const[S,M,O]=_,j=Ho(M);S===this.userId&&r.isPrefixOf(j)?j.length===i&&(d=d.add(O)):D.done()}).next(()=>this.En(e,d))}En(e,t){const r=[],i=[];return t.forEach(a=>{i.push(Bu(e).get(a).next(l=>{if(null===l)throw ot();Rt(l.userId===this.userId),r.push(Gd(this.It,l))}))}),ee.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return iD(e.ie,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.An(t.batchId)}),ee.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}An(e){delete this.In[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return ee.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return xg(e).Z({range:r},(a,l,d)=>{if(a[0]===this.userId){const _=Ho(a[1]);i.push(_)}else d.done()}).next(()=>{Rt(0===i.length)})})}containsKey(e,t){return H0(e,this.userId,t)}Rn(e){return ao(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function H0(n,e,t){const r=z_(e,t.path),i=r[1],a=IDBKeyRange.lowerBound(r);let l=!1;return xg(n).Z({range:a,X:!0},(d,_,w)=>{const[D,S,M]=d;D===e&&S===i&&(l=!0),w.done()}).next(()=>l)}function Bu(n){return ti(n,"mutations")}function xg(n){return ti(n,"documentMutations")}function ao(n){return ti(n,"mutationQueues")}class Wd{constructor(e){this.bn=e}next(){return this.bn+=2,this.bn}static Pn(){return new Wd(0)}static vn(){return new Wd(-1)}}class $0{constructor(e,t){this.referenceDelegate=e,this.It=t}allocateTargetId(e){return this.Vn(e).next(t=>{const r=new Wd(t.highestTargetId);return t.highestTargetId=r.next(),this.Sn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Vn(e).next(t=>Tt.fromTimestamp(new Vn(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Vn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.Vn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Sn(e,i)))}addTargetData(e,t){return this.Dn(e,t).next(()=>this.Vn(e).next(r=>(r.targetCount+=1,this.Cn(t,r),this.Sn(e,r))))}updateTargetData(e,t){return this.Dn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>If(e).delete(t.targetId)).next(()=>this.Vn(e)).next(r=>(Rt(r.targetCount>0),r.targetCount-=1,this.Sn(e,r)))}removeTargets(e,t,r){let i=0;const a=[];return If(e).Z((l,d)=>{const _=Tg(d);_.sequenceNumber<=t&&null===r.get(_.targetId)&&(i++,a.push(this.removeTargetData(e,_)))}).next(()=>ee.waitFor(a)).next(()=>i)}forEachTarget(e,t){return If(e).Z((r,i)=>{const a=Tg(i);t(a)})}Vn(e){return Ts(e).get("targetGlobalKey").next(t=>(Rt(null!==t),t))}Sn(e,t){return Ts(e).put("targetGlobalKey",t)}Dn(e,t){return If(e).put(MA(this.It,t))}Cn(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Vn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Vd(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return If(e).Z({range:i,index:"queryTargetsIndex"},(l,d,_)=>{const w=Tg(d);dg(t,w.target)&&(a=w,_.done())}).next(()=>a)}addMatchingKeys(e,t,r){const i=[],a=oc(e);return t.forEach(l=>{const d=Bi(l.path);i.push(a.put({targetId:r,path:d})),i.push(this.referenceDelegate.addReference(e,r,l))}),ee.waitFor(i)}removeMatchingKeys(e,t,r){const i=oc(e);return ee.forEach(t,a=>{const l=Bi(a.path);return ee.waitFor([i.delete([r,l]),this.referenceDelegate.removeReference(e,r,a)])})}removeMatchingKeysForTargetId(e,t){const r=oc(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=oc(e);let a=Ht();return i.Z({range:r,X:!0},(l,d,_)=>{const w=Ho(l[1]),D=new qe(w);a=a.add(D)}).next(()=>a)}containsKey(e,t){const r=Bi(t.path),i=IDBKeyRange.bound([r],[qw(r)],!1,!0);let a=0;return oc(e).Z({index:"documentTargetsIndex",X:!0,range:i},([l,d],_,w)=>{0!==l&&(a++,w.done())}).next(()=>a>0)}se(e,t){return If(e).get(t).next(r=>r?Tg(r):null)}}function If(n){return ti(n,"targets")}function Ts(n){return ti(n,"targetGlobal")}function oc(n){return ti(n,"targetDocuments")}function iy([n,e],[t,r]){const i=Pt(n,t);return 0===i?Pt(e,r):i}class VA{constructor(e){this.xn=e,this.buffer=new wn(iy),this.Nn=0}kn(){return++this.Nn}On(e){const t=[e,this.kn()];if(this.buffer.size<this.xn)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();iy(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class UA{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Mn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Fn(6e4)}stop(){this.Mn&&(this.Mn.cancel(),this.Mn=null)}get started(){return null!==this.Mn}Fn(e){var t=this;ke("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Mn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,ve.Z)(function*(){t.Mn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){Pu(r)?ke("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield jo(r)}yield t.Fn(3e5)}))}}class G0{constructor(e,t){this.$n=e,this.params=t}calculateTargetCount(e,t){return this.$n.Bn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return ee.resolve(Xr.at);const r=new VA(t);return this.$n.forEachTarget(e,i=>r.On(i.sequenceNumber)).next(()=>this.$n.Ln(e,i=>r.On(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.$n.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.$n.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(ke("LruGarbageCollector","Garbage collection skipped; disabled"),ee.resolve(rD)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ke("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),rD):this.Un(e,t))}getCacheSize(e){return this.$n.getCacheSize(e)}Un(e,t){let r,i,a,l,d,_,w;const D=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(S=>(S>this.params.maximumSequenceNumbersToCollect?(ke("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${S}`),i=this.params.maximumSequenceNumbersToCollect):i=S,l=Date.now(),this.nthSequenceNumber(e,i))).next(S=>(r=S,d=Date.now(),this.removeTargets(e,r,t))).next(S=>(a=S,_=Date.now(),this.removeOrphanedDocuments(e,r))).next(S=>(w=Date.now(),R_()<=eo.in.DEBUG&&ke("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${l-D}ms\n\tDetermined least recently used ${i} in `+(d-l)+`ms\n\tRemoved ${a} targets in `+(_-d)+`ms\n\tRemoved ${S} documents in `+(w-_)+`ms\nTotal Duration: ${w-D}ms`),ee.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:S})))}}class sD{constructor(e,t){this.db=e,this.garbageCollector=new G0(this,t)}Bn(e){const t=this.qn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}qn(e){let t=0;return this.Ln(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Ln(e,t){return this.Kn(e,(r,i)=>t(i))}addReference(e,t,r){return Rg(e,r)}removeReference(e,t,r){return Rg(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Rg(e,t)}Gn(e,t){return function(r,i){let a=!1;return ao(r).tt(l=>H0(r,l,i).next(d=>(d&&(a=!0),ee.resolve(!d)))).next(()=>a)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this.Kn(e,(l,d)=>{if(d<=t){const _=this.Gn(e,l).next(w=>{if(!w)return a++,r.getEntry(e,l).next(()=>(r.removeEntry(l,Tt.min()),oc(e).delete([0,Bi(l.path)])))});i.push(_)}}).next(()=>ee.waitFor(i)).next(()=>r.apply(e)).next(()=>a)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Rg(e,t)}Kn(e,t){const r=oc(e);let i,a=Xr.at;return r.Z({index:"documentTargetsIndex"},([l,d],{path:_,sequenceNumber:w})=>{0===l?(a!==Xr.at&&t(new qe(Ho(i)),a),a=w,i=_):a=Xr.at}).next(()=>{a!==Xr.at&&t(new qe(Ho(i)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Rg(n,e){return oc(n).put((r=n.currentSequenceNumber,{targetId:0,path:Bi(e.path),sequenceNumber:r}));var r}class oD{constructor(){this.changes=new ec(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Mn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?ee.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class aD{constructor(e){this.It=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return zd(e).put(r)}removeEntry(e,t,r){return zd(e).delete(function(i,a){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Dg(a),l[l.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.Qn(e,r)))}getEntry(e,t){let r=Mn.newInvalidDocument(t);return zd(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(qd(t))},(i,a)=>{r=this.jn(t,a)}).next(()=>r)}Wn(e,t){let r={size:0,document:Mn.newInvalidDocument(t)};return zd(e).Z({index:"documentKeyIndex",range:IDBKeyRange.only(qd(t))},(i,a)=>{r={document:this.jn(t,a),size:j0(a)}}).next(()=>r)}getEntries(e,t){let r=Xi();return this.zn(e,t,(i,a)=>{const l=this.jn(i,a);r=r.insert(i,l)}).next(()=>r)}Hn(e,t){let r=Xi(),i=new Un(qe.comparator);return this.zn(e,t,(a,l)=>{const d=this.jn(a,l);r=r.insert(a,d),i=i.insert(a,j0(l))}).next(()=>({documents:r,Jn:i}))}zn(e,t,r){if(t.isEmpty())return ee.resolve();let i=new wn(q0);t.forEach(_=>i=i.add(_));const a=IDBKeyRange.bound(qd(i.first()),qd(i.last())),l=i.getIterator();let d=l.getNext();return zd(e).Z({index:"documentKeyIndex",range:a},(_,w,D)=>{const S=qe.fromSegments([...w.prefixPath,w.collectionGroup,w.documentId]);for(;d&&q0(d,S)<0;)r(d,null),d=l.getNext();d&&d.isEqual(S)&&(r(d,w),d=l.hasNext()?l.getNext():null),d?D.j(qd(d)):D.done()}).next(()=>{for(;d;)r(d,null),d=l.hasNext()?l.getNext():null})}getAllFromCollection(e,t,r){const i=[t.popLast().toArray(),t.lastSegment(),Dg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],a=[t.popLast().toArray(),t.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return zd(e).W(IDBKeyRange.bound(i,a,!0)).next(l=>{let d=Xi();for(const _ of l){const w=this.jn(qe.fromSegments(_.prefixPath.concat(_.collectionGroup,_.documentId)),_);d=d.insert(w.key,w)}return d})}getAllFromCollectionGroup(e,t,r,i){let a=Xi();const l=ju(t,r),d=ju(t,Ds.max());return zd(e).Z({index:"collectionGroupIndex",range:IDBKeyRange.bound(l,d,!0)},(_,w,D)=>{const S=this.jn(qe.fromSegments(w.prefixPath.concat(w.collectionGroup,w.documentId)),w);a=a.insert(S.key,S),a.size===i&&D.done()}).next(()=>a)}newChangeBuffer(e){return new BA(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return z0(e).get("remoteDocumentGlobalKey").next(t=>(Rt(!!t),t))}Qn(e,t){return z0(e).put("remoteDocumentGlobalKey",t)}jn(e,t){if(t){const r=function RA(n,e){let t;if(e.document)t=T0(n.re,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=qe.fromSegments(e.noDocument.path),i=ic(e.noDocument.readTime);t=Mn.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return ot();{const r=qe.fromSegments(e.unknownDocument.path),i=ic(e.unknownDocument.version);t=Mn.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(r){const i=new Vn(r[0],r[1]);return Tt.fromTimestamp(i)}(e.readTime)),t}(this.It,t);if(!r.isNoDocument()||!r.version.isEqual(Tt.min()))return r}return Mn.newInvalidDocument(e)}}function W0(n){return new aD(n)}class BA extends oD{constructor(e,t){super(),this.Yn=e,this.trackRemovals=t,this.Xn=new ec(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new wn((a,l)=>Pt(a.canonicalString(),l.canonicalString()));return this.changes.forEach((a,l)=>{const d=this.Xn.get(a);if(t.push(this.Yn.removeEntry(e,a,d.readTime)),l.isValidDocument()){const _=L0(this.Yn.It,l);i=i.add(a.path.popLast()),r+=j0(_)-d.size,t.push(this.Yn.addEntry(e,a,_))}else if(r-=d.size,this.trackRemovals){const _=L0(this.Yn.It,l.convertToNoDocument(Tt.min()));t.push(this.Yn.addEntry(e,a,_))}}),i.forEach(a=>{t.push(this.Yn.indexManager.addToCollectionParentIndex(e,a))}),t.push(this.Yn.updateMetadata(e,r)),ee.waitFor(t)}getFromCache(e,t){return this.Yn.Wn(e,t).next(r=>(this.Xn.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.Yn.Hn(e,t).next(({documents:r,Jn:i})=>(i.forEach((a,l)=>{this.Xn.set(a,{size:l,readTime:r.get(a).readTime})}),r))}}function z0(n){return ti(n,"remoteDocumentGlobal")}function zd(n){return ti(n,"remoteDocumentsV14")}function qd(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function ju(n,e){const t=e.documentKey.path.toArray();return[n,Dg(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function q0(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(i=Pt(t[a],r[a]),i)return i;return i=Pt(t.length,r.length),i||(i=Pt(t[t.length-2],r[r.length-2]),i||Pt(t[t.length-1],r[r.length-1]))}class K0{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class La{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.getBaseDocument(e,t,r))).next(i=>(null!==r&&gg(r.mutation,i,fi.empty(),Vn.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Ht()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Ht()){const i=ka();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(a=>{let l=mg();return a.forEach((d,_)=>{l=l.insert(d,_.overlayedDocument)}),l}))}getOverlayedDocuments(e,t){const r=ka();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Ht()))}populateOverlays(e,t,r){const i=[];return r.forEach(a=>{t.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((l,d)=>{t.set(l,d)})})}computeViews(e,t,r,i){let a=Xi();const l=_g(),d=_g();return t.forEach((_,w)=>{const D=r.get(w.key);i.has(w.key)&&(void 0===D||D.mutation instanceof Vu)?a=a.insert(w.key,w):void 0!==D&&(l.set(w.key,D.mutation.getFieldMask()),gg(D.mutation,w,D.mutation.getFieldMask(),Vn.now()))}),this.recalculateAndSaveOverlays(e,a).next(_=>(_.forEach((w,D)=>l.set(w,D)),t.forEach((w,D)=>{var S;return d.set(w,new K0(D,null!==(S=l.get(w))&&void 0!==S?S:null))}),d))}recalculateAndSaveOverlays(e,t){const r=_g();let i=new Un((l,d)=>l-d),a=Ht();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(l=>{for(const d of l)d.keys().forEach(_=>{const w=t.get(_);if(null===w)return;let D=r.get(_)||fi.empty();D=d.applyToLocalView(w,D),r.set(_,D);const S=(i.get(d.batchId)||Ht()).add(_);i=i.insert(d.batchId,S)})}).next(()=>{const l=[],d=i.getReverseIterator();for(;d.hasNext();){const _=d.getNext(),w=_.key,D=_.value,S=mf();D.forEach(M=>{if(!a.has(M)){const O=m0(t.get(M),r.get(M));null!==O&&S.set(M,O),a=a.add(M)}}),l.push(this.documentOverlayCache.saveOverlays(e,w,S))}return ee.waitFor(l)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r){return qe.isDocumentKey((i=t).path)&&null===i.collectionGroup&&0===i.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):l0(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r):this.getDocumentsMatchingCollectionQuery(e,t,r);var i}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(a=>{const l=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-a.size):ee.resolve(ka());let d=-1,_=a;return l.next(w=>ee.forEach(w,(D,S)=>(d<S.largestBatchId&&(d=S.largestBatchId),a.get(D)?ee.resolve():this.getBaseDocument(e,D,S).next(M=>{_=_.insert(D,M)}))).next(()=>this.populateOverlays(e,w,a)).next(()=>this.computeViews(e,_,w,Ht())).next(D=>({batchId:d,changes:Mb(D)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new qe(t)).next(r=>{let i=mg();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r){const i=t.collectionGroup;let a=mg();return this.indexManager.getCollectionParents(e,i).next(l=>ee.forEach(l,d=>{const _=(w=t,D=d.child(i),new Lu(D,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt));var w,D;return this.getDocumentsMatchingCollectionQuery(e,_,r).next(w=>{w.forEach((D,S)=>{a=a.insert(D,S)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r){let i;return this.remoteDocumentCache.getAllFromCollection(e,t.path,r).next(a=>(i=a,this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId))).next(a=>{a.forEach((d,_)=>{const w=_.getKey();null===i.get(w)&&(i=i.insert(w,Mn.newInvalidDocument(w)))});let l=mg();return i.forEach((d,_)=>{const w=a.get(d);void 0!==w&&gg(w.mutation,_,fi.empty(),Vn.now()),_b(t,_)&&(l=l.insert(d,_))}),l})}getBaseDocument(e,t,r){return null===r||1===r.mutation.type?this.remoteDocumentCache.getEntry(e,t):ee.resolve(Mn.newInvalidDocument(t))}}class jA{constructor(e){this.It=e,this.Zn=new Map,this.ts=new Map}getBundleMetadata(e,t){return ee.resolve(this.Zn.get(t))}saveBundleMetadata(e,t){var r;return this.Zn.set(t.id,{id:(r=t).id,version:r.version,createTime:xr(r.createTime)}),ee.resolve()}getNamedQuery(e,t){return ee.resolve(this.ts.get(t))}saveNamedQuery(e,t){return this.ts.set(t.name,{name:(r=t).name,query:Q_(r.bundledQuery),readTime:xr(r.readTime)}),ee.resolve();var r}}class GN{constructor(){this.overlays=new Un(qe.comparator),this.es=new Map}getOverlay(e,t){return ee.resolve(this.overlays.get(t))}getOverlays(e,t){const r=ka();return ee.forEach(t,i=>this.getOverlay(e,i).next(a=>{null!==a&&r.set(i,a)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,a)=>{this.ue(e,t,a)}),ee.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.es.get(r);return void 0!==i&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.es.delete(r)),ee.resolve()}getOverlaysForCollection(e,t,r){const i=ka(),a=t.length+1,l=new qe(t.child("")),d=this.overlays.getIteratorFrom(l);for(;d.hasNext();){const _=d.getNext().value,w=_.getKey();if(!t.isPrefixOf(w.path))break;w.path.length===a&&_.largestBatchId>r&&i.set(_.getKey(),_)}return ee.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let a=new Un((w,D)=>w-D);const l=this.overlays.getIterator();for(;l.hasNext();){const w=l.getNext().value;if(w.getKey().getCollectionGroup()===t&&w.largestBatchId>r){let D=a.get(w.largestBatchId);null===D&&(D=ka(),a=a.insert(w.largestBatchId,D)),D.set(w.getKey(),w)}}const d=ka(),_=a.getIterator();for(;_.hasNext()&&(_.getNext().value.forEach((w,D)=>d.set(w,D)),!(d.size()>=i)););return ee.resolve(d)}ue(e,t,r){const i=this.overlays.get(r.key);if(null!==i){const l=this.es.get(i.largestBatchId).delete(r.key);this.es.set(i.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new O0(t,r));let a=this.es.get(t);void 0===a&&(a=Ht(),this.es.set(t,a)),this.es.set(t,a.add(r.key))}}class Z0{constructor(){this.ns=new wn(ni.ss),this.rs=new wn(ni.os)}isEmpty(){return this.ns.isEmpty()}addReference(e,t){const r=new ni(e,t);this.ns=this.ns.add(r),this.rs=this.rs.add(r)}us(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.cs(new ni(e,t))}hs(e,t){e.forEach(r=>this.removeReference(r,t))}ls(e){const t=new qe(new sn([])),r=new ni(t,e),i=new ni(t,e+1),a=[];return this.rs.forEachInRange([r,i],l=>{this.cs(l),a.push(l.key)}),a}fs(){this.ns.forEach(e=>this.cs(e))}cs(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}ds(e){const t=new qe(new sn([])),r=new ni(t,e),i=new ni(t,e+1);let a=Ht();return this.rs.forEachInRange([r,i],l=>{a=a.add(l.key)}),a}containsKey(e){const t=new ni(e,0),r=this.ns.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class ni{constructor(e,t){this.key=e,this._s=t}static ss(e,t){return qe.comparator(e.key,t.key)||Pt(e._s,t._s)}static os(e,t){return Pt(e._s,t._s)||qe.comparator(e.key,t.key)}}class HA{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.ws=1,this.gs=new wn(ni.ss)}checkEmpty(e){return ee.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){const a=this.ws;this.ws++;const l=new Z_(a,t,r,i);this.mutationQueue.push(l);for(const d of i)this.gs=this.gs.add(new ni(d.key,a)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return ee.resolve(l)}lookupMutationBatch(e,t){return ee.resolve(this.ys(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.ps(t+1),a=i<0?0:i;return ee.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return ee.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(e){return ee.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new ni(t,0),i=new ni(t,Number.POSITIVE_INFINITY),a=[];return this.gs.forEachInRange([r,i],l=>{const d=this.ys(l._s);a.push(d)}),ee.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new wn(Pt);return t.forEach(i=>{const a=new ni(i,0),l=new ni(i,Number.POSITIVE_INFINITY);this.gs.forEachInRange([a,l],d=>{r=r.add(d._s)})}),ee.resolve(this.Is(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let a=r;qe.isDocumentKey(a)||(a=a.child(""));const l=new ni(new qe(a),0);let d=new wn(Pt);return this.gs.forEachWhile(_=>{const w=_.key.path;return!!r.isPrefixOf(w)&&(w.length===i&&(d=d.add(_._s)),!0)},l),ee.resolve(this.Is(d))}Is(e){const t=[];return e.forEach(r=>{const i=this.ys(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){Rt(0===this.Ts(t.batchId,"removed")),this.mutationQueue.shift();let r=this.gs;return ee.forEach(t.mutations,i=>{const a=new ni(i.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.gs=r})}An(e){}containsKey(e,t){const r=new ni(t,0),i=this.gs.firstAfterOrEqual(r);return ee.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return ee.resolve()}Ts(e,t){return this.ps(e)}ps(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}ys(e){const t=this.ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class $A{constructor(e){this.Es=e,this.docs=new Un(qe.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),a=i?i.size:0,l=this.Es(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return ee.resolve(r?r.document.mutableCopy():Mn.newInvalidDocument(t))}getEntries(e,t){let r=Xi();return t.forEach(i=>{const a=this.docs.get(i);r=r.insert(i,a?a.document.mutableCopy():Mn.newInvalidDocument(i))}),ee.resolve(r)}getAllFromCollection(e,t,r){let i=Xi();const a=new qe(t.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:d,value:{document:_}}=l.getNext();if(!t.isPrefixOf(d.path))break;d.path.length>t.length+1||Kw(QC(_),r)<=0||(i=i.insert(_.key,_.mutableCopy()))}return ee.resolve(i)}getAllFromCollectionGroup(e,t,r,i){ot()}As(e,t){return ee.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new uD(this)}getSize(e){return ee.resolve(this.size)}}class uD extends oD{constructor(e){super(),this.Yn=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Yn.addEntry(e,i)):this.Yn.removeEntry(r)}),ee.waitFor(t)}getFromCache(e,t){return this.Yn.getEntry(e,t)}getAllFromCache(e,t){return this.Yn.getEntries(e,t)}}class WN{constructor(e){this.persistence=e,this.Rs=new ec(t=>Vd(t),dg),this.lastRemoteSnapshotVersion=Tt.min(),this.highestTargetId=0,this.bs=0,this.Ps=new Z0,this.targetCount=0,this.vs=Wd.Pn()}forEachTarget(e,t){return this.Rs.forEach((r,i)=>t(i)),ee.resolve()}getLastRemoteSnapshotVersion(e){return ee.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ee.resolve(this.bs)}allocateTargetId(e){return this.highestTargetId=this.vs.next(),ee.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.bs&&(this.bs=t),ee.resolve()}Dn(e){this.Rs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.vs=new Wd(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}addTargetData(e,t){return this.Dn(t),this.targetCount+=1,ee.resolve()}updateTargetData(e,t){return this.Dn(t),ee.resolve()}removeTargetData(e,t){return this.Rs.delete(t.target),this.Ps.ls(t.targetId),this.targetCount-=1,ee.resolve()}removeTargets(e,t,r){let i=0;const a=[];return this.Rs.forEach((l,d)=>{d.sequenceNumber<=t&&null===r.get(d.targetId)&&(this.Rs.delete(l),a.push(this.removeMatchingKeysForTargetId(e,d.targetId)),i++)}),ee.waitFor(a).next(()=>i)}getTargetCount(e){return ee.resolve(this.targetCount)}getTargetData(e,t){const r=this.Rs.get(t)||null;return ee.resolve(r)}addMatchingKeys(e,t,r){return this.Ps.us(t,r),ee.resolve()}removeMatchingKeys(e,t,r){this.Ps.hs(t,r);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach(l=>{a.push(i.markPotentiallyOrphaned(e,l))}),ee.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.Ps.ls(t),ee.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Ps.ds(t);return ee.resolve(r)}containsKey(e,t){return ee.resolve(this.Ps.containsKey(t))}}class Y0{constructor(e,t){this.Vs={},this.overlays={},this.Ss=new Xr(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=e(this),this.Cs=new WN(this),this.indexManager=new $N,this.remoteDocumentCache=new $A(r=>this.referenceDelegate.xs(r)),this.It=new F0(t),this.Ns=new jA(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new GN,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.Vs[e.toKey()];return r||(r=new HA(t,this.referenceDelegate),this.Vs[e.toKey()]=r),r}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(e,t,r){ke("MemoryPersistence","Starting transaction:",e);const i=new GA(this.Ss.next());return this.referenceDelegate.ks(),r(i).next(a=>this.referenceDelegate.Os(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}Ms(e,t){return ee.or(Object.values(this.Vs).map(r=>()=>r.containsKey(e,t)))}}class GA extends JC{constructor(e){super(),this.currentSequenceNumber=e}}class Mg{constructor(e){this.persistence=e,this.Fs=new Z0,this.$s=null}static Bs(e){return new Mg(e)}get Ls(){if(this.$s)return this.$s;throw ot()}addReference(e,t,r){return this.Fs.addReference(r,t),this.Ls.delete(r.toString()),ee.resolve()}removeReference(e,t,r){return this.Fs.removeReference(r,t),this.Ls.add(r.toString()),ee.resolve()}markPotentiallyOrphaned(e,t){return this.Ls.add(t.toString()),ee.resolve()}removeTarget(e,t){this.Fs.ls(t.targetId).forEach(i=>this.Ls.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(a=>this.Ls.add(a.toString()))}).next(()=>r.removeTargetData(e,t))}ks(){this.$s=new Set}Os(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ee.forEach(this.Ls,r=>{const i=qe.fromPath(r);return this.Us(e,i).next(a=>{a||t.removeEntry(i,Tt.min())})}).next(()=>(this.$s=null,t.apply(e)))}updateLimboDocument(e,t){return this.Us(e,t).next(r=>{r?this.Ls.delete(t.toString()):this.Ls.add(t.toString())})}xs(e){return 0}Us(e,t){return ee.or([()=>ee.resolve(this.Fs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ms(e,t)])}}class zN{constructor(e){this.It=e}$(e,t,r,i){const a=new Zw("createOrUpgrade",t);var d;r<1&&i>=1&&(e.createObjectStore("owner"),(d=e).createObjectStore("mutationQueues",{keyPath:"userId"}),d.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",jb,{unique:!0}),d.createObjectStore("documentMutations"),sy(e),function(d){d.createObjectStore("remoteDocuments")}(e));let l=ee.resolve();return r<3&&i>=3&&(0!==r&&(function(d){d.deleteObjectStore("targetDocuments"),d.deleteObjectStore("targets"),d.deleteObjectStore("targetGlobal")}(e),sy(e)),l=l.next(()=>function(d){const _=d.store("targetGlobal"),w={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Tt.min().toTimestamp(),targetCount:0};return _.put("targetGlobalKey",w)}(a))),r<4&&i>=4&&(0!==r&&(l=l.next(()=>function(d,_){return _.store("mutations").W().next(w=>{d.deleteObjectStore("mutations"),d.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",jb,{unique:!0});const D=_.store("mutations"),S=w.map(M=>D.put(M));return ee.waitFor(S)})}(e,a))),l=l.next(()=>{!function(d){d.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(l=l.next(()=>this.qs(a))),r<6&&i>=6&&(l=l.next(()=>(function(d){d.createObjectStore("remoteDocumentGlobal")}(e),this.Ks(a)))),r<7&&i>=7&&(l=l.next(()=>this.Gs(a))),r<8&&i>=8&&(l=l.next(()=>this.Qs(e,a))),r<9&&i>=9&&(l=l.next(()=>{!function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(l=l.next(()=>this.js(a))),r<11&&i>=11&&(l=l.next(()=>{(function(d){d.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(d){d.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(l=l.next(()=>{!function(d){const _=d.createObjectStore("documentOverlays",{keyPath:P0});_.createIndex("collectionPathOverlayIndex",BN,{unique:!1}),_.createIndex("collectionGroupOverlayIndex",SA,{unique:!1})}(e)})),r<13&&i>=13&&(l=l.next(()=>function(d){const _=d.createObjectStore("remoteDocumentsV14",{keyPath:$b});_.createIndex("documentKeyIndex",Gb),_.createIndex("collectionGroupIndex",q_)}(e)).next(()=>this.Ws(e,a)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(l=l.next(()=>this.zs(e,a))),r<15&&i>=15&&(l=l.next(()=>function(d){d.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),d.createObjectStore("indexState",{keyPath:zb}).createIndex("sequenceNumberIndex",Ef,{unique:!1}),d.createObjectStore("indexEntries",{keyPath:TA}).createIndex("documentKeyIndex",qb,{unique:!1})}(e))),l}Ks(e){let t=0;return e.store("remoteDocuments").Z((r,i)=>{t+=j0(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}qs(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.W().next(i=>ee.forEach(i,a=>{const l=IDBKeyRange.bound([a.userId,-1],[a.userId,a.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",l).next(d=>ee.forEach(d,_=>{Rt(_.userId===a.userId);const w=Gd(this.It,_);return iD(e,a.userId,w).next(()=>{})}))}))}Gs(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const a=[];return r.Z((l,d)=>{const _=new sn(l),w=[0,Bi(_)];a.push(t.get(w).next(D=>D?ee.resolve():t.put({targetId:0,path:Bi(_),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>ee.waitFor(a))})}Qs(e,t){e.createObjectStore("collectionParents",{keyPath:DA});const r=t.store("collectionParents"),i=new nD,a=l=>{if(i.add(l)){const d=l.lastSegment(),_=l.popLast();return r.put({collectionId:d,parent:Bi(_)})}};return t.store("remoteDocuments").Z({X:!0},(l,d)=>{const _=new sn(l);return a(_.popLast())}).next(()=>t.store("documentMutations").Z({X:!0},([l,d,_],w)=>{const D=Ho(d);return a(D.popLast())}))}js(e){const t=e.store("targets");return t.Z((r,i)=>{const a=Tg(i),l=MA(this.It,a);return t.put(l)})}Ws(e,t){const r=t.store("remoteDocuments"),i=[];return r.Z((a,l)=>{const d=t.store("remoteDocumentsV14"),_=(w=l,w.document?new qe(sn.fromString(w.document.name).popFirst(5)):w.noDocument?qe.fromSegments(w.noDocument.path):w.unknownDocument?qe.fromSegments(w.unknownDocument.path):ot()).path.toArray();var w;const D={prefixPath:_.slice(0,_.length-2),collectionGroup:_[_.length-2],documentId:_[_.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};i.push(d.put(D))}).next(()=>ee.waitFor(i))}zs(e,t){const r=t.store("mutations"),i=W0(this.It),a=new Y0(Mg.Bs,this.It.re);return r.W().next(l=>{const d=new Map;return l.forEach(_=>{var w;let D=null!==(w=d.get(_.userId))&&void 0!==w?w:Ht();Gd(this.It,_).keys().forEach(S=>D=D.add(S)),d.set(_.userId,D)}),ee.forEach(d,(_,w)=>{const D=new Ur(w),S=V0.oe(this.It,D),M=a.getIndexManager(D),O=ry.oe(D,this.It,M,a.referenceDelegate);return new La(i,O,S,M).recalculateAndSaveOverlaysForDocumentKeys(new K_(t,Xr.at),_).next()})})}}function sy(n){n.createObjectStore("targetDocuments",{keyPath:UN}).createIndex("documentTargetsIndex",Wb,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",k0,{unique:!0}),n.createObjectStore("targetGlobal")}const oy="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class ay{constructor(e,t,r,i,a,l,d,_,w,D,S=15){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Hs=a,this.window=l,this.document=d,this.Js=w,this.Ys=D,this.Xs=S,this.Ss=null,this.Ds=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Zs=null,this.inForeground=!1,this.ti=null,this.ei=null,this.ni=Number.NEGATIVE_INFINITY,this.si=M=>Promise.resolve(),!ay.C())throw new Ne(de.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new sD(this,i),this.ii=t+"main",this.It=new F0(_),this.ri=new so(this.ii,this.Xs,new zN(this.It)),this.Cs=new $0(this.referenceDelegate,this.It),this.remoteDocumentCache=W0(this.It),this.Ns=new jN,this.window&&this.window.localStorage?this.oi=this.window.localStorage:(this.oi=null,!1===D&&vr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.ui().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ne(de.FAILED_PRECONDITION,oy);return this.ci(),this.ai(),this.hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Cs.getHighestSequenceNumber(e))}).then(e=>{this.Ss=new Xr(e,this.Js)}).then(()=>{this.Ds=!0}).catch(e=>(this.ri&&this.ri.close(),Promise.reject(e)))}li(e){var t=this;return this.si=function(){var r=(0,ve.Z)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.ri.L(function(){var t=(0,ve.Z)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Hs.enqueueAndForget((0,ve.Z)(function*(){t.started&&(yield t.ui())})))}ui(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Ng(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.fi(e).next(t=>{t||(this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)))})}).next(()=>this.di(e)).next(t=>this.isPrimary&&!t?this._i(e).next(()=>!1):!!t&&this.wi(e).next(()=>!0))).catch(e=>{if(Pu(e))return ke("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ke("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Hs.enqueueRetryable(()=>this.si(e)),this.isPrimary=e})}fi(e){return Cf(e).get("owner").next(t=>ee.resolve(this.mi(t)))}gi(e){return Ng(e).delete(this.clientId)}yi(){var e=this;return(0,ve.Z)(function*(){if(e.isPrimary&&!e.pi(e.ni,18e5)){e.ni=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=ti(r,"clientMetadata");return i.W().next(a=>{const l=e.Ii(a,18e5),d=a.filter(_=>-1===l.indexOf(_));return ee.forEach(d,_=>i.delete(_.clientId)).next(()=>d)})}).catch(()=>[]);if(e.oi)for(const r of t)e.oi.removeItem(e.Ti(r.clientId))}})()}hi(){this.ei=this.Hs.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.ui().then(()=>this.yi()).then(()=>this.hi()))}mi(e){return!!e&&e.ownerId===this.clientId}di(e){return this.Ys?ee.resolve(!0):Cf(e).get("owner").next(t=>{if(null!==t&&this.pi(t.leaseTimestampMs,5e3)&&!this.Ei(t.ownerId)){if(this.mi(t)&&this.networkEnabled)return!0;if(!this.mi(t)){if(!t.allowTabSynchronization)throw new Ne(de.FAILED_PRECONDITION,oy);return!1}}return!(!this.networkEnabled||!this.inForeground)||Ng(e).W().next(r=>void 0===this.Ii(r,5e3).find(i=>{if(this.clientId!==i.clientId){const l=!this.inForeground&&i.inForeground,d=this.networkEnabled===i.networkEnabled;if(!this.networkEnabled&&i.networkEnabled||l&&d)return!0}return!1}))}).next(t=>(this.isPrimary!==t&&ke("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,ve.Z)(function*(){e.Ds=!1,e.Ai(),e.ei&&(e.ei.cancel(),e.ei=null),e.Ri(),e.bi(),yield e.ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new K_(t,Xr.at);return e._i(r).next(()=>e.gi(r))}),e.ri.close(),e.Pi()})()}Ii(e,t){return e.filter(r=>this.pi(r.updateTimeMs,t)&&!this.Ei(r.clientId))}vi(){return this.runTransaction("getActiveClients","readonly",e=>Ng(e).W().next(t=>this.Ii(t,18e5).map(r=>r.clientId)))}get started(){return this.Ds}getMutationQueue(e,t){return ry.oe(e,this.It,t,this.referenceDelegate)}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new FA(e,this.It.re.databaseId)}getDocumentOverlayCache(e){return V0.oe(this.It,e)}getBundleCache(){return this.Ns}runTransaction(e,t,r){ke("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",a=15===(l=this.Xs)?Yb:14===l?Zb:13===l?Kb:12===l?xA:11===l?AA:void ot();var l;let d;return this.ri.runTransaction(e,i,a,_=>(d=new K_(_,this.Ss?this.Ss.next():Xr.at),"readwrite-primary"===t?this.fi(d).next(w=>!!w||this.di(d)).next(w=>{if(!w)throw vr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Hs.enqueueRetryable(()=>this.si(!1)),new Ne(de.FAILED_PRECONDITION,Nd);return r(d)}).next(w=>this.wi(d).next(()=>w)):this.Vi(d).next(()=>r(d)))).then(_=>(d.raiseOnCommittedEvent(),_))}Vi(e){return Cf(e).get("owner").next(t=>{if(null!==t&&this.pi(t.leaseTimestampMs,5e3)&&!this.Ei(t.ownerId)&&!this.mi(t)&&!(this.Ys||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ne(de.FAILED_PRECONDITION,oy)})}wi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Cf(e).put("owner",t)}static C(){return so.C()}_i(e){const t=Cf(e);return t.get("owner").next(r=>this.mi(r)?(ke("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):ee.resolve())}pi(e,t){const r=Date.now();return!(e<r-t||e>r&&(vr(`Detected an update time that is in the future: ${e} > ${r}`),1))}ci(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ti=()=>{this.Hs.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.ui()))},this.document.addEventListener("visibilitychange",this.ti),this.inForeground="visible"===this.document.visibilityState)}Ri(){this.ti&&(this.document.removeEventListener("visibilitychange",this.ti),this.ti=null)}ai(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Zs=()=>{this.Ai(),(0,P.G6)()&&navigator.appVersion.match(/Version\/1[45]/)&&this.Hs.enterRestrictedMode(!0),this.Hs.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Zs))}bi(){this.Zs&&(this.window.removeEventListener("pagehide",this.Zs),this.Zs=null)}Ei(e){var t;try{const r=null!==(null===(t=this.oi)||void 0===t?void 0:t.getItem(this.Ti(e)));return ke("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return vr("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Ai(){if(this.oi)try{this.oi.setItem(this.Ti(this.clientId),String(Date.now()))}catch(e){vr("Failed to set zombie client id.",e)}}Pi(){if(this.oi)try{this.oi.removeItem(this.Ti(this.clientId))}catch{}}Ti(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Cf(n){return ti(n,"owner")}function Ng(n){return ti(n,"clientMetadata")}function uy(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class bf{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Si=r,this.Di=i}static Ci(e,t){let r=Ht(),i=Ht();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new bf(e,t.fromCache,r,i)}}class kg{constructor(){this.xi=!1}initialize(e,t){this.Ni=e,this.indexManager=t,this.xi=!0}getDocumentsMatchingQuery(e,t,r,i){return this.ki(e,t).next(a=>a||this.Oi(e,t,i,r)).next(a=>a||this.Mi(e,t))}ki(e,t){if(a0(t))return ee.resolve(null);let r=Ui(t);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=fg(t,null,"F"),r=Ui(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(a=>{const l=Ht(...a);return this.Ni.getDocuments(e,l).next(d=>this.indexManager.getMinOffset(e,r).next(_=>{const w=this.Fi(t,d);return this.$i(t,w,l,_.readTime)?this.ki(e,fg(t,null,"F")):this.Bi(e,w,t,_)}))})))}Oi(e,t,r,i){return a0(t)||i.isEqual(Tt.min())?this.Mi(e,t):this.Ni.getDocuments(e,r).next(a=>{const l=this.Fi(t,a);return this.$i(t,l,r,i)?this.Mi(e,t):(R_()<=eo.in.DEBUG&&ke("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),d0(t)),this.Bi(e,l,t,Ct(i,-1)))})}Fi(e,t){let r=new wn(L_(e));return t.forEach((i,a)=>{_b(e,a)&&(r=r.add(a))}),r}$i(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}Mi(e,t){return R_()<=eo.in.DEBUG&&ke("QueryEngine","Using full collection scan to execute query:",d0(t)),this.Ni.getDocumentsMatchingQuery(e,t,Ds.min())}Bi(e,t,r,i){return this.Ni.getDocumentsMatchingQuery(e,r,i).next(a=>(t.forEach(l=>{a=a.insert(l.key,l)}),a))}}class lD{constructor(e,t,r,i){this.persistence=e,this.Li=t,this.It=i,this.Ui=new Un(Pt),this.qi=new ec(a=>Vd(a),dg),this.Ki=new Map,this.Gi=e.getRemoteDocumentCache(),this.Cs=e.getTargetCache(),this.Ns=e.getBundleCache(),this.Qi(r)}Qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new La(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ui))}}function cD(n,e,t,r){return new lD(n,e,t,r)}function Q0(n,e){return ly.apply(this,arguments)}function ly(){return ly=(0,ve.Z)(function*(n,e){const t=Ke(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(a=>(i=a,t.Qi(e),t.mutationQueue.getAllMutationBatches(r))).next(a=>{const l=[],d=[];let _=Ht();for(const w of i){l.push(w.batchId);for(const D of w.mutations)_=_.add(D.key)}for(const w of a){d.push(w.batchId);for(const D of w.mutations)_=_.add(D.key)}return t.localDocuments.getDocuments(r,_).next(w=>({ji:w,removedBatchIds:l,addedBatchIds:d}))})})}),ly.apply(this,arguments)}function WA(n,e){const t=Ke(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),a=t.Gi.newChangeBuffer({trackRemovals:!0});return function(l,d,_,w){const D=_.batch,S=D.keys();let M=ee.resolve();return S.forEach(O=>{M=M.next(()=>w.getEntry(d,O)).next(j=>{const ae=_.docVersions.get(O);Rt(null!==ae),j.version.compareTo(ae)<0&&(D.applyToRemoteDocument(j,_),j.isValidDocument()&&(j.setReadTime(_.commitVersion),w.addEntry(j)))})}),M.next(()=>l.mutationQueue.removeMutationBatch(d,D))}(t,r,e,a).next(()=>a.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let d=Ht();for(let _=0;_<l.mutationResults.length;++_)l.mutationResults[_].transformResults.length>0&&(d=d.add(l.batch.mutations[_].key));return d}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function dD(n){const e=Ke(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Cs.getLastRemoteSnapshotVersion(t))}function qN(n,e){const t=Ke(n),r=e.snapshotVersion;let i=t.Ui;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const l=t.Gi.newChangeBuffer({trackRemovals:!0});i=t.Ui;const d=[];e.targetChanges.forEach((D,S)=>{const M=i.get(S);if(!M)return;d.push(t.Cs.removeMatchingKeys(a,D.removedDocuments,S).next(()=>t.Cs.addMatchingKeys(a,D.addedDocuments,S)));let O=M.withSequenceNumber(a.currentSequenceNumber);var j,ae,he;e.targetMismatches.has(S)?O=O.withResumeToken(jr.EMPTY_BYTE_STRING,Tt.min()).withLastLimboFreeSnapshotVersion(Tt.min()):D.resumeToken.approximateByteSize()>0&&(O=O.withResumeToken(D.resumeToken,r)),i=i.insert(S,O),ae=O,he=D,(0===(j=M).resumeToken.approximateByteSize()||ae.snapshotVersion.toMicroseconds()-j.snapshotVersion.toMicroseconds()>=3e8||he.addedDocuments.size+he.modifiedDocuments.size+he.removedDocuments.size>0)&&d.push(t.Cs.updateTargetData(a,O))});let _=Xi(),w=Ht();if(e.documentUpdates.forEach(D=>{e.resolvedLimboDocuments.has(D)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(a,D))}),d.push(zA(a,l,e.documentUpdates).next(D=>{_=D.Wi,w=D.zi})),!r.isEqual(Tt.min())){const D=t.Cs.getLastRemoteSnapshotVersion(a).next(S=>t.Cs.setTargetsMetadata(a,a.currentSequenceNumber,r));d.push(D)}return ee.waitFor(d).next(()=>l.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,_,w)).next(()=>_)}).then(a=>(t.Ui=i,a))}function zA(n,e,t){let r=Ht(),i=Ht();return t.forEach(a=>r=r.add(a)),e.getEntries(n,r).next(a=>{let l=Xi();return t.forEach((d,_)=>{const w=a.get(d);_.isFoundDocument()!==w.isFoundDocument()&&(i=i.add(d)),_.isNoDocument()&&_.version.isEqual(Tt.min())?(e.removeEntry(d,_.readTime),l=l.insert(d,_)):!w.isValidDocument()||_.version.compareTo(w.version)>0||0===_.version.compareTo(w.version)&&w.hasPendingWrites?(e.addEntry(_),l=l.insert(d,_)):ke("LocalStore","Ignoring outdated watch update for ",d,". Current version:",w.version," Watch version:",_.version)}),{Wi:l,zi:i}})}function hD(n,e){const t=Ke(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Df(n,e){const t=Ke(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Cs.getTargetData(r,e).next(a=>a?(i=a,ee.resolve(i)):t.Cs.allocateTargetId(r).next(l=>(i=new nc(e,l,0,r.currentSequenceNumber),t.Cs.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.Ui.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ui=t.Ui.insert(r.targetId,r),t.qi.set(e,r.targetId)),r})}function Tf(n,e,t){return J0.apply(this,arguments)}function J0(){return J0=(0,ve.Z)(function*(n,e,t){const r=Ke(n),i=r.Ui.get(e),a=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",a,l=>r.persistence.referenceDelegate.removeTarget(l,i)))}catch(l){if(!Pu(l))throw l;ke("LocalStore",`Failed to update sequence numbers for target ${e}: ${l}`)}r.Ui=r.Ui.remove(e),r.qi.delete(i.target)}),J0.apply(this,arguments)}function X0(n,e,t){const r=Ke(n);let i=Tt.min(),a=Ht();return r.persistence.runTransaction("Execute query","readonly",l=>function(d,_,w){const D=Ke(d),S=D.qi.get(w);return void 0!==S?ee.resolve(D.Ui.get(S)):D.Cs.getTargetData(_,w)}(r,l,Ui(e)).next(d=>{if(d)return i=d.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(l,d.targetId).next(_=>{a=_})}).next(()=>r.Li.getDocumentsMatchingQuery(l,e,t?i:Tt.min(),t?a:Ht())).next(d=>(ZA(r,h0(e),d),{documents:d,Hi:a})))}function qA(n,e){const t=Ke(n),r=Ke(t.Cs),i=t.Ui.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",a=>r.se(a,e).next(l=>l?l.target:null))}function KA(n,e){const t=Ke(n),r=t.Ki.get(e)||Tt.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Gi.getAllFromCollectionGroup(i,e,Ct(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(ZA(t,e,i),i))}function ZA(n,e,t){let r=n.Ki.get(e)||Tt.min();t.forEach((i,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)}),n.Ki.set(e,r)}function eE(){return eE=(0,ve.Z)(function*(n,e,t,r){const i=Ke(n);let a=Ht(),l=Xi();for(const w of t){const D=e.Ji(w.metadata.name);w.document&&(a=a.add(D));const S=e.Yi(w);S.setReadTime(e.Xi(w.metadata.readTime)),l=l.insert(D,S)}const d=i.Gi.newChangeBuffer({trackRemovals:!0}),_=yield Df(i,(w=r,Ui(Jl(sn.fromString(`__bundle__/docs/${w}`)))));var w;return i.persistence.runTransaction("Apply bundle documents","readwrite",w=>zA(w,d,l).next(D=>(d.apply(w),D)).next(D=>i.Cs.removeMatchingKeysForTargetId(w,_.targetId).next(()=>i.Cs.addMatchingKeys(w,a,_.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(w,D.Wi,D.zi)).next(()=>D.Wi)))}),eE.apply(this,arguments)}function cy(n,e){return tE.apply(this,arguments)}function tE(){return tE=(0,ve.Z)(function*(n,e,t=Ht()){const r=yield Df(n,Ui(Q_(e.bundledQuery))),i=Ke(n);return i.persistence.runTransaction("Save named query","readwrite",a=>{const l=xr(e.readTime);if(r.snapshotVersion.compareTo(l)>=0)return i.Ns.saveNamedQuery(a,e);const d=r.withResumeToken(jr.EMPTY_BYTE_STRING,l);return i.Ui=i.Ui.insert(d.targetId,d),i.Cs.updateTargetData(a,d).next(()=>i.Cs.removeMatchingKeysForTargetId(a,r.targetId)).next(()=>i.Cs.addMatchingKeys(a,t,r.targetId)).next(()=>i.Ns.saveNamedQuery(a,e))})}),tE.apply(this,arguments)}function fD(n,e){return`firestore_clients_${n}_${e}`}function nE(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Hu(n,e){return`firestore_targets_${n}_${e}`}class Pg{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Zi(e,t,r){const i=JSON.parse(r);let a,l="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return l&&i.error&&(l="string"==typeof i.error.message&&"string"==typeof i.error.code,l&&(a=new Ne(i.error.code,i.error.message))),l?new Pg(e,t,i.state,a):(vr("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}tr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Kd{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Zi(e,t){const r=JSON.parse(t);let i,a="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return a&&r.error&&(a="string"==typeof r.error.message&&"string"==typeof r.error.code,a&&(i=new Ne(r.error.code,r.error.message))),a?new Kd(e,r.state,i):(vr("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}tr(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Sf{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Zi(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,a=tc();for(let l=0;i&&l<r.activeTargetIds.length;++l)i=uA(r.activeTargetIds[l]),a=a.add(r.activeTargetIds[l]);return i?new Sf(e,a):(vr("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class rE{constructor(e,t){this.clientId=e,this.onlineState=t}static Zi(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new rE(t.clientId,t.onlineState):(vr("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Og{constructor(){this.activeTargetIds=tc()}er(e){this.activeTargetIds=this.activeTargetIds.add(e)}nr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}tr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Fg{constructor(e,t,r,i,a){this.window=e,this.Hs=t,this.persistenceKey=r,this.sr=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ir=this.rr.bind(this),this.ur=new Un(Pt),this.started=!1,this.cr=[];const l=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.ar=fD(this.persistenceKey,this.sr),this.hr=`firestore_sequence_number_${this.persistenceKey}`,this.ur=this.ur.insert(this.sr,new Og),this.lr=new RegExp(`^firestore_clients_${l}_([^_]*)$`),this.dr=new RegExp(`^firestore_mutations_${l}_(\\d+)(?:_(.*))?$`),this._r=new RegExp(`^firestore_targets_${l}_(\\d+)$`),this.wr=`firestore_online_state_${this.persistenceKey}`,this.mr=function(d){return`firestore_bundle_loaded_v2_${d}`}(this.persistenceKey),this.window.addEventListener("storage",this.ir)}static C(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,ve.Z)(function*(){const t=yield e.syncEngine.vi();for(const i of t){if(i===e.sr)continue;const a=e.getItem(fD(e.persistenceKey,i));if(a){const l=Sf.Zi(i,a);l&&(e.ur=e.ur.insert(l.clientId,l))}}e.gr();const r=e.storage.getItem(e.wr);if(r){const i=e.yr(r);i&&e.pr(i)}for(const i of e.cr)e.rr(i);e.cr=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.hr,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ir(this.ur)}isActiveQueryTarget(e){let t=!1;return this.ur.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Tr(e,"pending")}updateMutationState(e,t,r){this.Tr(e,t,r),this.Er(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(Hu(this.persistenceKey,e));if(r){const i=Kd.Zi(e,r);i&&(t=i.state)}}return this.Ar.er(e),this.gr(),t}removeLocalQueryTarget(e){this.Ar.nr(e),this.gr()}isLocalQueryTarget(e){return this.Ar.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Hu(this.persistenceKey,e))}updateQueryState(e,t,r){this.Rr(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Er(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.br(e)}notifyBundleLoaded(e){this.Pr(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ir),this.removeItem(this.ar),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return ke("SharedClientState","READ",e,t),t}setItem(e,t){ke("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){ke("SharedClientState","REMOVE",e),this.storage.removeItem(e)}rr(e){var t=this;const r=e;if(r.storageArea===this.storage){if(ke("SharedClientState","EVENT",r.key,r.newValue),r.key===this.ar)return void vr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Hs.enqueueRetryable((0,ve.Z)(function*(){if(t.started){if(null!==r.key)if(t.lr.test(r.key)){if(null==r.newValue){const i=t.vr(r.key);return t.Vr(i,null)}{const i=t.Sr(r.key,r.newValue);if(i)return t.Vr(i.clientId,i)}}else if(t.dr.test(r.key)){if(null!==r.newValue){const i=t.Dr(r.key,r.newValue);if(i)return t.Cr(i)}}else if(t._r.test(r.key)){if(null!==r.newValue){const i=t.Nr(r.key,r.newValue);if(i)return t.kr(i)}}else if(r.key===t.wr){if(null!==r.newValue){const i=t.yr(r.newValue);if(i)return t.pr(i)}}else if(r.key===t.hr){const i=function(a){let l=Xr.at;if(null!=a)try{const d=JSON.parse(a);Rt("number"==typeof d),l=d}catch(d){vr("SharedClientState","Failed to read sequence number from WebStorage",d)}return l}(r.newValue);i!==Xr.at&&t.sequenceNumberHandler(i)}else if(r.key===t.mr){const i=t.Or(r.newValue);yield Promise.all(i.map(a=>t.syncEngine.Mr(a)))}}else t.cr.push(r)}))}}get Ar(){return this.ur.get(this.sr)}gr(){this.setItem(this.ar,this.Ar.tr())}Tr(e,t,r){const i=new Pg(this.currentUser,e,t,r),a=nE(this.persistenceKey,this.currentUser,e);this.setItem(a,i.tr())}Er(e){const t=nE(this.persistenceKey,this.currentUser,e);this.removeItem(t)}br(e){this.storage.setItem(this.wr,JSON.stringify({clientId:this.sr,onlineState:e}))}Rr(e,t,r){const i=Hu(this.persistenceKey,e),a=new Kd(e,t,r);this.setItem(i,a.tr())}Pr(e){const t=JSON.stringify(Array.from(e));this.setItem(this.mr,t)}vr(e){const t=this.lr.exec(e);return t?t[1]:null}Sr(e,t){const r=this.vr(e);return Sf.Zi(r,t)}Dr(e,t){const r=this.dr.exec(e),i=Number(r[1]);return Pg.Zi(new Ur(void 0!==r[2]?r[2]:null),i,t)}Nr(e,t){const r=this._r.exec(e),i=Number(r[1]);return Kd.Zi(i,t)}yr(e){return rE.Zi(e)}Or(e){return JSON.parse(e)}Cr(e){var t=this;return(0,ve.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.Fr(e.batchId,e.state,e.error);ke("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}kr(e){return this.syncEngine.$r(e.targetId,e.state,e.error)}Vr(e,t){const r=t?this.ur.insert(e,t):this.ur.remove(e),i=this.Ir(this.ur),a=this.Ir(r),l=[],d=[];return a.forEach(_=>{i.has(_)||l.push(_)}),i.forEach(_=>{a.has(_)||d.push(_)}),this.syncEngine.Br(l,d).then(()=>{this.ur=r})}pr(e){this.ur.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ir(e){let t=tc();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class Lg{constructor(){this.Lr=new Og,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return this.Lr.er(e),this.Ur[e]||"not-current"}updateQueryState(e,t,r){this.Ur[e]=t}removeLocalQueryTarget(e){this.Lr.nr(e)}isLocalQueryTarget(e){return this.Lr.activeTargetIds.has(e)}clearQueryState(e){delete this.Ur[e]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(e){return this.Lr.activeTargetIds.has(e)}start(){return this.Lr=new Og,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class ZN{qr(e){}shutdown(){}}class YA{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(e){this.Wr.push(e)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){ke("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Wr)e(0)}jr(){ke("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Wr)e(1)}static C(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const YN={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class QN{constructor(e){this.Hr=e.Hr,this.Jr=e.Jr}Yr(e){this.Xr=e}Zr(e){this.eo=e}onMessage(e){this.no=e}close(){this.Jr()}send(e){this.Hr(e)}so(){this.Xr()}io(e){this.eo(e)}ro(e){this.no(e)}}class pD extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.oo=(e.ssl?"https":"http")+"://"+e.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(e,t,r,i,a){const l=this.ho(e,t);ke("RestConnection","Sending: ",l,r);const d={};return this.lo(d,i,a),this.fo(e,l,d,r).then(_=>(ke("RestConnection","Received: ",_),_),_=>{throw xd("RestConnection",`${e} failed with error: `,_,"url: ",l,"request:",r),_})}_o(e,t,r,i,a,l){return this.ao(e,t,r,i,a)}lo(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+Ad,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,a)=>e[a]=i),r&&r.headers.forEach((i,a)=>e[a]=i)}ho(e,t){return`${this.oo}/v1/${t}:${YN[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}fo(e,t,r,i){return new Promise((a,l)=>{const d=new $C;d.setWithCredentials(!0),d.listenOnce(jC.COMPLETE,()=>{var w;try{switch(d.getLastErrorCode()){case $w.NO_ERROR:const D=d.getResponseJson();ke("Connection","XHR received:",JSON.stringify(D)),a(D);break;case $w.TIMEOUT:ke("Connection",'RPC "'+e+'" timed out'),l(new Ne(de.DEADLINE_EXCEEDED,"Request time out"));break;case $w.HTTP_ERROR:const S=d.getStatus();if(ke("Connection",'RPC "'+e+'" failed with status:',S,"response text:",d.getResponseText()),S>0){let M=d.getResponseJson();Array.isArray(M)&&(M=M[0]);const O=null===(w=M)||void 0===w?void 0:w.error;if(O&&O.status&&O.message){const j=function(ae){const he=ae.toLowerCase().replace(/_/g,"-");return Object.values(de).indexOf(he)>=0?he:de.UNKNOWN}(O.status);l(new Ne(j,O.message))}else l(new Ne(de.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new Ne(de.UNAVAILABLE,"Connection failed."));break;default:ot()}}finally{ke("Connection",'RPC "'+e+'" completed.')}});const _=JSON.stringify(i);d.send(t,"POST",_,r,15)})}wo(e,t,r){const i=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=BC(),l=S_(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(d.xmlHttpFactory=new x_({})),this.lo(d.initMessageHeaders,t,r),d.encodeInitMessageHeaders=!0;const _=i.join("");ke("Connection","Creating WebChannel: "+_,d);const w=a.createWebChannel(_,d);let D=!1,S=!1;const M=new QN({Hr:j=>{S?ke("Connection","Not sending because WebChannel is closed:",j):(D||(ke("Connection","Opening WebChannel transport."),w.open(),D=!0),ke("Connection","WebChannel sending:",j),w.send(j))},Jr:()=>w.close()}),O=(j,ae,he)=>{j.listen(ae,$e=>{try{he($e)}catch(nt){setTimeout(()=>{throw nt},0)}})};return O(w,sg.EventType.OPEN,()=>{S||ke("Connection","WebChannel transport opened.")}),O(w,sg.EventType.CLOSE,()=>{S||(S=!0,ke("Connection","WebChannel transport closed"),M.io())}),O(w,sg.EventType.ERROR,j=>{S||(S=!0,xd("Connection","WebChannel transport errored:",j),M.io(new Ne(de.UNAVAILABLE,"The operation could not be completed")))}),O(w,sg.EventType.MESSAGE,j=>{var ae;if(!S){const he=j.data[0];Rt(!!he);const $e=he,nt=$e.error||(null===(ae=$e[0])||void 0===ae?void 0:ae.error);if(nt){ke("Connection","WebChannel received error:",nt);const et=nt.status;let at=function(Ot){const Cr=wr[Ot];if(void 0!==Cr)return xb(Cr)}(et),St=nt.message;void 0===at&&(at=de.INTERNAL,St="Unknown error status: "+et+" with message "+nt.message),S=!0,M.io(new Ne(at,St)),w.close()}else ke("Connection","WebChannel received:",he),M.ro(he)}}),O(l,HC.STAT_EVENT,j=>{j.stat===A_.PROXY?ke("Connection","Detected buffering proxy"):j.stat===A_.NOPROXY&&ke("Connection","Detected no buffering proxy")}),setTimeout(()=>{M.so()},0),M}}function gD(){return typeof window<"u"?window:null}function dy(){return typeof document<"u"?document:null}function Vg(n){return new EA(n,!0)}class iE{constructor(e,t,r=1e3,i=1.5,a=6e4){this.Hs=e,this.timerId=t,this.mo=r,this.yo=i,this.po=a,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(e){this.cancel();const t=Math.floor(this.Io+this.bo()),r=Math.max(0,Date.now()-this.Eo),i=Math.max(0,t-r);i>0&&ke("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Io} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,i,()=>(this.Eo=Date.now(),e())),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class sE{constructor(e,t,r,i,a,l,d,_){this.Hs=e,this.vo=r,this.Vo=i,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=d,this.listener=_,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new iE(e,t)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}stop(){var e=this;return(0,ve.Z)(function*(){e.No()&&(yield e.close(0))})()}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,()=>this.$o()))}Bo(e){this.Lo(),this.stream.send(e)}$o(){var e=this;return(0,ve.Z)(function*(){if(e.ko())return e.close(0)})()}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}close(e,t){var r=this;return(0,ve.Z)(function*(){r.Lo(),r.Uo(),r.xo.cancel(),r.So++,4!==e?r.xo.reset():t&&t.code===de.RESOURCE_EXHAUSTED?(vr(t.toString()),vr("Using maximum backoff delay to prevent overloading the backend."),r.xo.Ao()):t&&t.code===de.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.qo(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.Zr(t)})()}qo(){}auth(){this.state=1;const e=this.Ko(this.So),t=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.So===t&&this.Go(r,i)},r=>{e(()=>{const i=new Ne(de.UNKNOWN,"Fetching auth token failed: "+r.message);return this.Qo(i)})})}Go(e,t){const r=this.Ko(this.So);this.stream=this.jo(e,t),this.stream.Yr(()=>{r(()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,()=>(this.ko()&&(this.state=3),Promise.resolve())),this.listener.Yr()))}),this.stream.Zr(i=>{r(()=>this.Qo(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Oo(){var e=this;this.state=5,this.xo.Ro((0,ve.Z)(function*(){e.state=0,e.start()}))}Qo(e){return ke("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Ko(e){return t=>{this.Hs.enqueueAndForget(()=>this.So===e?t():(ke("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class mD extends sE{constructor(e,t,r,i,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,l),this.It=a}jo(e,t){return this.connection.wo("Listen",e,t)}onMessage(e){this.xo.reset();const t=function Ob(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(_=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===_?1:"REMOVE"===_?2:"CURRENT"===_?3:"RESET"===_?4:ot(),i=e.targetChange.targetIds||[],a=function(_,w){return _.gt?(Rt(void 0===w||"string"==typeof w),jr.fromBase64String(w||"")):(Rt(void 0===w||w instanceof Uint8Array),jr.fromUint8Array(w||new Uint8Array))}(n,e.targetChange.resumeToken),l=e.targetChange.cause,d=l&&function(_){const w=void 0===_.code?de.UNKNOWN:xb(_.code);return new Ne(w,_.message||"")}(l);t=new Eg(r,i,a,d||null)}else if("documentChange"in e){const r=e.documentChange,i=Oa(n,r.document.name),a=xr(r.document.updateTime),l=new pi({mapValue:{fields:r.document.fields}}),d=Mn.newFoundDocument(i,a,l);t=new H_(r.targetIds||[],r.removedTargetIds||[],d.key,d)}else if("documentDelete"in e){const r=e.documentDelete,i=Oa(n,r.document),a=r.readTime?xr(r.readTime):Tt.min(),l=Mn.newNoDocument(i,a);t=new H_([],r.removedTargetIds||[],l.key,l)}else if("documentRemove"in e){const r=e.documentRemove,i=Oa(n,r.document);t=new H_([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return ot();{const r=e.filter,a=new Ab(r.count||0);t=new wg(r.targetId,a)}}var _;return t}(this.It,e),r=function(i){if(!("targetChange"in i))return Tt.min();const a=i.targetChange;return a.targetIds&&a.targetIds.length?Tt.min():a.readTime?xr(a.readTime):Tt.min()}(e);return this.listener.Wo(t,r)}zo(e){const t={};t.database=Cg(this.It),t.addTarget=function(i,a){let l;const d=a.target;return l=hf(d)?{documents:A0(i,d)}:{query:x0(i,d)},l.targetId=a.targetId,a.resumeToken.approximateByteSize()>0?l.resumeToken=IA(i,a.resumeToken):a.snapshotVersion.compareTo(Tt.min())>0&&(l.readTime=Ig(i,a.snapshotVersion.toTimestamp())),l}(this.It,e);const r=function Lb(n,e){const t=function(r,i){switch(i){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return ot()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.Bo(t)}Ho(e){const t={};t.database=Cg(this.It),t.removeTarget=e,this.Bo(t)}}class _D extends sE{constructor(e,t,r,i,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,l),this.It=a,this.Jo=!1}get Yo(){return this.Jo}start(){this.Jo=!1,this.lastStreamToken=void 0,super.start()}qo(){this.Jo&&this.Xo([])}jo(e,t){return this.connection.wo("Write",e,t)}onMessage(e){if(Rt(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Jo){this.xo.reset();const t=function Fb(n,e){return n&&n.length>0?(Rt(void 0!==e),n.map(t=>function(r,i){let a=xr(r.updateTime?r.updateTime:i);return a.isEqual(Tt.min())&&(a=xr(i)),new FN(a,r.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=xr(e.commitTime);return this.listener.Zo(r,t)}return Rt(!e.writeResults||0===e.writeResults.length),this.Jo=!0,this.listener.tu()}eu(){const e={};e.database=Cg(this.It),this.Bo(e)}Xo(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>_f(this.It,r))};this.Bo(t)}}class QA extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.It=i,this.nu=!1}su(){if(this.nu)throw new Ne(de.FAILED_PRECONDITION,"The client has already been terminated.")}ao(e,t,r){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,a])=>this.connection.ao(e,t,r,i,a)).catch(i=>{throw"FirebaseError"===i.name?(i.code===de.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new Ne(de.UNKNOWN,i.toString())})}_o(e,t,r,i){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,l])=>this.connection._o(e,t,r,a,l,i)).catch(a=>{throw"FirebaseError"===a.name?(a.code===de.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ne(de.UNKNOWN,a.toString())})}terminate(){this.nu=!0}}class oE{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve())))}hu(e){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.cu("Offline")))}set(e){this.lu(),this.iu=0,"Online"===e&&(this.ou=!1),this.cu(e)}cu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}au(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(vr(t),this.ou=!1):ke("OnlineStateTracker",t)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class JN{constructor(e,t,r,i,a){var l=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=a,this.mu.qr(d=>{r.enqueueAndForget((0,ve.Z)(function*(){var _;ac(l)&&(ke("RemoteStore","Restarting streams for network reachability change."),yield(_=(0,ve.Z)(function*(w){const D=Ke(w);D._u.add(4),yield xf(D),D.gu.set("Unknown"),D._u.delete(4),yield Af(D)}),function(w){return _.apply(this,arguments)})(l))}))}),this.gu=new oE(r,i)}}function Af(n){return Ug.apply(this,arguments)}function Ug(){return Ug=(0,ve.Z)(function*(n){if(ac(n))for(const e of n.wu)yield e(!0)}),Ug.apply(this,arguments)}function xf(n){return aE.apply(this,arguments)}function aE(){return aE=(0,ve.Z)(function*(n){for(const e of n.wu)yield e(!1)}),aE.apply(this,arguments)}function uE(n,e){const t=Ke(n);t.du.has(e.targetId)||(t.du.set(e.targetId,e),vD(t)?cE(t):mt(t).ko()&&lE(t,e))}function fy(n,e){const t=Ke(n),r=mt(t);t.du.delete(e),r.ko()&&yD(t,e),0===t.du.size&&(r.ko()?r.Fo():ac(t)&&t.gu.set("Unknown"))}function lE(n,e){n.yu.Mt(e.targetId),mt(n).zo(e)}function yD(n,e){n.yu.Mt(e),mt(n).Ho(e)}function cE(n){n.yu=new wA({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),se:e=>n.du.get(e)||null}),mt(n).start(),n.gu.uu()}function vD(n){return ac(n)&&!mt(n).No()&&n.du.size>0}function ac(n){return 0===Ke(n)._u.size}function XA(n){n.yu=void 0}function XN(n){return wD.apply(this,arguments)}function wD(){return wD=(0,ve.Z)(function*(n){n.du.forEach((e,t)=>{lE(n,e)})}),wD.apply(this,arguments)}function ex(n,e){return ED.apply(this,arguments)}function ED(){return ED=(0,ve.Z)(function*(n,e){XA(n),vD(n)?(n.gu.hu(e),cE(n)):n.gu.set("Unknown")}),ED.apply(this,arguments)}function ek(n,e,t){return ID.apply(this,arguments)}function ID(){return ID=(0,ve.Z)(function*(n,e,t){if(n.gu.set("Online"),e instanceof Eg&&2===e.state&&e.cause)try{yield(r=(0,ve.Z)(function*(i,a){const l=a.cause;for(const d of a.targetIds)i.du.has(d)&&(yield i.remoteSyncer.rejectListen(d,l),i.du.delete(d),i.yu.removeTarget(d))}),function(i,a){return r.apply(this,arguments)})(n,e)}catch(r){ke("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield dE(n,r)}else if(e instanceof H_?n.yu.Gt(e):e instanceof wg?n.yu.Yt(e):n.yu.Wt(e),!t.isEqual(Tt.min()))try{const r=yield dD(n.localStore);t.compareTo(r)>=0&&(yield function(i,a){const l=i.yu.te(a);return l.targetChanges.forEach((d,_)=>{if(d.resumeToken.approximateByteSize()>0){const w=i.du.get(_);w&&i.du.set(_,w.withResumeToken(d.resumeToken,a))}}),l.targetMismatches.forEach(d=>{const _=i.du.get(d);if(!_)return;i.du.set(d,_.withResumeToken(jr.EMPTY_BYTE_STRING,_.snapshotVersion)),yD(i,d);const w=new nc(_.target,d,1,_.sequenceNumber);lE(i,w)}),i.remoteSyncer.applyRemoteEvent(l)}(n,t))}catch(r){ke("RemoteStore","Failed to raise snapshot:",r),yield dE(n,r)}var r}),ID.apply(this,arguments)}function dE(n,e,t){return CD.apply(this,arguments)}function CD(){return CD=(0,ve.Z)(function*(n,e,t){if(!Pu(e))throw e;n._u.add(1),yield xf(n),n.gu.set("Offline"),t||(t=()=>dD(n.localStore)),n.asyncQueue.enqueueRetryable((0,ve.Z)(function*(){ke("RemoteStore","Retrying IndexedDB access"),yield t(),n._u.delete(1),yield Af(n)}))}),CD.apply(this,arguments)}function tx(n,e){return e().catch(t=>dE(n,t,e))}function s(n){return o.apply(this,arguments)}function o(){return o=(0,ve.Z)(function*(n){const e=Ke(n),t=De(e);let r=e.fu.length>0?e.fu[e.fu.length-1].batchId:-1;for(;u(e);)try{const i=yield hD(e.localStore,r);if(null===i){0===e.fu.length&&t.Fo();break}r=i.batchId,c(e,i)}catch(i){yield dE(e,i)}h(e)&&g(e)}),o.apply(this,arguments)}function u(n){return ac(n)&&n.fu.length<10}function c(n,e){n.fu.push(e);const t=De(n);t.ko()&&t.Yo&&t.Xo(e.mutations)}function h(n){return ac(n)&&!De(n).No()&&n.fu.length>0}function g(n){De(n).start()}function v(n){return I.apply(this,arguments)}function I(){return I=(0,ve.Z)(function*(n){De(n).eu()}),I.apply(this,arguments)}function C(n){return A.apply(this,arguments)}function A(){return A=(0,ve.Z)(function*(n){const e=De(n);for(const t of n.fu)e.Xo(t.mutations)}),A.apply(this,arguments)}function N(n,e,t){return L.apply(this,arguments)}function L(){return L=(0,ve.Z)(function*(n,e,t){const r=n.fu.shift(),i=Y_.from(r,e,t);yield tx(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield s(n)}),L.apply(this,arguments)}function z(n,e){return ne.apply(this,arguments)}function ne(){return ne=(0,ve.Z)(function*(n,e){var t;e&&De(n).Yo&&(yield(t=(0,ve.Z)(function*(r,i){if(_0(a=i.code)&&a!==de.ABORTED){const l=r.fu.shift();De(r).Mo(),yield tx(r,()=>r.remoteSyncer.rejectFailedWrite(l.batchId,i)),yield s(r)}var a}),function(r,i){return t.apply(this,arguments)})(n,e)),h(n)&&g(n)}),ne.apply(this,arguments)}function Ee(n,e){return Oe.apply(this,arguments)}function Oe(){return Oe=(0,ve.Z)(function*(n,e){const t=Ke(n);t.asyncQueue.verifyOperationInProgress(),ke("RemoteStore","RemoteStore received new credentials");const r=ac(t);t._u.add(3),yield xf(t),r&&t.gu.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t._u.delete(3),yield Af(t)}),Oe.apply(this,arguments)}function We(n,e){return st.apply(this,arguments)}function st(){return st=(0,ve.Z)(function*(n,e){const t=Ke(n);e?(t._u.delete(2),yield Af(t)):e||(t._u.add(2),yield xf(t),t.gu.set("Unknown"))}),st.apply(this,arguments)}function mt(n){return n.pu||(n.pu=function(e,t,r){const i=Ke(e);return i.su(),new mD(t,i.connection,i.authCredentials,i.appCheckCredentials,i.It,r)}(n.datastore,n.asyncQueue,{Yr:XN.bind(null,n),Zr:ex.bind(null,n),Wo:ek.bind(null,n)}),n.wu.push(function(){var e=(0,ve.Z)(function*(t){t?(n.pu.Mo(),vD(n)?cE(n):n.gu.set("Unknown")):(yield n.pu.stop(),XA(n))});return function(t){return e.apply(this,arguments)}}())),n.pu}function De(n){return n.Iu||(n.Iu=function(e,t,r){const i=Ke(e);return i.su(),new _D(t,i.connection,i.authCredentials,i.appCheckCredentials,i.It,r)}(n.datastore,n.asyncQueue,{Yr:v.bind(null,n),Zr:z.bind(null,n),tu:C.bind(null,n),Zo:N.bind(null,n)}),n.wu.push(function(){var e=(0,ve.Z)(function*(t){t?(n.Iu.Mo(),yield s(n)):(yield n.Iu.stop(),n.fu.length>0&&(ke("RemoteStore",`Stopping write stream with ${n.fu.length} pending writes`),n.fu=[]))});return function(t){return e.apply(this,arguments)}}())),n.Iu}class Dt{constructor(e,t,r,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=a,this.deferred=new Br,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}static createAndSchedule(e,t,r,i,a){const l=Date.now()+r,d=new Dt(e,t,l,i,a);return d.start(r),d}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ne(de.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Xt(n,e){if(vr("AsyncQueue",`${e}: ${n}`),Pu(n))return new Ne(de.UNAVAILABLE,`${e}: ${n}`);throw n}class En{constructor(e){this.comparator=e?(t,r)=>e(t,r)||qe.comparator(t.key,r.key):(t,r)=>qe.comparator(t.key,r.key),this.keyedMap=mg(),this.sortedSet=new Un(this.comparator)}static emptySet(e){return new En(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof En)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=r.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new En;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class uc{constructor(){this.Tu=new Un(qe.comparator)}track(e){const t=e.doc.key,r=this.Tu.get(t);r?0!==e.type&&3===r.type?this.Tu=this.Tu.insert(t,e):3===e.type&&1!==r.type?this.Tu=this.Tu.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.Tu=this.Tu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.Tu=this.Tu.remove(t):1===e.type&&2===r.type?this.Tu=this.Tu.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):ot():this.Tu=this.Tu.insert(t,e)}Eu(){const e=[];return this.Tu.inorderTraversal((t,r)=>{e.push(r)}),e}}class lc{constructor(e,t,r,i,a,l,d,_,w){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=d,this.excludesMetadataChanges=_,this.hasCachedResults=w}static fromInitialDocuments(e,t,r,i,a){const l=[];return t.forEach(d=>{l.push({type:0,doc:d})}),new lc(e,t,En.emptySet(t),l,r,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ma(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class hE{constructor(){this.Au=void 0,this.listeners=[]}}class fE{constructor(){this.queries=new ec(e=>c0(e),Ma),this.onlineState="Unknown",this.Ru=new Set}}function Bg(n,e){return jg.apply(this,arguments)}function jg(){return jg=(0,ve.Z)(function*(n,e){const t=Ke(n),r=e.query;let i=!1,a=t.queries.get(r);if(a||(i=!0,a=new hE),i)try{a.Au=yield t.onListen(r)}catch(l){const d=Xt(l,`Initialization of query '${d0(e.query)}' failed`);return void e.onError(d)}t.queries.set(r,a),a.listeners.push(e),e.bu(t.onlineState),a.Au&&e.Pu(a.Au)&&nx(t)}),jg.apply(this,arguments)}function Hg(n,e){return $g.apply(this,arguments)}function $g(){return $g=(0,ve.Z)(function*(n,e){const t=Ke(n),r=e.query;let i=!1;const a=t.queries.get(r);if(a){const l=a.listeners.indexOf(e);l>=0&&(a.listeners.splice(l,1),i=0===a.listeners.length)}if(i)return t.queries.delete(r),t.onUnlisten(r)}),$g.apply(this,arguments)}function pE(n,e){const t=Ke(n);let r=!1;for(const i of e){const l=t.queries.get(i.query);if(l){for(const d of l.listeners)d.Pu(i)&&(r=!0);l.Au=i}}r&&nx(t)}function gE(n,e,t){const r=Ke(n),i=r.queries.get(e);if(i)for(const a of i.listeners)a.onError(t);r.queries.delete(e)}function nx(n){n.Ru.forEach(e=>{e.next()})}class rx{constructor(e,t,r){this.query=e,this.vu=t,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=r||{}}Pu(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new lc(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),t=!0):this.Cu(e,this.onlineState)&&(this.xu(e),t=!0),this.Su=e,t}onError(e){this.vu.error(e)}bu(e){this.onlineState=e;let t=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),t=!0),t}Cu(e,t){return!e.fromCache||(!this.options.Nu||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Du(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}xu(e){e=lc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Vu=!0,this.vu.next(e)}}class rV{constructor(e,t){this.ku=e,this.byteLength=t}Ou(){return"metadata"in this.ku}}class tk{constructor(e){this.It=e}Ji(e){return Oa(this.It,e)}Yi(e){return e.metadata.exists?T0(this.It,e.document,!1):Mn.newNoDocument(this.Ji(e.metadata.name),this.Xi(e.metadata.readTime))}Xi(e){return xr(e)}}class iV{constructor(e,t,r){this.Mu=e,this.localStore=t,this.It=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=nk(e)}Fu(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.ku.namedQuery)this.queries.push(e.ku.namedQuery);else if(e.ku.documentMetadata){this.documents.push({metadata:e.ku.documentMetadata}),e.ku.documentMetadata.exists||++t;const r=sn.fromString(e.ku.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.ku.document&&(this.documents[this.documents.length-1].document=e.ku.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}$u(e){const t=new Map,r=new tk(this.It);for(const i of e)if(i.metadata.queries){const a=r.Ji(i.metadata.name);for(const l of i.metadata.queries){const d=(t.get(l)||Ht()).add(a);t.set(l,d)}}return t}complete(){var e=this;return(0,ve.Z)(function*(){const t=yield function KN(n,e,t,r){return eE.apply(this,arguments)}(e.localStore,new tk(e.It),e.documents,e.Mu.id),r=e.$u(e.documents);for(const i of e.queries)yield cy(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,Bu:e.collectionGroups,Lu:t}})()}}function nk(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class rk{constructor(e){this.key=e}}class ik{constructor(e){this.key=e}}class sk{constructor(e,t){this.query=e,this.Uu=t,this.qu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=Ht(),this.mutatedKeys=Ht(),this.Gu=L_(e),this.Qu=new En(this.Gu)}get ju(){return this.Uu}Wu(e,t){const r=t?t.zu:new uc,i=t?t.Qu:this.Qu;let a=t?t.mutatedKeys:this.mutatedKeys,l=i,d=!1;const _="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,w="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((D,S)=>{const M=i.get(D),O=_b(this.query,S)?S:null,j=!!M&&this.mutatedKeys.has(M.key),ae=!!O&&(O.hasLocalMutations||this.mutatedKeys.has(O.key)&&O.hasCommittedMutations);let he=!1;M&&O?M.data.isEqual(O.data)?j!==ae&&(r.track({type:3,doc:O}),he=!0):this.Hu(M,O)||(r.track({type:2,doc:O}),he=!0,(_&&this.Gu(O,_)>0||w&&this.Gu(O,w)<0)&&(d=!0)):!M&&O?(r.track({type:0,doc:O}),he=!0):M&&!O&&(r.track({type:1,doc:M}),he=!0,(_||w)&&(d=!0)),he&&(O?(l=l.add(O),a=ae?a.add(D):a.delete(D)):(l=l.delete(D),a=a.delete(D)))}),null!==this.query.limit)for(;l.size>this.query.limit;){const D="F"===this.query.limitType?l.last():l.first();l=l.delete(D.key),a=a.delete(D.key),r.track({type:1,doc:D})}return{Qu:l,zu:r,$i:d,mutatedKeys:a}}Hu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r){const i=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;const a=e.zu.Eu();a.sort((w,D)=>function(S,M){const O=j=>{switch(j){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ot()}};return O(S)-O(M)}(w.type,D.type)||this.Gu(w.doc,D.doc)),this.Ju(r);const l=t?this.Yu():[],d=0===this.Ku.size&&this.current?1:0,_=d!==this.qu;return this.qu=d,0!==a.length||_?{snapshot:new lc(this.query,e.Qu,i,a,e.mutatedKeys,0===d,_,!1,!!r&&r.resumeToken.approximateByteSize()>0),Xu:l}:{Xu:l}}bu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new uc,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(e){return!this.Uu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}Ju(e){e&&(e.addedDocuments.forEach(t=>this.Uu=this.Uu.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Uu=this.Uu.delete(t)),this.current=e.current)}Yu(){if(!this.current)return[];const e=this.Ku;this.Ku=Ht(),this.Qu.forEach(r=>{this.Zu(r.key)&&(this.Ku=this.Ku.add(r.key))});const t=[];return e.forEach(r=>{this.Ku.has(r)||t.push(new ik(r))}),this.Ku.forEach(r=>{e.has(r)||t.push(new rk(r))}),t}tc(e){this.Uu=e.Hi,this.Ku=Ht();const t=this.Wu(e.documents);return this.applyChanges(t,!0)}ec(){return lc.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.qu,this.hasCachedResults)}}class sV{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class oV{constructor(e){this.key=e,this.nc=!1}}class aV{constructor(e,t,r,i,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.sc={},this.ic=new ec(d=>c0(d),Ma),this.rc=new Map,this.oc=new Set,this.uc=new Un(qe.comparator),this.cc=new Map,this.ac=new Z0,this.hc={},this.lc=new Map,this.fc=Wd.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}function uV(n,e){return ix.apply(this,arguments)}function ix(){return ix=(0,ve.Z)(function*(n,e){const t=Sx(n);let r,i;const a=t.ic.get(e);if(a)r=a.targetId,t.sharedClientState.addLocalQueryTarget(r),i=a.view.ec();else{const l=yield Df(t.localStore,Ui(e));t.isPrimaryClient&&uE(t.remoteStore,l);const d=t.sharedClientState.addLocalQueryTarget(l.targetId);r=l.targetId,i=yield sx(t,e,r,"current"===d,l.resumeToken)}return i}),ix.apply(this,arguments)}function sx(n,e,t,r,i){return ox.apply(this,arguments)}function ox(){return ox=(0,ve.Z)(function*(n,e,t,r,i){n._c=(S,M,O)=>{return(j=(0,ve.Z)(function*(ae,he,$e,nt){let et=he.view.Wu($e);et.$i&&(et=yield X0(ae.localStore,he.query,!1).then(({documents:Ot})=>he.view.Wu(Ot,et)));const at=nt&&nt.targetChanges.get(he.targetId),St=he.view.applyChanges(et,ae.isPrimaryClient,at);return mx(ae,he.targetId,St.Xu),St.snapshot}),function(ae,he,$e,nt){return j.apply(this,arguments)})(n,S,M,O);var j};const a=yield X0(n.localStore,e,!0),l=new sk(e,a.Hi),d=l.Wu(a.documents),_=vg.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState,i),w=l.applyChanges(d,n.isPrimaryClient,_);mx(n,t,w.Xu);const D=new sV(e,t,l);return n.ic.set(e,D),n.rc.has(t)?n.rc.get(t).push(e):n.rc.set(t,[e]),w.snapshot}),ox.apply(this,arguments)}function lV(n,e){return ax.apply(this,arguments)}function ax(){return ax=(0,ve.Z)(function*(n,e){const t=Ke(n),r=t.ic.get(e),i=t.rc.get(r.targetId);if(i.length>1)return t.rc.set(r.targetId,i.filter(a=>!Ma(a,e))),void t.ic.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(r.targetId),t.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Tf(t.localStore,r.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(r.targetId),fy(t.remoteStore,r.targetId),py(t,r.targetId)}).catch(jo))):(py(t,r.targetId),yield Tf(t.localStore,r.targetId,!0))}),ax.apply(this,arguments)}function ux(){return ux=(0,ve.Z)(function*(n,e,t){const r=Ax(n);try{const i=yield function(a,l){const d=Ke(a),_=Vn.now(),w=l.reduce((M,O)=>M.add(O.key),Ht());let D,S;return d.persistence.runTransaction("Locally write mutations","readwrite",M=>{let O=Xi(),j=Ht();return d.Gi.getEntries(M,w).next(ae=>{O=ae,O.forEach((he,$e)=>{$e.isValidDocument()||(j=j.add(he))})}).next(()=>d.localDocuments.getOverlayedDocuments(M,O)).next(ae=>{D=ae;const he=[];for(const $e of l){const nt=vA($e,D.get($e.key).overlayedDocument);null!=nt&&he.push(new Vu($e.key,nt,P_(nt.value.mapValue),er.exists(!0)))}return d.mutationQueue.addMutationBatch(M,_,he,l)}).next(ae=>{S=ae;const he=ae.applyToLocalDocumentSet(D,j);return d.documentOverlayCache.saveOverlays(M,ae.batchId,he)})}).then(()=>({batchId:S.batchId,changes:Mb(D)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,l,d){let _=a.hc[a.currentUser.toKey()];_||(_=new Un(Pt)),_=_.insert(l,d),a.hc[a.currentUser.toKey()]=_}(r,i.batchId,t),yield Zd(r,i.changes),yield s(r.remoteStore)}catch(i){const a=Xt(i,"Failed to persist write");t.reject(a)}}),ux.apply(this,arguments)}function ok(n,e){return lx.apply(this,arguments)}function lx(){return lx=(0,ve.Z)(function*(n,e){const t=Ke(n);try{const r=yield qN(t.localStore,e);e.targetChanges.forEach((i,a)=>{const l=t.cc.get(a);l&&(Rt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?l.nc=!0:i.modifiedDocuments.size>0?Rt(l.nc):i.removedDocuments.size>0&&(Rt(l.nc),l.nc=!1))}),yield Zd(t,r,e)}catch(r){yield jo(r)}}),lx.apply(this,arguments)}function ak(n,e,t){const r=Ke(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.ic.forEach((a,l)=>{const d=l.view.bu(e);d.snapshot&&i.push(d.snapshot)}),function(a,l){const d=Ke(a);d.onlineState=l;let _=!1;d.queries.forEach((w,D)=>{for(const S of D.listeners)S.bu(l)&&(_=!0)}),_&&nx(d)}(r.eventManager,e),i.length&&r.sc.Wo(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function dV(n,e,t){return cx.apply(this,arguments)}function cx(){return cx=(0,ve.Z)(function*(n,e,t){const r=Ke(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.cc.get(e),a=i&&i.key;if(a){let l=new Un(qe.comparator);l=l.insert(a,Mn.newNoDocument(a,Tt.min()));const d=Ht().add(a),_=new yg(Tt.min(),new Map,new wn(Pt),l,d);yield ok(r,_),r.uc=r.uc.remove(a),r.cc.delete(e),_x(r)}else yield Tf(r.localStore,e,!1).then(()=>py(r,e,t)).catch(jo)}),cx.apply(this,arguments)}function hV(n,e){return dx.apply(this,arguments)}function dx(){return dx=(0,ve.Z)(function*(n,e){const t=Ke(n),r=e.batch.batchId;try{const i=yield WA(t.localStore,e);gx(t,r,null),px(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Zd(t,i)}catch(i){yield jo(i)}}),dx.apply(this,arguments)}function fV(n,e,t){return hx.apply(this,arguments)}function hx(){return hx=(0,ve.Z)(function*(n,e,t){const r=Ke(n);try{const i=yield function(a,l){const d=Ke(a);return d.persistence.runTransaction("Reject batch","readwrite-primary",_=>{let w;return d.mutationQueue.lookupMutationBatch(_,l).next(D=>(Rt(null!==D),w=D.keys(),d.mutationQueue.removeMutationBatch(_,D))).next(()=>d.mutationQueue.performConsistencyCheck(_)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(_,w,l)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(_,w)).next(()=>d.localDocuments.getDocuments(_,w))})}(r.localStore,e);gx(r,e,t),px(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Zd(r,i)}catch(i){yield jo(i)}}),hx.apply(this,arguments)}function fx(){return fx=(0,ve.Z)(function*(n,e){const t=Ke(n);ac(t.remoteStore)||ke("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(a){const l=Ke(a);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",d=>l.mutationQueue.getHighestUnacknowledgedBatchId(d))}(t.localStore);if(-1===r)return void e.resolve();const i=t.lc.get(r)||[];i.push(e),t.lc.set(r,i)}catch(r){const i=Xt(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}}),fx.apply(this,arguments)}function px(n,e){(n.lc.get(e)||[]).forEach(t=>{t.resolve()}),n.lc.delete(e)}function gx(n,e,t){const r=Ke(n);let i=r.hc[r.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),r.hc[r.currentUser.toKey()]=i}}function py(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.rc.get(e))n.ic.delete(r),t&&n.sc.wc(r,t);n.rc.delete(e),n.isPrimaryClient&&n.ac.ls(e).forEach(r=>{n.ac.containsKey(r)||uk(n,r)})}function uk(n,e){n.oc.delete(e.path.canonicalString());const t=n.uc.get(e);null!==t&&(fy(n.remoteStore,t),n.uc=n.uc.remove(e),n.cc.delete(t),_x(n))}function mx(n,e,t){for(const r of t)r instanceof rk?(n.ac.addReference(r.key,e),gV(n,r)):r instanceof ik?(ke("SyncEngine","Document no longer in limbo: "+r.key),n.ac.removeReference(r.key,e),n.ac.containsKey(r.key)||uk(n,r.key)):ot()}function gV(n,e){const t=e.key,r=t.path.canonicalString();n.uc.get(t)||n.oc.has(r)||(ke("SyncEngine","New document in limbo: "+t),n.oc.add(r),_x(n))}function _x(n){for(;n.oc.size>0&&n.uc.size<n.maxConcurrentLimboResolutions;){const e=n.oc.values().next().value;n.oc.delete(e);const t=new qe(sn.fromString(e)),r=n.fc.next();n.cc.set(r,new oV(t)),n.uc=n.uc.insert(t,r),uE(n.remoteStore,new nc(Ui(Jl(t.path)),r,2,Xr.at))}}function Zd(n,e,t){return yx.apply(this,arguments)}function yx(){return yx=(0,ve.Z)(function*(n,e,t){const r=Ke(n),i=[],a=[],l=[];var d;r.ic.isEmpty()||(r.ic.forEach((d,_)=>{l.push(r._c(_,e,t).then(w=>{if((w||t)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(_.targetId,w?.fromCache?"not-current":"current"),w){i.push(w);const D=bf.Ci(_.targetId,w);a.push(D)}}))}),yield Promise.all(l),r.sc.Wo(i),yield(d=(0,ve.Z)(function*(_,w){const D=Ke(_);try{yield D.persistence.runTransaction("notifyLocalViewChanges","readwrite",S=>ee.forEach(w,M=>ee.forEach(M.Si,O=>D.persistence.referenceDelegate.addReference(S,M.targetId,O)).next(()=>ee.forEach(M.Di,O=>D.persistence.referenceDelegate.removeReference(S,M.targetId,O)))))}catch(S){if(!Pu(S))throw S;ke("LocalStore","Failed to update sequence numbers: "+S)}for(const S of w){const M=S.targetId;if(!S.fromCache){const O=D.Ui.get(M),ae=O.withLastLimboFreeSnapshotVersion(O.snapshotVersion);D.Ui=D.Ui.insert(M,ae)}}}),function(_,w){return d.apply(this,arguments)})(r.localStore,a))}),yx.apply(this,arguments)}function mV(n,e){return vx.apply(this,arguments)}function vx(){return vx=(0,ve.Z)(function*(n,e){const t=Ke(n);if(!t.currentUser.isEqual(e)){ke("SyncEngine","User change. New user:",e.toKey());const r=yield Q0(t.localStore,e);t.currentUser=e,(i=t).lc.forEach(l=>{l.forEach(d=>{d.reject(new Ne(de.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),i.lc.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Zd(t,r.ji)}var i}),vx.apply(this,arguments)}function _V(n,e){const t=Ke(n),r=t.cc.get(e);if(r&&r.nc)return Ht().add(r.key);{let i=Ht();const a=t.rc.get(e);if(!a)return i;for(const l of a){const d=t.ic.get(l);i=i.unionWith(d.view.ju)}return i}}function yV(n,e){return wx.apply(this,arguments)}function wx(){return wx=(0,ve.Z)(function*(n,e){const t=Ke(n),r=yield X0(t.localStore,e.query,!0),i=e.view.tc(r);return t.isPrimaryClient&&mx(t,e.targetId,i.Xu),i}),wx.apply(this,arguments)}function vV(n,e){return Ex.apply(this,arguments)}function Ex(){return Ex=(0,ve.Z)(function*(n,e){const t=Ke(n);return KA(t.localStore,e).then(r=>Zd(t,r))}),Ex.apply(this,arguments)}function wV(n,e,t,r){return Ix.apply(this,arguments)}function Ix(){return Ix=(0,ve.Z)(function*(n,e,t,r){const i=Ke(n),a=yield function(l,d){const _=Ke(l),w=Ke(_.mutationQueue);return _.persistence.runTransaction("Lookup mutation documents","readonly",D=>w.Tn(D,d).next(S=>S?_.localDocuments.getDocuments(D,S):ee.resolve(null)))}(i.localStore,e);var d;null!==a?("pending"===t?yield s(i.remoteStore):"acknowledged"===t||"rejected"===t?(gx(i,e,r||null),px(i,e),d=e,Ke(Ke(i.localStore).mutationQueue).An(d)):ot(),yield Zd(i,a)):ke("SyncEngine","Cannot apply mutation batch with id: "+e)}),Ix.apply(this,arguments)}function Cx(){return Cx=(0,ve.Z)(function*(n,e){const t=Ke(n);if(Sx(t),Ax(t),!0===e&&!0!==t.dc){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield lk(t,r.toArray());t.dc=!0,yield We(t.remoteStore,!0);for(const a of i)uE(t.remoteStore,a)}else if(!1===e&&!1!==t.dc){const r=[];let i=Promise.resolve();t.rc.forEach((a,l)=>{t.sharedClientState.isLocalQueryTarget(l)?r.push(l):i=i.then(()=>(py(t,l),Tf(t.localStore,l,!0))),fy(t.remoteStore,l)}),yield i,yield lk(t,r),function(a){const l=Ke(a);l.cc.forEach((d,_)=>{fy(l.remoteStore,_)}),l.ac.fs(),l.cc=new Map,l.uc=new Un(qe.comparator)}(t),t.dc=!1,yield We(t.remoteStore,!1)}}),Cx.apply(this,arguments)}function lk(n,e,t){return bx.apply(this,arguments)}function bx(){return bx=(0,ve.Z)(function*(n,e,t){const r=Ke(n),i=[],a=[];for(const l of e){let d;const _=r.rc.get(l);if(_&&0!==_.length){d=yield Df(r.localStore,Ui(_[0]));for(const w of _){const D=r.ic.get(w),S=yield yV(r,D);S.snapshot&&a.push(S.snapshot)}}else{const w=yield qA(r.localStore,l);d=yield Df(r.localStore,w),yield sx(r,ck(w),l,!1,d.resumeToken)}i.push(d)}return r.sc.Wo(a),i}),bx.apply(this,arguments)}function ck(n){return F_(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function IV(n){const e=Ke(n);return Ke(Ke(e.localStore).persistence).vi()}function CV(n,e,t,r){return Dx.apply(this,arguments)}function Dx(){return Dx=(0,ve.Z)(function*(n,e,t,r){const i=Ke(n);if(i.dc)return void ke("SyncEngine","Ignoring unexpected query state notification.");const a=i.rc.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const l=yield KA(i.localStore,h0(a[0])),d=yg.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,jr.EMPTY_BYTE_STRING);yield Zd(i,l,d);break}case"rejected":yield Tf(i.localStore,e,!0),py(i,e,r);break;default:ot()}}),Dx.apply(this,arguments)}function bV(n,e,t){return Tx.apply(this,arguments)}function Tx(){return Tx=(0,ve.Z)(function*(n,e,t){const r=Sx(n);if(r.dc){for(const i of e){if(r.rc.has(i)){ke("SyncEngine","Adding an already active target "+i);continue}const a=yield qA(r.localStore,i),l=yield Df(r.localStore,a);yield sx(r,ck(a),l.targetId,!1,l.resumeToken),uE(r.remoteStore,l)}for(const i of t)r.rc.has(i)&&(yield Tf(r.localStore,i,!1).then(()=>{fy(r.remoteStore,i),py(r,i)}).catch(jo))}}),Tx.apply(this,arguments)}function Sx(n){const e=Ke(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=ok.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=_V.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=dV.bind(null,e),e.sc.Wo=pE.bind(null,e.eventManager),e.sc.wc=gE.bind(null,e.eventManager),e}function Ax(n){const e=Ke(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=hV.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=fV.bind(null,e),e}class dk{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,ve.Z)(function*(){t.It=Vg(e.databaseInfo.databaseId),t.sharedClientState=t.gc(e),t.persistence=t.yc(e),yield t.persistence.start(),t.localStore=t.Ic(e),t.gcScheduler=t.Tc(e,t.localStore),t.indexBackfillerScheduler=t.Ec(e,t.localStore)})()}Tc(e,t){return null}Ec(e,t){return null}Ic(e){return cD(this.persistence,new kg,e.initialUser,this.It)}yc(e){return new Y0(Mg.Bs,this.It)}gc(e){return new Lg}terminate(){var e=this;return(0,ve.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class hk extends dk{constructor(e,t,r){super(),this.Ac=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,ve.Z)(function*(){yield t().call(r,e),yield r.Ac.initialize(r,e),yield Ax(r.Ac.syncEngine),yield s(r.Ac.remoteStore),yield r.persistence.li(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}Ic(e){return cD(this.persistence,new kg,e.initialUser,this.It)}Tc(e,t){return new UA(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Ec(e,t){const r=new iA(t,this.persistence);return new rA(e.asyncQueue,r)}yc(e){const t=uy(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?es.withCacheSize(this.cacheSizeBytes):es.DEFAULT;return new ay(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,gD(),dy(),this.It,this.sharedClientState,!!this.forceOwnership)}gc(e){return new Lg}}class TV extends hk{constructor(e,t){super(e,t,!1),this.Ac=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,ve.Z)(function*(){yield t().call(r,e);const i=r.Ac.syncEngine;r.sharedClientState instanceof Fg&&(r.sharedClientState.syncEngine={Fr:wV.bind(null,i),$r:CV.bind(null,i),Br:bV.bind(null,i),vi:IV.bind(null,i),Mr:vV.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.li(function(){var a=(0,ve.Z)(function*(l){yield function EV(n,e){return Cx.apply(this,arguments)}(r.Ac.syncEngine,l),r.gcScheduler&&(l&&!r.gcScheduler.started?r.gcScheduler.start():l||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(l&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():l||r.indexBackfillerScheduler.stop())});return function(l){return a.apply(this,arguments)}}())})()}gc(e){const t=gD();if(!Fg.C(t))throw new Ne(de.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=uy(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Fg(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class xx{initialize(e,t){var r=this;return(0,ve.Z)(function*(){r.localStore||(r.localStore=e.localStore,r.sharedClientState=e.sharedClientState,r.datastore=r.createDatastore(t),r.remoteStore=r.createRemoteStore(t),r.eventManager=r.createEventManager(t),r.syncEngine=r.createSyncEngine(t,!e.synchronizeTabs),r.sharedClientState.onlineStateHandler=i=>ak(r.syncEngine,i,1),r.remoteStore.remoteSyncer.handleCredentialChange=mV.bind(null,r.syncEngine),yield We(r.remoteStore,r.syncEngine.isPrimaryClient))})()}createEventManager(e){return new fE}createDatastore(e){const t=Vg(e.databaseInfo.databaseId),r=new pD(e.databaseInfo);return new QA(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return t=this.localStore,r=this.datastore,i=e.asyncQueue,a=d=>ak(this.syncEngine,d,0),l=YA.C()?new YA:new ZN,new JN(t,r,i,a,l);var t,r,i,a,l}createSyncEngine(e,t){return function(r,i,a,l,d,_,w){const D=new aV(r,i,a,l,d,_);return w&&(D.dc=!0),D}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,ve.Z)(function*(t){const r=Ke(t);ke("RemoteStore","RemoteStore shutting down."),r._u.add(5),yield xf(r),r.mu.shutdown(),r.gu.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function Rx(n,e,t){if(!t)throw new Ne(de.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function fk(n,e,t,r){if(!0===e&&!0===r)throw new Ne(de.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function pk(n){if(!qe.isDocumentKey(n))throw new Ne(de.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function gk(n){if(qe.isDocumentKey(n))throw new Ne(de.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function bD(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":ot()}function un(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ne(de.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=bD(n);throw new Ne(de.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function mk(n,e){if(e<=0)throw new Ne(de.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}const _k=new Map;class yk{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Ne(de.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Ne(de.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,fk("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class mE{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new yk({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Ne(de.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Ne(de.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new yk(e),void 0!==e.credentials&&(this._authCredentials=function(t){if(!t)return new QS;switch(t.type){case"gapi":return new tA(t.client,t.sessionIndex||"0",t.iamToken||null,t.authTokenFactory||null);case"provider":return t.client;default:throw new Ne(de.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=_k.get(e);t&&(ke("ComponentProvider","Removing Datastore"),_k.delete(e),t.terminate())}(this),Promise.resolve()}}class tr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new cc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new tr(this.firestore,e,this._key)}}class ts{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ts(this.firestore,e,this._query)}}class cc extends ts{constructor(e,t,r){super(e,t,Jl(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new tr(this.firestore,null,new qe(e))}withConverter(e){return new cc(this.firestore,e,this._path)}}function wk(n,e,...t){if(n=(0,P.m9)(n),Rx("collection","path",e),n instanceof mE){const r=sn.fromString(e,...t);return gk(r),new cc(n,null,r)}{if(!(n instanceof tr||n instanceof cc))throw new Ne(de.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(sn.fromString(e,...t));return gk(r),new cc(n.firestore,null,r)}}function DD(n,e,...t){if(n=(0,P.m9)(n),1===arguments.length&&(e=zw.R()),Rx("doc","path",e),n instanceof mE){const r=sn.fromString(e,...t);return pk(r),new tr(n,null,new qe(r))}{if(!(n instanceof tr||n instanceof cc))throw new Ne(de.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(sn.fromString(e,...t));return pk(r),new tr(n.firestore,n instanceof cc?n.converter:null,new qe(r))}}function Ek(n,e){return n=(0,P.m9)(n),e=(0,P.m9)(e),(n instanceof tr||n instanceof cc)&&(e instanceof tr||e instanceof cc)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function Mx(n,e){return n=(0,P.m9)(n),e=(0,P.m9)(e),n instanceof ts&&e instanceof ts&&n.firestore===e.firestore&&Ma(n._query,e._query)&&n.converter===e.converter}function Ik(n,e=10240){let t=0;return{read:()=>(0,ve.Z)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,ve.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class TD{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Rc(this.observer.next,e)}error(e){this.observer.error?this.Rc(this.observer.error,e):vr("Uncaught Error in snapshot listener:",e.toString())}bc(){this.muted=!0}Rc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class AV{constructor(e,t){this.Pc=e,this.It=t,this.metadata=new Br,this.buffer=new Uint8Array,this.vc=new TextDecoder("utf-8"),this.Vc().then(r=>{r&&r.Ou()?this.metadata.resolve(r.ku.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.ku)}`))},r=>this.metadata.reject(r))}close(){return this.Pc.cancel()}getMetadata(){var e=this;return(0,ve.Z)(function*(){return e.metadata.promise})()}mc(){var e=this;return(0,ve.Z)(function*(){return yield e.getMetadata(),e.Vc()})()}Vc(){var e=this;return(0,ve.Z)(function*(){const t=yield e.Sc();if(null===t)return null;const r=e.vc.decode(t),i=Number(r);isNaN(i)&&e.Dc(`length string (${r}) is not valid number`);const a=yield e.Cc(i);return new rV(JSON.parse(a),t.length+i)})()}xc(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}Sc(){var e=this;return(0,ve.Z)(function*(){for(;e.xc()<0&&!(yield e.Nc()););if(0===e.buffer.length)return null;const t=e.xc();t<0&&e.Dc("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}Cc(e){var t=this;return(0,ve.Z)(function*(){for(;t.buffer.length<e;)(yield t.Nc())&&t.Dc("Reached the end of bundle when more is expected.");const r=t.vc.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}Dc(e){throw this.Pc.cancel(),new Error(`Invalid bundle format: ${e}`)}Nc(){var e=this;return(0,ve.Z)(function*(){const t=yield e.Pc.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class MV{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,ve.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new Ne(de.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const r=yield(i=(0,ve.Z)(function*(a,l){const d=Ke(a),_=Cg(d.It)+"/documents",w={documents:l.map(O=>$d(d.It,O))},D=yield d._o("BatchGetDocuments",_,w,l.length),S=new Map;D.forEach(O=>{const j=function CA(n,e){return"found"in e?function(t,r){Rt(!!r.found);const i=Oa(t,r.found.name),a=xr(r.found.updateTime),l=new pi({mapValue:{fields:r.found.fields}});return Mn.newFoundDocument(i,a,l)}(n,e):"missing"in e?function(t,r){Rt(!!r.missing),Rt(!!r.readTime);const i=Oa(t,r.missing),a=xr(r.readTime);return Mn.newNoDocument(i,a)}(n,e):ot()}(d.It,O);S.set(j.key.toString(),j)});const M=[];return l.forEach(O=>{const j=S.get(O.toString());Rt(!!j),M.push(j)}),M}),function(a,l){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Na(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,ve.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const a=qe.fromPath(i);e.mutations.push(new j_(a,e.precondition(a)))}),yield(r=(0,ve.Z)(function*(i,a){const l=Ke(i),d=Cg(l.It)+"/documents",_={writes:a.map(w=>_f(l.It,w))};yield l.ao("Commit",d,_)}),function(i,a){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw ot();t=Tt.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new Ne(de.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(Tt.min())?er.exists(!1):er.updateTime(t):er.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Tt.min()))throw new Ne(de.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return er.updateTime(t)}return er.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class NV{constructor(e,t,r,i,a){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=a,this.kc=r.maxAttempts,this.xo=new iE(this.asyncQueue,"transaction_retry")}run(){this.kc-=1,this.Oc()}Oc(){var e=this;this.xo.Ro((0,ve.Z)(function*(){const t=new MV(e.datastore),r=e.Mc(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(a=>{e.Fc(a)}))}).catch(i=>{e.Fc(i)})}))}Mc(e){try{const t=this.updateFunction(e);return!N_(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}Fc(e){this.kc>0&&this.$c(e)?(this.kc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Oc(),Promise.resolve()))):this.deferred.reject(e)}$c(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!_0(t)}return!1}}class kV{constructor(e,t,r,i){var a=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ur.UNAUTHENTICATED,this.clientId=zw.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,function(){var l=(0,ve.Z)(function*(d){ke("FirestoreClient","Received user=",d.uid),yield a.authCredentialListener(d),a.user=d});return function(d){return l.apply(this,arguments)}}()),this.appCheckCredentials.start(r,l=>(ke("FirestoreClient","Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}getConfiguration(){var e=this;return(0,ve.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,authCredentials:e.authCredentials,appCheckCredentials:e.appCheckCredentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Ne(de.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new Br;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,ve.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=Xt(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function Ck(n,e){return Nx.apply(this,arguments)}function Nx(){return Nx=(0,ve.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),ke("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,ve.Z)(function*(a){r.isEqual(a)||(yield Q0(e.localStore,a),r=a)});return function(a){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e}),Nx.apply(this,arguments)}function bk(n,e){return kx.apply(this,arguments)}function kx(){return kx=(0,ve.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield Px(n);ke("FirestoreClient","Initializing OnlineComponentProvider");const r=yield n.getConfiguration();yield e.initialize(t,r),n.setCredentialChangeListener(i=>Ee(e.remoteStore,i)),n.setAppCheckTokenChangeListener((i,a)=>Ee(e.remoteStore,a)),n.onlineComponents=e}),kx.apply(this,arguments)}function Px(n){return Ox.apply(this,arguments)}function Ox(){return Ox=(0,ve.Z)(function*(n){return n.offlineComponents||(ke("FirestoreClient","Using default OfflineComponentProvider"),yield Ck(n,new dk)),n.offlineComponents}),Ox.apply(this,arguments)}function SD(n){return Fx.apply(this,arguments)}function Fx(){return Fx=(0,ve.Z)(function*(n){return n.onlineComponents||(ke("FirestoreClient","Using default OnlineComponentProvider"),yield bk(n,new xx)),n.onlineComponents}),Fx.apply(this,arguments)}function Dk(n){return Px(n).then(e=>e.persistence)}function AD(n){return Px(n).then(e=>e.localStore)}function Lx(n){return SD(n).then(e=>e.remoteStore)}function Vx(n){return SD(n).then(e=>e.syncEngine)}function gy(n){return Ux.apply(this,arguments)}function Ux(){return Ux=(0,ve.Z)(function*(n){const e=yield SD(n),t=e.eventManager;return t.onListen=uV.bind(null,e.syncEngine),t.onUnlisten=lV.bind(null,e.syncEngine),t}),Ux.apply(this,arguments)}function Sk(n,e,t={}){const r=new Br;return n.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){return function(i,a,l,d,_){const w=new TD({next:S=>{a.enqueueAndForget(()=>Hg(i,D));const M=S.docs.has(l);!M&&S.fromCache?_.reject(new Ne(de.UNAVAILABLE,"Failed to get document because the client is offline.")):M&&S.fromCache&&d&&"server"===d.source?_.reject(new Ne(de.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):_.resolve(S)},error:S=>_.reject(S)}),D=new rx(Jl(l.path),w,{includeMetadataChanges:!0,Nu:!0});return Bg(i,D)}(yield gy(n),n.asyncQueue,e,t,r)})),r.promise}function Ak(n,e,t={}){const r=new Br;return n.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){return function(i,a,l,d,_){const w=new TD({next:S=>{a.enqueueAndForget(()=>Hg(i,D)),S.fromCache&&"server"===d.source?_.reject(new Ne(de.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):_.resolve(S)},error:S=>_.reject(S)}),D=new rx(l,w,{includeMetadataChanges:!0,Nu:!0});return Bg(i,D)}(yield gy(n),n.asyncQueue,e,t,r)})),r.promise}class jV{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.Uc=!1,this.qc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new iE(this,"async_queue_retry"),this.Wc=()=>{const t=dy();t&&ke("AsyncQueue","Visibility state changed to "+t.visibilityState),this.xo.Po()};const e=dy();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.Uc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.zc(),this.Hc(e)}enterRestrictedMode(e){if(!this.Uc){this.Uc=!0,this.Qc=e||!1;const t=dy();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Wc)}}enqueue(e){if(this.zc(),this.Uc)return new Promise(()=>{});const t=new Br;return this.Hc(()=>this.Uc&&this.Qc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Lc.push(e),this.Jc()))}Jc(){var e=this;return(0,ve.Z)(function*(){if(0!==e.Lc.length){try{yield e.Lc[0](),e.Lc.shift(),e.xo.reset()}catch(t){if(!Pu(t))throw t;ke("AsyncQueue","Operation failed with retryable error: "+t)}e.Lc.length>0&&e.xo.Ro(()=>e.Jc())}})()}Hc(e){const t=this.Bc.then(()=>(this.Gc=!0,e().catch(r=>{throw this.Kc=r,this.Gc=!1,vr("INTERNAL UNHANDLED ERROR: ",function(a){let l=a.message||"";return a.stack&&(l=a.stack.includes(a.message)?a.stack:a.message+"\n"+a.stack),l}(r)),r}).then(r=>(this.Gc=!1,r))));return this.Bc=t,t}enqueueAfterDelay(e,t,r){this.zc(),this.jc.indexOf(e)>-1&&(t=0);const i=Dt.createAndSchedule(this,e,t,r,a=>this.Yc(a));return this.qc.push(i),i}zc(){this.Kc&&ot()}verifyOperationInProgress(){}Xc(){var e=this;return(0,ve.Z)(function*(){let t;do{t=e.Bc,yield t}while(t!==e.Bc)})()}Zc(e){for(const t of this.qc)if(t.timerId===e)return!0;return!1}ta(e){return this.Xc().then(()=>{this.qc.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.qc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Xc()})}ea(e){this.jc.push(e)}Yc(e){const t=this.qc.indexOf(e);this.qc.splice(t,1)}}function Bx(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const i of["next","error","complete"])if(i in r&&"function"==typeof r[i])return!0;return!1}(n)}class HV{constructor(){this._progressObserver={},this._taskCompletionResolver=new Br,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class nr extends mE{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new jV,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||xk(this),this._firestoreClient.terminate()}}function Hr(n){return n._firestoreClient||xk(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function xk(n){var e;const t=n._freezeSettings(),r=(a=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new aA(n._databaseId,a,n._persistenceKey,(d=t).host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,d.useFetchStreams));var a,d;n._firestoreClient=new kV(n._authCredentials,n._appCheckCredentials,n._queue,r)}function Rk(n,e,t){const r=new Br;return n.asyncQueue.enqueue((0,ve.Z)(function*(){try{yield Ck(n,t),yield bk(n,e),r.resolve()}catch(i){const a=i;if(!("FirebaseError"===(l=a).name?l.code===de.FAILED_PRECONDITION||l.code===de.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||22===l.code||20===l.code||11===l.code))throw a;xd("Error enabling offline persistence. Falling back to persistence disabled: "+a),r.reject(a)}var l})).then(()=>r.promise)}function Mk(n){if(n._initialized||n._terminated)throw new Ne(de.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class dc{constructor(e){this._byteString=e}static fromBase64String(e){try{return new dc(jr.fromBase64String(e))}catch(t){throw new Ne(de.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new dc(jr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Yd{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Ne(de.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new cr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Gg{constructor(e){this._methodName=e}}class xD{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ne(de.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ne(de.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Pt(this._lat,e._lat)||Pt(this._long,e._long)}}const JV=/^__.*__$/;class XV{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new Vu(e,this.data,this.fieldMask,t,this.fieldTransforms):new gf(e,this.data,t,this.fieldTransforms)}}class Nk{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Vu(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function kk(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ot()}}class RD{constructor(e,t,r,i,a,l){this.settings=e,this.databaseId=t,this.It=r,this.ignoreUndefinedProperties=i,void 0===a&&this.na(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get sa(){return this.settings.sa}ia(e){return new RD(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.It,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}ra(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.ia({path:r,oa:!1});return i.ua(e),i}ca(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.ia({path:r,oa:!1});return i.na(),i}aa(e){return this.ia({path:void 0,oa:!0})}ha(e){return kD(e,this.settings.methodName,this.settings.la||!1,this.path,this.settings.fa)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}na(){if(this.path)for(let e=0;e<this.path.length;e++)this.ua(this.path.get(e))}ua(e){if(0===e.length)throw this.ha("Document fields must not be empty");if(kk(this.sa)&&JV.test(e))throw this.ha('Document fields cannot begin and end with "__"')}}class eU{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.It=r||Vg(e)}da(e,t,r,i=!1){return new RD({sa:e,methodName:t,fa:r,path:cr.emptyPath(),oa:!1,la:i},this.databaseId,this.It,this.ignoreUndefinedProperties)}}function Wg(n){const e=n._freezeSettings(),t=Vg(n._databaseId);return new eU(n._databaseId,!!e.ignoreUndefinedProperties,t)}function MD(n,e,t,r,i,a={}){const l=n.da(a.merge||a.mergeFields?2:0,e,t,i);Gx("Data must be an object, but it was:",l,r);const d=Fk(r,l);let _,w;if(a.merge)_=new fi(l.fieldMask),w=l.fieldTransforms;else if(a.mergeFields){const D=[];for(const S of a.mergeFields){const M=Wx(e,S,t);if(!l.contains(M))throw new Ne(de.INVALID_ARGUMENT,`Field '${M}' is specified in your field mask but missing from your input data.`);Vk(D,M)||D.push(M)}_=new fi(D),w=l.fieldTransforms.filter(S=>_.covers(S.field))}else _=null,w=l.fieldTransforms;return new XV(new pi(d),_,w)}class _E extends Gg{_toFieldTransform(e){if(2!==e.sa)throw e.ha(1===e.sa?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof _E}}function Pk(n,e,t){return new RD({sa:3,fa:e.settings.fa,methodName:n._methodName,oa:t},e.databaseId,e.It,e.ignoreUndefinedProperties)}class jx extends Gg{_toFieldTransform(e){return new pg(e.path,new Ud)}isEqual(e){return e instanceof jx}}class tU extends Gg{constructor(e,t){super(e),this._a=t}_toFieldTransform(e){const t=Pk(this,e,!0),r=this._a.map(a=>zg(a,t)),i=new Bd(r);return new pg(e.path,i)}isEqual(e){return this===e}}class nU extends Gg{constructor(e,t){super(e),this._a=t}_toFieldTransform(e){const t=Pk(this,e,!0),r=this._a.map(a=>zg(a,t)),i=new jd(r);return new pg(e.path,i)}isEqual(e){return this===e}}class rU extends Gg{constructor(e,t){super(e),this.wa=t}_toFieldTransform(e){const t=new Hd(e.It,f0(e.It,this.wa));return new pg(e.path,t)}isEqual(e){return this===e}}function Hx(n,e,t,r){const i=n.da(1,e,t);Gx("Data must be an object, but it was:",i,r);const a=[],l=pi.empty();kd(r,(_,w)=>{const D=ND(e,_,t);w=(0,P.m9)(w);const S=i.ca(D);if(w instanceof _E)a.push(D);else{const M=zg(w,S);null!=M&&(a.push(D),l.set(D,M))}});const d=new fi(a);return new Nk(l,d,i.fieldTransforms)}function $x(n,e,t,r,i,a){const l=n.da(1,e,t),d=[Wx(e,r,t)],_=[i];if(a.length%2!=0)throw new Ne(de.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let M=0;M<a.length;M+=2)d.push(Wx(e,a[M])),_.push(a[M+1]);const w=[],D=pi.empty();for(let M=d.length-1;M>=0;--M)if(!Vk(w,d[M])){const O=d[M];let j=_[M];j=(0,P.m9)(j);const ae=l.ca(O);if(j instanceof _E)w.push(O);else{const he=zg(j,ae);null!=he&&(w.push(O),D.set(O,he))}}const S=new fi(w);return new Nk(D,S,l.fieldTransforms)}function Ok(n,e,t,r=!1){return zg(t,n.da(r?4:3,e))}function zg(n,e){if(Lk(n=(0,P.m9)(n)))return Gx("Unsupported field value:",e,n),Fk(n,e);if(n instanceof Gg)return function(t,r){if(!kk(r.sa))throw r.ha(`${t._methodName}() can only be used with update() and set()`);if(!r.path)throw r.ha(`${t._methodName}() is not currently supported inside arrays`);const i=t._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.oa&&4!==e.sa)throw e.ha("Nested arrays are not supported");return function(t,r){const i=[];let a=0;for(const l of t){let d=zg(l,r.aa(a));null==d&&(d={nullValue:"NULL_VALUE"}),i.push(d),a++}return{arrayValue:{values:i}}}(n,e)}return function(t,r){if(null===(t=(0,P.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return f0(r.It,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const i=Vn.fromDate(t);return{timestampValue:Ig(r.It,i)}}if(t instanceof Vn){const i=new Vn(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Ig(r.It,i)}}if(t instanceof xD)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof dc)return{bytesValue:IA(r.It,t._byteString)};if(t instanceof tr){const i=r.databaseId,a=t.firestore._databaseId;if(!a.isEqual(i))throw r.ha(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:$_(t.firestore._databaseId||r.databaseId,t._key.path)}}throw r.ha(`Unsupported field value: ${bD(t)}`)}(n,e)}function Fk(n,e){const t={};return nb(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):kd(n,(r,i)=>{const a=zg(i,e.ra(r));null!=a&&(t[r]=a)}),{mapValue:{fields:t}}}function Lk(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Vn||n instanceof xD||n instanceof dc||n instanceof tr||n instanceof Gg)}function Gx(n,e,t){if(!Lk(t)||"object"!=typeof(r=t)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r)){const r=bD(t);throw e.ha("an object"===r?n+" a custom object":n+" "+r)}var r}function Wx(n,e,t){if((e=(0,P.m9)(e))instanceof Yd)return e._internalPath;if("string"==typeof e)return ND(n,e);throw kD("Field path arguments must be of type string or ",n,!1,void 0,t)}const iU=new RegExp("[~\\*/\\[\\]]");function ND(n,e,t){if(e.search(iU)>=0)throw kD(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Yd(...e.split("."))._internalPath}catch{throw kD(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function kD(n,e,t,r,i){const a=r&&!r.isEmpty(),l=void 0!==i;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let _="";return(a||l)&&(_+=" (found",a&&(_+=` in field ${r}`),l&&(_+=` in document ${i}`),_+=")"),new Ne(de.INVALID_ARGUMENT,d+n+_)}function Vk(n,e){return n.some(t=>t.isEqual(e))}class yE{constructor(e,t,r,i,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new tr(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new sU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(PD("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class sU extends yE{data(){return super.data()}}function PD(n,e){return"string"==typeof e?ND(n,e):e instanceof Yd?e._internalPath:e._delegate._internalPath}function Uk(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new Ne(de.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class vE{}function Rf(n,...e){for(const t of e)n=t._apply(n);return n}class oU extends vE{constructor(e,t,r){super(),this.ma=e,this.ga=t,this.ya=r,this.type="where"}_apply(e){const t=Wg(e.firestore),r=function(i,a,l,d,_,w,D){let S;if(_.isKeyField()){if("array-contains"===w||"array-contains-any"===w)throw new Ne(de.INVALID_ARGUMENT,`Invalid Query. You can't perform '${w}' queries on documentId().`);if("in"===w||"not-in"===w){Wk(D,w);const O=[];for(const j of D)O.push(Gk(d,i,j));S={arrayValue:{values:O}}}else S=Gk(d,i,D)}else"in"!==w&&"not-in"!==w&&"array-contains-any"!==w||Wk(D,w),S=Ok(l,"where",D,"in"===w||"not-in"===w);const M=gi.create(_,w,S);return function(O,j){if(j.dt()){const he=u0(O);if(null!==he&&!he.isEqual(j.field))throw new Ne(de.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${he.toString()}' and '${j.field.toString()}'`);const $e=hg(O);null!==$e&&zk(0,j.field,$e)}const ae=function(he,$e){for(const nt of he.filters)if($e.indexOf(nt.op)>=0)return nt.op;return null}(O,function(he){switch(he){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(j.op));if(null!==ae)throw new Ne(de.INVALID_ARGUMENT,ae===j.op?`Invalid query. You cannot use more than one '${j.op.toString()}' filter.`:`Invalid query. You cannot use '${j.op.toString()}' filters with '${ae.toString()}' filters.`)}(i,M),M}(e._query,0,t,e.firestore._databaseId,this.ma,this.ga,this.ya);return new ts(e.firestore,e.converter,function(i,a){const l=i.filters.concat([a]);return new Lu(i.path,i.collectionGroup,i.explicitOrderBy.slice(),l,i.limit,i.limitType,i.startAt,i.endAt)}(e._query,r))}}class uU extends vE{constructor(e,t){super(),this.ma=e,this.pa=t,this.type="orderBy"}_apply(e){const t=function(r,i,a){if(null!==r.startAt)throw new Ne(de.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==r.endAt)throw new Ne(de.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const l=new ff(i,a);return function(d,_){if(null===hg(d)){const w=u0(d);null!==w&&zk(0,w,_.field)}}(r,l),l}(e._query,this.ma,this.pa);return new ts(e.firestore,e.converter,function(r,i){const a=r.explicitOrderBy.concat([i]);return new Lu(r.path,r.collectionGroup,a,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,t))}}class Bk extends vE{constructor(e,t,r){super(),this.type=e,this.Ia=t,this.Ta=r}_apply(e){return new ts(e.firestore,e.converter,fg(e._query,this.Ia,this.Ta))}}class jk extends vE{constructor(e,t,r){super(),this.type=e,this.Ea=t,this.Aa=r}_apply(e){const t=$k(e,this.type,this.Ea,this.Aa);return new ts(e.firestore,e.converter,(i=t,new Lu((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,i,r.endAt)));var r,i}}class Hk extends vE{constructor(e,t,r){super(),this.type=e,this.Ea=t,this.Aa=r}_apply(e){const t=$k(e,this.type,this.Ea,this.Aa);return new ts(e.firestore,e.converter,(i=t,new Lu((r=e._query).path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,i)));var r,i}}function $k(n,e,t,r){if(t[0]=(0,P.m9)(t[0]),t[0]instanceof yE)return function(i,a,l,d,_){if(!d)throw new Ne(de.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const w=[];for(const D of Xl(i))if(D.field.isKeyField())w.push(Ld(a,d.key));else{const S=d.data.field(D.field);if(Jw(S))throw new Ne(de.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+D.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===S){const M=D.field.canonicalString();throw new Ne(de.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${M}' (used as the orderBy) does not exist.`)}w.push(S)}return new Ql(w,_)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=Wg(n.firestore);return function(a,l,d,_,w,D){const S=a.explicitOrderBy;if(w.length>S.length)throw new Ne(de.INVALID_ARGUMENT,`Too many arguments provided to ${_}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const M=[];for(let O=0;O<w.length;O++){const j=w[O];if(S[O].field.isKeyField()){if("string"!=typeof j)throw new Ne(de.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${_}(), but got a ${typeof j}`);if(!l0(a)&&-1!==j.indexOf("/"))throw new Ne(de.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${_}() must be a plain document ID, but '${j}' contains a slash.`);const ae=a.path.child(sn.fromString(j));if(!qe.isDocumentKey(ae))throw new Ne(de.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${_}() must result in a valid document path, but '${ae}' is not because it contains an odd number of segments.`);const he=new qe(ae);M.push(Ld(l,he))}else{const ae=Ok(d,_,j);M.push(ae)}}return new Ql(M,D)}(n._query,n.firestore._databaseId,i,e,t,r)}}function Gk(n,e,t){if("string"==typeof(t=(0,P.m9)(t))){if(""===t)throw new Ne(de.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!l0(e)&&-1!==t.indexOf("/"))throw new Ne(de.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(sn.fromString(t));if(!qe.isDocumentKey(r))throw new Ne(de.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ld(n,new qe(r))}if(t instanceof tr)return Ld(n,t._key);throw new Ne(de.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bD(t)}.`)}function Wk(n,e){if(!Array.isArray(n)||0===n.length)throw new Ne(de.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(n.length>10)throw new Ne(de.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function zk(n,e,t){if(!t.isEqual(e))throw new Ne(de.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class zx{convertValue(e,t="none"){switch(Fd(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Xn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Zl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw ot()}}convertObject(e,t){const r={};return kd(e.fields,(i,a)=>{r[i]=this.convertValue(a,t)}),r}convertGeoPoint(e){return new xD(Xn(e.latitude),Xn(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Xw(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(lg(e));default:return null}}convertTimestamp(e){const t=Ou(e);return new Vn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=sn.fromString(e);Rt(wf(r));const i=new Pd(r.get(1),r.get(3)),a=new qe(r.popFirst(5));return i.isEqual(t)||vr(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}function OD(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class mU extends zx{constructor(e){super(),this.firestore=e}convertBytes(e){return new dc(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new tr(this.firestore,null,t)}}class qg{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Qd extends yE{constructor(e,t,r,i,a,l){super(e,t,r,i,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new wE(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(PD("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class wE extends Qd{data(e={}){return super.data(e)}}class Mf{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new qg(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new wE(this._firestore,this._userDataWriter,r.key,r,new qg(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ne(de.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let a=0;return r._snapshot.docChanges.map(l=>({type:"added",doc:new wE(r._firestore,r._userDataWriter,l.doc.key,l.doc,new qg(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:a++}))}{let a=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>i||3!==l.type).map(l=>{const d=new wE(r._firestore,r._userDataWriter,l.doc.key,l.doc,new qg(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let _=-1,w=-1;return 0!==l.type&&(_=a.indexOf(l.doc.key),a=a.delete(l.doc.key)),1!==l.type&&(a=a.add(l.doc),w=a.indexOf(l.doc.key)),{type:_U(l.type),doc:d,oldIndex:_,newIndex:w}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function _U(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ot()}}function qk(n,e){return n instanceof Qd&&e instanceof Qd?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Mf&&e instanceof Mf&&n._firestore===e._firestore&&Mx(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class Nf extends zx{constructor(e){super(),this.firestore=e}convertBytes(e){return new dc(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new tr(this.firestore,null,t)}}function Kk(n,e,t){n=un(n,tr);const r=un(n.firestore,nr),i=OD(n.converter,e,t);return my(r,[MD(Wg(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,er.none())])}function Zk(n,e,t,...r){n=un(n,tr);const i=un(n.firestore,nr),a=Wg(i);let l;return l="string"==typeof(e=(0,P.m9)(e))||e instanceof Yd?$x(a,"updateDoc",n._key,e,t,r):Hx(a,"updateDoc",n._key,e),my(i,[l.toMutation(n._key,er.exists(!0))])}function Yk(n,...e){var t,r,i;n=(0,P.m9)(n);let a={includeMetadataChanges:!1},l=0;"object"!=typeof e[l]||Bx(e[l])||(a=e[l],l++);const d={includeMetadataChanges:a.includeMetadataChanges};if(Bx(e[l])){const S=e[l];e[l]=null===(t=S.next)||void 0===t?void 0:t.bind(S),e[l+1]=null===(r=S.error)||void 0===r?void 0:r.bind(S),e[l+2]=null===(i=S.complete)||void 0===i?void 0:i.bind(S)}let _,w,D;if(n instanceof tr)w=un(n.firestore,nr),D=Jl(n._key.path),_={next:S=>{e[l]&&e[l](qx(w,n,S))},error:e[l+1],complete:e[l+2]};else{const S=un(n,ts);w=un(S.firestore,nr),D=S._query;const M=new Nf(w);_={next:O=>{e[l]&&e[l](new Mf(w,M,S,O))},error:e[l+1],complete:e[l+2]},Uk(n._query)}return function(S,M,O,j){const ae=new TD(j),he=new rx(M,ae,O);return S.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){return Bg(yield gy(S),he)})),()=>{ae.bc(),S.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){return Hg(yield gy(S),he)}))}}(Hr(w),D,d,_)}function my(n,e){return function(t,r){const i=new Br;return t.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){return function cV(n,e,t){return ux.apply(this,arguments)}(yield Vx(t),r,i)})),i.promise}(Hr(n),e)}function qx(n,e,t){const r=t.docs.get(e._key),i=new Nf(n);return new Qd(n,i,e._key,r,new qg(t.hasPendingWrites,t.fromCache),e.converter)}const SU={maxAttempts:5};class Qk{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Wg(e)}set(e,t,r){this._verifyNotCommitted();const i=kf(e,this._firestore),a=OD(i.converter,t,r),l=MD(this._dataReader,"WriteBatch.set",i._key,a,null!==i.converter,r);return this._mutations.push(l.toMutation(i._key,er.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const a=kf(e,this._firestore);let l;return l="string"==typeof(t=(0,P.m9)(t))||t instanceof Yd?$x(this._dataReader,"WriteBatch.update",a._key,t,r,i):Hx(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(l.toMutation(a._key,er.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=kf(e,this._firestore);return this._mutations=this._mutations.concat(new Na(t._key,er.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ne(de.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function kf(n,e){if((n=(0,P.m9)(n)).firestore!==e)throw new Ne(de.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class AU extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Wg(e)}get(e){const t=kf(e,this._firestore),r=new mU(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||1!==i.length)return ot();const a=i[0];if(a.isFoundDocument())return new yE(this._firestore,r,a.key,a,t.converter);if(a.isNoDocument())return new yE(this._firestore,r,t._key,null,t.converter);throw ot()})}set(e,t,r){const i=kf(e,this._firestore),a=OD(i.converter,t,r),l=MD(this._dataReader,"Transaction.set",i._key,a,null!==i.converter,r);return this._transaction.set(i._key,l),this}update(e,t,r,...i){const a=kf(e,this._firestore);let l;return l="string"==typeof(t=(0,P.m9)(t))||t instanceof Yd?$x(this._dataReader,"Transaction.update",a._key,t,r,i):Hx(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,l),this}delete(e){const t=kf(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=kf(e,this._firestore),r=new Nf(this._firestore);return super.get(e).then(i=>new Qd(this._firestore,r,t._key,i._document,new qg(!1,!1),t.converter))}}function Kx(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Ne("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function Xk(){if(typeof Uint8Array>"u")throw new Ne("unimplemented","Uint8Arrays are not available in this environment.")}function eP(){if(!function sA(){return typeof atob<"u"}())throw new Ne("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(n,e=!0){Ad=Qi.SDK_VERSION,(0,Qi._registerComponent)(new Xs.wA("firestore",(t,{instanceIdentifier:r,options:i})=>{const a=t.getProvider("app").getImmediate(),l=new nr(new XS(t.getProvider("auth-internal")),new qC(t.getProvider("app-check-internal")),function(d,_){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new Ne(de.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Pd(d.options.projectId,_)}(a,r),a);return i=Object.assign({useFetchStreams:e},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),(0,Qi.registerVersion)(Gw,"3.7.3",n),(0,Qi.registerVersion)(Gw,"3.7.3","esm2017")}();class EE{constructor(e){this._delegate=e}static fromBase64String(e){return eP(),new EE(dc.fromBase64String(e))}static fromUint8Array(e){return Xk(),new EE(dc.fromUint8Array(e))}toBase64(){return eP(),this._delegate.toBase64()}toUint8Array(){return Xk(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Zx(n){return function LU(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class VU{enableIndexedDbPersistence(e,t){return function GV(n,e){Mk(n=un(n,nr));const t=Hr(n),r=n._freezeSettings(),i=new xx;return Rk(t,i,new hk(i,r.cacheSizeBytes,e?.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function WV(n){Mk(n=un(n,nr));const e=Hr(n),t=n._freezeSettings(),r=new xx;return Rk(e,r,new TV(r,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function zV(n){if(n._initialized&&!n._terminated)throw new Ne(de.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Br;return n._queue.enqueueAndForgetEvenWhileRestricted((0,ve.Z)(function*(){try{yield(t=(0,ve.Z)(function*(r){if(!so.C())return Promise.resolve();const i=r+"main";yield so.delete(i)}),function(r){return t.apply(this,arguments)})(uy(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class tP{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Pd||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&xd("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function vk(n,e,t,r={}){var i;const a=(n=un(n,mE))._getSettings();if("firestore.googleapis.com"!==a.host&&a.host!==e&&xd("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},a),{host:`${e}:${t}`,ssl:!1})),r.mockUserToken){let l,d;if("string"==typeof r.mockUserToken)l=r.mockUserToken,d=Ur.MOCK_USER;else{l=(0,P.Sg)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const _=r.mockUserToken.sub||r.mockUserToken.user_id;if(!_)throw new Ne(de.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Ur(_)}n._authCredentials=new JS(new WC(l,d))}}(this._delegate,e,t,r)}enableNetwork(){return function KV(n){return function PV(n){return n.asyncQueue.enqueue((0,ve.Z)(function*(){const e=yield Dk(n),t=yield Lx(n);return e.setNetworkEnabled(!0),function(r){const i=Ke(r);return i._u.delete(0),Af(i)}(t)}))}(Hr(n=un(n,nr)))}(this._delegate)}disableNetwork(){return function ZV(n){return function OV(n){return n.asyncQueue.enqueue((0,ve.Z)(function*(){const e=yield Dk(n),t=yield Lx(n);return e.setNetworkEnabled(!1),(r=(0,ve.Z)(function*(i){const a=Ke(i);a._u.add(0),yield xf(a),a.gu.set("Offline")}),function(i){return r.apply(this,arguments)})(t);var r}))}(Hr(n=un(n,nr)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,fk("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function qV(n){return function(e){const t=new Br;return e.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){return function pV(n,e){return fx.apply(this,arguments)}(yield Vx(e),t)})),t.promise}(Hr(n=un(n,nr)))}(this._delegate)}onSnapshotsInSync(e){return function TU(n,e){return function VV(n,e){const t=new TD(e);return n.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){return r=yield gy(n),i=t,Ke(r).Ru.add(i),void i.next();var r,i})),()=>{t.bc(),n.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){return r=yield gy(n),i=t,void Ke(r).Ru.delete(i);var r,i}))}}(Hr(n=un(n,nr)),Bx(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new Ne("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new _y(this,wk(this._delegate,e))}catch(t){throw Ss(t,"collection()","Firestore.collection()")}}doc(e){try{return new Va(this,DD(this._delegate,e))}catch(t){throw Ss(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new As(this,function SV(n,e){if(n=un(n,mE),Rx("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new Ne(de.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new ts(n,null,(t=e,new Lu(sn.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw Ss(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function xU(n,e,t){n=un(n,nr);const r=Object.assign(Object.assign({},SU),t);return function(i){if(i.maxAttempts<1)throw new Ne(de.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(i,a,l){const d=new Br;return i.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){const _=yield function Tk(n){return SD(n).then(e=>e.datastore)}(i);new NV(i.asyncQueue,_,l,a,d).run()})),d.promise}(Hr(n),i=>e(new AU(n,i)),r)}(this._delegate,t=>e(new nP(this,t)))}batch(){return Hr(this._delegate),new rP(new Qk(this._delegate,e=>my(this._delegate,e)))}loadBundle(e){return function YV(n,e){const t=Hr(n=un(n,nr)),r=new HV;return function UV(n,e,t,r){const i=function(a,l){let d;return d="string"==typeof a?(new TextEncoder).encode(a):a,_=function(_,w){if(_ instanceof Uint8Array)return Ik(_,w);if(_ instanceof ArrayBuffer)return Ik(new Uint8Array(_),w);if(_ instanceof ReadableStream)return _.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(d),new AV(_,l);var _}(t,Vg(e));n.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){!function DV(n,e,t){const r=Ke(n);var i;(i=(0,ve.Z)(function*(a,l,d){try{const _=yield l.getMetadata();if(yield function(M,O){const j=Ke(M),ae=xr(O.createTime);return j.persistence.runTransaction("hasNewerBundle","readonly",he=>j.Ns.getBundleMetadata(he,O.id)).then(he=>!!he&&he.createTime.compareTo(ae)>=0)}(a.localStore,_))return yield l.close(),d._completeWith({taskState:"Success",documentsLoaded:(M=_).totalDocuments,bytesLoaded:M.totalBytes,totalDocuments:M.totalDocuments,totalBytes:M.totalBytes}),Promise.resolve(new Set);d._updateProgress(nk(_));const w=new iV(_,a.localStore,l.It);let D=yield l.mc();for(;D;){const M=yield w.Fu(D);M&&d._updateProgress(M),D=yield l.mc()}const S=yield w.complete();return yield Zd(a,S.Lu,void 0),yield function(M,O){const j=Ke(M);return j.persistence.runTransaction("Save bundle","readwrite",ae=>j.Ns.saveBundleMetadata(ae,O))}(a.localStore,_),d._completeWith(S.progress),Promise.resolve(S.Bu)}catch(_){return xd("SyncEngine",`Loading bundle failed with ${_}`),d._failWith(_),Promise.resolve(new Set)}var M}),function(a,l,d){return i.apply(this,arguments)})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield Vx(n),i,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function QV(n,e){return function BV(n,e){return n.asyncQueue.enqueue((0,ve.Z)(function*(){return function(t,r){const i=Ke(t);return i.persistence.runTransaction("Get named query","readonly",a=>i.Ns.getNamedQuery(a,r))}(yield AD(n),e)}))}(Hr(n=un(n,nr)),e).then(t=>t?new ts(n,null,t.query):null)}(this._delegate,e).then(t=>t?new As(this,t):null)}}class FD extends zx{constructor(e){super(),this.firestore=e}convertBytes(e){return new EE(new dc(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Va.forKey(t,this.firestore,null)}}class nP{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new FD(e)}get(e){const t=Zg(e);return this._delegate.get(t).then(r=>new IE(this._firestore,new Qd(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=Zg(e);return r?(Kx("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=Zg(e);return 2===arguments.length?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=Zg(e);return this._delegate.delete(t),this}}class rP{constructor(e){this._delegate=e}set(e,t,r){const i=Zg(e);return r?(Kx("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const a=Zg(e);return 2===arguments.length?this._delegate.update(a,t):this._delegate.update(a,t,r,...i),this}delete(e){const t=Zg(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Kg{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new wE(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new CE(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Kg.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let a=i.get(t);return a||(a=new Kg(e,new FD(e),t),i.set(t,a)),a}}Kg.INSTANCES=new WeakMap;class Va{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new FD(e)}static forPath(e,t,r){if(e.length%2!=0)throw new Ne("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Va(t,new tr(t._delegate,r,new qe(e)))}static forKey(e,t,r){return new Va(t,new tr(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new _y(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new _y(this.firestore,wk(this._delegate,e))}catch(t){throw Ss(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,P.m9)(e))instanceof tr&&Ek(this._delegate,e)}set(e,t){t=Kx("DocumentReference.set",t);try{return t?Kk(this._delegate,e,t):Kk(this._delegate,e)}catch(r){throw Ss(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?Zk(this._delegate,e):Zk(this._delegate,e,t,...r)}catch(i){throw Ss(i,"updateDoc()","DocumentReference.update()")}}delete(){return function bU(n){return my(un(n.firestore,nr),[new Na(n._key,er.none())])}(this._delegate)}onSnapshot(...e){const t=iP(e),r=sP(e,i=>new IE(this.firestore,new Qd(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Yk(this._delegate,t,r)}get(e){let t;return t="cache"===e?.source?function vU(n){n=un(n,tr);const e=un(n.firestore,nr),t=Hr(e),r=new Nf(e);return function FV(n,e){const t=new Br;return n.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){return(r=(0,ve.Z)(function*(i,a,l){try{const d=yield function(_,w){const D=Ke(_);return D.persistence.runTransaction("read document","readonly",S=>D.localDocuments.getDocument(S,w))}(i,a);d.isFoundDocument()?l.resolve(d):d.isNoDocument()?l.resolve(null):l.reject(new Ne(de.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(d){const _=Xt(d,`Failed to get document '${a} from cache`);l.reject(_)}}),function(i,a,l){return r.apply(this,arguments)})(yield AD(n),e,t);var r})),t.promise}(t,n._key).then(i=>new Qd(e,r,n._key,i,new qg(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function wU(n){n=un(n,tr);const e=un(n.firestore,nr);return Sk(Hr(e),n._key,{source:"server"}).then(t=>qx(e,n,t))}(this._delegate):function yU(n){n=un(n,tr);const e=un(n.firestore,nr);return Sk(Hr(e),n._key).then(t=>qx(e,n,t))}(this._delegate),t.then(r=>new IE(this.firestore,new Qd(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Va(this.firestore,this._delegate.withConverter(e?Kg.getInstance(this.firestore,e):null))}}function Ss(n,e,t){return n.message=n.message.replace(e,t),n}function iP(n){for(const e of n)if("object"==typeof e&&!Zx(e))return e;return{}}function sP(n,e){var t,r;let i;return i=Zx(n[0])?n[0]:Zx(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:a=>{i.next&&i.next(e(a))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class IE{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Va(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return qk(this._delegate,e._delegate)}}class CE extends IE{data(e){const t=this._delegate.data(e);return function YS(n,e){n||ot()}(void 0!==t),t}}class As{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new FD(e)}where(e,t,r){try{return new As(this.firestore,Rf(this._delegate,function aU(n,e,t){const r=e,i=PD("where",n);return new oU(i,r,t)}(e,t,r)))}catch(i){throw Ss(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new As(this.firestore,Rf(this._delegate,function lU(n,e="asc"){const t=e,r=PD("orderBy",n);return new uU(r,t)}(e,t)))}catch(r){throw Ss(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new As(this.firestore,Rf(this._delegate,function cU(n){return mk("limit",n),new Bk("limit",n,"F")}(e)))}catch(t){throw Ss(t,"limit()","Query.limit()")}}limitToLast(e){try{return new As(this.firestore,Rf(this._delegate,function dU(n){return mk("limitToLast",n),new Bk("limitToLast",n,"L")}(e)))}catch(t){throw Ss(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new As(this.firestore,Rf(this._delegate,function hU(...n){return new jk("startAt",n,!0)}(...e)))}catch(t){throw Ss(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new As(this.firestore,Rf(this._delegate,function fU(...n){return new jk("startAfter",n,!1)}(...e)))}catch(t){throw Ss(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new As(this.firestore,Rf(this._delegate,function pU(...n){return new Hk("endBefore",n,!1)}(...e)))}catch(t){throw Ss(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new As(this.firestore,Rf(this._delegate,function gU(...n){return new Hk("endAt",n,!0)}(...e)))}catch(t){throw Ss(t,"endAt()","Query.endAt()")}}isEqual(e){return Mx(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function IU(n){n=un(n,ts);const e=un(n.firestore,nr),t=Hr(e),r=new Nf(e);return function LV(n,e){const t=new Br;return n.asyncQueue.enqueueAndForget((0,ve.Z)(function*(){return(r=(0,ve.Z)(function*(i,a,l){try{const d=yield X0(i,a,!0),_=new sk(a,d.Hi),w=_.Wu(d.documents),D=_.applyChanges(w,!1);l.resolve(D.snapshot)}catch(d){const _=Xt(d,`Failed to execute query '${a} against cache`);l.reject(_)}}),function(i,a,l){return r.apply(this,arguments)})(yield AD(n),e,t);var r})),t.promise}(t,n._query).then(i=>new Mf(e,r,n,i))}(this._delegate):"server"===e?.source?function CU(n){n=un(n,ts);const e=un(n.firestore,nr),t=Hr(e),r=new Nf(e);return Ak(t,n._query,{source:"server"}).then(i=>new Mf(e,r,n,i))}(this._delegate):function EU(n){n=un(n,ts);const e=un(n.firestore,nr),t=Hr(e),r=new Nf(e);return Uk(n._query),Ak(t,n._query).then(i=>new Mf(e,r,n,i))}(this._delegate),t.then(r=>new Yx(this.firestore,new Mf(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=iP(e),r=sP(e,i=>new Yx(this.firestore,new Mf(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Yk(this._delegate,t,r)}withConverter(e){return new As(this.firestore,this._delegate.withConverter(e?Kg.getInstance(this.firestore,e):null))}}class BU{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new CE(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Yx{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new As(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new CE(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new BU(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new CE(this._firestore,r))})}isEqual(e){return qk(this._delegate,e._delegate)}}class _y extends As{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Va(this.firestore,e):null}doc(e){try{return new Va(this.firestore,void 0===e?DD(this._delegate):DD(this._delegate,e))}catch(t){throw Ss(t,"doc()","CollectionReference.doc()")}}add(e){return function DU(n,e){const t=un(n.firestore,nr),r=DD(n),i=OD(n.converter,e);return my(t,[MD(Wg(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,er.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new Va(this.firestore,t))}isEqual(e){return Ek(this._delegate,e._delegate)}withConverter(e){return new _y(this.firestore,this._delegate.withConverter(e?Kg.getInstance(this.firestore,e):null))}}function Zg(n){return un(n,tr)}class Qx{constructor(...e){this._delegate=new Yd(...e)}static documentId(){return new Qx(cr.keyField().canonicalString())}isEqual(e){return(e=(0,P.m9)(e))instanceof Yd&&this._delegate._internalPath.isEqual(e._internalPath)}}class Yg{constructor(e){this._delegate=e}static serverTimestamp(){const e=function MU(){return new jx("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Yg(e)}static delete(){const e=function RU(){return new _E("deleteField")}();return e._methodName="FieldValue.delete",new Yg(e)}static arrayUnion(...e){const t=function NU(...n){return new tU("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new Yg(t)}static arrayRemove(...e){const t=function kU(...n){return new nU("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new Yg(t)}static increment(e){const t=function PU(n){return new rU("increment",n)}(e);return t._methodName="FieldValue.increment",new Yg(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const jU={Firestore:tP,GeoPoint:xD,Timestamp:Vn,Blob:EE,Transaction:nP,WriteBatch:rP,DocumentReference:Va,DocumentSnapshot:IE,Query:As,QueryDocumentSnapshot:CE,QuerySnapshot:Yx,CollectionReference:_y,FieldPath:Qx,FieldValue:Yg,setLogLevel:function UU(n){!function GC(n){Mu.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};!function $U(n){(function HU(n,e){n.INTERNAL.registerComponent(new Xs.wA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},jU)))})(n,(e,t)=>new tP(e,t,new VU)),n.registerVersion("@firebase/firestore-compat","0.2.3")}(iC.Z);var Jx=V(6451),LD=V(5363),GU=V(6063);class WU extends Zs.x{constructor(e=1/0,t=1/0,r=GU.l){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:a,_windowTime:l}=this;t||(r.push(e),!i&&r.push(a.now()+l)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,a=i.slice();for(let l=0;l<a.length&&!e.closed;l+=r?1:2)e.next(a[l]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,a=(i?1:2)*e;if(e<1/0&&a<r.length&&r.splice(0,r.length-a),!i){const l=t.now();let d=0;for(let _=1;_<r.length&&r[_]<=l;_+=2)d=_;d&&r.splice(0,d+1)}}}var oP=V(3099);function aP(n,e,t){let r,i=!1;return n&&"object"==typeof n?({bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n):r=n??1/0,(0,oP.B)({connector:()=>new WU(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function uP(n,e){return(0,li.m)(e)?Yn(()=>n,e):Yn(()=>n)}var Xx=V(9468);const tR=new Map,lP={activated:!1,tokenObservers:[]},YU={initialized:!1,enabled:!1};function ji(n){return tR.get(n)||Object.assign({},lP)}function UD(){return YU}class nB{constructor(e,t,r,i,a){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=a,this.pending=null,this.nextErrorWaitInterval=i,i>a)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,ve.Z)(function*(){t.stop();try{t.pending=new P.BH,yield function rB(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new P.BH,yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(r){t.retryPolicy(r)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const xs=new P.LL("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function dP(n){if(!ji(n).activated)throw xs.create("use-before-activation",{appName:n.name})}function iR(n,e){return sR.apply(this,arguments)}function sR(){return sR=(0,ve.Z)(function*({url:n,body:e},t){var r,i;const a={"Content-Type":"application/json"},l=t.getImmediate({optional:!0});if(l){const O=yield l.getHeartbeatsHeader();O&&(a["X-Firebase-Client"]=O)}const d={method:"POST",body:JSON.stringify(e),headers:a};let _,w;try{_=yield fetch(n,d)}catch(O){throw xs.create("fetch-network-error",{originalErrorMessage:null===(r=O)||void 0===r?void 0:r.message})}if(200!==_.status)throw xs.create("fetch-status-error",{httpStatus:_.status});try{w=yield _.json()}catch(O){throw xs.create("fetch-parse-error",{originalErrorMessage:null===(i=O)||void 0===i?void 0:i.message})}const D=w.ttl.match(/^([\d.]+)(s)$/);if(!D||!D[2]||isNaN(Number(D[1])))throw xs.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${w.ttl}`});const S=1e3*Number(D[1]),M=Date.now();return{token:w.token,expireTimeMillis:M+S,issuedAtTimeMillis:M}}),sR.apply(this,arguments)}function aB(n,e){const{projectId:t,appId:r,apiKey:i}=n.options;return{url:`https://content-firebaseappcheck.googleapis.com/v1/projects/${t}/apps/${r}:exchangeDebugToken?key=${i}`,body:{debug_token:e}}}const bE="firebase-app-check-store";let HD=null;function fP(){return HD||(HD=new Promise((n,e)=>{var t;try{const r=indexedDB.open("firebase-app-check-database",1);r.onsuccess=i=>{n(i.target.result)},r.onerror=i=>{var a;e(xs.create("storage-open",{originalErrorMessage:null===(a=i.target.error)||void 0===a?void 0:a.message}))},r.onupgradeneeded=i=>{0===i.oldVersion&&i.target.result.createObjectStore(bE,{keyPath:"compositeKey"})}}catch(r){e(xs.create("storage-open",{originalErrorMessage:null===(t=r)||void 0===t?void 0:t.message}))}}),HD)}function oR(){return oR=(0,ve.Z)(function*(n,e){const r=(yield fP()).transaction(bE,"readwrite"),a=r.objectStore(bE).put({compositeKey:n,value:e});return new Promise((l,d)=>{a.onsuccess=_=>{l()},r.onerror=_=>{var w;d(xs.create("storage-set",{originalErrorMessage:null===(w=_.target.error)||void 0===w?void 0:w.message}))}})}),oR.apply(this,arguments)}const DE=new eo.Yd("@firebase/app-check");function lR(n,e){return(0,P.hl)()?function dB(n,e){return function pP(n,e){return oR.apply(this,arguments)}(function mP(n){return`${n.options.appId}-${n.name}`}(n),e)}(n,e).catch(t=>{DE.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function _P(){return UD().enabled}function yP(){return dR.apply(this,arguments)}function dR(){return dR=(0,ve.Z)(function*(){const n=UD();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")}),dR.apply(this,arguments)}const _B={error:"UNKNOWN_ERROR"};function yB(n){return P.US.encodeString(JSON.stringify(n),!1)}function $D(n){return hR.apply(this,arguments)}function hR(){return hR=(0,ve.Z)(function*(n,e=!1){const t=n.app;dP(t);const r=ji(t);let a,i=r.token;if(i&&!yy(i)&&(r.token=void 0,i=void 0),!i){const _=yield r.cachedTokenPromise;_&&(yy(_)?i=_:yield lR(t,void 0))}if(!e&&i&&yy(i))return{token:i.token};let d,l=!1;if(_P()){r.exchangeTokenPromise||(r.exchangeTokenPromise=iR(aB(t,yield yP()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),l=!0);const _=yield r.exchangeTokenPromise;return yield lR(t,_),r.token=_,{token:_.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),l=!0),i=yield ji(t).exchangeTokenPromise}catch(_){"appCheck/throttled"===_.code?DE.warn(_.message):DE.error(_),a=_}return i?a?d=yy(i)?{token:i.token,internalError:a}:EP(a):(d={token:i.token},r.token=i,yield lR(t,i)):d=EP(a),l&&wP(t,d),d}),hR.apply(this,arguments)}function pR(n,e){const t=ji(n),r=t.tokenObservers.filter(i=>i.next!==e);0===r.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function vP(n){const{app:e}=n,t=ji(e);let r=t.tokenRefresher;r||(r=function vB(n){const{app:e}=n;return new nB((0,ve.Z)(function*(){let r;if(r=ji(e).token?yield $D(n,!0):yield $D(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{const t=ji(e);if(t.token){let r=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,t.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},3e4,96e4)}(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function wP(n,e){const t=ji(n).tokenObservers;for(const r of t)try{"EXTERNAL"===r.type&&null!=e.error?r.error(e.error):r.next(e)}catch{}}function yy(n){return n.expireTimeMillis-Date.now()>0}function EP(n){return{token:yB(_B),error:n}}class wB{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=ji(this.app);for(const t of e)pR(this.app,t.next);return Promise.resolve()}}const xP="app-check-internal";!function PB(){(0,Qi._registerComponent)(new Xs.wA("app-check",n=>function EB(n,e){return new wB(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(xP).initialize()})),(0,Qi._registerComponent)(new Xs.wA(xP,n=>function IB(n){return{getToken:e=>$D(n,e),addTokenListener:e=>function fR(n,e,t,r){const{app:i}=n,a=ji(i);if(a.tokenObservers=[...a.tokenObservers,{next:t,error:r,type:e}],a.token&&yy(a.token)){const d=a.token;Promise.resolve().then(()=>{t({token:d.token}),vP(n)}).catch(()=>{})}a.cachedTokenPromise.then(()=>vP(n))}(n,"INTERNAL",e),removeTokenListener:e=>pR(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),(0,Qi.registerVersion)("@firebase/app-check","0.5.17")}();class TE{constructor(){return(0,gn.vb)("app-check")}}typeof window<"u"&&window;var WD=V(127);const vR=new f.OlP("angularfire2.auth.use-emulator"),wR=new f.OlP("angularfire2.auth.settings"),ER=new f.OlP("angularfire2.auth.tenant-id"),IR=new f.OlP("angularfire2.auth.langugage-code"),CR=new f.OlP("angularfire2.auth.use-device-language"),bR=new f.OlP("angularfire.auth.persistence"),DR=(n,e,t,r,i,a,l,d)=>(0,Fr.cc)(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const _=e.runOutsideAngular(()=>n.auth());if(t&&_.useEmulator(...t),r&&(_.tenantId=r),_.languageCode=i,a&&_.useDeviceLanguage(),l)for(const[w,D]of Object.entries(l))_.settings[w]=D;return d&&_.setPersistence(d),_},[t,r,i,a,l,d]);let SE=(()=>{class n{constructor(t,r,i,a,l,d,_,w,D,S,M,O){const j=new Zs.x,ae=it(void 0).pipe((0,LD.Q)(l.outsideAngular),Yn(()=>a.runOutsideAngular(()=>Promise.resolve().then(V.bind(V,1277)))),(0,ft.U)(()=>(0,Fr.on)(t,a,r)),(0,ft.U)(he=>DR(he,a,d,w,D,S,_,M)),aP({bufferSize:1,refCount:!1}));if(Dr(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=it(null);else{ae.pipe(ma()).subscribe();const $e=ae.pipe(Yn(at=>at.getRedirectResult().then(St=>St,()=>null)),gn.iC,aP({bufferSize:1,refCount:!1})),nt=ae.pipe(Yn(at=>new Nr.y(St=>({unsubscribe:a.runOutsideAngular(()=>at.onAuthStateChanged(Ot=>St.next(Ot),Ot=>St.error(Ot),()=>St.complete()))})))),et=ae.pipe(Yn(at=>new Nr.y(St=>({unsubscribe:a.runOutsideAngular(()=>at.onIdTokenChanged(Ot=>St.next(Ot),Ot=>St.error(Ot),()=>St.complete()))}))));this.authState=$e.pipe(uP(nt),(0,Xx.R)(l.outsideAngular),(0,LD.Q)(l.insideAngular)),this.user=$e.pipe(uP(et),(0,Xx.R)(l.outsideAngular),(0,LD.Q)(l.insideAngular)),this.idToken=this.user.pipe(Yn(at=>at?(0,zt.D)(at.getIdToken()):it(null))),this.idTokenResult=this.user.pipe(Yn(at=>at?(0,zt.D)(at.getIdTokenResult()):it(null))),this.credential=(0,Jx.T)($e,j,this.authState.pipe(kr(at=>!at))).pipe((0,ft.U)(at=>at?.user?at:null),(0,Xx.R)(l.outsideAngular),(0,LD.Q)(l.insideAngular))}return(0,Fr.pX)(this,ae,a,{spy:{apply:(he,$e,nt)=>{(he.startsWith("signIn")||he.startsWith("createUser"))&&nt.then(et=>j.next(et))}}})}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Fr.Dh),f.LFG(Fr.xv,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(gn.HU),f.LFG(vR,8),f.LFG(wR,8),f.LFG(ER,8),f.LFG(IR,8),f.LFG(CR,8),f.LFG(bR,8),f.LFG(TE,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),BB=(()=>{class n{constructor(){WD.Z.registerVersion("angularfire",gn.q4.full,"auth-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[SE]}),n})();function MP(n,e){return function jB(n,e=Bp.z){return new Nr.y(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}(n,e)}function TR(n,e){return MP(n,e).pipe((0,ft.U)(t=>({payload:t,type:"query"})))}function zD(n,e){return TR(n,e).pipe(ga(void 0),Gv(),(0,ft.U)(([t,r])=>{const i=r.payload.docChanges(),a=i.map(l=>({type:l.type,payload:l}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((l,d)=>{const _=i.find(D=>D.doc.ref.isEqual(l.ref)),w=t?.payload.docs.find(D=>D.ref.isEqual(l.ref));_&&JSON.stringify(_.doc.metadata)===JSON.stringify(l.metadata)||!_&&w&&JSON.stringify(w.metadata)===JSON.stringify(l.metadata)||a.push({type:"modified",payload:{oldIndex:d,newIndex:d,type:"modified",doc:l}})}),a}))}function NP(n,e,t){return zD(n,t).pipe(_a((r,i)=>function $B(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function GB(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return SR(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return SR(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return SR(n,e.oldIndex,1)}return n}(n,r))}),n}(r,i.map(a=>a.payload),e),[]),rC(),(0,ft.U)(r=>r.map(i=>({type:i.type,payload:i}))))}function SR(n,e,t,...r){const i=n.slice();return i.splice(e,t,...r),i}function kP(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class PP{constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=zD(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,ft.U)(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(ga(void 0),Gv(),kr(([r,i])=>i.length>0||!r),(0,ft.U)(([r,i])=>i),gn.iC)}auditTrail(e){return this.stateChanges(e).pipe(_a((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=kP(e);return NP(this.query,t,this.afs.schedulers.outsideAngular).pipe(gn.iC)}valueChanges(e={}){return TR(this.query,this.afs.schedulers.outsideAngular).pipe((0,ft.U)(t=>t.payload.docs.map(r=>e.idField?Object.assign(Object.assign({},r.data()),{[e.idField]:r.id}):r.data())),gn.iC)}get(e){return(0,zt.D)(this.query.get(e)).pipe(gn.iC)}add(e){return this.ref.add(e)}doc(e){return new OP(this.ref.doc(e),this.afs)}}class OP{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:i,query:a}=VP(r,t);return new PP(i,a,this.afs)}snapshotChanges(){return function HB(n,e){return MP(n,e).pipe(ga(void 0),Gv(),(0,ft.U)(([t,r])=>r.exists?t?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(gn.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,ft.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,zt.D)(this.ref.get(e)).pipe(gn.iC)}}class WB{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?zD(this.query,this.afs.schedulers.outsideAngular).pipe((0,ft.U)(t=>t.filter(r=>e.indexOf(r.type)>-1)),kr(t=>t.length>0),gn.iC):zD(this.query,this.afs.schedulers.outsideAngular).pipe(gn.iC)}auditTrail(e){return this.stateChanges(e).pipe(_a((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=kP(e);return NP(this.query,t,this.afs.schedulers.outsideAngular).pipe(gn.iC)}valueChanges(e={}){return TR(this.query,this.afs.schedulers.outsideAngular).pipe((0,ft.U)(r=>r.payload.docs.map(i=>e.idField?Object.assign({[e.idField]:i.id},i.data()):i.data())),gn.iC)}get(e){return(0,zt.D)(this.query.get(e)).pipe(gn.iC)}}const FP=new f.OlP("angularfire2.enableFirestorePersistence"),LP=new f.OlP("angularfire2.firestore.persistenceSettings"),zB=new f.OlP("angularfire2.firestore.settings"),qB=new f.OlP("angularfire2.firestore.use-emulator");function VP(n,e=(t=>t)){return{query:e(n),ref:n}}let UP=(()=>{class n{constructor(t,r,i,a,l,d,_,w,D,S,M,O,j,ae,he,$e,nt){this.schedulers=_;const et=(0,Fr.on)(t,d,r),at=D;S&&DR(et,d,M,j,ae,he,O,$e),[this.firestore,this.persistenceEnabled$]=(0,Fr.cc)(`${et.name}.firestore`,"AngularFirestore",et.name,()=>{const St=d.runOutsideAngular(()=>et.firestore());if(a&&St.settings(a),at&&St.useEmulator(...at),i&&!Dr(l)){const Ot=()=>{try{return(0,zt.D)(St.enablePersistence(w||void 0).then(()=>!0,()=>!1))}catch(Cr){return typeof console<"u"&&console.warn(Cr),it(!1)}};return[St,d.runOutsideAngular(Ot)]}return[St,it(!1)]},[a,at,i])}collection(t,r){let i;i="string"==typeof t?this.firestore.collection(t):t;const{ref:a,query:l}=VP(i,r),d=this.schedulers.ngZone.run(()=>a);return new PP(d,l,this)}collectionGroup(t,r){const i=r||(l=>l),a=this.firestore.collectionGroup(t);return new WB(i(a),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const i=this.schedulers.ngZone.run(()=>r);return new OP(i,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Fr.Dh),f.LFG(Fr.xv,8),f.LFG(FP,8),f.LFG(zB,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(gn.HU),f.LFG(LP,8),f.LFG(qB,8),f.LFG(SE,8),f.LFG(vR,8),f.LFG(wR,8),f.LFG(ER,8),f.LFG(IR,8),f.LFG(CR,8),f.LFG(bR,8),f.LFG(TE,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),KB=(()=>{class n{constructor(){WD.Z.registerVersion("angularfire",gn.q4.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:FP,useValue:!0},{provide:LP,useValue:t}]}}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[UP]}),n})(),Jd=(()=>{class n{constructor(t,r,i,a,l){this.afs=t,this.afAuth=r,this.router=i,this.ngZone=a,this.http=l,this.defaultProfilePhoto="https://cdn.pixabay.com/photo/2015/10/05/22/37/blank-profile-picture-973460_1280.png",console.log("User id Token at the construction of the service",localStorage.getItem("userIdToken")),this.afAuth.authState.subscribe(d=>{console.log("User info available",d),this.storeIdToken(d.getIdToken()),d?(this.userData=d,localStorage.setItem("user",JSON.stringify(this.userData)),JSON.parse(localStorage.getItem("user"))):(localStorage.setItem("user","null"),JSON.parse(localStorage.getItem("user")))})}canActivate(){return!!this.loggedIn()||(this.router.navigate(["/login"]),!1)}storeIdToken(t){t.then(r=>{localStorage.setItem("userIdToken",r),console.log("Id Token value: ",localStorage.getItem("userIdToken"))})}SignIn(t,r){return this.afAuth.signInWithEmailAndPassword(t,r).then(i=>{console.log("Nice, it worke!",i),window.alert("Successfully logged in!"),this.router.navigate(["/albums"])}).catch(i=>{console.log("Something went wrong",i.message),window.alert("Something went wrong!")})}SignUp(t,r,i){return this.afAuth.createUserWithEmailAndPassword(t,r).then(a=>{console.log("Success! sign up! ",a),console.log("Name in signup = ",i),this.registerUser(t,i),window.alert("Successfully Signed Up!")}).catch(a=>{console.log("Something went wrong:",a.message),window.alert("Something went wrong!")})}registerUser(t,r){return console.log("Name in registration = ",r),this.http.post(Ul_API_BASE_URL+"/api/users",{email:t,id:"",name:r,profilePhotoUrl:this.defaultProfilePhoto}).subscribe(a=>{console.log("Success! registration!"),this.router.navigate(["/albums"])})}loggedIn(){return localStorage.getItem("user")}logOut(){return this.afAuth.signOut().then(()=>{localStorage.clear(),this.router.navigate(["/login"]),window.alert("You have been logged out")})}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(UP),f.LFG(SE),f.LFG(Sr),f.LFG(f.R0b),f.LFG(ys))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),BP=(()=>{class n{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(f.Qsj),f.Y36(f.SBq))},n.\u0275dir=f.lG2({type:n}),n})(),Qg=(()=>{class n extends BP{}return n.\u0275fac=function(){let e;return function(r){return(e||(e=f.n5z(n)))(r||n)}}(),n.\u0275dir=f.lG2({type:n,features:[f.qOj]}),n})();const hc=new f.OlP("NgValueAccessor"),QB={provide:hc,useExisting:(0,f.Gpc)(()=>qD),multi:!0},XB=new f.OlP("CompositionEventMode");let qD=(()=>{class n extends BP{constructor(t,r,i){super(t,r),this._compositionMode=i,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function JB(){const n=F()?F().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(f.Qsj),f.Y36(f.SBq),f.Y36(XB,8))},n.\u0275dir=f.lG2({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,r){1&t&&f.NdJ("input",function(a){return r._handleInput(a.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(a){return r._compositionEnd(a.target.value)})},features:[f._Bn([QB]),f.qOj]}),n})();const ns=new f.OlP("NgValidators"),Of=new f.OlP("NgAsyncValidators");function QP(n){return null!=n}function JP(n){return(0,f.QGY)(n)?(0,zt.D)(n):n}function XP(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function eO(n,e){return e.map(t=>t(n))}function tO(n){return n.map(e=>function n2(n){return!n.validate}(e)?e:t=>e.validate(t))}function AR(n){return null!=n?function nO(n){if(!n)return null;const e=n.filter(QP);return 0==e.length?null:function(t){return XP(eO(t,e))}}(tO(n)):null}function xR(n){return null!=n?function rO(n){if(!n)return null;const e=n.filter(QP);return 0==e.length?null:function(t){return function ZB(...n){const e=(0,ms.jO)(n),{args:t,keys:r}=$y(n),i=new Nr.y(a=>{const{length:l}=t;if(!l)return void a.complete();const d=new Array(l);let _=l,w=l;for(let D=0;D<l;D++){let S=!1;(0,Ml.Xf)(t[D]).subscribe((0,pn.x)(a,M=>{S||(S=!0,w--),d[D]=M},()=>_--,void 0,()=>{(!_||!S)&&(w||a.next(r?pu(r,d):d),a.complete())}))}});return e?i.pipe(up(e)):i}(eO(t,e).map(JP)).pipe((0,ft.U)(XP))}}(tO(n)):null}function iO(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function RR(n){return n?Array.isArray(n)?n:[n]:[]}function ZD(n,e){return Array.isArray(n)?n.includes(e):n===e}function aO(n,e){const t=RR(e);return RR(n).forEach(i=>{ZD(t,i)||t.push(i)}),t}function uO(n,e){return RR(e).filter(t=>!ZD(n,t))}class lO{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=AR(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=xR(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class Rs extends lO{get formDirective(){return null}get path(){return null}}class Ff extends lO{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}let dO=(()=>{class n extends class cO{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(Ff,2))},n.\u0275dir=f.lG2({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,r){2&t&&f.ekj("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[f.qOj]}),n})();const AE="VALID",QD="INVALID",vy="PENDING",xE="DISABLED";function fO(n){return Array.isArray(n)?AR(n):n||null}function pO(n){return Array.isArray(n)?xR(n):n||null}function JD(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}function RE(n,e){(function LR(n,e){const t=function sO(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(iO(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const r=function oO(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(iO(r,e.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const i=()=>n.updateValueAndValidity();tT(e._rawValidators,i),tT(e._rawAsyncValidators,i)})(n,e),e.valueAccessor.writeValue(n.value),n.disabled&&e.valueAccessor.setDisabledState?.(!0),function h2(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&yO(n,e)})}(n,e),function p2(n,e){const t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function f2(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&yO(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function d2(n,e){if(e.valueAccessor.setDisabledState){const t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function tT(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function yO(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function IO(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function CO(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const I2={provide:Ff,useExisting:(0,f.Gpc)(()=>jR)},SO=(()=>Promise.resolve())();let jR=(()=>{class n extends Ff{constructor(t,r,i,a,l){super(),this._changeDetectorRef=l,this.control=new class extends class _O{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=e,this._rawAsyncValidators=t,this._composedValidatorFn=fO(this._rawValidators),this._composedAsyncValidatorFn=pO(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===AE}get invalid(){return this.status===QD}get pending(){return this.status==vy}get disabled(){return this.status===xE}get enabled(){return this.status!==xE}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._rawValidators=e,this._composedValidatorFn=fO(e)}setAsyncValidators(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=pO(e)}addValidators(e){this.setValidators(aO(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(aO(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(uO(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(uO(e,this._rawAsyncValidators))}hasValidator(e){return ZD(this._rawValidators,e)}hasAsyncValidator(e){return ZD(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=vy,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=xE,this.errors=null,this._forEachChild(r=>{r.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=AE,this._forEachChild(r=>{r.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===AE||this.status===vy)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?xE:AE}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=vy,this._hasOwnPendingAsyncValidator=!0;const t=JP(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){const r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new f.vpe,this.statusChanges=new f.vpe}_calculateStatus(){return this._allControlsDisabled()?xE:this.errors?QD:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(vy)?vy:this._anyControlsHaveStatus(QD)?QD:AE}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){JD(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}}{constructor(e=null,t,r){super(function PR(n){return(JD(n)?n.validators:n)||null}(t),function OR(n,e){return(JD(e)?e.asyncValidators:n)||null}(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),JD(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=CO(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){IO(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){IO(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){CO(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},this._registered=!1,this.update=new f.vpe,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=function UR(n,e){if(!e)return null;let t,r,i;return Array.isArray(e),e.forEach(a=>{a.constructor===qD?t=a:function _2(n){return Object.getPrototypeOf(n.constructor)===Qg}(a)?r=a:i=a}),i||r||t||null}(0,a)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function VR(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){RE(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){SO.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const r=t.isDisabled.currentValue,i=0!==r&&(0,f.D6c)(r);SO.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function XD(n,e){return[...e.path,n]}(t,this._parent):[t]}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(Rs,9),f.Y36(ns,10),f.Y36(Of,10),f.Y36(hc,10),f.Y36(f.sBO,8))},n.\u0275dir=f.lG2({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[f._Bn([I2]),f.qOj,f.TTD]}),n})(),xO=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({}),n})(),q2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({imports:[xO]}),n})(),K2=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({imports:[q2]}),n})();function Y2(n,e){if(1&n){const t=f.EpF();f.TgZ(0,"div",2)(1,"ul",3)(2,"li",4)(3,"a",5),f._uU(4,"Sign In"),f.qZA()(),f.TgZ(5,"li",4)(6,"a",6),f.NdJ("click",function(){f.CHM(t);const i=f.oxw();return f.KtG(i.makeSignUpFormVisible())}),f._uU(7,"Sign Up"),f.qZA()()(),f.TgZ(8,"div",7)(9,"label",8),f._uU(10,"Email address"),f.qZA(),f.TgZ(11,"input",9),f.NdJ("ngModelChange",function(i){f.CHM(t);const a=f.oxw();return f.KtG(a.email=i)}),f.qZA(),f.TgZ(12,"small",10),f._uU(13,"We'll never share your email with anyone else."),f.qZA()(),f.TgZ(14,"div",7)(15,"label",11),f._uU(16,"Password"),f.qZA(),f.TgZ(17,"input",12),f.NdJ("ngModelChange",function(i){f.CHM(t);const a=f.oxw();return f.KtG(a.password=i)}),f.qZA()(),f.TgZ(18,"button",13),f.NdJ("click",function(){f.CHM(t);const i=f.oxw();return f.KtG(i.signIn())}),f._uU(19,"Sign In"),f.qZA()()}if(2&n){const t=f.oxw();f.xp6(11),f.Q6J("ngModel",t.email),f.xp6(6),f.Q6J("ngModel",t.password)}}function Q2(n,e){if(1&n){const t=f.EpF();f.TgZ(0,"div",2)(1,"ul",3)(2,"li",4)(3,"a",6),f.NdJ("click",function(){f.CHM(t);const i=f.oxw();return f.KtG(i.makeSignInFormVisible())}),f._uU(4,"Sign In"),f.qZA()(),f.TgZ(5,"li",4)(6,"a",5),f._uU(7,"Sign Up"),f.qZA()()(),f.TgZ(8,"div",7)(9,"label",8),f._uU(10,"Name"),f.qZA(),f.TgZ(11,"input",14),f.NdJ("ngModelChange",function(i){f.CHM(t);const a=f.oxw();return f.KtG(a.name=i)}),f.qZA()(),f.TgZ(12,"div",7)(13,"label",8),f._uU(14,"Email address"),f.qZA(),f.TgZ(15,"input",9),f.NdJ("ngModelChange",function(i){f.CHM(t);const a=f.oxw();return f.KtG(a.email=i)}),f.qZA(),f.TgZ(16,"small",10),f._uU(17,"We'll never share your email with anyone else."),f.qZA()(),f.TgZ(18,"div",7)(19,"label",11),f._uU(20,"Password"),f.qZA(),f.TgZ(21,"input",12),f.NdJ("ngModelChange",function(i){f.CHM(t);const a=f.oxw();return f.KtG(a.password=i)}),f.qZA()(),f.TgZ(22,"button",13),f.NdJ("click",function(){f.CHM(t);const i=f.oxw();return f.KtG(i.signUp())}),f._uU(23,"Sign Up"),f.qZA()()}if(2&n){const t=f.oxw();f.xp6(11),f.Q6J("ngModel",t.name),f.xp6(4),f.Q6J("ngModel",t.email),f.xp6(6),f.Q6J("ngModel",t.password)}}let J2=(()=>{class n{constructor(t){this.userService=t,this.signInFormVisible=!0}ngOnInit(){}makeSignInFormVisible(){this.signInFormVisible=!0}makeSignUpFormVisible(){this.signInFormVisible=!1}signIn(){console.log("User tried to login!"),this.userService.SignIn(this.email,this.password),this.email="",this.password=""}signUp(){console.log("User tried to sign Up!"),console.log("Name in component = ",this.name),this.userService.SignUp(this.email,this.password,this.name),this.email="",this.password="",this.name=""}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(Jd))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-login"]],decls:3,vars:2,consts:[["style","width: 400px; margin:auto;",4,"ngIf","ngIfElse"],["signUpForm",""],[2,"width","400px","margin","auto"],[1,"nav","nav-tabs"],[1,"nav-item"],[1,"nav-link","active"],[1,"nav-link",3,"click"],[1,"form-group"],["for","exampleInputEmail1"],["type","email","aria-describedby","emailHelp","placeholder","Enter email",1,"form-control",3,"ngModel","ngModelChange"],["id","emailHelp",1,"form-text","text-muted"],["for","exampleInputPassword1"],["type","password","placeholder","Password",1,"form-control",3,"ngModel","ngModelChange"],["type","submit",1,"btn","btn-primary",3,"click"],["type","text","placeholder","Enter your name",1,"form-control",3,"ngModel","ngModelChange"]],template:function(t,r){if(1&t&&(f.YNc(0,Y2,20,2,"div",0),f.YNc(1,Q2,24,3,"ng-template",null,1,f.W1O)),2&t){const i=f.MAs(2);f.Q6J("ngIf",r.signInFormVisible)("ngIfElse",i)}},dependencies:[or,qD,dO,jR]}),n})(),X2=(()=>{class n{constructor(t){this.http=t}getAllAlbums(){var t=this.getHeaders();return this.http.get(Ul_API_BASE_URL+"/api/albums",{headers:t})}getHeaders(){return{idToken:localStorage.getItem("userIdToken")}}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(ys))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const ej=function(n){return["/album",n]};function tj(n,e){if(1&n&&(f.TgZ(0,"div",4)(1,"div",5),f._UZ(2,"img",6),f.TgZ(3,"div",7)(4,"h5",8),f._uU(5),f.qZA(),f.TgZ(6,"a",9),f._uU(7,"Go to Album"),f.qZA()()()()),2&n){const t=e.$implicit;f.xp6(2),f.Q6J("src",t.coverPhotoUrl,f.LSH),f.xp6(3),f.Oqu(t.name),f.xp6(1),f.Q6J("routerLink",f.VKq(3,ej,t.id))}}const nj=function(){return["/photo"]};let rj=(()=>{class n{constructor(t){this.albumService=t}ngOnInit(){this.albumService.getAllAlbums().subscribe(t=>{this.albums=t,console.log("Got all Albums response!",this.albums)})}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(X2))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-my-albums"]],decls:7,vars:3,consts:[[1,"float-end",2,"padding-right","30px"],[1,"btn","btn-outline-success",3,"routerLink"],[1,"row"],["class","col-sm-3 pt-3",4,"ngFor","ngForOf"],[1,"col-sm-3","pt-3"],[1,"card",2,"width","18rem"],["alt","Card image cap",1,"card-img-top",3,"src"],[1,"card-body"],[1,"card-title"],[1,"btn","btn-primary",3,"routerLink"]],template:function(t,r){1&t&&(f.TgZ(0,"div",0)(1,"a",1),f._uU(2,"Photo Details"),f.qZA()(),f.TgZ(3,"h2"),f._uU(4,"Album Details"),f.qZA(),f.TgZ(5,"div",2),f.YNc(6,tj,8,5,"div",3),f.qZA()),2&t&&(f.xp6(1),f.Q6J("routerLink",f.DdM(2,nj)),f.xp6(5),f.Q6J("ngForOf",r.albums))},dependencies:[po,Bh]}),n})(),ij=(()=>{class n{constructor(t){this.http=t}getAllPhotos(){var t=this.getHeaders();return this.http.get(Ul_API_BASE_URL+"/api/photos",{headers:t})}getHeaders(){return{idToken:localStorage.getItem("userIdToken")}}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(ys))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const sj=function(){return["/albums"]};let oj=(()=>{class n{constructor(t){this.phtoService=t}ngOnInit(){this.phtoService.getAllPhotos().subscribe(t=>{console.log("Got all Photo response!",t)})}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(ij))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-photo-details"]],decls:5,vars:2,consts:[[1,"float-end",2,"padding-right","30px"],[1,"btn","btn-outline-success",3,"routerLink"]],template:function(t,r){1&t&&(f.TgZ(0,"div",0)(1,"button",1),f._uU(2,"Go back to Album"),f.qZA()(),f.TgZ(3,"p"),f._uU(4,"All Photo details will be listed here."),f.qZA()),2&t&&(f.xp6(1),f.Q6J("routerLink",f.DdM(1,sj)))},dependencies:[Nv]}),n})(),aj=(()=>{class n{constructor(){}ngOnInit(){}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-profile"]],decls:2,vars:0,template:function(t,r){1&t&&(f.TgZ(0,"p"),f._uU(1,"Profile will be displayed here."),f.qZA())}}),n})();const uj=function(n){return["/album",n]},lj=[{path:"album/:albumId",component:TN,canActivate:[Jd]},{path:"login",component:J2},{path:"albums",component:rj,canActivate:[Jd]},{path:"profile",component:aj,canActivate:[Jd]},{path:"create",component:Qm,canActivate:[Jd]},{path:"upload/:albumId",component:(()=>{class n{constructor(t){this.route=t}ngOnInit(){this.route.paramMap.subscribe(t=>{this.albumId=t.get("albumId"),console.log("Got album Id: ",this.albumId)})}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(Fo))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-upload-picture"]],decls:8,vars:4,consts:[[1,"float-end",2,"padding-right","30px"],[1,"btn","btn-outline-info",3,"routerLink"]],template:function(t,r){1&t&&(f.TgZ(0,"div",0)(1,"a",1),f._uU(2,"Get back to Albums"),f.qZA()(),f.TgZ(3,"p"),f._uU(4,"upload-picture works!"),f.qZA(),f._UZ(5,"br"),f.TgZ(6,"p"),f._uU(7),f.qZA()),2&t&&(f.xp6(1),f.Q6J("routerLink",f.VKq(2,uj,r.albumId)),f.xp6(6),f.hij("The retrieved albumID is ",r.albumId," "))},dependencies:[Bh]}),n})(),canActivate:[Jd]},{path:"photo",component:oj,canActivate:[Jd]},{path:"",redirectTo:"login",pathMatch:"full"}];let cj=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({imports:[Js.forRoot(lj),Js]}),n})();const dj=function(){return["/login"]};function hj(n,e){1&n&&(f.TgZ(0,"a",8),f._uU(1,"Login"),f.qZA()),2&n&&f.Q6J("routerLink",f.DdM(1,dj))}function fj(n,e){if(1&n){const t=f.EpF();f.TgZ(0,"button",12),f.NdJ("click",function(){f.CHM(t);const i=f.oxw(2);return f.KtG(i.logOut())}),f._uU(1,"LogOut"),f.qZA()}}const qO=function(){return["/albums"]},pj=function(){return["/profile"]};function gj(n,e){if(1&n&&(f.TgZ(0,"ul",6)(1,"li",7)(2,"a",8),f._uU(3,"Home"),f.qZA()(),f.TgZ(4,"li",7)(5,"a",8),f._uU(6,"Albums"),f.qZA()(),f.TgZ(7,"li",7)(8,"a",8),f._uU(9,"Profile"),f.qZA()(),f.TgZ(10,"li",7),f.YNc(11,hj,2,2,"a",9),f.qZA(),f.TgZ(12,"div",10),f.YNc(13,fj,2,0,"button",11),f.qZA()()),2&n){const t=f.oxw();f.xp6(2),f.Q6J("routerLink",f.DdM(5,qO)),f.xp6(3),f.Q6J("routerLink",f.DdM(6,qO)),f.xp6(3),f.Q6J("routerLink",f.DdM(7,pj)),f.xp6(3),f.Q6J("ngIf",!t.userService.loggedIn()),f.xp6(2),f.Q6J("ngIf",t.userService.loggedIn())}}let mj=(()=>{class n{constructor(t){this.userService=t,this.title="PhotoApplication"}loggedIn(){this.userService.loggedIn()}logOut(){this.userService.logOut()}}return n.\u0275fac=function(t){return new(t||n)(f.Y36(Jd))},n.\u0275cmp=f.Xpm({type:n,selectors:[["app-root"]],decls:9,vars:1,consts:[[1,"navbar","navbar-expand-lg","navbar-light","bg-light"],["href","/albums",1,"navbar-brand"],["type","button","data-toggle","collapse","data-target","#navbarSupportedContent","aria-controls","navbarSupportedContent","aria-expanded","false","aria-label","Toggle navigation",1,"navbar-toggler"],[1,"navbar-toggler-icon"],["id","navbarSupportedContent",1,"collapse","navbar-collapse"],["class","navbar-nav mr-auto",4,"ngIf"],[1,"navbar-nav","mr-auto"],[1,"nav-item"],[1,"nav-link",3,"routerLink"],["class","nav-link",3,"routerLink",4,"ngIf"],[1,"float-end",2,"padding-right","30px"],["class","btn btn-outline-danger",3,"click",4,"ngIf"],[1,"btn","btn-outline-danger",3,"click"]],template:function(t,r){1&t&&(f.TgZ(0,"nav",0)(1,"a",1)(2,"h1"),f._uU(3,"Photo Application"),f.qZA()(),f.TgZ(4,"button",2),f._UZ(5,"span",3),f.qZA(),f.TgZ(6,"div",4),f.YNc(7,gj,14,8,"ul",5),f.qZA()(),f._UZ(8,"router-outlet")),2&t&&(f.xp6(7),f.Q6J("ngIf",r.userService.loggedIn()))},dependencies:[or,Yr,Bh]}),n})();const KO="firebasestorage.googleapis.com",ZO="storageBucket";class Er extends P.ZR{constructor(e,t,r=0){super(KR(e),`Firebase Storage: ${t} (${KR(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Er.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return KR(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.message=this.customData.serverResponse?`${this._baseMessage}\n${this.customData.serverResponse}`:this._baseMessage}}function KR(n){return"storage/"+n}function ZR(){return new Er("unknown","An unknown error occurred, please check the error payload for server response.")}function YO(){return new Er("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}function QO(){return new Er("canceled","User canceled the upload/download.")}function JO(){return new Er("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function wy(n){return new Er("invalid-argument",n)}function XO(){return new Er("app-deleted","The Firebase app was deleted.")}function e1(n){return new Er("invalid-root-operation","The operation '"+n+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function NE(n,e){return new Er("invalid-format","String does not match format '"+n+"': "+e)}function kE(n){throw new Er("internal-error","Internal error: "+n)}class rs{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=rs.makeFromUrl(e,t)}catch{return new rs(e,"")}if(""===r.path)return r;throw function Sj(n){return new Er("invalid-default-bucket","Invalid default bucket '"+n+"'.")}(e)}static makeFromUrl(e,t){let r=null;const i="([A-Za-z0-9.\\-_]+)",d=new RegExp("^gs://"+i+"(/(.*))?$","i");function w(at){at.path_=decodeURIComponent(at.path)}const S=t.replace(/[.]/g,"\\."),et=[{regex:d,indices:{bucket:1,path:3},postModify:function a(at){"/"===at.path.charAt(at.path.length-1)&&(at.path_=at.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${S}/v[A-Za-z0-9_]+/b/${i}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:w},{regex:new RegExp(`^https?://${t===KO?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${i}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:w}];for(let at=0;at<et.length;at++){const St=et[at],Ot=St.regex.exec(e);if(Ot){let Ku=Ot[St.indices.path];Ku||(Ku=""),r=new rs(Ot[St.indices.bucket],Ku),St.postModify(r);break}}if(null==r)throw function Tj(n){return new Er("invalid-url","Invalid URL '"+n+"'.")}(e);return r}}class Nj{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function rT(n){return"string"==typeof n||n instanceof String}function t1(n){return YR()&&n instanceof Blob}function YR(){return typeof Blob<"u"&&!(0,P.UG)()}function QR(n,e,t,r){if(r<e)throw wy(`Invalid value for '${n}'. Expected ${e} or greater.`);if(r>t)throw wy(`Invalid value for '${n}'. Expected ${t} or less.`)}function Xd(n,e,t){let r=e;return null==t&&(r=`https://${e}`),`${t}://${r}/v0${n}`}function n1(n){const e=encodeURIComponent;let t="?";for(const r in n)n.hasOwnProperty(r)&&(t=t+(e(r)+"=")+e(n[r])+"&");return t=t.slice(0,-1),t}var Lf=(()=>(function(n){n[n.NO_ERROR=0]="NO_ERROR",n[n.NETWORK_ERROR=1]="NETWORK_ERROR",n[n.ABORT=2]="ABORT"}(Lf||(Lf={})),Lf))();function r1(n,e){const t=n>=500&&n<600,i=-1!==[408,429].indexOf(n),a=-1!==e.indexOf(n);return t||i||a}class Vj{constructor(e,t,r,i,a,l,d,_,w,D,S,M=!0){this.url_=e,this.method_=t,this.headers_=r,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=l,this.callback_=d,this.errorCallback_=_,this.timeout_=w,this.progressCallback_=D,this.connectionFactory_=S,this.retry=M,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((O,j)=>{this.resolve_=O,this.reject_=j,this.start_()})}start_(){const t=(r,i)=>{const a=this.resolve_,l=this.reject_,d=i.connection;if(i.wasSuccessCode)try{const _=this.callback_(d,d.getResponse());!function Oj(n){return void 0!==n}(_)?a():a(_)}catch(_){l(_)}else if(null!==d){const _=ZR();_.serverResponse=d.getErrorText(),l(this.errorCallback_?this.errorCallback_(d,_):_)}else l(i.canceled?this.appDelete_?XO():QO():YO())};this.canceled_?t(0,new iT(!1,null,!0)):this.backoffId_=function kj(n,e,t){let r=1,i=null,a=null,l=!1,d=0;function _(){return 2===d}let w=!1;function D(...he){w||(w=!0,e.apply(null,he))}function S(he){i=setTimeout(()=>{i=null,n(O,_())},he)}function M(){a&&clearTimeout(a)}function O(he,...$e){if(w)return void M();if(he)return M(),void D.call(null,he,...$e);if(_()||l)return M(),void D.call(null,he,...$e);let et;r<64&&(r*=2),1===d?(d=2,et=0):et=1e3*(r+Math.random()),S(et)}let j=!1;function ae(he){j||(j=!0,M(),!w&&(null!==i?(he||(d=2),clearTimeout(i),S(0)):he||(d=1)))}return S(0),a=setTimeout(()=>{l=!0,ae(!0)},t),ae}((r,i)=>{if(i)return void r(!1,new iT(!1,null,!0));const a=this.connectionFactory_();this.pendingConnection_=a;const l=d=>{null!==this.progressCallback_&&this.progressCallback_(d.loaded,d.lengthComputable?d.total:-1)};null!==this.progressCallback_&&a.addUploadProgressListener(l),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&a.removeUploadProgressListener(l),this.pendingConnection_=null;const d=a.getErrorCode()===Lf.NO_ERROR,_=a.getStatus();if((!d||r1(_,this.additionalRetryCodes_))&&this.retry){const D=a.getErrorCode()===Lf.ABORT;return void r(!1,new iT(!1,null,D))}const w=-1!==this.successCodes_.indexOf(_);r(!0,new iT(w,a))})},t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&function Pj(n){n(!1)}(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class iT{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function Wj(...n){const e=function Gj(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}();if(void 0!==e){const t=new e;for(let r=0;r<n.length;r++)t.append(n[r]);return t.getBlob()}if(YR())return new Blob(n);throw new Er("unsupported-environment","This browser doesn't seem to support creating Blobs")}const $o={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class JR{constructor(e,t){this.data=e,this.contentType=t||null}}function XR(n,e){switch(n){case $o.RAW:return new JR(i1(e));case $o.BASE64:case $o.BASE64URL:return new JR(s1(n,e));case $o.DATA_URL:return new JR(function Zj(n){const e=new o1(n);return e.base64?s1($o.BASE64,e.rest):function Kj(n){let e;try{e=decodeURIComponent(n)}catch{throw NE($o.DATA_URL,"Malformed data URL.")}return i1(e)}(e.rest)}(e),function Yj(n){return new o1(n).contentType}(e))}throw ZR()}function i1(n){const e=[];for(let t=0;t<n.length;t++){let r=n.charCodeAt(t);r<=127?e.push(r):r<=2047?e.push(192|r>>6,128|63&r):55296==(64512&r)?t<n.length-1&&56320==(64512&n.charCodeAt(t+1))?(r=65536|(1023&r)<<10|1023&n.charCodeAt(++t),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)):e.push(239,191,189):56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function s1(n,e){switch(n){case $o.BASE64:{const i=-1!==e.indexOf("-"),a=-1!==e.indexOf("_");if(i||a)throw NE(n,"Invalid character '"+(i?"-":"_")+"' found: is it base64url encoded?");break}case $o.BASE64URL:{const i=-1!==e.indexOf("+"),a=-1!==e.indexOf("/");if(i||a)throw NE(n,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let t;try{t=function qj(n){if(typeof atob>"u")throw function Mj(n){return new Er("unsupported-environment",`${n} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}("base-64");return atob(n)}(e)}catch(i){throw i.message.includes("polyfill")?i:NE(n,"Invalid character found")}const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}class o1{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw NE($o.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;null!=r&&(this.base64=function Qj(n,e){return n.length>=e.length&&n.substring(n.length-e.length)===e}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class fc{constructor(e,t){let r=0,i="";t1(e)?(this.data_=e,r=e.size,i=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=i}size(){return this.size_}type(){return this.type_}slice(e,t){if(t1(this.data_)){const i=function zj(n,e,t){return n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null}(this.data_,e,t);return null===i?null:new fc(i)}{const r=new Uint8Array(this.data_.buffer,e,t-e);return new fc(r,!0)}}static getBlob(...e){if(YR()){const t=e.map(r=>r instanceof fc?r.data_:r);return new fc(Wj.apply(null,t))}{const t=e.map(l=>rT(l)?XR($o.RAW,l).data:l.data_);let r=0;t.forEach(l=>{r+=l.byteLength});const i=new Uint8Array(r);let a=0;return t.forEach(l=>{for(let d=0;d<l.length;d++)i[a++]=l[d]}),new fc(i,!0)}}uploadData(){return this.data_}}function eM(n){let e;try{e=JSON.parse(n)}catch{return null}return function Lj(n){return"object"==typeof n&&!Array.isArray(n)}(e)?e:null}function a1(n){const e=n.lastIndexOf("/",n.length-2);return-1===e?n:n.slice(e+1)}function eH(n,e){return e}class Ms{constructor(e,t,r,i){this.server=e,this.local=t||e,this.writable=!!r,this.xform=i||eH}}let sT=null;function PE(){if(sT)return sT;const n=[];n.push(new Ms("bucket")),n.push(new Ms("generation")),n.push(new Ms("metageneration")),n.push(new Ms("name","fullPath",!0));const t=new Ms("name");t.xform=function e(a,l){return function tH(n){return!rT(n)||n.length<2?n:a1(n)}(l)},n.push(t);const i=new Ms("size");return i.xform=function r(a,l){return void 0!==l?Number(l):l},n.push(i),n.push(new Ms("timeCreated")),n.push(new Ms("updated")),n.push(new Ms("md5Hash",null,!0)),n.push(new Ms("cacheControl",null,!0)),n.push(new Ms("contentDisposition",null,!0)),n.push(new Ms("contentEncoding",null,!0)),n.push(new Ms("contentLanguage",null,!0)),n.push(new Ms("contentType",null,!0)),n.push(new Ms("metadata","customMetadata",!0)),sT=n,sT}function u1(n,e,t){const r=eM(e);return null===r?null:function rH(n,e,t){const r={type:"file"},i=t.length;for(let a=0;a<i;a++){const l=t[a];r[l.local]=l.xform(r,e[l.server])}return function nH(n,e){Object.defineProperty(n,"ref",{get:function t(){const a=new rs(n.bucket,n.fullPath);return e._makeStorageReference(a)}})}(r,n),r}(n,r,t)}function tM(n,e){const t={},r=e.length;for(let i=0;i<r;i++){const a=e[i];a.writable&&(t[a.server]=n[a.local])}return JSON.stringify(t)}const l1="prefixes";class pc{constructor(e,t,r,i){this.url=e,this.method=t,this.handler=r,this.timeout=i,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function gc(n){if(!n)throw ZR()}function oT(n,e){return function t(r,i){const a=u1(n,i,e);return gc(null!==a),a}}function Ey(n){return function e(t,r){let i;return i=401===t.getStatus()?t.getErrorText().includes("Firebase App Check token is invalid")?function bj(){return new Er("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}():function Cj(){return new Er("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again.")}():402===t.getStatus()?function Ij(n){return new Er("quota-exceeded","Quota for bucket '"+n+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(n.bucket):403===t.getStatus()?function Dj(n){return new Er("unauthorized","User does not have permission to access '"+n+"'.")}(n.path):r,i.status=t.getStatus(),i.serverResponse=r.serverResponse,i}}function OE(n){const e=Ey(n);return function t(r,i){let a=e(r,i);return 404===r.getStatus()&&(a=function Ej(n){return new Er("object-not-found","Object '"+n+"' does not exist.")}(n.path)),a.serverResponse=i.serverResponse,a}}function d1(n,e,t){const i=Xd(e.fullServerUrl(),n.host,n._protocol),l=n.maxOperationRetryTime,d=new pc(i,"GET",oT(n,t),l);return d.errorHandler=OE(e),d}function lH(n,e,t,r,i){const a={};a.prefix=e.isRoot?"":e.path+"/",t&&t.length>0&&(a.delimiter=t),r&&(a.pageToken=r),i&&(a.maxResults=i);const d=Xd(e.bucketOnlyServerUrl(),n.host,n._protocol),w=n.maxOperationRetryTime,D=new pc(d,"GET",function aH(n,e){return function t(r,i){const a=function oH(n,e,t){const r=eM(t);return null===r?null:function sH(n,e,t){const r={prefixes:[],items:[],nextPageToken:t.nextPageToken};if(t[l1])for(const i of t[l1]){const a=i.replace(/\/$/,""),l=n._makeStorageReference(new rs(e,a));r.prefixes.push(l)}if(t.items)for(const i of t.items){const a=n._makeStorageReference(new rs(e,i.name));r.items.push(a)}return r}(n,e,r)}(n,e,i);return gc(null!==a),a}}(n,e.bucket),w);return D.urlParams=a,D.errorHandler=Ey(e),D}function f1(n,e,t){const r=Object.assign({},t);return r.fullPath=n.path,r.size=e.size(),r.contentType||(r.contentType=function fH(n,e){return n&&n.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}class aT{constructor(e,t,r,i){this.current=e,this.total=t,this.finalized=!!r,this.metadata=i||null}}function nM(n,e){let t=null;try{t=n.getResponseHeader("X-Goog-Upload-Status")}catch{gc(!1)}return gc(!!t&&-1!==(e||["active"]).indexOf(t)),t}const _H={STATE_CHANGED:"state_changed"},Ns={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function rM(n){switch(n){case"running":case"pausing":case"canceling":return Ns.RUNNING;case"paused":return Ns.PAUSED;case"success":return Ns.SUCCESS;case"canceled":return Ns.CANCELED;default:return Ns.ERROR}}class yH{constructor(e,t,r){if(function Fj(n){return"function"==typeof n}(e)||null!=t||null!=r)this.next=e,this.error=t??void 0,this.complete=r??void 0;else{const a=e;this.next=a.next,this.error=a.error,this.complete=a.complete}}}function Iy(n){return(...e)=>{Promise.resolve().then(()=>n(...e))}}class wH extends class vH{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Lf.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Lf.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Lf.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,i){if(this.sent_)throw kE("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==i)for(const a in i)i.hasOwnProperty(a)&&this.xhr_.setRequestHeader(a,i[a].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw kE("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw kE("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw kE("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw kE("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}{initXhr(){this.xhr_.responseType="text"}}function $u(){return new wH}class _1{constructor(e,t,r=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=r,this._mappings=PE(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=i=>{if(this._request=void 0,this._chunkMultiplier=1,i._codeEquals("canceled"))this._needToFetchStatus=!0,this.completeTransitions_();else{const a=this.isExponentialBackoffExpired();if(r1(i.status,[])){if(!a)return this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,void this.completeTransitions_();i=YO()}this._error=i,this._transition("error")}},this._metadataErrorHandler=i=>{this._request=void 0,i._codeEquals("canceled")?this.completeTransitions_():(this._error=i,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((i,a)=>{this._resolve=i,this._reject=a,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,r])=>{switch(this._state){case"running":e(t,r);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{const r=function pH(n,e,t,r,i){const a=e.bucketOnlyServerUrl(),l=f1(e,r,i),d={name:l.fullPath},_=Xd(a,n.host,n._protocol),D={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":l.contentType,"Content-Type":"application/json; charset=utf-8"},S=tM(l,t),j=new pc(_,"POST",function O(ae){let he;nM(ae);try{he=ae.getResponseHeader("X-Goog-Upload-URL")}catch{gc(!1)}return gc(rT(he)),he},n.maxUploadRetryTime);return j.urlParams=d,j.headers=D,j.body=S,j.errorHandler=Ey(e),j}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,$u,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._uploadUrl=a,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((t,r)=>{const i=function gH(n,e,t,r){const _=new pc(t,"POST",function a(w){const D=nM(w,["active","final"]);let S=null;try{S=w.getResponseHeader("X-Goog-Upload-Size-Received")}catch{gc(!1)}S||gc(!1);const M=Number(S);return gc(!isNaN(M)),new aT(M,r.size(),"final"===D)},n.maxUploadRetryTime);return _.headers={"X-Goog-Upload-Command":"query"},_.errorHandler=Ey(e),_}(this._ref.storage,this._ref._location,e,this._blob),a=this._ref.storage._makeRequest(i,$u,t,r);this._request=a,a.getPromise().then(l=>{this._request=void 0,this._updateProgress(l.current),this._needToFetchStatus=!1,l.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=262144*this._chunkMultiplier,t=new aT(this._transferred,this._blob.size()),r=this._uploadUrl;this._resolveToken((i,a)=>{let l;try{l=function mH(n,e,t,r,i,a,l,d){const _=new aT(0,0);if(l?(_.current=l.current,_.total=l.total):(_.current=0,_.total=r.size()),r.size()!==_.total)throw function xj(){return new Er("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}();const w=_.total-_.current;let D=w;i>0&&(D=Math.min(D,i));const S=_.current;let O="";O=0===D?"finalize":w===D?"upload, finalize":"upload";const j={"X-Goog-Upload-Command":O,"X-Goog-Upload-Offset":`${_.current}`},ae=r.slice(S,S+D);if(null===ae)throw JO();const et=new pc(t,"POST",function he(at,St){const Ot=nM(at,["active","final"]),Cr=_.current+D,Ku=r.size();let mN;return mN="final"===Ot?oT(e,a)(at,St):null,new aT(Cr,Ku,"final"===Ot,mN)},e.maxUploadRetryTime);return et.headers=j,et.body=ae.uploadData(),et.progressCallback=d||null,et.errorHandler=Ey(n),et}(this._ref._location,this._ref.storage,r,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(_){return this._error=_,void this._transition("error")}const d=this._ref.storage._makeRequest(l,$u,i,a,!1);this._request=d,d.getPromise().then(_=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(_.current),_.finalized?(this._metadata=_.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){262144*this._chunkMultiplier*2<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{const r=d1(this._ref.storage,this._ref._location,this._mappings),i=this._ref.storage._makeRequest(r,$u,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{const r=function p1(n,e,t,r,i){const a=e.bucketOnlyServerUrl(),l={"X-Goog-Upload-Protocol":"multipart"},_=function d(){let et="";for(let at=0;at<2;at++)et+=Math.random().toString().slice(2);return et}();l["Content-Type"]="multipart/related; boundary="+_;const w=f1(e,r,i),D=tM(w,t),O=fc.getBlob("--"+_+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+D+"\r\n--"+_+"\r\nContent-Type: "+w.contentType+"\r\n\r\n",r,"\r\n--"+_+"--");if(null===O)throw JO();const j={name:w.fullPath},ae=Xd(a,n.host,n._protocol),$e=n.maxUploadRetryTime,nt=new pc(ae,"POST",oT(n,t),$e);return nt.urlParams=j,nt.headers=l,nt.body=O.uploadData(),nt.errorHandler=Ey(e),nt}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),i=this._ref.storage._makeRequest(r,$u,e,t);this._request=i,i.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=QO(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=rM(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,r,i){const a=new yH(t||void 0,r||void 0,i||void 0);return this._addObserver(a),()=>{this._removeObserver(a)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(t=>{this._notifyObserver(t)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(rM(this._state)){case Ns.SUCCESS:Iy(this._resolve.bind(null,this.snapshot))();break;case Ns.CANCELED:case Ns.ERROR:Iy(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(rM(this._state)){case Ns.RUNNING:case Ns.PAUSED:e.next&&Iy(e.next.bind(e,this.snapshot))();break;case Ns.SUCCESS:e.complete&&Iy(e.complete.bind(e))();break;default:e.error&&Iy(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class Xg{constructor(e,t){this._service=e,this._location=t instanceof rs?t:rs.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Xg(e,t)}get root(){const e=new rs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return a1(this._location.path)}get storage(){return this._service}get parent(){const e=function Jj(n){if(0===n.length)return null;const e=n.lastIndexOf("/");return-1===e?"":n.slice(0,e)}(this._location.path);if(null===e)return null;const t=new rs(this._location.bucket,e);return new Xg(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw e1(e)}}function v1(n,e,t){return iM.apply(this,arguments)}function iM(){return iM=(0,ve.Z)(function*(n,e,t){const i=yield w1(n,{pageToken:t});e.prefixes.push(...i.prefixes),e.items.push(...i.items),null!=i.nextPageToken&&(yield v1(n,e,i.nextPageToken))}),iM.apply(this,arguments)}function w1(n,e){null!=e&&"number"==typeof e.maxResults&&QR("options.maxResults",1,1e3,e.maxResults);const t=e||{},r=lH(n.storage,n._location,"/",t.pageToken,t.maxResults);return n.storage.makeRequestWithTokens(r,$u)}function NH(n){n._throwIfRoot("getDownloadURL");const e=function cH(n,e,t){const i=Xd(e.fullServerUrl(),n.host,n._protocol),l=n.maxOperationRetryTime,d=new pc(i,"GET",function uH(n,e){return function t(r,i){const a=u1(n,i,e);return gc(null!==a),function iH(n,e,t,r){const i=eM(e);if(null===i||!rT(i.downloadTokens))return null;const a=i.downloadTokens;if(0===a.length)return null;const l=encodeURIComponent;return a.split(",").map(w=>{const S=n.fullPath;return Xd("/b/"+l(n.bucket)+"/o/"+l(S),t,r)+n1({alt:"media",token:w})})[0]}(a,i,n.host,n._protocol)}}(n,t),l);return d.errorHandler=OE(e),d}(n.storage,n._location,PE());return n.storage.makeRequestWithTokens(e,$u).then(t=>{if(null===t)throw function Rj(){return new Er("no-download-url","The given file does not have any download URLs.")}();return t})}function E1(n,e){const t=function Xj(n,e){const t=e.split("/").filter(r=>r.length>0).join("/");return 0===n.length?t:n+"/"+t}(n._location.path,e),r=new rs(n._location.bucket,t);return new Xg(n.storage,r)}function I1(n,e){if(n instanceof sM){const t=n;if(null==t._bucket)throw function Aj(){return new Er("no-default-bucket","No default bucket found. Did you set the '"+ZO+"' property when initializing the app?")}();const r=new Xg(t,t._bucket);return null!=e?I1(r,e):r}return void 0!==e?E1(n,e):n}function FH(n,e){if(e&&function PH(n){return/^[A-Za-z]+:\/\//.test(n)}(e)){if(n instanceof sM)return function OH(n,e){return new Xg(n,e)}(n,e);throw wy("To use ref(service, url), the first argument must be a Storage instance.")}return I1(n,e)}function C1(n,e){const t=e?.[ZO];return null==t?null:rs.makeFromBucketSpec(t,n)}class sM{constructor(e,t,r,i,a){this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=i,this._firebaseVersion=a,this._bucket=null,this._host=KO,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?rs.makeFromBucketSpec(i,this._host):C1(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._bucket=null!=this._url?rs.makeFromBucketSpec(this._url,e):C1(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){QR("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){QR("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}_getAuthToken(){var e=this;return(0,ve.Z)(function*(){if(e._overrideAuthToken)return e._overrideAuthToken;const t=e._authProvider.getImmediate({optional:!0});if(t){const r=yield t.getToken();if(null!==r)return r.accessToken}return null})()}_getAppCheckToken(){var e=this;return(0,ve.Z)(function*(){const t=e._appCheckProvider.getImmediate({optional:!0});return t?(yield t.getToken()).token:null})()}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Xg(this,e)}_makeRequest(e,t,r,i,a=!0){if(this._deleted)return new Nj(XO());{const l=function $j(n,e,t,r,i,a,l=!0){const d=n1(n.urlParams),_=n.url+d,w=Object.assign({},n.headers);return function jj(n,e){e&&(n["X-Firebase-GMPID"]=e)}(w,e),function Uj(n,e){null!==e&&e.length>0&&(n.Authorization="Firebase "+e)}(w,t),function Bj(n,e){n["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}(w,a),function Hj(n,e){null!==e&&(n["X-Firebase-AppCheck"]=e)}(w,r),new Vj(_,n.method,w,n.body,n.successCodes,n.additionalRetryCodes,n.handler,n.errorHandler,n.timeout,n.progressCallback,i,l)}(e,this._appId,r,i,t,this._firebaseVersion,a);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}makeRequestWithTokens(e,t){var r=this;return(0,ve.Z)(function*(){const[i,a]=yield Promise.all([r._getAuthToken(),r._getAppCheckToken()]);return r._makeRequest(e,t,i,a).getPromise()})()}}const b1="@firebase/storage";function S1(n,e){return FH(n=(0,P.m9)(n),e)}function zH(n,{instanceIdentifier:e}){const t=n.getProvider("app").getImmediate(),r=n.getProvider("auth-internal"),i=n.getProvider("app-check-internal");return new sM(t,r,i,e,Qi.SDK_VERSION)}!function qH(){(0,Qi._registerComponent)(new Xs.wA("storage",zH,"PUBLIC").setMultipleInstances(!0)),(0,Qi.registerVersion)(b1,"0.9.14",""),(0,Qi.registerVersion)(b1,"0.9.14","esm2017")}();class uT{constructor(e,t,r){this._delegate=e,this.task=t,this.ref=r}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class x1{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new uT(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(r=>{if(e)return e(new uT(r,this,this._ref))},t)}on(e,t,r,i){let a;return t&&(a="function"==typeof t?l=>t(new uT(l,this,this._ref)):{next:t.next?l=>t.next(new uT(l,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,a,r||void 0,i||void 0)}}class R1{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new eh(e,this._service))}get items(){return this._delegate.items.map(e=>new eh(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}class eh{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=function WH(n,e){return E1(n,e)}(this._delegate,e);return new eh(t,this.storage)}get root(){return new eh(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new eh(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new x1(function VH(n,e,t){return function SH(n,e,t){return n._throwIfRoot("uploadBytesResumable"),new _1(n,new fc(e),t)}(n=(0,P.m9)(n),e,t)}(this._delegate,e,t),this)}putString(e,t=$o.RAW,r){this._throwIfRoot("putString");const i=XR(t,e),a=Object.assign({},r);return null==a.contentType&&null!=i.contentType&&(a.contentType=i.contentType),new x1(new _1(this._delegate,new fc(i.data,!0),a),this)}listAll(){return function HH(n){return function xH(n){const e={prefixes:[],items:[]};return v1(n,e).then(()=>e)}(n=(0,P.m9)(n))}(this._delegate).then(e=>new R1(e,this.storage))}list(e){return function jH(n,e){return w1(n=(0,P.m9)(n),e)}(this._delegate,e||void 0).then(t=>new R1(t,this.storage))}getMetadata(){return function UH(n){return function RH(n){n._throwIfRoot("getMetadata");const e=d1(n.storage,n._location,PE());return n.storage.makeRequestWithTokens(e,$u)}(n=(0,P.m9)(n))}(this._delegate)}updateMetadata(e){return function BH(n,e){return function MH(n,e){n._throwIfRoot("updateMetadata");const t=function dH(n,e,t,r){const a=Xd(e.fullServerUrl(),n.host,n._protocol),d=tM(t,r),w=n.maxOperationRetryTime,D=new pc(a,"PATCH",oT(n,r),w);return D.headers={"Content-Type":"application/json; charset=utf-8"},D.body=d,D.errorHandler=OE(e),D}(n.storage,n._location,e,PE());return n.storage.makeRequestWithTokens(t,$u)}(n=(0,P.m9)(n),e)}(this._delegate,e)}getDownloadURL(){return function $H(n){return NH(n=(0,P.m9)(n))}(this._delegate)}delete(){return this._throwIfRoot("delete"),function GH(n){return function kH(n){n._throwIfRoot("deleteObject");const e=function hH(n,e){const r=Xd(e.fullServerUrl(),n.host,n._protocol),d=new pc(r,"DELETE",function l(_,w){},n.maxOperationRetryTime);return d.successCodes=[200,204],d.errorHandler=OE(e),d}(n.storage,n._location);return n.storage.makeRequestWithTokens(e,$u)}(n=(0,P.m9)(n))}(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw e1(e)}}class M1{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(N1(e))throw wy("ref() expected a child path but got a URL, use refFromURL instead.");return new eh(S1(this._delegate,e),this)}refFromURL(e){if(!N1(e))throw wy("refFromURL() expected a full URL but got a child path, use ref() instead.");try{rs.makeFromUrl(e,this._delegate.host)}catch{throw wy("refFromUrl() expected a valid full URL but got an invalid one.")}return new eh(S1(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,r={}){!function A1(n,e,t,r={}){!function LH(n,e,t,r={}){n.host=`${e}:${t}`,n._protocol="http";const{mockUserToken:i}=r;i&&(n._overrideAuthToken="string"==typeof i?i:(0,P.Sg)(i,n.app.options.projectId))}(n,e,t,r)}(this._delegate,e,t,r)}}function N1(n){return/^[A-Za-z]+:\/\//.test(n)}function QH(n,{instanceIdentifier:e}){const t=n.getProvider("app-compat").getImmediate(),r=n.getProvider("storage").getImmediate({identifier:e});return new M1(t,r)}function k1(n){const e=function XH(n){return new Nr.y(e=>{const t=l=>e.next(l);t(n.snapshot);const a=n.on("state_changed",t);return n.then(l=>{t(l),e.complete()},l=>{t(n.snapshot),(l=>{e.error(l)})(l)}),function(){a()}}).pipe(function _j(n,e=Bp.z){return(0,An.e)((t,r)=>{let i=null,a=null,l=null;const d=()=>{if(i){i.unsubscribe(),i=null;const w=a;a=null,r.next(w)}};function _(){const w=l+n,D=e.now();if(D<w)return i=this.schedule(void 0,w-D),void r.add(i);d()}t.subscribe((0,pn.x)(r,w=>{a=w,l=e.now(),i||(i=e.schedule(_,n),r.add(i))},()=>{d(),r.complete()},void 0,()=>{a=i=null}))})}(0))}(n);return{task:n,then:n.then.bind(n),catch:n.catch.bind(n),pause:n.pause.bind(n),cancel:n.cancel.bind(n),resume:n.resume.bind(n),snapshotChanges:()=>e,percentageChanges:()=>e.pipe((0,ft.U)(t=>t.bytesTransferred/t.totalBytes*100))}}function lT(n){return{getDownloadURL:()=>it(void 0).pipe(gn.fc,Yn(()=>n.getDownloadURL()),gn.iC),getMetadata:()=>it(void 0).pipe(gn.fc,Yn(()=>n.getMetadata()),gn.iC),delete:()=>(0,zt.D)(n.delete()),child:e=>lT(n.child(e)),updateMetadata:e=>(0,zt.D)(n.updateMetadata(e)),put:(e,t)=>k1(n.put(e,t)),putString:(e,t,r)=>k1(n.putString(e,t,r)),list:e=>(0,zt.D)(n.list(e)),listAll:()=>(0,zt.D)(n.listAll())}}!function JH(n){const e={TaskState:Ns,TaskEvent:_H,StringFormat:$o,Storage:M1,Reference:eh};n.INTERNAL.registerComponent(new Xs.wA("storage-compat",QH,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),n.registerVersion("@firebase/storage-compat","0.1.22")}(iC.Z);const e$=new f.OlP("angularfire2.storageBucket"),t$=new f.OlP("angularfire2.storage.maxUploadRetryTime"),n$=new f.OlP("angularfire2.storage.maxOperationRetryTime"),r$=new f.OlP("angularfire2.storage.use-emulator");let i$=(()=>{class n{constructor(t,r,i,a,l,d,_,w,D,S){const M=(0,Fr.on)(t,l,r);this.storage=(0,Fr.cc)(`${M.name}.storage.${i}`,"AngularFireStorage",M.name,()=>{const O=l.runOutsideAngular(()=>M.storage(i||void 0)),j=D;return j&&O.useEmulator(...j),_&&O.setMaxUploadRetryTime(_),w&&O.setMaxOperationRetryTime(w),O},[_,w])}ref(t){return lT(this.storage.ref(t))}refFromURL(t){return lT(this.storage.refFromURL(t))}upload(t,r,i){return lT(this.storage.ref(t)).put(r,i)}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Fr.Dh),f.LFG(Fr.xv,8),f.LFG(e$,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(gn.HU),f.LFG(t$,8),f.LFG(n$,8),f.LFG(r$,8),f.LFG(TE,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),s$=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({}),n})(),o$=(()=>{class n{constructor(){WD.Z.registerVersion("angularfire",gn.q4.full,"gcs-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[i$],imports:[s$]}),n})();var a$=V(5032);const P1="@firebase/database",O1="0.13.10";let oM="";function F1(n){oM=n}class c${constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,P.Wl)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,P.cI)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class d${constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,P.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const L1=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new c$(e)}}catch{}return new d$},em=L1("localStorage"),aM=L1("sessionStorage"),Cy=new eo.Yd("@firebase/database"),V1=function(){let n=1;return function(){return n++}}(),U1=function(n){const e=(0,P.dS)(n),t=new P.gQ;t.update(e);const r=t.digest();return P.US.encodeByteArray(r)},FE=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=FE.apply(null,r):e+="object"==typeof r?(0,P.Wl)(r):r,e+=" "}return e};let tm=null,B1=!0;const j1=function(n,e){(0,P.hu)(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(Cy.logLevel=eo.in.VERBOSE,tm=Cy.log.bind(Cy),e&&aM.set("logging_enabled",!0)):"function"==typeof n?tm=n:(tm=null,aM.remove("logging_enabled"))},Ti=function(...n){if(!0===B1&&(B1=!1,null===tm&&!0===aM.get("logging_enabled")&&j1(!0)),tm){const e=FE.apply(null,n);tm(e)}},LE=function(n){return function(...e){Ti(n,...e)}},uM=function(...n){const e="FIREBASE INTERNAL ERROR: "+FE(...n);Cy.error(e)},mc=function(...n){const e=`FIREBASE FATAL ERROR: ${FE(...n)}`;throw Cy.error(e),new Error(e)},is=function(...n){const e="FIREBASE WARNING: "+FE(...n);Cy.warn(e)},cT=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},th="[MIN_NAME]",_c="[MAX_NAME]",nm=function(n,e){if(n===e)return 0;if(n===th||e===_c)return-1;if(e===th||n===_c)return 1;{const t=dT(n),r=dT(e);return null!==t?null!==r?t-r==0?n.length-e.length:t-r:-1:null!==r?1:n<e?-1:1}},p$=function(n,e){return n===e?0:n<e?-1:1},VE=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+(0,P.Wl)(e))},lM=function(n){if("object"!=typeof n||null===n)return(0,P.Wl)(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)0!==r&&(t+=","),t+=(0,P.Wl)(e[r]),t+=":",t+=lM(n[e[r]]);return t+="}",t},H1=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)r.push(n.substring(i,i+e>t?t:i+e));return r};function Si(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const $1=function(n){(0,P.hu)(!cT(n),"Invalid JSON number");const r=1023;let i,a,l,d,_;0===n?(a=0,l=0,i=1/n==-1/0?1:0):(i=n<0,(n=Math.abs(n))>=Math.pow(2,1-r)?(d=Math.min(Math.floor(Math.log(n)/Math.LN2),r),a=d+r,l=Math.round(n*Math.pow(2,52-d)-Math.pow(2,52))):(a=0,l=Math.round(n/Math.pow(2,-1074))));const w=[];for(_=52;_;_-=1)w.push(l%2?1:0),l=Math.floor(l/2);for(_=11;_;_-=1)w.push(a%2?1:0),a=Math.floor(a/2);w.push(i?1:0),w.reverse();const D=w.join("");let S="";for(_=0;_<64;_+=8){let M=parseInt(D.substr(_,8),2).toString(16);1===M.length&&(M="0"+M),S+=M}return S.toLowerCase()},y$=new RegExp("^-?(0*)\\d{1,10}$"),G1=-2147483648,cM=2147483647,dT=function(n){if(y$.test(n)){const e=Number(n);if(e>=G1&&e<=cM)return e}return null},by=function(n){try{n()}catch(e){setTimeout(()=>{throw is("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},UE=function(n,e){const t=setTimeout(n,e);return"number"==typeof t&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):"object"==typeof t&&t.unref&&t.unref(),t};class w${constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){is(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class E${constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(Ti("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',is(e)}}let BE=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const Z1=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,J1="websocket",X1="long_polling";class hM{constructor(e,t,r,i,a=!1,l="",d=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=a,this.persistenceKey=l,this.includeNamespaceInQueryParams=d,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=em.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&em.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function eF(n,e,t){let r;if((0,P.hu)("string"==typeof e,"typeof type must == string"),(0,P.hu)("object"==typeof t,"typeof params must == object"),e===J1)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==X1)throw new Error("Unknown connection type: "+e);r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function I$(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const i=[];return Si(t,(a,l)=>{i.push(a+"="+l)}),r+i.join("&")}class C${constructor(){this.counters_={}}incrementCounter(e,t=1){(0,P.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,P.p$)(this.counters_)}}const fM={},pM={};function gM(n){const e=n.toString();return fM[e]||(fM[e]=new C$),fM[e]}class D${constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&by(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class Vf{constructor(e,t,r,i,a,l,d){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=a,this.transportSessionId=l,this.lastSessionId=d,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=LE(e),this.stats_=gM(t),this.urlFn=_=>(this.appCheckToken&&(_.ac=this.appCheckToken),eF(t,X1,_))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new D$(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,P.Yr)()||"complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new mM((...a)=>{const[l,d,_,w,D]=a;if(this.incrementIncomingBytes_(a),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===l)this.id=d,this.password=_;else{if("close"!==l)throw new Error("Unrecognized command received: "+l);d?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(d,()=>{this.onClosed_()})):this.onClosed_()}},(...a)=>{const[l,d]=a;this.incrementIncomingBytes_(a),this.myPacketOrderer.handleResponse(l,d)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&Z1.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){Vf.forceAllow_=!0}static forceDisallow(){Vf.forceDisallow_=!0}static isAvailable(){return!((0,P.Yr)()||!Vf.forceAllow_&&(Vf.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,P.Wl)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=(0,P.h$)(t),i=H1(r,1840);for(let a=0;a<i.length;a++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[a]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,P.Yr)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,P.Wl)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class mM{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,P.Yr)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=V1(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=mM.createIFrame_();let a="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(a='<script>document.domain="'+document.domain+'";<\/script>');const l="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(l),this.myIFrame.doc.close()}catch(d){Ti("frame writing exception"),d.stack&&Ti(d.stack),Ti(d)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Ti("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const l=this.pendingSegs.shift();r=r+"&seg"+i+"="+l.seg+"&ts"+i+"="+l.ts+"&d"+i+"="+l.d,i++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),r()})}addTag(e,t){(0,P.Yr)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Ti("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}let fT=null;typeof MozWebSocket<"u"?fT=MozWebSocket:typeof WebSocket<"u"&&(fT=WebSocket);let Dy=(()=>{class n{constructor(t,r,i,a,l,d,_){this.connId=t,this.applicationId=i,this.appCheckToken=a,this.authToken=l,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=LE(this.connId),this.stats_=gM(r),this.connURL=n.connectionURL_(r,d,_,a,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,a,l){const d={v:"5"};return!(0,P.Yr)()&&typeof location<"u"&&location.hostname&&Z1.test(location.hostname)&&(d.r="f"),r&&(d.s=r),i&&(d.ls=i),a&&(d.ac=a),l&&(d.p=l),eF(t,J1,d)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,em.set("previous_websocket_failure",!0);try{let i;if((0,P.Yr)()){i={headers:{"User-Agent":`Firebase/5/${oM}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);const l=process.env,d=0===this.connURL.indexOf("wss://")?l.HTTPS_PROXY||l.https_proxy:l.HTTP_PROXY||l.http_proxy;d&&(i.proxy={origin:d})}this.mySock=new fT(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const a=i.message||i.data;return a&&this.log_(a),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const a=i.message||i.data;a&&this.log_(a),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&null!==fT&&!n.forceDisallow_}static previouslyFailed(){return em.isInMemoryStorage||!0===em.get("previous_websocket_failure")}markConnectionHealthy(){em.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=(0,P.cI)(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,P.hu)(null===this.frames,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const r=(0,P.Wl)(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=H1(r,16384);i.length>1&&this.sendString_(String(i.length));for(let a=0;a<i.length;a++)this.sendString_(i[a])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),aF=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[Vf,Dy]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const r=Dy&&Dy.isAvailable();let i=r&&!Dy.previouslyFailed();if(t.webSocketOnly&&(r||is("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Dy];else{const a=this.transports_=[];for(const l of n.ALL_TRANSPORTS)l&&l.isAvailable()&&a.push(l);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class pF{constructor(e,t,r,i,a,l,d,_,w,D){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=a,this.onMessage_=l,this.onReady_=d,this.onDisconnect_=_,this.onKill_=w,this.lastSessionId=D,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=LE("c:"+this.id+":"),this.transportManager_=new aF(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=UE(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=VE("t",e),r=VE("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=VE("t",e),r=VE("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=VE("t",e);if("d"in e){const r=e.d;if("h"===t)this.onHandshake_(r);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(r):"r"===t?this.onReset_(r):"e"===t?uM("Server Error: "+r):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):uM("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==r&&is("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),UE(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):UE(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(em.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class gF{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}class mF{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,P.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let a=0;a<i.length;a++)if(i[a].callback===t&&(!r||r===i[a].context))return void i.splice(a,1)}validateEventType_(e){(0,P.hu)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class pT extends mF{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!(0,P.uI)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new pT}getInitialEvent(e){return(0,P.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class Tn{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function _n(){return new Tn("")}function Zt(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Uf(n){return n.pieces_.length-n.pieceNum_}function Bn(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new Tn(n.pieces_,e)}function yM(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function jE(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function vF(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new Tn(e,0)}function dr(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof Tn)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new Tn(t,0)}function Yt(n){return n.pieceNum_>=n.pieces_.length}function ks(n,e){const t=Zt(n),r=Zt(e);if(null===t)return e;if(t===r)return ks(Bn(n),Bn(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function q$(n,e){const t=jE(n,0),r=jE(e,0);for(let i=0;i<t.length&&i<r.length;i++){const a=nm(t[i],r[i]);if(0!==a)return a}return t.length===r.length?0:t.length<r.length?-1:1}function vM(n,e){if(Uf(n)!==Uf(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function Ua(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Uf(n)>Uf(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class K${constructor(e,t){this.errorPrefix_=t,this.parts_=jE(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,P.ug)(this.parts_[r]);wF(this)}}function wF(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+rm(n))}function rm(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class wM extends mF{constructor(){let e,t;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new wM}getInitialEvent(e){return(0,P.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const HE=1e3;let mT,im=(()=>{class n extends gF{constructor(t,r,i,a,l,d,_,w){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=a,this.onServerInfoUpdate_=l,this.authTokenProvider_=d,this.appCheckTokenProvider_=_,this.authOverride_=w,this.id=n.nextPersistentConnectionId_++,this.log_=LE("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=HE,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,w&&!(0,P.Yr)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");wM.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&pT.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){const a=++this.requestNumber_,l={r:a,a:t,b:r};this.log_((0,P.Wl)(l)),(0,P.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(l),i&&(this.requestCBHash_[a]=i)}get(t){this.initConnection_();const r=new P.BH,i={p:t._path.toString(),q:t._queryObject};return this.outstandingGets_.push({action:"g",request:i,onComplete:d=>{const _=d.d;"ok"===d.s?r.resolve(_):r.reject(_)}}),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(t,r,i,a){this.initConnection_();const l=t._queryIdentifier,d=t._path.toString();this.log_("Listen called for "+d+" "+l),this.listens.has(d)||this.listens.set(d,new Map),(0,P.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,P.hu)(!this.listens.get(d).has(l),"listen() called twice for same path/queryId.");const _={onComplete:a,hashFn:r,query:t,tag:i};this.listens.get(d).set(l,_),this.connected_&&this.sendListen_(_)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){const r=t.query,i=r._path.toString(),a=r._queryIdentifier;this.log_("Listen on "+i+" for "+a);const l={p:i};t.tag&&(l.q=r._queryObject,l.t=t.tag),l.h=t.hashFn(),this.sendRequest("q",l,_=>{const w=_.d,D=_.s;n.warnOnListenWarnings_(w,r),(this.listens.get(i)&&this.listens.get(i).get(a))===t&&(this.log_("listen response",_),"ok"!==D&&this.removeListen_(i,a),t.onComplete&&t.onComplete(D,w))})}static warnOnListenWarnings_(t,r){if(t&&"object"==typeof t&&(0,P.r3)(t,"w")){const i=(0,P.DV)(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const a='".indexOn": "'+r._queryParams.getIndex().toString()+'"',l=r._path.toString();is(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${a} at ${l} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,P.GJ)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=(0,P.w9)(t)?"auth":"gauth",i={cred:t};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,a=>{const l=a.s,d=a.d||"error";this.authToken_===t&&("ok"===l?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(l,d))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,i=t.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){const i=t._path.toString(),a=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+a),(0,P.hu)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,a)&&this.connected_&&this.sendUnlisten_(i,a,t._queryObject,r)}sendUnlisten_(t,r,i,a){this.log_("Unlisten on "+t+" for "+r);const l={p:t};a&&(l.q=i,l.t=a),this.sendRequest("n",l)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,a){const l={p:r,d:i};this.log_("onDisconnect "+t,l),this.sendRequest(t,l,d=>{a&&setTimeout(()=>{a(d.s,d.d)},Math.floor(0))})}put(t,r,i,a){this.putInternal("p",t,r,i,a)}merge(t,r,i,a){this.putInternal("m",t,r,i,a)}putInternal(t,r,i,a,l){this.initConnection_();const d={p:r,d:i};void 0!==l&&(d.h=l),this.outstandingPuts_.push({action:t,request:d,onComplete:a}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,a=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,l=>{this.log_(r+" response",l),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),a&&a(l.s,l.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,P.Wl)(t));const r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),"d"===t?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===t?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===t?this.onListenRevoked_(r.p,r.q):"ac"===t?this.onAuthRevoked_(r.s,r.d):"apc"===t?this.onAppCheckRevoked_(r.s,r.d):"sd"===t?this.onSecurityDebugPacket_(r):uM("Unrecognized action received from server: "+(0,P.Wl)(t)+"\nAre you using the latest client?")}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,P.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=HE,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=HE,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=HE),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,ve.Z)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const r=t.onDataMessage_.bind(t),i=t.onReady_.bind(t),a=t.onRealtimeDisconnect_.bind(t),l=t.id+":"+n.nextConnectionId_++,d=t.lastSessionId;let _=!1,w=null;const D=function(){w?w.close():(_=!0,a())};t.realtime_={close:D,sendRequest:function(O){(0,P.hu)(w,"sendRequest call when we're not connected not allowed."),w.sendRequest(O)}};const M=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[O,j]=yield Promise.all([t.authTokenProvider_.getToken(M),t.appCheckTokenProvider_.getToken(M)]);_?Ti("getToken() completed but was canceled"):(Ti("getToken() completed. Creating connection."),t.authToken_=O&&O.accessToken,t.appCheckToken_=j&&j.token,w=new pF(l,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,r,i,a,ae=>{is(ae+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},d))}catch(O){t.log_("Failed to get token: "+O),_||(t.repoInfo_.nodeAdmin&&is(O),D())}}})()}interrupt(t){Ti("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Ti("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,P.xb)(this.interruptReasons_)&&(this.reconnectDelay_=HE,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;i=r?r.map(l=>lM(l)).join("$"):"default";const a=this.removeListen_(t,i);a&&a.onComplete&&a.onComplete("permission_denied")}removeListen_(t,r){const i=new Tn(t).toString();let a;if(this.listens.has(i)){const l=this.listens.get(i);a=l.get(r),l.delete(r),0===l.size&&this.listens.delete(i)}else a=void 0;return a}onAuthRevoked_(t,r){Ti("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Ti("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";(0,P.Yr)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+r+"."+oM.replace(/\./g,"-")]=1,(0,P.uI)()?t["framework.cordova"]=1:(0,P.b$)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=pT.getInstance().currentlyOnline();return(0,P.xb)(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class en{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new en(e,t)}}class gT{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new en(th,e),i=new en(th,t);return 0!==this.compare(r,i)}minPost(){return en.MIN}}class CF extends gT{static get __EMPTY_NODE(){return mT}static set __EMPTY_NODE(e){mT=e}compare(e,t){return nm(e.name,t.name)}isDefinedOn(e){throw(0,P.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return en.MIN}maxPost(){return new en(_c,mT)}makePost(e,t){return(0,P.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new en(e,mT)}toString(){return".key"}}const yc=new CF;class _T{constructor(e,t,r,i,a=null){this.isReverse_=i,this.resultGenerator_=a,this.nodeStack_=[];let l=1;for(;!e.isEmpty();)if(l=t?r(e.key,t):1,i&&(l*=-1),l<0)e=this.isReverse_?e.left:e.right;else{if(0===l){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let IM,Gu=(()=>{class n{constructor(t,r,i,a,l){this.key=t,this.value=r,this.color=i??n.RED,this.left=a??uo.EMPTY_NODE,this.right=l??uo.EMPTY_NODE}copy(t,r,i,a,l){return new n(t??this.key,r??this.value,i??this.color,a??this.left,l??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let a=this;const l=i(t,a.key);return a=l<0?a.copy(null,null,null,a.left.insert(t,r,i),null):0===l?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(t,r,i)),a.fixUp_()}removeMin_(){if(this.left.isEmpty())return uo.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,a;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(t,i.key)){if(i.right.isEmpty())return uo.EMPTY_NODE;a=i.right.min_(),i=i.copy(a.key,a.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class uo{constructor(e,t=uo.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new uo(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,Gu.BLACK,null,null))}remove(e){return new uo(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Gu.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new _T(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new _T(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new _T(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new _T(this.root_,null,this.comparator_,!0,e)}}function nG(n,e){return nm(n.name,e.name)}function EM(n,e){return nm(n,e)}uo.EMPTY_NODE=new class tG{copy(e,t,r,i,a){return this}insert(e,t,r){return new Gu(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const bF=function(n){return"number"==typeof n?"number:"+$1(n):"string:"+n},DF=function(n){if(n.isLeafNode()){const e=n.val();(0,P.hu)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,P.r3)(e,".sv"),"Priority must be a string or number.")}else(0,P.hu)(n===IM||n.isEmpty(),"priority of unexpected type.");(0,P.hu)(n===IM||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let TF,SF,AF,Ty=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,(0,P.hu)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),DF(this.priorityNode_)}static set __childrenNodeConstructor(t){TF=t}static get __childrenNodeConstructor(){return TF}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Yt(t)?this:".priority"===Zt(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const i=Zt(t);return null===i?r:r.isEmpty()&&".priority"!==i?this:((0,P.hu)(".priority"!==i||1===Uf(t),".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(Bn(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+bF(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",t+="number"===r?$1(this.value_):this.value_,this.lazyHash_=U1(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:((0,P.hu)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,i=typeof this.value_,a=n.VALUE_TYPE_ORDER.indexOf(r),l=n.VALUE_TYPE_ORDER.indexOf(i);return(0,P.hu)(a>=0,"Unknown leaf type: "+r),(0,P.hu)(l>=0,"Unknown leaf type: "+i),a===l?"object"===i?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:l-a}withIndex(){return this}isIndexed(){return!0}equals(t){if(t===this)return!0;if(t.isLeafNode()){const r=t;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}return!1}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const Wn=new class oG extends gT{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),a=r.compareTo(i);return 0===a?nm(e.name,t.name):a}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return en.MIN}maxPost(){return new en(_c,new Ty("[PRIORITY-POST]",AF))}makePost(e,t){const r=SF(e);return new en(t,new Ty("[PRIORITY-POST]",r))}toString(){return".priority"}},aG=Math.log(2);class uG{constructor(e){this.count=parseInt(Math.log(e+1)/aG,10),this.current_=this.count-1;const i=(a=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const yT=function(n,e,t,r){n.sort(e);const i=function(_,w){const D=w-_;let S,M;if(0===D)return null;if(1===D)return S=n[_],M=t?t(S):S,new Gu(M,S.node,Gu.BLACK,null,null);{const O=parseInt(D/2,10)+_,j=i(_,O),ae=i(O+1,w);return S=n[O],M=t?t(S):S,new Gu(M,S.node,Gu.BLACK,j,ae)}},d=function(_){let w=null,D=null,S=n.length;const M=function(j,ae){const he=S-j,$e=S;S-=j;const nt=i(he+1,$e),et=n[he],at=t?t(et):et;O(new Gu(at,et.node,ae,null,nt))},O=function(j){w?(w.left=j,w=j):(D=j,w=j)};for(let j=0;j<_.count;++j){const ae=_.nextBitIsOne(),he=Math.pow(2,_.count-(j+1));ae?M(he,Gu.BLACK):(M(he,Gu.BLACK),M(he,Gu.RED))}return D}(new uG(n.length));return new uo(r||e,d)};let CM;const Sy={};class nh{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,P.hu)(Sy&&Wn,"ChildrenNode.ts has not been loaded"),CM=CM||new nh({".priority":Sy},{".priority":Wn}),CM}get(e){const t=(0,P.DV)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof uo?t:null}hasIndex(e){return(0,P.r3)(this.indexSet_,e.toString())}addIndex(e,t){(0,P.hu)(e!==yc,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const a=t.getIterator(en.Wrap);let d,l=a.getNext();for(;l;)i=i||e.isDefinedOn(l.node),r.push(l),l=a.getNext();d=i?yT(r,e.getCompare()):Sy;const _=e.toString(),w=Object.assign({},this.indexSet_);w[_]=e;const D=Object.assign({},this.indexes_);return D[_]=d,new nh(D,w)}addToIndexes(e,t){const r=(0,P.UI)(this.indexes_,(i,a)=>{const l=(0,P.DV)(this.indexSet_,a);if((0,P.hu)(l,"Missing index implementation for "+a),i===Sy){if(l.isDefinedOn(e.node)){const d=[],_=t.getIterator(en.Wrap);let w=_.getNext();for(;w;)w.name!==e.name&&d.push(w),w=_.getNext();return d.push(e),yT(d,l.getCompare())}return Sy}{const d=t.get(e.name);let _=i;return d&&(_=_.remove(new en(e.name,d))),_.insert(e,e.node)}});return new nh(r,this.indexSet_)}removeFromIndexes(e,t){const r=(0,P.UI)(this.indexes_,i=>{if(i===Sy)return i;{const a=t.get(e.name);return a?i.remove(new en(e.name,a)):i}});return new nh(r,this.indexSet_)}}let $E,Gt=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&DF(this.priorityNode_),this.children_.isEmpty()&&(0,P.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return $E||($E=new n(new uo(EM),null,nh.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||$E}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const r=this.children_.get(t);return null===r?$E:r}}getChild(t){const r=Zt(t);return null===r?this:this.getImmediateChild(r).getChild(Bn(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,r){if((0,P.hu)(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);{const i=new en(t,r);let a,l;r.isEmpty()?(a=this.children_.remove(t),l=this.indexMap_.removeFromIndexes(i,this.children_)):(a=this.children_.insert(t,r),l=this.indexMap_.addToIndexes(i,this.children_));const d=a.isEmpty()?$E:this.priorityNode_;return new n(a,d,l)}}updateChild(t,r){const i=Zt(t);if(null===i)return r;{(0,P.hu)(".priority"!==Zt(t)||1===Uf(t),".priority must be the last token in a path");const a=this.getImmediateChild(i).updateChild(Bn(t),r);return this.updateImmediateChild(i,a)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let i=0,a=0,l=!0;if(this.forEachChild(Wn,(d,_)=>{r[d]=_.val(t),i++,l&&n.INTEGER_REGEXP_.test(d)?a=Math.max(a,Number(d)):l=!1}),!t&&l&&a<2*i){const d=[];for(const _ in r)d[_]=r[_];return d}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+bF(this.getPriority().val())+":"),this.forEachChild(Wn,(r,i)=>{const a=i.hash();""!==a&&(t+=":"+r+":"+a)}),this.lazyHash_=""===t?"":U1(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){const a=this.resolveIndex_(i);if(a){const l=a.getPredecessorKey(new en(t,r));return l?l.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new en(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new en(r,this.children_.get(r)):null}forEachChild(t,r){const i=this.resolveIndex_(t);return i?i.inorderTraversal(a=>r(a.name,a.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,a=>a);{const a=this.children_.getIteratorFrom(t.name,en.Wrap);let l=a.peek();for(;null!=l&&r.compare(l,t)<0;)a.getNext(),l=a.peek();return a}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,a=>a);{const a=this.children_.getReverseIteratorFrom(t.name,en.Wrap);let l=a.peek();for(;null!=l&&r.compare(l,t)>0;)a.getNext(),l=a.peek();return a}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===GE?-1:0}withIndex(t){if(t===yc||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===yc||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(Wn),a=r.getIterator(Wn);let l=i.getNext(),d=a.getNext();for(;l&&d;){if(l.name!==d.name||!l.node.equals(d.node))return!1;l=i.getNext(),d=a.getNext()}return null===l&&null===d}return!1}return!1}}resolveIndex_(t){return t===yc?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const GE=new class lG extends Gt{constructor(){super(new uo(EM),Gt.EMPTY_NODE,nh.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Gt.EMPTY_NODE}isEmpty(){return!1}};function Ir(n,e=null){if(null===n)return Gt.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),(0,P.hu)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new Ty(n,Ir(e));if(n instanceof Array){let t=Gt.EMPTY_NODE;return Si(n,(r,i)=>{if((0,P.r3)(n,r)&&"."!==r.substring(0,1)){const a=Ir(i);(a.isLeafNode()||!a.isEmpty())&&(t=t.updateImmediateChild(r,a))}}),t.updatePriority(Ir(e))}{const t=[];let r=!1;if(Si(n,(l,d)=>{if("."!==l.substring(0,1)){const _=Ir(d);_.isEmpty()||(r=r||!_.getPriority().isEmpty(),t.push(new en(l,_)))}}),0===t.length)return Gt.EMPTY_NODE;const a=yT(t,nG,l=>l.name,EM);if(r){const l=yT(t,Wn.getCompare());return new Gt(a,Ir(e),new nh({".priority":l},{".priority":Wn}))}return new Gt(a,Ir(e),nh.Default)}}Object.defineProperties(en,{MIN:{value:new en(th,Gt.EMPTY_NODE)},MAX:{value:new en(_c,GE)}}),CF.__EMPTY_NODE=Gt.EMPTY_NODE,Ty.__childrenNodeConstructor=Gt,function rG(n){IM=n}(GE),function sG(n){AF=n}(GE),function iG(n){SF=n}(Ir);class bM extends gT{constructor(e){super(),this.indexPath_=e,(0,P.hu)(!Yt(e)&&".priority"!==Zt(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),a=r.compareTo(i);return 0===a?nm(e.name,t.name):a}makePost(e,t){const r=Ir(e),i=Gt.EMPTY_NODE.updateChild(this.indexPath_,r);return new en(t,i)}maxPost(){const e=Gt.EMPTY_NODE.updateChild(this.indexPath_,GE);return new en(_c,e)}toString(){return jE(this.indexPath_,0).join("/")}}const DM=new class dG extends gT{compare(e,t){const r=e.node.compareTo(t.node);return 0===r?nm(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return en.MIN}maxPost(){return en.MAX}makePost(e,t){const r=Ir(e);return new en(t,r)}toString(){return".value"}},Ay="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",hG=function(){let n=0;const e=[];return function(t){const r=t===n;let i;n=t;const a=new Array(8);for(i=7;i>=0;i--)a[i]=Ay.charAt(t%64),t=Math.floor(t/64);(0,P.hu)(0===t,"Cannot push at time == 0");let l=a.join("");if(r){for(i=11;i>=0&&63===e[i];i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(64*Math.random());for(i=0;i<12;i++)l+=Ay.charAt(e[i]);return(0,P.hu)(20===l.length,"nextPushId: Length should be 20."),l}}(),MF=function(n){if(n===""+cM)return"-";const e=dT(n);if(null!=e)return""+(e+1);const t=new Array(n.length);for(let l=0;l<t.length;l++)t[l]=n.charAt(l);if(t.length<786)return t.push("-"),t.join("");let r=t.length-1;for(;r>=0&&"z"===t[r];)r--;if(-1===r)return _c;const a=Ay.charAt(Ay.indexOf(t[r])+1);return t[r]=a,t.slice(0,r+1).join("")},NF=function(n){if(n===""+G1)return th;const e=dT(n);if(null!=e)return""+(e-1);const t=new Array(n.length);for(let r=0;r<t.length;r++)t[r]=n.charAt(r);return"-"===t[t.length-1]?1===t.length?""+cM:(delete t[t.length-1],t.join("")):(t[t.length-1]=Ay.charAt(Ay.indexOf(t[t.length-1])-1),t.join("")+"z".repeat(786-t.length))};function kF(n){return{type:"value",snapshotNode:n}}function xy(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function WE(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function zE(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class SM{constructor(e){this.index_=e}updateChild(e,t,r,i,a,l){(0,P.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const d=e.getImmediateChild(t);return d.getChild(i).equals(r.getChild(i))&&d.isEmpty()===r.isEmpty()||(null!=l&&(r.isEmpty()?e.hasChild(t)?l.trackChildChange(WE(t,d)):(0,P.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):d.isEmpty()?l.trackChildChange(xy(t,r)):l.trackChildChange(zE(t,r,d))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(Wn,(i,a)=>{t.hasChild(i)||r.trackChildChange(WE(i,a))}),t.isLeafNode()||t.forEachChild(Wn,(i,a)=>{if(e.hasChild(i)){const l=e.getImmediateChild(i);l.equals(a)||r.trackChildChange(zE(i,a,l))}else r.trackChildChange(xy(i,a))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?Gt.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class qE{constructor(e){this.indexedFilter_=new SM(e.getIndex()),this.index_=e.getIndex(),this.startPost_=qE.getStartPost_(e),this.endPost_=qE.getEndPost_(e)}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0}updateChild(e,t,r,i,a,l){return this.matches(new en(t,r))||(r=Gt.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,a,l)}updateFullNode(e,t,r){t.isLeafNode()&&(t=Gt.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(Gt.EMPTY_NODE);const a=this;return t.forEachChild(Wn,(l,d)=>{a.matches(new en(l,d))||(i=i.updateImmediateChild(l,Gt.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class pG{constructor(e){this.rangedFilter_=new qE(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}updateChild(e,t,r,i,a,l){return this.rangedFilter_.matches(new en(t,r))||(r=Gt.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,a,l):this.fullLimitUpdateChild_(e,t,r,a,l)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=Gt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let a;i=Gt.EMPTY_NODE.withIndex(this.index_),a=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let l=0;for(;a.hasNext()&&l<this.limit_;){const d=a.getNext();let _;if(_=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),d)<=0:this.index_.compare(d,this.rangedFilter_.getEndPost())<=0,!_)break;i=i.updateImmediateChild(d.name,d.node),l++}}else{let a,l,d,_;if(i=t.withIndex(this.index_),i=i.updatePriority(Gt.EMPTY_NODE),this.reverse_){_=i.getReverseIterator(this.index_),a=this.rangedFilter_.getEndPost(),l=this.rangedFilter_.getStartPost();const S=this.index_.getCompare();d=(M,O)=>S(O,M)}else _=i.getIterator(this.index_),a=this.rangedFilter_.getStartPost(),l=this.rangedFilter_.getEndPost(),d=this.index_.getCompare();let w=0,D=!1;for(;_.hasNext();){const S=_.getNext();!D&&d(a,S)<=0&&(D=!0),D&&w<this.limit_&&d(S,l)<=0?w++:i=i.updateImmediateChild(S.name,Gt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,a){let l;if(this.reverse_){const S=this.index_.getCompare();l=(M,O)=>S(O,M)}else l=this.index_.getCompare();const d=e;(0,P.hu)(d.numChildren()===this.limit_,"");const _=new en(t,r),w=this.reverse_?d.getFirstChild(this.index_):d.getLastChild(this.index_),D=this.rangedFilter_.matches(_);if(d.hasChild(t)){const S=d.getImmediateChild(t);let M=i.getChildAfterChild(this.index_,w,this.reverse_);for(;null!=M&&(M.name===t||d.hasChild(M.name));)M=i.getChildAfterChild(this.index_,M,this.reverse_);const O=null==M?1:l(M,_);if(D&&!r.isEmpty()&&O>=0)return a?.trackChildChange(zE(t,r,S)),d.updateImmediateChild(t,r);{a?.trackChildChange(WE(t,S));const ae=d.updateImmediateChild(t,Gt.EMPTY_NODE);return null!=M&&this.rangedFilter_.matches(M)?(a?.trackChildChange(xy(M.name,M.node)),ae.updateImmediateChild(M.name,M.node)):ae}}return r.isEmpty()?e:D&&l(w,_)>=0?(null!=a&&(a.trackChildChange(WE(w.name,w.node)),a.trackChildChange(xy(t,r))),d.updateImmediateChild(t,r).updateImmediateChild(w.name,Gt.EMPTY_NODE)):e}}class vT{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Wn}hasStart(){return this.startSet_}hasStartAfter(){return this.startAfterSet_}hasEndBefore(){return this.endBeforeSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,P.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,P.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:th}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,P.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,P.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:_c}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,P.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Wn}copy(){const e=new vT;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function AM(n,e,t){const r=n.copy();return r.startSet_=!0,void 0===e&&(e=null),r.indexStartValue_=e,null!=t?(r.startNameSet_=!0,r.indexStartName_=t):(r.startNameSet_=!1,r.indexStartName_=""),r}function xM(n,e,t){const r=n.copy();return r.endSet_=!0,void 0===e&&(e=null),r.indexEndValue_=e,void 0!==t?(r.endNameSet_=!0,r.indexEndName_=t):(r.endNameSet_=!1,r.indexEndName_=""),r}function wT(n,e){const t=n.copy();return t.index_=e,t}function PF(n){const e={};if(n.isDefault())return e;let t;return n.index_===Wn?t="$priority":n.index_===DM?t="$value":n.index_===yc?t="$key":((0,P.hu)(n.index_ instanceof bM,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=(0,P.Wl)(t),n.startSet_&&(e.startAt=(0,P.Wl)(n.indexStartValue_),n.startNameSet_&&(e.startAt+=","+(0,P.Wl)(n.indexStartName_))),n.endSet_&&(e.endAt=(0,P.Wl)(n.indexEndValue_),n.endNameSet_&&(e.endAt+=","+(0,P.Wl)(n.indexEndName_))),n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function OF(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_)),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_)),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==Wn&&(e.i=n.index_.toString()),e}class ET extends gF{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=LE("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,P.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const a=e._path.toString();this.log_("Listen called for "+a+" "+e._queryIdentifier);const l=ET.getListenId_(e,r),d={};this.listens_[l]=d;const _=PF(e._queryParams);this.restRequest_(a+".json",_,(w,D)=>{let S=D;if(404===w&&(S=null,w=null),null===w&&this.onDataUpdate_(a,S,!1,r),(0,P.DV)(this.listens_,l)===d){let M;M=w?401===w?"permission_denied":"rest_error:"+w:"ok",i(M,null)}})}unlisten(e,t){const r=ET.getListenId_(e,t);delete this.listens_[r]}get(e){const t=PF(e._queryParams),r=e._path.toString(),i=new P.BH;return this.restRequest_(r+".json",t,(a,l)=>{let d=l;404===a&&(d=null,a=null),null===a?(this.onDataUpdate_(r,d,!1,null),i.resolve(d)):i.reject(new Error(d))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,a])=>{i&&i.accessToken&&(t.auth=i.accessToken),a&&a.token&&(t.ac=a.token);const l=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,P.xO)(t);this.log_("Sending REST request for "+l);const d=new XMLHttpRequest;d.onreadystatechange=()=>{if(r&&4===d.readyState){this.log_("REST Response for "+l+" received. status:",d.status,"response:",d.responseText);let _=null;if(d.status>=200&&d.status<300){try{_=(0,P.cI)(d.responseText)}catch{is("Failed to parse JSON response for "+l+": "+d.responseText)}r(null,_)}else 401!==d.status&&404!==d.status&&is("Got unsuccessful REST response for "+l+" Status: "+d.status),r(d.status);r=null}},d.open("GET",l,!0),d.send()})}}class wG{constructor(){this.rootNode_=Gt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function IT(){return{value:null,children:new Map}}function Ry(n,e,t){if(Yt(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const r=Zt(e);n.children.has(r)||n.children.set(r,IT()),Ry(n.children.get(r),e=Bn(e),t)}}function RM(n,e){if(Yt(e))return n.value=null,n.children.clear(),!0;if(null!==n.value){if(n.value.isLeafNode())return!1;{const t=n.value;return n.value=null,t.forEachChild(Wn,(r,i)=>{Ry(n,new Tn(r),i)}),RM(n,e)}}if(n.children.size>0){const t=Zt(e);return e=Bn(e),n.children.has(t)&&RM(n.children.get(t),e)&&n.children.delete(t),0===n.children.size}return!0}function MM(n,e,t){null!==n.value?t(e,n.value):function EG(n,e){n.children.forEach((t,r)=>{e(r,t)})}(n,(r,i)=>{MM(i,new Tn(e.toString()+"/"+r),t)})}class IG{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Si(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}class DG{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new IG(e);const r=1e4+2e4*Math.random();UE(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;Si(e,(i,a)=>{a>0&&(0,P.r3)(this.statsToReport_,i)&&(t[i]=a,r=!0)}),r&&this.server_.reportStats(t),UE(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var Ba=(()=>(function(n){n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Ba||(Ba={})),Ba))();function PM(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class CT{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=Ba.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Yt(this.path)){if(null!=this.affectedTree.value)return(0,P.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new Tn(e));return new CT(_n(),t,this.revert)}}return(0,P.hu)(Zt(this.path)===e,"operationForChild called for unrelated child."),new CT(Bn(this.path),this.affectedTree,this.revert)}}class KE{constructor(e,t){this.source=e,this.path=t,this.type=Ba.LISTEN_COMPLETE}operationForChild(e){return Yt(this.path)?new KE(this.source,_n()):new KE(this.source,Bn(this.path))}}class sm{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=Ba.OVERWRITE}operationForChild(e){return Yt(this.path)?new sm(this.source,_n(),this.snap.getImmediateChild(e)):new sm(this.source,Bn(this.path),this.snap)}}class My{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=Ba.MERGE}operationForChild(e){if(Yt(this.path)){const t=this.children.subtree(new Tn(e));return t.isEmpty()?null:t.value?new sm(this.source,_n(),t.value):new My(this.source,_n(),t)}return(0,P.hu)(Zt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new My(this.source,Bn(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Bf{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Yt(e))return this.isFullyInitialized()&&!this.filtered_;const t=Zt(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class TG{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function ZE(n,e,t,r,i,a){const l=r.filter(d=>d.type===t);l.sort((d,_)=>function xG(n,e,t){if(null==e.childName||null==t.childName)throw(0,P.g5)("Should only compare child_ events.");const r=new en(e.childName,e.snapshotNode),i=new en(t.childName,t.snapshotNode);return n.index_.compare(r,i)}(n,d,_)),l.forEach(d=>{const _=function AG(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,d,a);i.forEach(w=>{w.respondsTo(d.type)&&e.push(w.createEvent(_,n.query_))})})}function bT(n,e){return{eventCache:n,serverCache:e}}function YE(n,e,t,r){return bT(new Bf(e,t,r),n.serverCache)}function LF(n,e,t,r){return bT(n.eventCache,new Bf(e,t,r))}function DT(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function om(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let OM;class zn{constructor(e,t=(()=>(OM||(OM=new uo(p$)),OM))()){this.value=e,this.children=t}static fromObject(e){let t=new zn(null);return Si(e,(r,i)=>{t=t.set(new Tn(r),i)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:_n(),value:this.value};if(Yt(e))return null;{const r=Zt(e),i=this.children.get(r);if(null!==i){const a=i.findRootMostMatchingPathAndValue(Bn(e),t);return null!=a?{path:dr(new Tn(r),a.path),value:a.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Yt(e))return this;{const t=Zt(e),r=this.children.get(t);return null!==r?r.subtree(Bn(e)):new zn(null)}}set(e,t){if(Yt(e))return new zn(t,this.children);{const r=Zt(e),a=(this.children.get(r)||new zn(null)).set(Bn(e),t),l=this.children.insert(r,a);return new zn(this.value,l)}}remove(e){if(Yt(e))return this.children.isEmpty()?new zn(null):new zn(null,this.children);{const t=Zt(e),r=this.children.get(t);if(r){const i=r.remove(Bn(e));let a;return a=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&a.isEmpty()?new zn(null):new zn(this.value,a)}return this}}get(e){if(Yt(e))return this.value;{const t=Zt(e),r=this.children.get(t);return r?r.get(Bn(e)):null}}setTree(e,t){if(Yt(e))return t;{const r=Zt(e),a=(this.children.get(r)||new zn(null)).setTree(Bn(e),t);let l;return l=a.isEmpty()?this.children.remove(r):this.children.insert(r,a),new zn(this.value,l)}}fold(e){return this.fold_(_n(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,a)=>{r[i]=a.fold_(dr(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,_n(),t)}findOnPath_(e,t,r){const i=!!this.value&&r(t,this.value);if(i)return i;if(Yt(e))return null;{const a=Zt(e),l=this.children.get(a);return l?l.findOnPath_(Bn(e),dr(t,a),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,_n(),t)}foreachOnPath_(e,t,r){if(Yt(e))return this;{this.value&&r(t,this.value);const i=Zt(e),a=this.children.get(i);return a?a.foreachOnPath_(Bn(e),dr(t,i),r):new zn(null)}}foreach(e){this.foreach_(_n(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(dr(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}class Wu{constructor(e){this.writeTree_=e}static empty(){return new Wu(new zn(null))}}function QE(n,e,t){if(Yt(e))return new Wu(new zn(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let a=r.value;const l=ks(i,e);return a=a.updateChild(l,t),new Wu(n.writeTree_.set(i,a))}{const i=new zn(t),a=n.writeTree_.setTree(e,i);return new Wu(a)}}}function FM(n,e,t){let r=n;return Si(t,(i,a)=>{r=QE(r,dr(e,i),a)}),r}function VF(n,e){if(Yt(e))return Wu.empty();{const t=n.writeTree_.setTree(e,new zn(null));return new Wu(t)}}function LM(n,e){return null!=am(n,e)}function am(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(ks(t.path,e)):null}function UF(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(Wn,(r,i)=>{e.push(new en(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&e.push(new en(r,i.value))}),e}function jf(n,e){if(Yt(e))return n;{const t=am(n,e);return new Wu(null!=t?new zn(t):n.writeTree_.subtree(e))}}function VM(n){return n.writeTree_.isEmpty()}function Ny(n,e){return BF(_n(),n.writeTree_,e)}function BF(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,a)=>{".priority"===i?((0,P.hu)(null!==a.value,"Priority writes must always be leaf nodes"),r=a.value):t=BF(dr(n,i),a,t)}),!t.getChild(n).isEmpty()&&null!==r&&(t=t.updateChild(dr(n,".priority"),r)),t}}function TT(n,e){return WF(e,n)}function OG(n,e){if(n.snap)return Ua(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&Ua(dr(n.path,t),e))return!0;return!1}function LG(n){return n.visible}function jF(n,e,t){let r=Wu.empty();for(let i=0;i<n.length;++i){const a=n[i];if(e(a)){const l=a.path;let d;if(a.snap)Ua(t,l)?(d=ks(t,l),r=QE(r,d,a.snap)):Ua(l,t)&&(d=ks(l,t),r=QE(r,_n(),a.snap.getChild(d)));else{if(!a.children)throw(0,P.g5)("WriteRecord should have .snap or .children");if(Ua(t,l))d=ks(t,l),r=FM(r,d,a.children);else if(Ua(l,t))if(d=ks(l,t),Yt(d))r=FM(r,_n(),a.children);else{const _=(0,P.DV)(a.children,Zt(d));if(_){const w=_.getChild(Bn(d));r=QE(r,_n(),w)}}}}}return r}function HF(n,e,t,r,i){if(r||i){const a=jf(n.visibleWrites,e);return!i&&VM(a)?t:i||null!=t||LM(a,_n())?Ny(jF(n.allWrites,function(w){return(w.visible||i)&&(!r||!~r.indexOf(w.writeId))&&(Ua(w.path,e)||Ua(e,w.path))},e),t||Gt.EMPTY_NODE):null}{const a=am(n.visibleWrites,e);if(null!=a)return a;{const l=jf(n.visibleWrites,e);return VM(l)?t:null!=t||LM(l,_n())?Ny(l,t||Gt.EMPTY_NODE):null}}}function ST(n,e,t,r){return HF(n.writeTree,n.treePath,e,t,r)}function UM(n,e){return function VG(n,e,t){let r=Gt.EMPTY_NODE;const i=am(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Wn,(a,l)=>{r=r.updateImmediateChild(a,l)}),r;if(t){const a=jf(n.visibleWrites,e);return t.forEachChild(Wn,(l,d)=>{const _=Ny(jf(a,new Tn(l)),d);r=r.updateImmediateChild(l,_)}),UF(a).forEach(l=>{r=r.updateImmediateChild(l.name,l.node)}),r}return UF(jf(n.visibleWrites,e)).forEach(l=>{r=r.updateImmediateChild(l.name,l.node)}),r}(n.writeTree,n.treePath,e)}function $F(n,e,t,r){return function UG(n,e,t,r,i){(0,P.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");const a=dr(e,t);if(LM(n.visibleWrites,a))return null;{const l=jf(n.visibleWrites,a);return VM(l)?i.getChild(t):Ny(l,i.getChild(t))}}(n.writeTree,n.treePath,e,t,r)}function AT(n,e){return function jG(n,e){return am(n.visibleWrites,e)}(n.writeTree,dr(n.treePath,e))}function BM(n,e,t){return function BG(n,e,t,r){const i=dr(e,t),a=am(n.visibleWrites,i);return null!=a?a:r.isCompleteForChild(t)?Ny(jf(n.visibleWrites,i),r.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function GF(n,e){return WF(dr(n.treePath,e),n.writeTree)}function WF(n,e){return{treePath:n,writeTree:e}}class WG{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;(0,P.hu)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,P.hu)(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const a=i.type;if("child_added"===t&&"child_removed"===a)this.changeMap.set(r,zE(r,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===a)this.changeMap.delete(r);else if("child_removed"===t&&"child_changed"===a)this.changeMap.set(r,WE(r,i.oldSnap));else if("child_changed"===t&&"child_added"===a)this.changeMap.set(r,xy(r,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==a)throw(0,P.g5)("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(r,zE(r,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const zF=new class zG{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}};class jM{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new Bf(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return BM(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:om(this.viewCache_),a=function GG(n,e,t,r,i,a){return function HG(n,e,t,r,i,a,l){let d;const _=jf(n.visibleWrites,e),w=am(_,_n());if(null!=w)d=w;else{if(null==t)return[];d=Ny(_,t)}if(d=d.withIndex(l),d.isEmpty()||d.isLeafNode())return[];{const D=[],S=l.getCompare(),M=a?d.getReverseIteratorFrom(r,l):d.getIteratorFrom(r,l);let O=M.getNext();for(;O&&D.length<i;)0!==S(O,r)&&D.push(O),O=M.getNext();return D}}(n.writeTree,n.treePath,e,t,r,i,a)}(this.writes_,i,t,1,r,e);return 0===a.length?null:a[0]}}function qF(n,e,t,r,i,a){const l=e.eventCache;if(null!=AT(r,t))return e;{let d,_;if(Yt(t))if((0,P.hu)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const w=om(e),S=UM(r,w instanceof Gt?w:Gt.EMPTY_NODE);d=n.filter.updateFullNode(e.eventCache.getNode(),S,a)}else{const w=ST(r,om(e));d=n.filter.updateFullNode(e.eventCache.getNode(),w,a)}else{const w=Zt(t);if(".priority"===w){(0,P.hu)(1===Uf(t),"Can't have a priority with additional path components");const D=l.getNode();_=e.serverCache.getNode();const S=$F(r,t,D,_);d=null!=S?n.filter.updatePriority(D,S):l.getNode()}else{const D=Bn(t);let S;if(l.isCompleteForChild(w)){_=e.serverCache.getNode();const M=$F(r,t,l.getNode(),_);S=null!=M?l.getNode().getImmediateChild(w).updateChild(D,M):l.getNode().getImmediateChild(w)}else S=BM(r,w,e.serverCache);d=null!=S?n.filter.updateChild(l.getNode(),w,S,D,i,a):l.getNode()}}return YE(e,d,l.isFullyInitialized()||Yt(t),n.filter.filtersNodes())}}function xT(n,e,t,r,i,a,l,d){const _=e.serverCache;let w;const D=l?n.filter:n.filter.getIndexedFilter();if(Yt(t))w=D.updateFullNode(_.getNode(),r,null);else if(D.filtersNodes()&&!_.isFiltered()){const O=_.getNode().updateChild(t,r);w=D.updateFullNode(_.getNode(),O,null)}else{const O=Zt(t);if(!_.isCompleteForPath(t)&&Uf(t)>1)return e;const j=Bn(t),he=_.getNode().getImmediateChild(O).updateChild(j,r);w=".priority"===O?D.updatePriority(_.getNode(),he):D.updateChild(_.getNode(),O,he,j,zF,null)}const S=LF(e,w,_.isFullyInitialized()||Yt(t),D.filtersNodes());return qF(n,S,t,i,new jM(i,S,a),d)}function HM(n,e,t,r,i,a,l){const d=e.eventCache;let _,w;const D=new jM(i,e,a);if(Yt(t))w=n.filter.updateFullNode(e.eventCache.getNode(),r,l),_=YE(e,w,!0,n.filter.filtersNodes());else{const S=Zt(t);if(".priority"===S)w=n.filter.updatePriority(e.eventCache.getNode(),r),_=YE(e,w,d.isFullyInitialized(),d.isFiltered());else{const M=Bn(t),O=d.getNode().getImmediateChild(S);let j;if(Yt(M))j=r;else{const ae=D.getCompleteChild(S);j=null!=ae?".priority"===yM(M)&&ae.getChild(vF(M)).isEmpty()?ae:ae.updateChild(M,r):Gt.EMPTY_NODE}_=O.equals(j)?e:YE(e,n.filter.updateChild(d.getNode(),S,j,M,D,l),d.isFullyInitialized(),n.filter.filtersNodes())}}return _}function KF(n,e){return n.eventCache.isCompleteForChild(e)}function ZF(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function $M(n,e,t,r,i,a,l,d){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let w,_=e;w=Yt(t)?r:new zn(null).setTree(t,r);const D=e.serverCache.getNode();return w.children.inorderTraversal((S,M)=>{if(D.hasChild(S)){const j=ZF(0,e.serverCache.getNode().getImmediateChild(S),M);_=xT(n,_,new Tn(S),j,i,a,l,d)}}),w.children.inorderTraversal((S,M)=>{const O=!e.serverCache.isCompleteForChild(S)&&null===M.value;if(!D.hasChild(S)&&!O){const ae=ZF(0,e.serverCache.getNode().getImmediateChild(S),M);_=xT(n,_,new Tn(S),ae,i,a,l,d)}}),_}class tW{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new SM(r.getIndex()),a=function gG(n){return n.loadsAllData()?new SM(n.getIndex()):n.hasLimit()?new pG(n):new qE(n)}(r);this.processor_=function qG(n){return{filter:n}}(a);const l=t.serverCache,d=t.eventCache,_=i.updateFullNode(Gt.EMPTY_NODE,l.getNode(),null),w=a.updateFullNode(Gt.EMPTY_NODE,d.getNode(),null),D=new Bf(_,l.isFullyInitialized(),i.filtersNodes()),S=new Bf(w,d.isFullyInitialized(),a.filtersNodes());this.viewCache_=bT(S,D),this.eventGenerator_=new TG(this.query_)}get query(){return this.query_}}function iW(n,e){const t=om(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Yt(e)&&!t.getImmediateChild(Zt(e)).isEmpty())?t.getChild(e):null}function YF(n){return 0===n.eventRegistrations_.length}function QF(n,e,t){const r=[];if(t){(0,P.hu)(null==e,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(a=>{const l=a.createCancelEvent(t,i);l&&r.push(l)})}if(e){let i=[];for(let a=0;a<n.eventRegistrations_.length;++a){const l=n.eventRegistrations_[a];if(l.matches(e)){if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(a+1));break}}else i.push(l)}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function JF(n,e,t,r){e.type===Ba.MERGE&&null!==e.source.queryId&&((0,P.hu)(om(n.viewCache_),"We should always have a full cache before handling merges"),(0,P.hu)(DT(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,a=function ZG(n,e,t,r,i){const a=new WG;let l,d;if(t.type===Ba.OVERWRITE){const w=t;w.source.fromUser?l=HM(n,e,w.path,w.snap,r,i,a):((0,P.hu)(w.source.fromServer,"Unknown source."),d=w.source.tagged||e.serverCache.isFiltered()&&!Yt(w.path),l=xT(n,e,w.path,w.snap,r,i,d,a))}else if(t.type===Ba.MERGE){const w=t;w.source.fromUser?l=function QG(n,e,t,r,i,a,l){let d=e;return r.foreach((_,w)=>{const D=dr(t,_);KF(e,Zt(D))&&(d=HM(n,d,D,w,i,a,l))}),r.foreach((_,w)=>{const D=dr(t,_);KF(e,Zt(D))||(d=HM(n,d,D,w,i,a,l))}),d}(n,e,w.path,w.children,r,i,a):((0,P.hu)(w.source.fromServer,"Unknown source."),d=w.source.tagged||e.serverCache.isFiltered(),l=$M(n,e,w.path,w.children,r,i,d,a))}else if(t.type===Ba.ACK_USER_WRITE){const w=t;l=w.revert?function eW(n,e,t,r,i,a){let l;if(null!=AT(r,t))return e;{const d=new jM(r,e,i),_=e.eventCache.getNode();let w;if(Yt(t)||".priority"===Zt(t)){let D;if(e.serverCache.isFullyInitialized())D=ST(r,om(e));else{const S=e.serverCache.getNode();(0,P.hu)(S instanceof Gt,"serverChildren would be complete if leaf node"),D=UM(r,S)}w=n.filter.updateFullNode(_,D,a)}else{const D=Zt(t);let S=BM(r,D,e.serverCache);null==S&&e.serverCache.isCompleteForChild(D)&&(S=_.getImmediateChild(D)),w=null!=S?n.filter.updateChild(_,D,S,Bn(t),d,a):e.eventCache.getNode().hasChild(D)?n.filter.updateChild(_,D,Gt.EMPTY_NODE,Bn(t),d,a):_,w.isEmpty()&&e.serverCache.isFullyInitialized()&&(l=ST(r,om(e)),l.isLeafNode()&&(w=n.filter.updateFullNode(w,l,a)))}return l=e.serverCache.isFullyInitialized()||null!=AT(r,_n()),YE(e,w,l,n.filter.filtersNodes())}}(n,e,w.path,r,i,a):function JG(n,e,t,r,i,a,l){if(null!=AT(i,t))return e;const d=e.serverCache.isFiltered(),_=e.serverCache;if(null!=r.value){if(Yt(t)&&_.isFullyInitialized()||_.isCompleteForPath(t))return xT(n,e,t,_.getNode().getChild(t),i,a,d,l);if(Yt(t)){let w=new zn(null);return _.getNode().forEachChild(yc,(D,S)=>{w=w.set(new Tn(D),S)}),$M(n,e,t,w,i,a,d,l)}return e}{let w=new zn(null);return r.foreach((D,S)=>{const M=dr(t,D);_.isCompleteForPath(M)&&(w=w.set(D,_.getNode().getChild(M)))}),$M(n,e,t,w,i,a,d,l)}}(n,e,w.path,w.affectedTree,r,i,a)}else{if(t.type!==Ba.LISTEN_COMPLETE)throw(0,P.g5)("Unknown operation type: "+t.type);l=function XG(n,e,t,r,i){const a=e.serverCache;return qF(n,LF(e,a.getNode(),a.isFullyInitialized()||Yt(t),a.isFiltered()),t,r,zF,i)}(n,e,t.path,r,a)}const _=a.getChanges();return function YG(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),a=DT(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(a)||!r.getNode().getPriority().equals(a.getPriority()))&&t.push(kF(DT(e)))}}(e,l,_),{viewCache:l,changes:_}}(n.processor_,i,e,t,r);return function KG(n,e){(0,P.hu)(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,P.hu)(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,a.viewCache),(0,P.hu)(a.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=a.viewCache,XF(n,a.changes,a.viewCache.eventCache.getNode(),null)}function XF(n,e,t,r){return function SG(n,e,t,r){const i=[],a=[];return e.forEach(l=>{"child_changed"===l.type&&n.index_.indexedValueChanged(l.oldSnap,l.snapshotNode)&&a.push(function fG(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(l.childName,l.snapshotNode))}),ZE(n,i,"child_removed",e,r,t),ZE(n,i,"child_added",e,r,t),ZE(n,i,"child_moved",a,r,t),ZE(n,i,"child_changed",e,r,t),ZE(n,i,"value",e,r,t),i}(n.eventGenerator_,e,t,r?[r]:n.eventRegistrations_)}let RT,NT;class eL{constructor(){this.views=new Map}}function GM(n,e,t,r){const i=e.source.queryId;if(null!==i){const a=n.views.get(i);return(0,P.hu)(null!=a,"SyncTree gave us an op for an invalid query."),JF(a,e,t,r)}{let a=[];for(const l of n.views.values())a=a.concat(JF(l,e,t,r));return a}}function tL(n,e,t,r,i){const l=n.views.get(e._queryIdentifier);if(!l){let d=ST(t,i?r:null),_=!1;d?_=!0:r instanceof Gt?(d=UM(t,r),_=!1):(d=Gt.EMPTY_NODE,_=!1);const w=bT(new Bf(d,_,!1),new Bf(r,i,!1));return new tW(e,w)}return l}function nL(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Hf(n,e){let t=null;for(const r of n.views.values())t=t||iW(r,e);return t}function rL(n,e){return e._queryParams.loadsAllData()?MT(n):n.views.get(e._queryIdentifier)}function iL(n,e){return null!=rL(n,e)}function $f(n){return null!=MT(n)}function MT(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let pW=1;class sL{constructor(e){this.listenProvider_=e,this.syncPointTree_=new zn(null),this.pendingWriteTree_=function $G(){return{visibleWrites:Wu.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function WM(n,e,t,r,i){return function MG(n,e,t,r,i){(0,P.hu)(r>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=QE(n.visibleWrites,e,t)),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r,i),i?ky(n,new sm({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function Gf(n,e,t=!1){const r=function kG(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}(n.pendingWriteTree_,e);if(function PG(n,e){const t=n.allWrites.findIndex(d=>d.writeId===e);(0,P.hu)(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,a=!1,l=n.allWrites.length-1;for(;i&&l>=0;){const d=n.allWrites[l];d.visible&&(l>=t&&OG(d,r.path)?i=!1:Ua(r.path,d.path)&&(a=!0)),l--}return!!i&&(a?(function FG(n){n.visibleWrites=jF(n.allWrites,LG,_n()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(r.snap?n.visibleWrites=VF(n.visibleWrites,r.path):Si(r.children,_=>{n.visibleWrites=VF(n.visibleWrites,dr(r.path,_))}),!0))}(n.pendingWriteTree_,e)){let a=new zn(null);return null!=r.snap?a=a.set(_n(),!0):Si(r.children,l=>{a=a.set(new Tn(l),!0)}),ky(n,new CT(r.path,a,t))}return[]}function JE(n,e,t){return ky(n,new sm({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function kT(n,e,t,r,i=!1){const a=e._path,l=n.syncPointTree_.get(a);let d=[];if(l&&("default"===e._queryIdentifier||iL(l,e))){const _=function dW(n,e,t,r){const i=e._queryIdentifier,a=[];let l=[];const d=$f(n);if("default"===i)for(const[_,w]of n.views.entries())l=l.concat(QF(w,t,r)),YF(w)&&(n.views.delete(_),w.query._queryParams.loadsAllData()||a.push(w.query));else{const _=n.views.get(i);_&&(l=l.concat(QF(_,t,r)),YF(_)&&(n.views.delete(i),_.query._queryParams.loadsAllData()||a.push(_.query)))}return d&&!$f(n)&&a.push(new(function uW(){return(0,P.hu)(RT,"Reference.ts has not been loaded"),RT}())(e._repo,e._path)),{removed:a,events:l}}(l,e,t,r);(function lW(n){return 0===n.views.size})(l)&&(n.syncPointTree_=n.syncPointTree_.remove(a));const w=_.removed;if(d=_.events,!i){const D=-1!==w.findIndex(M=>M._queryParams.loadsAllData()),S=n.syncPointTree_.findOnPath(a,(M,O)=>$f(O));if(D&&!S){const M=n.syncPointTree_.subtree(a);if(!M.isEmpty()){const O=function EW(n){return n.fold((e,t,r)=>{if(t&&$f(t))return[MT(t)];{let i=[];return t&&(i=nL(t)),Si(r,(a,l)=>{i=i.concat(l)}),i}})}(M);for(let j=0;j<O.length;++j){const ae=O[j],he=ae.query,$e=lL(n,ae);n.listenProvider_.startListening(eI(he),XE(n,he),$e.hashFn,$e.onComplete)}}}!S&&w.length>0&&!r&&(D?n.listenProvider_.stopListening(eI(e),null):w.forEach(M=>{const O=n.queryToTagMap.get(OT(M));n.listenProvider_.stopListening(eI(M),O)}))}!function IW(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=OT(r),a=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(a)}}}(n,w)}return d}function oL(n,e,t,r){const i=qM(n,r);if(null!=i){const a=KM(i),l=a.path,d=a.queryId,_=ks(l,e);return ZM(n,l,new sm(PM(d),_,t))}return[]}function zM(n,e,t,r=!1){const i=e._path;let a=null,l=!1;n.syncPointTree_.foreachOnPath(i,(M,O)=>{const j=ks(M,i);a=a||Hf(O,j),l=l||$f(O)});let _,d=n.syncPointTree_.get(i);d?(l=l||$f(d),a=a||Hf(d,_n())):(d=new eL,n.syncPointTree_=n.syncPointTree_.set(i,d)),null!=a?_=!0:(_=!1,a=Gt.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((O,j)=>{const ae=Hf(j,_n());ae&&(a=a.updateImmediateChild(O,ae))}));const w=iL(d,e);if(!w&&!e._queryParams.loadsAllData()){const M=OT(e);(0,P.hu)(!n.queryToTagMap.has(M),"View does not exist, but we have a tag");const O=function CW(){return pW++}();n.queryToTagMap.set(M,O),n.tagToQueryMap.set(O,M)}let S=function cW(n,e,t,r,i,a){const l=tL(n,e,r,i,a);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,l),function sW(n,e){n.eventRegistrations_.push(e)}(l,t),function oW(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Wn,(a,l)=>{r.push(xy(a,l))}),t.isFullyInitialized()&&r.push(kF(t.getNode())),XF(n,r,t.getNode(),e)}(l,t)}(d,e,t,TT(n.pendingWriteTree_,i),a,_);if(!w&&!l&&!r){const M=rL(d,e);S=S.concat(function bW(n,e,t){const r=e._path,i=XE(n,e),a=lL(n,t),l=n.listenProvider_.startListening(eI(e),i,a.hashFn,a.onComplete),d=n.syncPointTree_.subtree(r);if(i)(0,P.hu)(!$f(d.value),"If we're adding a query, it shouldn't be shadowed");else{const _=d.fold((w,D,S)=>{if(!Yt(w)&&D&&$f(D))return[MT(D).query];{let M=[];return D&&(M=M.concat(nL(D).map(O=>O.query))),Si(S,(O,j)=>{M=M.concat(j)}),M}});for(let w=0;w<_.length;++w){const D=_[w];n.listenProvider_.stopListening(eI(D),XE(n,D))}}return l}(n,e,M))}return S}function PT(n,e,t){const i=n.pendingWriteTree_,a=n.syncPointTree_.findOnPath(e,(l,d)=>{const w=Hf(d,ks(l,e));if(w)return w});return HF(i,e,a,t,!0)}function ky(n,e){return aL(e,n.syncPointTree_,null,TT(n.pendingWriteTree_,_n()))}function aL(n,e,t,r){if(Yt(n.path))return uL(n,e,t,r);{const i=e.get(_n());null==t&&null!=i&&(t=Hf(i,_n()));let a=[];const l=Zt(n.path),d=n.operationForChild(l),_=e.children.get(l);if(_&&d){const w=t?t.getImmediateChild(l):null,D=GF(r,l);a=a.concat(aL(d,_,w,D))}return i&&(a=a.concat(GM(i,n,r,t))),a}}function uL(n,e,t,r){const i=e.get(_n());null==t&&null!=i&&(t=Hf(i,_n()));let a=[];return e.children.inorderTraversal((l,d)=>{const _=t?t.getImmediateChild(l):null,w=GF(r,l),D=n.operationForChild(l);D&&(a=a.concat(uL(D,d,_,w)))}),i&&(a=a.concat(GM(i,n,r,t))),a}function lL(n,e){const t=e.query,r=XE(n,t);return{hashFn:()=>(function nW(n){return n.viewCache_.serverCache.getNode()}(e)||Gt.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function yW(n,e,t){const r=qM(n,t);if(r){const i=KM(r),a=i.path,l=i.queryId,d=ks(a,e);return ZM(n,a,new KE(PM(l),d))}return[]}(n,t._path,r):function _W(n,e){return ky(n,new KE({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(n,t._path);{const a=function _$(n,e){let t="Unknown Error";"too_big"===n?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?t="Client doesn't have permission to access the desired data.":"unavailable"===n&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}(i,t);return kT(n,t,null,a)}}}}function XE(n,e){const t=OT(e);return n.queryToTagMap.get(t)}function OT(n){return n._path.toString()+"$"+n._queryIdentifier}function qM(n,e){return n.tagToQueryMap.get(e)}function KM(n){const e=n.indexOf("$");return(0,P.hu)(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new Tn(n.substr(0,e))}}function ZM(n,e,t){const r=n.syncPointTree_.get(e);return(0,P.hu)(r,"Missing sync point for query tag that we're tracking"),GM(r,t,TT(n.pendingWriteTree_,e),null)}function eI(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function fW(){return(0,P.hu)(NT,"Reference.ts has not been loaded"),NT}())(n._repo,n._path):n}class YM{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new YM(t)}node(){return this.node_}}class QM{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=dr(this.path_,e);return new QM(this.syncTree_,t)}node(){return PT(this.syncTree_,this.path_)}}const cL=function(n,e,t){return n&&"object"==typeof n?((0,P.hu)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?TW(n[".sv"],e,t):"object"==typeof n[".sv"]?SW(n[".sv"],e):void(0,P.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},TW=function(n,e,t){if("timestamp"===n)return t.timestamp;(0,P.hu)(!1,"Unexpected server value: "+n)},SW=function(n,e,t){n.hasOwnProperty("increment")||(0,P.hu)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;"number"!=typeof r&&(0,P.hu)(!1,"Unexpected increment value: "+r);const i=e.node();if((0,P.hu)(null!==i&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const l=i.getValue();return"number"!=typeof l?r:l+r},dL=function(n,e,t,r){return XM(e,new QM(t,n),r)},JM=function(n,e,t){return XM(n,new YM(e),t)};function XM(n,e,t){const r=n.getPriority().val(),i=cL(r,e.getImmediateChild(".priority"),t);let a;if(n.isLeafNode()){const l=n,d=cL(l.getValue(),e,t);return d!==l.getValue()||i!==l.getPriority().val()?new Ty(d,Ir(i)):n}{const l=n;return a=l,i!==l.getPriority().val()&&(a=a.updatePriority(new Ty(i))),l.forEachChild(Wn,(d,_)=>{const w=XM(_,e.getImmediateChild(d),t);w!==_&&(a=a.updateImmediateChild(d,w))}),a}}class eN{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function FT(n,e){let t=e instanceof Tn?e:new Tn(e),r=n,i=Zt(t);for(;null!==i;){const a=(0,P.DV)(r.node.children,i)||{children:{},childCount:0};r=new eN(i,r,a),t=Bn(t),i=Zt(t)}return r}function um(n){return n.node.value}function tN(n,e){n.node.value=e,nN(n)}function hL(n){return n.node.childCount>0}function LT(n,e){Si(n.node.children,(t,r)=>{e(new eN(t,n,r))})}function fL(n,e,t,r){t&&!r&&e(n),LT(n,i=>{fL(i,e,!0,r)}),t&&r&&e(n)}function tI(n){return new Tn(null===n.parent?n.name:tI(n.parent)+"/"+n.name)}function nN(n){null!==n.parent&&function RW(n,e,t){const r=function AW(n){return void 0===um(n)&&!hL(n)}(t),i=(0,P.r3)(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,nN(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,nN(n))}(n.parent,n.name,n)}const MW=/[\[\].#$\/\u0000-\u001F\u007F]/,NW=/[\[\].#$\u0000-\u001F\u007F]/,rN=10485760,VT=function(n){return"string"==typeof n&&0!==n.length&&!MW.test(n)},pL=function(n){return"string"==typeof n&&0!==n.length&&!NW.test(n)},nI=function(n){return null===n||"string"==typeof n||"number"==typeof n&&!cT(n)||n&&"object"==typeof n&&(0,P.r3)(n,".sv")},vc=function(n,e,t,r){r&&void 0===e||rI((0,P.gK)(n,"value"),e,t)},rI=function(n,e,t){const r=t instanceof Tn?new K$(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+rm(r));if("function"==typeof e)throw new Error(n+"contains a function "+rm(r)+" with contents = "+e.toString());if(cT(e))throw new Error(n+"contains "+e.toString()+" "+rm(r));if("string"==typeof e&&e.length>rN/3&&(0,P.ug)(e)>rN)throw new Error(n+"contains a string greater than "+rN+" utf8 bytes "+rm(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let i=!1,a=!1;if(Si(e,(l,d)=>{if(".value"===l)i=!0;else if(".priority"!==l&&".sv"!==l&&(a=!0,!VT(l)))throw new Error(n+" contains an invalid key ("+l+") "+rm(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function Z$(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=(0,P.ug)(e),wF(n)})(r,l),rI(n,d,r),function Y$(n){const e=n.parts_.pop();n.byteLength_-=(0,P.ug)(e),n.parts_.length>0&&(n.byteLength_-=1)}(r)}),i&&a)throw new Error(n+' contains ".value" child '+rm(r)+" in addition to actual children.")}},gL=function(n,e,t,r){if(r&&void 0===e)return;const i=(0,P.gK)(n,"values");if(!e||"object"!=typeof e||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");const a=[];Si(e,(l,d)=>{const _=new Tn(l);if(rI(i,d,dr(t,_)),".priority"===yM(_)&&!nI(d))throw new Error(i+"contains an invalid value for '"+_.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(_)}),function(n,e){let t,r;for(t=0;t<e.length;t++){r=e[t];const a=jE(r);for(let l=0;l<a.length;l++)if((".priority"!==a[l]||l!==a.length-1)&&!VT(a[l]))throw new Error(n+"contains an invalid key ("+a[l]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(q$);let i=null;for(t=0;t<e.length;t++){if(r=e[t],null!==i&&Ua(i,r))throw new Error(n+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}}(i,a)},iN=function(n,e,t){if(!t||void 0!==e){if(cT(e))throw new Error((0,P.gK)(n,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!nI(e))throw new Error((0,P.gK)(n,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},iI=function(n,e,t,r){if(!(r&&void 0===t||VT(t)))throw new Error((0,P.gK)(n,e)+'was an invalid key = "'+t+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},sI=function(n,e,t,r){if(!(r&&void 0===t||pL(t)))throw new Error((0,P.gK)(n,e)+'was an invalid path = "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},ja=function(n,e){if(".info"===Zt(e))throw new Error(n+" failed = Can't modify data under /.info/")},mL=function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!VT(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),pL(n)}(t))throw new Error((0,P.gK)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class FW{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function UT(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],a=i.getPath();null!==t&&!vM(a,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:a}),t.events.push(i)}t&&n.eventLists_.push(t)}function _L(n,e,t){UT(n,t),yL(n,r=>vM(r,e))}function Go(n,e,t){UT(n,t),yL(n,r=>Ua(r,e)||Ua(e,r))}function yL(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];i&&(e(i.path)?(LW(n.eventLists_[r]),n.eventLists_[r]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}function LW(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const r=t.getEventRunner();tm&&Ti("event: "+t.toString()),by(r)}}}const vL="repo_interrupt";class UW{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new FW,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=IT(),this.transactionQueueTree_=new eN,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function wL(n){const t=n.infoData_.getNode(new Tn(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function oI(n){return function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n}({timestamp:wL(n)})}function EL(n,e,t,r,i){n.dataUpdateCount++;const a=new Tn(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let l=[];if(i)if(r){const _=(0,P.UI)(t,w=>Ir(w));l=function vW(n,e,t,r){const i=qM(n,r);if(i){const a=KM(i),l=a.path,d=a.queryId,_=ks(l,e),w=zn.fromObject(t);return ZM(n,l,new My(PM(d),_,w))}return[]}(n.serverSyncTree_,a,_,i)}else{const _=Ir(t);l=oL(n.serverSyncTree_,a,_,i)}else if(r){const _=(0,P.UI)(t,w=>Ir(w));l=function mW(n,e,t){const r=zn.fromObject(t);return ky(n,new My({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(n.serverSyncTree_,a,_)}else{const _=Ir(t);l=JE(n.serverSyncTree_,a,_)}let d=a;l.length>0&&(d=Oy(n,a)),Go(n.eventQueue_,d,l)}function IL(n,e){sN(n,"connected",e),!1===e&&function GW(n){Py(n,"onDisconnectEvents");const e=oI(n),t=IT();MM(n.onDisconnect_,_n(),(i,a)=>{const l=dL(i,a,n.serverSyncTree_,e);Ry(t,i,l)});let r=[];MM(t,_n(),(i,a)=>{r=r.concat(JE(n.serverSyncTree_,i,a));const l=lN(n,i);Oy(n,l)}),n.onDisconnect_=IT(),Go(n.eventQueue_,_n(),r)}(n)}function sN(n,e,t){const r=new Tn("/.info/"+e),i=Ir(t);n.infoData_.updateSnapshot(r,i);const a=JE(n.infoSyncTree_,r,i);Go(n.eventQueue_,r,a)}function BT(n){return n.nextWriteId_++}function oN(n,e,t,r,i){Py(n,"set",{path:e.toString(),value:t,priority:r});const a=oI(n),l=Ir(t,r),d=PT(n.serverSyncTree_,e),_=JM(l,d,a),w=BT(n),D=WM(n.serverSyncTree_,e,_,w,!0);UT(n.eventQueue_,D),n.server_.put(e.toString(),l.val(!0),(M,O)=>{const j="ok"===M;j||is("set at "+e+" failed: "+M);const ae=Gf(n.serverSyncTree_,w,!j);Go(n.eventQueue_,e,ae),Wf(0,i,M,O)});const S=lN(n,e);Oy(n,S),Go(n.eventQueue_,S,[])}function WW(n,e,t){n.server_.onDisconnectCancel(e.toString(),(r,i)=>{"ok"===r&&RM(n.onDisconnect_,e),Wf(0,t,r,i)})}function CL(n,e,t,r){const i=Ir(t);n.server_.onDisconnectPut(e.toString(),i.val(!0),(a,l)=>{"ok"===a&&Ry(n.onDisconnect_,e,i),Wf(0,r,a,l)})}function aN(n,e,t){let r;r=".info"===Zt(e._path)?kT(n.infoSyncTree_,e,t):kT(n.serverSyncTree_,e,t),_L(n.eventQueue_,e._path,r)}function bL(n){n.persistentConnection_&&n.persistentConnection_.interrupt(vL)}function Py(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Ti(t,...e)}function Wf(n,e,t,r){e&&by(()=>{if("ok"===t)e(null);else{const i=(t||"error").toUpperCase();let a=i;r&&(a+=": "+r);const l=new Error(a);l.code=i,e(l)}})}function uN(n,e,t){return PT(n.serverSyncTree_,e,t)||Gt.EMPTY_NODE}function jT(n,e=n.transactionQueueTree_){if(e||HT(n,e),um(e)){const t=TL(n,e);(0,P.hu)(t.length>0,"Sending zero length transaction queue"),t.every(i=>0===i.status)&&function QW(n,e,t){const r=t.map(w=>w.currentWriteId),i=uN(n,e,r);let a=i;const l=i.hash();for(let w=0;w<t.length;w++){const D=t[w];(0,P.hu)(0===D.status,"tryToSendTransactionQueue_: items in queue should all be run."),D.status=1,D.retryCount++;const S=ks(e,D.path);a=a.updateChild(S,D.currentOutputSnapshotRaw)}const d=a.val(!0),_=e;n.server_.put(_.toString(),d,w=>{Py(n,"transaction put response",{path:_.toString(),status:w});let D=[];if("ok"===w){const S=[];for(let M=0;M<t.length;M++)t[M].status=2,D=D.concat(Gf(n.serverSyncTree_,t[M].currentWriteId)),t[M].onComplete&&S.push(()=>t[M].onComplete(null,!0,t[M].currentOutputSnapshotResolved)),t[M].unwatcher();HT(n,FT(n.transactionQueueTree_,e)),jT(n,n.transactionQueueTree_),Go(n.eventQueue_,e,D);for(let M=0;M<S.length;M++)by(S[M])}else{if("datastale"===w)for(let S=0;S<t.length;S++)t[S].status=3===t[S].status?4:0;else{is("transaction at "+_.toString()+" failed: "+w);for(let S=0;S<t.length;S++)t[S].status=4,t[S].abortReason=w}Oy(n,e)}},l)}(n,tI(e),t)}else hL(e)&&LT(e,t=>{jT(n,t)})}function Oy(n,e){const t=DL(n,e),r=tI(t);return function JW(n,e,t){if(0===e.length)return;const r=[];let i=[];const l=e.filter(d=>0===d.status).map(d=>d.currentWriteId);for(let d=0;d<e.length;d++){const _=e[d],w=ks(t,_.path);let S,D=!1;if((0,P.hu)(null!==w,"rerunTransactionsUnderNode_: relativePath should not be null."),4===_.status)D=!0,S=_.abortReason,i=i.concat(Gf(n.serverSyncTree_,_.currentWriteId,!0));else if(0===_.status)if(_.retryCount>=25)D=!0,S="maxretry",i=i.concat(Gf(n.serverSyncTree_,_.currentWriteId,!0));else{const M=uN(n,_.path,l);_.currentInputSnapshot=M;const O=e[d].update(M.val());if(void 0!==O){rI("transaction failed: Data returned ",O,_.path);let j=Ir(O);"object"==typeof O&&null!=O&&(0,P.r3)(O,".priority")||(j=j.updatePriority(M.getPriority()));const he=_.currentWriteId,$e=oI(n),nt=JM(j,M,$e);_.currentOutputSnapshotRaw=j,_.currentOutputSnapshotResolved=nt,_.currentWriteId=BT(n),l.splice(l.indexOf(he),1),i=i.concat(WM(n.serverSyncTree_,_.path,nt,_.currentWriteId,_.applyLocally)),i=i.concat(Gf(n.serverSyncTree_,he,!0))}else D=!0,S="nodata",i=i.concat(Gf(n.serverSyncTree_,_.currentWriteId,!0))}Go(n.eventQueue_,t,i),i=[],D&&(e[d].status=2,setTimeout(e[d].unwatcher,Math.floor(0)),e[d].onComplete&&r.push("nodata"===S?()=>e[d].onComplete(null,!1,e[d].currentInputSnapshot):()=>e[d].onComplete(new Error(S),!1,null)))}HT(n,n.transactionQueueTree_);for(let d=0;d<r.length;d++)by(r[d]);jT(n,n.transactionQueueTree_)}(n,TL(n,t),r),r}function DL(n,e){let t,r=n.transactionQueueTree_;for(t=Zt(e);null!==t&&void 0===um(r);)r=FT(r,t),t=Zt(e=Bn(e));return r}function TL(n,e){const t=[];return SL(n,e,t),t.sort((r,i)=>r.order-i.order),t}function SL(n,e,t){const r=um(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);LT(e,i=>{SL(n,i,t)})}function HT(n,e){const t=um(e);if(t){let r=0;for(let i=0;i<t.length;i++)2!==t[i].status&&(t[r]=t[i],r++);t.length=r,tN(e,t.length>0?t:void 0)}LT(e,r=>{HT(n,r)})}function lN(n,e){const t=tI(DL(n,e)),r=FT(n.transactionQueueTree_,e);return function xW(n,e,t){let r=t?n:n.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,i=>{cN(n,i)}),cN(n,r),fL(r,i=>{cN(n,i)}),t}function cN(n,e){const t=um(e);if(t){const r=[];let i=[],a=-1;for(let l=0;l<t.length;l++)3===t[l].status||(1===t[l].status?((0,P.hu)(a===l-1,"All SENT items should be at beginning of queue."),a=l,t[l].status=3,t[l].abortReason="set"):((0,P.hu)(0===t[l].status,"Unexpected transaction status in abort"),t[l].unwatcher(),i=i.concat(Gf(n.serverSyncTree_,t[l].currentWriteId,!0)),t[l].onComplete&&r.push(t[l].onComplete.bind(null,new Error("set"),!1,null))));-1===a?tN(e,void 0):t.length=a+1,Go(n.eventQueue_,tI(e),i);for(let l=0;l<r.length;l++)by(r[l])}}const dN=function(n,e){const t=t3(n),r=t.namespace;return"firebase.com"===t.domain&&mc(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==t.domain&&mc("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&is("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new hM(t.host,t.secure,r,"ws"===t.scheme||"wss"===t.scheme,e,"",r!==t.subdomain),path:new Tn(t.pathString)}},t3=function(n){let e="",t="",r="",i="",a="",l=!0,d="https",_=443;if("string"==typeof n){let w=n.indexOf("//");w>=0&&(d=n.substring(0,w-1),n=n.substring(w+2));let D=n.indexOf("/");-1===D&&(D=n.length);let S=n.indexOf("?");-1===S&&(S=n.length),e=n.substring(0,Math.min(D,S)),D<S&&(i=function XW(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}(n.substring(D,S)));const M=function e3(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const r=t.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):is(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,S)));w=e.indexOf(":"),w>=0?(l="https"===d||"wss"===d,_=parseInt(e.substring(w+1),10)):w=e.length;const O=e.slice(0,w);if("localhost"===O.toLowerCase())t="localhost";else if(O.split(".").length<=2)t=O;else{const j=e.indexOf(".");r=e.substring(0,j).toLowerCase(),t=e.substring(j+1),a=r}"ns"in M&&(a=M.ns)}return{host:e,port:_,domain:t,subdomain:r,secure:l,scheme:d,pathString:i,namespace:a}};class AL{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,P.Wl)(this.snapshot.exportVal())}}class xL{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class hN{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,P.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class RL{constructor(e,t){this._repo=e,this._path=t}cancel(){const e=new P.BH;return WW(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){ja("OnDisconnect.remove",this._path);const e=new P.BH;return CL(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){ja("OnDisconnect.set",this._path),vc("OnDisconnect.set",e,this._path,!1);const t=new P.BH;return CL(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){ja("OnDisconnect.setWithPriority",this._path),vc("OnDisconnect.setWithPriority",e,this._path,!1),iN("OnDisconnect.setWithPriority",t,!1);const r=new P.BH;return function zW(n,e,t,r,i){const a=Ir(t,r);n.server_.onDisconnectPut(e.toString(),a.val(!0),(l,d)=>{"ok"===l&&Ry(n.onDisconnect_,e,a),Wf(0,i,l,d)})}(this._repo,this._path,e,t,r.wrapCallback(()=>{})),r.promise}update(e){ja("OnDisconnect.update",this._path),gL("OnDisconnect.update",e,this._path,!1);const t=new P.BH;return function qW(n,e,t,r){if((0,P.xb)(t))return Ti("onDisconnect().update() called with empty data.  Don't do anything."),void Wf(0,r,"ok",void 0);n.server_.onDisconnectMerge(e.toString(),t,(i,a)=>{"ok"===i&&Si(t,(l,d)=>{const _=Ir(d);Ry(n.onDisconnect_,dr(e,l),_)}),Wf(0,r,i,a)})}(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}class lo{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return Yt(this._path)?null:yM(this._path)}get ref(){return new Ha(this._repo,this._path)}get _queryIdentifier(){const e=OF(this._queryParams),t=lM(e);return"{}"===t?"default":t}get _queryObject(){return OF(this._queryParams)}isEqual(e){if(!((e=(0,P.m9)(e))instanceof lo))return!1;const t=this._repo===e._repo,r=vM(this._path,e._path);return t&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function z$(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}function $T(n,e){if(!0===n._orderByCalled)throw new Error(e+": You can't combine multiple orderBy calls.")}function zf(n){let e=null,t=null;if(n.hasStart()&&(e=n.getIndexStartValue()),n.hasEnd()&&(t=n.getIndexEndValue()),n.getIndex()===yc){const r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(n.hasStart()){if(n.getIndexStartName()!==th)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(n.hasEnd()){if(n.getIndexEndName()!==_c)throw new Error(r);if("string"!=typeof t)throw new Error(i)}}else if(n.getIndex()===Wn){if(null!=e&&!nI(e)||null!=t&&!nI(t))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,P.hu)(n.getIndex()instanceof bM||n.getIndex()===DM,"unknown index type."),null!=e&&"object"==typeof e||null!=t&&"object"==typeof t)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function GT(n){if(n.hasStart()&&n.hasEnd()&&n.hasLimit()&&!n.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class Ha extends lo{constructor(e,t){super(e,t,new vT,!1)}get parent(){const e=vF(this._path);return null===e?null:new Ha(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class lm{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new Tn(e),r=cm(this.ref,e);return new lm(this._node.getChild(t),r,Wn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>e(new lm(i,cm(this.ref,r),Wn)))}hasChild(e){const t=new Tn(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function ML(n,e){return(n=(0,P.m9)(n))._checkNotDeleted("ref"),void 0!==e?cm(n._root,e):n._root}function NL(n,e){(n=(0,P.m9)(n))._checkNotDeleted("refFromURL");const t=dN(e,n._repo.repoInfo_.nodeAdmin);mL("refFromURL",t);const r=t.repoInfo;return!n._repo.repoInfo_.isCustomHost()&&r.host!==n._repo.repoInfo_.host&&mc("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+n._repo.repoInfo_.host+")"),ML(n,t.path.toString())}function cm(n,e){return null===Zt((n=(0,P.m9)(n))._path)?(t=e,t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),sI("child","path",t,!1)):sI("child","path",e,!1),new Ha(n._repo,dr(n._path,e));var t}function fN(n,e){n=(0,P.m9)(n),ja("set",n._path),vc("set",e,n._path,!1);const t=new P.BH;return oN(n._repo,n._path,e,null,t.wrapCallback(()=>{})),t.promise}function o3(n,e){gL("update",e,n._path,!1);const t=new P.BH;return function $W(n,e,t,r){Py(n,"update",{path:e.toString(),value:t});let i=!0;const a=oI(n),l={};if(Si(t,(d,_)=>{i=!1,l[d]=dL(dr(e,d),Ir(_),n.serverSyncTree_,a)}),i)Ti("update() called with empty data.  Don't do anything."),Wf(0,r,"ok",void 0);else{const d=BT(n),_=function gW(n,e,t,r){!function NG(n,e,t,r){(0,P.hu)(r>n.lastWriteId,"Stacking an older merge on top of newer ones"),n.allWrites.push({path:e,children:t,writeId:r,visible:!0}),n.visibleWrites=FM(n.visibleWrites,e,t),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r);const i=zn.fromObject(t);return ky(n,new My({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,i))}(n.serverSyncTree_,e,l,d);UT(n.eventQueue_,_),n.server_.merge(e.toString(),t,(w,D)=>{const S="ok"===w;S||is("update at "+e+" failed: "+w);const M=Gf(n.serverSyncTree_,d,!S),O=M.length>0?Oy(n,e):e;Go(n.eventQueue_,O,M),Wf(0,r,w,D)}),Si(t,w=>{const D=lN(n,dr(e,w));Oy(n,D)}),Go(n.eventQueue_,e,[])}}(n._repo,n._path,e,t.wrapCallback(()=>{})),t.promise}function a3(n){n=(0,P.m9)(n);const e=new hN(()=>{}),t=new aI(e);return function HW(n,e,t){const r=function wW(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(w,D)=>{const S=ks(w,t);r=r||Hf(D,S)});let i=n.syncPointTree_.get(t);i?r=r||Hf(i,_n()):(i=new eL,n.syncPointTree_=n.syncPointTree_.set(t,i));const a=null!=r,l=a?new Bf(r,!0,!1):null;return function rW(n){return DT(n.viewCache_)}(tL(i,e,TT(n.pendingWriteTree_,e._path),a?l.getNode():Gt.EMPTY_NODE,a))}(n.serverSyncTree_,e);return null!=r?Promise.resolve(r):n.server_.get(e).then(i=>{const a=Ir(i).withIndex(e._queryParams.getIndex());let l;if(zM(n.serverSyncTree_,e,t,!0),e._queryParams.loadsAllData())l=JE(n.serverSyncTree_,e._path,a);else{const d=XE(n.serverSyncTree_,e);l=oL(n.serverSyncTree_,e._path,a,d)}return Go(n.eventQueue_,e._path,l),kT(n.serverSyncTree_,e,t,null,!0),a},i=>(Py(n,"get for query "+(0,P.Wl)(e)+" failed: "+i),Promise.reject(new Error(i))))}(n._repo,n,t).then(r=>new lm(r,new Ha(n._repo,n._path),n._queryParams.getIndex()))}class aI{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const r=t._queryParams.getIndex();return new AL("value",this,new lm(e.snapshotNode,new Ha(t._repo,t._path),r))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new xL(this,e,t):null}matches(e){return e instanceof aI&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class WT{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new xL(this,e,t):null}createEvent(e,t){(0,P.hu)(null!=e.childName,"Child events should have a childName.");const r=cm(new Ha(t._repo,t._path),e.childName),i=t._queryParams.getIndex();return new AL(e.type,this,new lm(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof WT&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function uI(n,e,t,r,i){let a;if("object"==typeof r&&(a=void 0,i=r),"function"==typeof r&&(a=r),i&&i.onlyOnce){const _=t,w=(D,S)=>{aN(n._repo,n,d),_(D,S)};w.userCallback=t.userCallback,w.context=t.context,t=w}const l=new hN(t,a||void 0),d="value"===e?new aI(l):new WT(e,l);return function KW(n,e,t){let r;r=".info"===Zt(e._path)?zM(n.infoSyncTree_,e,t):zM(n.serverSyncTree_,e,t),_L(n.eventQueue_,e._path,r)}(n._repo,n,d),()=>aN(n._repo,n,d)}function pN(n,e,t,r){return uI(n,"value",e,t,r)}function kL(n,e,t,r){return uI(n,"child_added",e,t,r)}function PL(n,e,t,r){return uI(n,"child_changed",e,t,r)}function OL(n,e,t,r){return uI(n,"child_moved",e,t,r)}function FL(n,e,t,r){return uI(n,"child_removed",e,t,r)}function LL(n,e,t){let r=null;const i=t?new hN(t):null;"value"===e?r=new aI(i):e&&(r=new WT(e,i)),aN(n._repo,n,r)}class zu{}class VL extends zu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){vc("endAt",this._value,e._path,!0);const t=xM(e._queryParams,this._value,this._key);if(GT(t),zf(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new lo(e._repo,e._path,t,e._orderByCalled)}}class l3 extends zu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){vc("endBefore",this._value,e._path,!1);const t=function vG(n,e,t){let r,i;return n.index_===yc?("string"==typeof e&&(e=NF(e)),i=xM(n,e,t)):(r=null==t?th:NF(t),i=xM(n,e,r)),i.endBeforeSet_=!0,i}(e._queryParams,this._value,this._key);if(GT(t),zf(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new lo(e._repo,e._path,t,e._orderByCalled)}}class UL extends zu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){vc("startAt",this._value,e._path,!0);const t=AM(e._queryParams,this._value,this._key);if(GT(t),zf(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new lo(e._repo,e._path,t,e._orderByCalled)}}class h3 extends zu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){vc("startAfter",this._value,e._path,!1);const t=function yG(n,e,t){let r;if(n.index_===yc)"string"==typeof e&&(e=MF(e)),r=AM(n,e,t);else{let i;i=null==t?_c:MF(t),r=AM(n,e,i)}return r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(GT(t),zf(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new lo(e._repo,e._path,t,e._orderByCalled)}}class p3 extends zu{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new lo(e._repo,e._path,function mG(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="l",t}(e._queryParams,this._limit),e._orderByCalled)}}class m3 extends zu{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new lo(e._repo,e._path,function _G(n,e){const t=n.copy();return t.limitSet_=!0,t.limit_=e,t.viewFrom_="r",t}(e._queryParams,this._limit),e._orderByCalled)}}class y3 extends zu{constructor(e){super(),this._path=e}_apply(e){$T(e,"orderByChild");const t=new Tn(this._path);if(Yt(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");const r=new bM(t),i=wT(e._queryParams,r);return zf(i),new lo(e._repo,e._path,i,!0)}}class w3 extends zu{_apply(e){$T(e,"orderByKey");const t=wT(e._queryParams,yc);return zf(t),new lo(e._repo,e._path,t,!0)}}class I3 extends zu{_apply(e){$T(e,"orderByPriority");const t=wT(e._queryParams,Wn);return zf(t),new lo(e._repo,e._path,t,!0)}}class b3 extends zu{_apply(e){$T(e,"orderByValue");const t=wT(e._queryParams,DM);return zf(t),new lo(e._repo,e._path,t,!0)}}class T3 extends zu{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(vc("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new VL(this._value,this._key)._apply(new UL(this._value,this._key)._apply(e))}}function qu(n,...e){let t=(0,P.m9)(n);for(const r of e)t=r._apply(t);return t}(function aW(n){(0,P.hu)(!RT,"__referenceConstructor has already been defined"),RT=n})(Ha),function hW(n){(0,P.hu)(!NT,"__referenceConstructor has already been defined"),NT=n}(Ha);const gN={};function jL(n,e,t,r,i){let a=r||n.options.databaseURL;void 0===a&&(n.options.projectId||mc("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Ti("Using default host for project ",n.options.projectId),a=`${n.options.projectId}-default-rtdb.firebaseio.com`);let _,w,l=dN(a,i),d=l.repoInfo;typeof process<"u"&&process.env&&(w=process.env.FIREBASE_DATABASE_EMULATOR_HOST),w?(_=!0,a=`http://${w}?ns=${d.namespace}`,l=dN(a,i),d=l.repoInfo):_=!l.repoInfo.secure;const D=i&&_?new BE(BE.OWNER):new E$(n.name,n.options,e);mL("Invalid Firebase Database URL",l),Yt(l.path)||mc("Database URL must point to the root of a Firebase Database (not including a child path).");const S=function M3(n,e,t,r){let i=gN[e.name];i||(i={},gN[e.name]=i);let a=i[n.toURLString()];return a&&mc("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new UW(n,false,t,r),i[n.toURLString()]=a,a}(d,n,D,new w$(n.name,t));return new k3(S,n)}class k3{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function BW(n,e,t){if(n.stats_=gM(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new ET(n.repoInfo_,(r,i,a,l)=>{EL(n,r,i,a,l)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>IL(n,!0),0);else{if(typeof t<"u"&&null!==t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,P.Wl)(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new im(n.repoInfo_,e,(r,i,a,l)=>{EL(n,r,i,a,l)},r=>{IL(n,r)},r=>{!function jW(n,e){Si(e,(t,r)=>{sN(n,t,r)})}(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=function b$(n,e){const t=n.toString();return pM[t]||(pM[t]=e()),pM[t]}(n.repoInfo_,()=>new DG(n.stats_,n.server_)),n.infoData_=new wG,n.infoSyncTree_=new sL({startListening:(r,i,a,l)=>{let d=[];const _=n.infoData_.getNode(r._path);return _.isEmpty()||(d=JE(n.infoSyncTree_,r._path,_),setTimeout(()=>{l("ok")},0)),d},stopListening:()=>{}}),sN(n,"connected",!1),n.serverSyncTree_=new sL({startListening:(r,i,a,l)=>(n.server_.listen(r,a,i,(d,_)=>{const w=l(d,_);Go(n.eventQueue_,r._path,w)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Ha(this._repo,_n())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function R3(n,e){const t=gN[e];(!t||t[n.key]!==n)&&mc(`Database ${e}(${n.repoInfo_}) has already been deleted.`),bL(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&mc("Cannot call "+e+" on a deleted database.")}}function HL(){aF.IS_TRANSPORT_INITIALIZED&&is("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function P3(){HL(),Vf.forceDisallow()}function O3(){HL(),Dy.forceDisallow(),Vf.forceAllow()}function V3(n,e){j1(n,e)}const B3={".sv":"timestamp"};class $3{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}im.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},im.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function U3(n){F1(Qi.SDK_VERSION),(0,Qi._registerComponent)(new Xs.wA("database",(e,{instanceIdentifier:t})=>jL(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,Qi.registerVersion)(P1,O1,n),(0,Qi.registerVersion)(P1,O1,"esm2017")}();const q3=new eo.Yd("@firebase/database-compat"),GL=function(n){q3.warn("FIREBASE WARNING: "+n)};class Y3{constructor(e){this._delegate=e}cancel(e){(0,P.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,P.Wj)("OnDisconnect.cancel","onComplete",e,!0);const t=this._delegate.cancel();return e&&t.then(()=>e(null),r=>e(r)),t}remove(e){(0,P.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,P.Wj)("OnDisconnect.remove","onComplete",e,!0);const t=this._delegate.remove();return e&&t.then(()=>e(null),r=>e(r)),t}set(e,t){(0,P.Dv)("OnDisconnect.set",1,2,arguments.length),(0,P.Wj)("OnDisconnect.set","onComplete",t,!0);const r=this._delegate.set(e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,P.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,P.Wj)("OnDisconnect.setWithPriority","onComplete",r,!0);const i=this._delegate.setWithPriority(e,t);return r&&i.then(()=>r(null),a=>r(a)),i}update(e,t){if((0,P.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let a=0;a<e.length;++a)i[""+a]=e[a];e=i,GL("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,P.Wj)("OnDisconnect.update","onComplete",t,!0);const r=this._delegate.update(e);return t&&r.then(()=>t(null),i=>t(i)),r}}class Q3{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return(0,P.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}class qf{constructor(e,t){this._database=e,this._delegate=t}val(){return(0,P.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,P.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,P.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,P.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,P.Dv)("DataSnapshot.child",0,1,arguments.length),e=String(e),sI("DataSnapshot.child","path",e,!1),new qf(this._database,this._delegate.child(e))}hasChild(e){return(0,P.Dv)("DataSnapshot.hasChild",1,1,arguments.length),sI("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,P.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,P.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,P.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new qf(this._database,t)))}hasChildren(){return(0,P.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,P.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,P.Dv)("DataSnapshot.ref",0,0,arguments.length),new Wo(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class Hi{constructor(e,t){this.database=e,this._delegate=t}on(e,t,r,i){var a;(0,P.Dv)("Query.on",2,4,arguments.length),(0,P.Wj)("Query.on","callback",t,!1);const l=Hi.getCancelAndContextArgs_("Query.on",r,i),d=(w,D)=>{t.call(l.context,new qf(this.database,w),D)};d.userCallback=t,d.context=l.context;const _=null===(a=l.cancel)||void 0===a?void 0:a.bind(l.context);switch(e){case"value":return pN(this._delegate,d,_),t;case"child_added":return kL(this._delegate,d,_),t;case"child_removed":return FL(this._delegate,d,_),t;case"child_changed":return PL(this._delegate,d,_),t;case"child_moved":return OL(this._delegate,d,_),t;default:throw new Error((0,P.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,r){if((0,P.Dv)("Query.off",0,3,arguments.length),function(n,e,t){if(void 0!==e)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error((0,P.gK)("Query.off","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}(0,e),(0,P.Wj)("Query.off","callback",t,!0),(0,P.lb)("Query.off","context",r,!0),t){const i=()=>{};i.userCallback=t,i.context=r,LL(this._delegate,e,i)}else LL(this._delegate,e)}get(){return a3(this._delegate).then(e=>new qf(this.database,e))}once(e,t,r,i){(0,P.Dv)("Query.once",1,4,arguments.length),(0,P.Wj)("Query.once","callback",t,!0);const a=Hi.getCancelAndContextArgs_("Query.once",r,i),l=new P.BH,d=(w,D)=>{const S=new qf(this.database,w);t&&t.call(a.context,S,D),l.resolve(S)};d.userCallback=t,d.context=a.context;const _=w=>{a.cancel&&a.cancel.call(a.context,w),l.reject(w)};switch(e){case"value":pN(this._delegate,d,_,{onlyOnce:!0});break;case"child_added":kL(this._delegate,d,_,{onlyOnce:!0});break;case"child_removed":FL(this._delegate,d,_,{onlyOnce:!0});break;case"child_changed":PL(this._delegate,d,_,{onlyOnce:!0});break;case"child_moved":OL(this._delegate,d,_,{onlyOnce:!0});break;default:throw new Error((0,P.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return l.promise}limitToFirst(e){return(0,P.Dv)("Query.limitToFirst",1,1,arguments.length),new Hi(this.database,qu(this._delegate,function g3(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new p3(n)}(e)))}limitToLast(e){return(0,P.Dv)("Query.limitToLast",1,1,arguments.length),new Hi(this.database,qu(this._delegate,function _3(n){if("number"!=typeof n||Math.floor(n)!==n||n<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new m3(n)}(e)))}orderByChild(e){return(0,P.Dv)("Query.orderByChild",1,1,arguments.length),new Hi(this.database,qu(this._delegate,function v3(n){if("$key"===n)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===n)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===n)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return sI("orderByChild","path",n,!1),new y3(n)}(e)))}orderByKey(){return(0,P.Dv)("Query.orderByKey",0,0,arguments.length),new Hi(this.database,qu(this._delegate,function E3(){return new w3}()))}orderByPriority(){return(0,P.Dv)("Query.orderByPriority",0,0,arguments.length),new Hi(this.database,qu(this._delegate,function C3(){return new I3}()))}orderByValue(){return(0,P.Dv)("Query.orderByValue",0,0,arguments.length),new Hi(this.database,qu(this._delegate,function D3(){return new b3}()))}startAt(e=null,t){return(0,P.Dv)("Query.startAt",0,2,arguments.length),new Hi(this.database,qu(this._delegate,function d3(n=null,e){return iI("startAt","key",e,!0),new UL(n,e)}(e,t)))}startAfter(e=null,t){return(0,P.Dv)("Query.startAfter",0,2,arguments.length),new Hi(this.database,qu(this._delegate,function f3(n,e){return iI("startAfter","key",e,!0),new h3(n,e)}(e,t)))}endAt(e=null,t){return(0,P.Dv)("Query.endAt",0,2,arguments.length),new Hi(this.database,qu(this._delegate,function u3(n,e){return iI("endAt","key",e,!0),new VL(n,e)}(e,t)))}endBefore(e=null,t){return(0,P.Dv)("Query.endBefore",0,2,arguments.length),new Hi(this.database,qu(this._delegate,function c3(n,e){return iI("endBefore","key",e,!0),new l3(n,e)}(e,t)))}equalTo(e,t){return(0,P.Dv)("Query.equalTo",1,2,arguments.length),new Hi(this.database,qu(this._delegate,function S3(n,e){return iI("equalTo","key",e,!0),new T3(n,e)}(e,t)))}toString(){return(0,P.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,P.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,P.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof Hi))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,r){const i={cancel:void 0,context:void 0};if(t&&r)i.cancel=t,(0,P.Wj)(e,"cancel",i.cancel,!0),i.context=r,(0,P.lb)(e,"context",i.context,!0);else if(t)if("object"==typeof t&&null!==t)i.context=t;else{if("function"!=typeof t)throw new Error((0,P.gK)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");i.cancel=t}return i}get ref(){return new Wo(this.database,new Ha(this._delegate._repo,this._delegate._path))}}class Wo extends Hi{constructor(e,t){super(e,new lo(t._repo,t._path,new vT,!1)),this.database=e,this._delegate=t}getKey(){return(0,P.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,P.Dv)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new Wo(this.database,cm(this._delegate,e))}getParent(){(0,P.Dv)("Reference.parent",0,0,arguments.length);const e=this._delegate.parent;return e?new Wo(this.database,e):null}getRoot(){return(0,P.Dv)("Reference.root",0,0,arguments.length),new Wo(this.database,this._delegate.root)}set(e,t){(0,P.Dv)("Reference.set",1,2,arguments.length),(0,P.Wj)("Reference.set","onComplete",t,!0);const r=fN(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}update(e,t){if((0,P.Dv)("Reference.update",1,2,arguments.length),Array.isArray(e)){const i={};for(let a=0;a<e.length;++a)i[""+a]=e[a];e=i,GL("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ja("Reference.update",this._delegate._path),(0,P.Wj)("Reference.update","onComplete",t,!0);const r=o3(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}setWithPriority(e,t,r){(0,P.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,P.Wj)("Reference.setWithPriority","onComplete",r,!0);const i=function s3(n,e,t){if(ja("setWithPriority",n._path),vc("setWithPriority",e,n._path,!1),iN("setWithPriority",t,!1),".length"===n.key||".keys"===n.key)throw"setWithPriority failed: "+n.key+" is a read-only object.";const r=new P.BH;return oN(n._repo,n._path,e,t,r.wrapCallback(()=>{})),r.promise}(this._delegate,e,t);return r&&i.then(()=>r(null),a=>r(a)),i}remove(e){(0,P.Dv)("Reference.remove",0,1,arguments.length),(0,P.Wj)("Reference.remove","onComplete",e,!0);const t=function r3(n){return ja("remove",n._path),fN(n,null)}(this._delegate);return e&&t.then(()=>e(null),r=>e(r)),t}transaction(e,t,r){(0,P.Dv)("Reference.transaction",1,3,arguments.length),(0,P.Wj)("Reference.transaction","transactionUpdate",e,!1),(0,P.Wj)("Reference.transaction","onComplete",t,!0),function(n,e,t,r){if(void 0!==t&&"boolean"!=typeof t)throw new Error((0,P.gK)("Reference.transaction","applyLocally")+"must be a boolean.")}(0,0,r);const i=function G3(n,e,t){var r;if(n=(0,P.m9)(n),ja("Reference.transaction",n._path),".length"===n.key||".keys"===n.key)throw"Reference.transaction failed: "+n.key+" is a read-only object.";const i=null===(r=t?.applyLocally)||void 0===r||r,a=new P.BH,d=pN(n,()=>{});return function YW(n,e,t,r,i,a){Py(n,"transaction on "+e);const l={path:e,update:t,onComplete:r,status:null,order:V1(),applyLocally:a,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},d=uN(n,e,void 0);l.currentInputSnapshot=d;const _=l.update(d.val());if(void 0===_)l.unwatcher(),l.currentOutputSnapshotRaw=null,l.currentOutputSnapshotResolved=null,l.onComplete&&l.onComplete(null,!1,l.currentInputSnapshot);else{rI("transaction failed: Data returned ",_,l.path),l.status=0;const w=FT(n.transactionQueueTree_,e),D=um(w)||[];let S;D.push(l),tN(w,D),"object"==typeof _&&null!==_&&(0,P.r3)(_,".priority")?(S=(0,P.DV)(_,".priority"),(0,P.hu)(nI(S),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):S=(PT(n.serverSyncTree_,e)||Gt.EMPTY_NODE).getPriority().val();const M=oI(n),O=Ir(_,S),j=JM(O,d,M);l.currentOutputSnapshotRaw=O,l.currentOutputSnapshotResolved=j,l.currentWriteId=BT(n);const ae=WM(n.serverSyncTree_,e,j,l.currentWriteId,l.applyLocally);Go(n.eventQueue_,e,ae),jT(n,n.transactionQueueTree_)}}(n._repo,n._path,e,(_,w,D)=>{let S=null;_?a.reject(_):(S=new lm(D,new Ha(n._repo,n._path),Wn),a.resolve(new $3(w,S)))},d,i),a.promise}(this._delegate,e,{applyLocally:r}).then(a=>new Q3(a.committed,new qf(this.database,a.snapshot)));return t&&i.then(a=>t(null,a.committed,a.snapshot),a=>t(a,!1,null)),i}setPriority(e,t){(0,P.Dv)("Reference.setPriority",1,2,arguments.length),(0,P.Wj)("Reference.setPriority","onComplete",t,!0);const r=function i3(n,e){n=(0,P.m9)(n),ja("setPriority",n._path),iN("setPriority",e,!1);const t=new P.BH;return oN(n._repo,dr(n._path,".priority"),e,null,t.wrapCallback(()=>{})),t.promise}(this._delegate,e);return t&&r.then(()=>t(null),i=>t(i)),r}push(e,t){(0,P.Dv)("Reference.push",0,2,arguments.length),(0,P.Wj)("Reference.push","onComplete",t,!0);const r=function n3(n,e){n=(0,P.m9)(n),ja("push",n._path),vc("push",e,n._path,!0);const t=wL(n._repo),r=hG(t),i=cm(n,r),a=cm(n,r);let l;return l=null!=e?fN(a,e).then(()=>a):Promise.resolve(a),i.then=l.then.bind(l),i.catch=l.then.bind(l,void 0),i}(this._delegate,e),i=r.then(l=>new Wo(this.database,l));t&&i.then(()=>t(null),l=>t(l));const a=new Wo(this.database,r);return a.then=i.then.bind(i),a.catch=i.catch.bind(i,void 0),a}onDisconnect(){return ja("Reference.onDisconnect",this._delegate._path),new Y3(new RL(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}class lI{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:P3,forceLongPolling:O3}}useEmulator(e,t,r={}){!function $L(n,e,t,r={}){(n=(0,P.m9)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&mc("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let a;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&mc('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),a=new BE(BE.OWNER);else if(r.mockUserToken){const l="string"==typeof r.mockUserToken?r.mockUserToken:(0,P.Sg)(r.mockUserToken,n.app.options.projectId);a=new BE(l)}!function x3(n,e,t,r){n.repoInfo_=new hM(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams),r&&(n.authTokenProvider_=r)}(i,e,t,a)}(this._delegate,e,t,r)}ref(e){if((0,P.Dv)("database.ref",0,1,arguments.length),e instanceof Wo){const t=NL(this._delegate,e.toString());return new Wo(this,t)}{const t=ML(this._delegate,e);return new Wo(this,t)}}refFromURL(e){(0,P.Dv)("database.refFromURL",1,1,arguments.length);const r=NL(this._delegate,e);return new Wo(this,r)}goOffline(){return(0,P.Dv)("database.goOffline",0,0,arguments.length),function F3(n){(n=(0,P.m9)(n))._checkNotDeleted("goOffline"),bL(n._repo)}(this._delegate)}goOnline(){return(0,P.Dv)("database.goOnline",0,0,arguments.length),function L3(n){(n=(0,P.m9)(n))._checkNotDeleted("goOnline"),function ZW(n){n.persistentConnection_&&n.persistentConnection_.resume(vL)}(n._repo)}(this._delegate)}}lI.ServerValue={TIMESTAMP:function j3(){return B3}(),increment:n=>function H3(n){return{".sv":{increment:n}}}(n)};var X3=Object.freeze({__proto__:null,initStandalone:function J3({app:n,url:e,version:t,customAuthImpl:r,namespace:i,nodeAdmin:a=!1}){F1(t);const l=new Xs.zt("auth-internal",new Xs.H0("database-standalone"));return l.setComponent(new Xs.wA("auth-internal",()=>r,"PRIVATE")),{instance:new lI(jL(n,l,void 0,e,a),n),namespace:i}}});const ez=lI.ServerValue;function WL(n){return null==n}function zL(n){return"function"==typeof n.set}function qL(n,e){return zL(e)?e:n.ref(e)}function KL(n,e){if(function nz(n){return"string"==typeof n}(n))return e.stringCase();if(zL(n))return e.firebaseCase();if(function rz(n){return"function"==typeof n.exportVal}(n))return e.snapshotCase();throw new Error("Expects a string, snapshot, or reference. Got: "+typeof n)}function cI(n,e,t="on",r=Bp.z){return new Nr.y(i=>{let a=null;return a=n[t](e,(l,d)=>{r.schedule(()=>{i.next({snapshot:l,prevKey:d})}),"once"===t&&r.schedule(()=>i.complete())},l=>{r.schedule(()=>i.error(l))}),"on"===t?{unsubscribe(){null!=a&&n.off(e,a)}}:{unsubscribe(){}}}).pipe((0,ft.U)(i=>{const{snapshot:a,prevKey:l}=i;let d=null;return a.exists()&&(d=a.key),{type:e,payload:a,prevKey:l,key:d}}),(0,oP.B)())}function ZL(n,e){const t=n.length;for(let r=0;r<t;r++)if(n[r].payload.key===e)return r;return-1}function oz(n,e){const{payload:t,prevKey:r,key:i}=e,a=ZL(n,i),l=function sz(n,e){if(WL(e))return 0;{const t=ZL(n,e);return-1===t?n.length:t+1}}(n,r);switch(e.type){case"value":if(e.payload&&e.payload.exists()){let d=null;e.payload.forEach(_=>{const w={payload:_,type:"value",prevKey:d,key:_.key};return d=_.key,n=[...n,w],!1})}return n;case"child_added":if(a>-1){const d=n[a-1];(d&&d.key||null)!==r&&(n=n.filter(_=>_.payload.key!==t.key)).splice(l,0,e)}else{if(null==r)return[e,...n];(n=n.slice()).splice(l,0,e)}return n;case"child_removed":return n.filter(d=>d.payload.key!==t.key);case"child_changed":return n.map(d=>d.payload.key===i?e:d);case"child_moved":if(a>-1){const d=n.splice(a,1)[0];return(n=n.slice()).splice(l,0,d),n}return n;default:return n}}function YL(n){return(WL(n)||0===n.length)&&(n=["child_added","child_removed","child_changed","child_moved"]),n}function QL(n,e,t){return function iz(n,e,t){return cI(n,"value","once",t).pipe(Yn(r=>{const i=[it(r)];return e.forEach(a=>i.push(cI(n,a,"on",t))),(0,Jx.T)(...i).pipe(_a(oz,[]))}),rC())}(n,e=YL(e),t)}function JL(n,e,t){const r=(e=YL(e)).map(i=>cI(n,i,"on",t));return(0,Jx.T)(...r)}function XL(n,e){return function(r,i){return KL(r,{stringCase:()=>n.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function cz(n){return function(t){return t?KL(t,{stringCase:()=>n.child(t).remove(),firebaseCase:()=>t.remove(),snapshotCase:()=>t.ref.remove()}):n.remove()}}function eV(n,e){return function(){return cI(n,"value","on",e)}}!function tz(n){n.INTERNAL.registerComponent(new Xs.wA("database-compat",(e,{instanceIdentifier:t})=>{const r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:t});return new lI(i,r)},"PUBLIC").setServiceProps({Reference:Wo,Query:Hi,Database:lI,DataSnapshot:qf,enableLogging:V3,INTERNAL:X3,ServerValue:ez}).setMultipleInstances(!0)),n.registerVersion("@firebase/database-compat","0.2.10")}(iC.Z);const fz=new f.OlP("angularfire2.realtimeDatabaseURL"),pz=new f.OlP("angularfire2.database.use-emulator");let gz=(()=>{class n{constructor(t,r,i,a,l,d,_,w,D,S,M,O,j,ae,he){this.schedulers=d;const $e=_,nt=(0,Fr.on)(t,l,r);w&&DR(nt,l,D,M,O,j,S,ae),this.database=(0,Fr.cc)(`${nt.name}.database.${i}`,"AngularFireDatabase",nt.name,()=>{const et=l.runOutsideAngular(()=>nt.database(i||void 0));return $e&&et.useEmulator(...$e),et},[$e])}list(t,r){const i=this.schedulers.ngZone.runOutsideAngular(()=>qL(this.database,t));let a=i;return r&&(a=r(i)),function dz(n,e){const t=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>n.ref);return{query:n,update:XL(r,"update"),set:XL(r,"set"),push:i=>r.push(i),remove:cz(r),snapshotChanges:i=>QL(n,i,t).pipe(gn.iC),stateChanges:i=>JL(n,i,t).pipe(gn.iC),auditTrail:i=>function az(n,e,t){return function lz(n,e,t){return function uz(n,e){return cI(n,"value","on",e).pipe((0,ft.U)(t=>{let r;return t.payload.forEach(i=>(r=i.key,!1)),{data:t,lastKeyToLoad:r}}))}(n,t).pipe(function u$(...n){const e=(0,ms.jO)(n);return(0,An.e)((t,r)=>{const i=n.length,a=new Array(i);let l=n.map(()=>!1),d=!1;for(let _=0;_<i;_++)(0,Ml.Xf)(n[_]).subscribe((0,pn.x)(r,w=>{a[_]=w,!d&&!l[_]&&(l[_]=!0,(d=l.every(Yc.y))&&(l=null))},a$.Z));t.subscribe((0,pn.x)(r,_=>{if(d){const w=[_,...a];r.next(e?e(...w):w)}}))})}(e),(0,ft.U)(([i,a])=>{const l=i.lastKeyToLoad,d=a.map(_=>_.key);return{actions:a,lastKeyToLoad:l,loadedKeys:d}}),function l$(n){return(0,An.e)((e,t)=>{let r=!1,i=0;e.subscribe((0,pn.x)(t,a=>(r||(r=!n(a,i++)))&&t.next(a)))})}(i=>-1===i.loadedKeys.indexOf(i.lastKeyToLoad)),(0,ft.U)(i=>i.actions))}(n,JL(n,e).pipe(_a((i,a)=>[...i,a],[])),t)}(n,i,t).pipe(gn.iC),valueChanges:(i,a)=>QL(n,i,t).pipe((0,ft.U)(d=>d.map(_=>a&&a.idField?Object.assign(Object.assign({},_.payload.val()),{[a.idField]:_.key}):_.payload.val())),gn.iC)}}(a,this)}object(t){return function hz(n,e){return{query:n,snapshotChanges:()=>eV(n,e.schedulers.outsideAngular)().pipe(gn.iC),update:t=>n.ref.update(t),set:t=>n.ref.set(t),remove:()=>n.ref.remove(),valueChanges:()=>eV(n,e.schedulers.outsideAngular)().pipe(gn.iC,(0,ft.U)(r=>r.payload.exists()?r.payload.val():null))}}(this.schedulers.ngZone.runOutsideAngular(()=>qL(this.database,t)),this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}}return n.\u0275fac=function(t){return new(t||n)(f.LFG(Fr.Dh),f.LFG(Fr.xv,8),f.LFG(fz,8),f.LFG(f.Lbi),f.LFG(f.R0b),f.LFG(gn.HU),f.LFG(pz,8),f.LFG(SE,8),f.LFG(vR,8),f.LFG(wR,8),f.LFG(ER,8),f.LFG(IR,8),f.LFG(CR,8),f.LFG(bR,8),f.LFG(TE,8))},n.\u0275prov=f.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),mz=(()=>{class n{constructor(){WD.Z.registerVersion("angularfire",gn.q4.full,"rtdb-compat")}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n}),n.\u0275inj=f.cJS({providers:[gz]}),n})(),_z=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=f.oAB({type:n,bootstrap:[mj]}),n.\u0275inj=f.cJS({providers:[Jd],imports:[Hc,cj,BB,Fr.hO.initializeApp(Ul_firebaseConfig),KB,o$,mz,K2,ha]}),n})();(0,f.G48)(),Il().bootstrapModule(_z).catch(n=>console.error(n))},5867:(ct,Te,V)=>{V.d(Te,{C6:()=>f.getApps,Mq:()=>f.getApp,ZF:()=>f.initializeApp});var f=V(9681);(0,f.registerVersion)("firebase","9.14.0","app")},127:(ct,Te,V)=>{V.d(Te,{Z:()=>f.Z});var f=V(3942);f.Z.registerVersion("firebase","9.14.0","app-compat")},1277:(ct,Te,V)=>{V.r(Te);var f=V(5861),te=V(3942),F=V(2090),ue=V(9681),se=V(1877),fe=V(655),ce=V(4859);const Ce=function Ve(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},rt=function Me(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},ye=new F.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Je=new se.Yd("@firebase/auth");function ut(y,...p){Je.logLevel<=se.in.ERROR&&Je.error(`Auth (${ue.SDK_VERSION}): ${y}`,...p)}function Re(y,...p){throw je(y,...p)}function we(y,...p){return je(y,...p)}function be(y,p,m){const E=Object.assign(Object.assign({},rt()),{[p]:m});return new F.LL("auth","Firebase",E).create(p,{appName:y.name})}function Be(y,p,m){if(!(p instanceof m))throw m.name!==p.constructor.name&&Re(y,"argument-error"),be(y,"argument-error",`Type of ${p.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function je(y,...p){if("string"!=typeof y){const m=p[0],E=[...p.slice(1)];return E[0]&&(E[0].appName=y.name),y._errorFactory.create(m,...E)}return ye.create(y,...p)}function H(y,p,...m){if(!y)throw je(p,...m)}function _e(y){const p="INTERNAL ASSERTION FAILED: "+y;throw ut(p),new Error(p)}function K(y,p){y||_e(p)}const X=new Map;function ie(y){K(y instanceof Function,"Expected a class definition");let p=X.get(y);return p?(K(p instanceof y,"Instance stored in cache mismatched with class"),p):(p=new y,X.set(y,p),p)}function Pe(){var y;return typeof self<"u"&&(null===(y=self.location)||void 0===y?void 0:y.href)||""}function dt(){return"http:"===tn()||"https:"===tn()}function tn(){var y;return typeof self<"u"&&(null===(y=self.location)||void 0===y?void 0:y.protocol)||null}class cn{constructor(p,m){this.shortDelay=p,this.longDelay=m,K(m>p,"Short delay should be less than long delay!"),this.isMobile=(0,F.uI)()||(0,F.b$)()}get(){return function jt(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(dt()||(0,F.ru)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function In(y,p){K(y.emulator,"Emulator should always be set here");const{url:m}=y.emulator;return p?`${m}${p.startsWith("/")?p.slice(1):p}`:m}class Qt{static initialize(p,m,E){this.fetchImpl=p,m&&(this.headersImpl=m),E&&(this.responseImpl=E)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:void _e("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:void _e("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:void _e("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const nn={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},$r=new cn(3e4,6e4);function Nt(y,p){return y.tenantId&&!p.tenantId?Object.assign(Object.assign({},p),{tenantId:y.tenantId}):p}function dn(y,p,m,E){return ss.apply(this,arguments)}function ss(){return(ss=(0,f.Z)(function*(y,p,m,E,x={}){return Ai(y,x,(0,f.Z)(function*(){let k={},q={};E&&("GET"===p?q=E:k={body:JSON.stringify(E)});const le=(0,F.xO)(Object.assign({key:y.config.apiKey},q)).slice(1),Le=yield y._getAdditionalHeaders();return Le["Content-Type"]="application/json",y.languageCode&&(Le["X-Firebase-Locale"]=y.languageCode),Qt.fetch()(xi(y,y.config.apiHost,m,le),Object.assign({method:p,headers:Le,referrerPolicy:"no-referrer"},k))}))})).apply(this,arguments)}function Ai(y,p,m){return Gr.apply(this,arguments)}function Gr(){return(Gr=(0,f.Z)(function*(y,p,m){y._canInitEmulator=!1;const E=Object.assign(Object.assign({},nn),p);try{const x=new ri(y),k=yield Promise.race([m(),x.promise]);x.clearNetworkTimeout();const q=yield k.json();if("needConfirmation"in q)throw mi(y,"account-exists-with-different-credential",q);if(k.ok&&!("errorMessage"in q))return q;{const le=k.ok?q.errorMessage:q.error.message,[Le,Qe]=le.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===Le)throw mi(y,"credential-already-in-use",q);if("EMAIL_EXISTS"===Le)throw mi(y,"email-already-in-use",q);if("USER_DISABLED"===Le)throw mi(y,"user-disabled",q);const wt=E[Le]||Le.toLowerCase().replace(/[_\s]+/g,"-");if(Qe)throw be(y,wt,Qe);Re(y,wt)}}catch(x){if(x instanceof F.ZR)throw x;Re(y,"network-request-failed")}})).apply(this,arguments)}function Wr(y,p,m,E){return Ps.apply(this,arguments)}function Ps(){return(Ps=(0,f.Z)(function*(y,p,m,E,x={}){const k=yield dn(y,p,m,E,x);return"mfaPendingCredential"in k&&Re(y,"multi-factor-auth-required",{_serverResponse:k}),k})).apply(this,arguments)}function xi(y,p,m,E){const x=`${p}${m}?${E}`;return y.config.emulator?In(y.config,x):`${y.config.apiScheme}://${x}`}class ri{constructor(p){this.auth=p,this.timer=null,this.promise=new Promise((m,E)=>{this.timer=setTimeout(()=>E(we(this.auth,"network-request-failed")),$r.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function mi(y,p,m){const E={appName:y.name};m.email&&(E.email=m.email),m.phoneNumber&&(E.phoneNumber=m.phoneNumber);const x=we(y,p,E);return x.customData._tokenResponse=m,x}function Ye(){return(Ye=(0,f.Z)(function*(y,p){return dn(y,"POST","/v1/accounts:delete",p)})).apply(this,arguments)}function Rr(y,p){return Os.apply(this,arguments)}function Os(){return(Os=(0,f.Z)(function*(y,p){return dn(y,"POST","/v1/accounts:update",p)})).apply(this,arguments)}function rr(y,p){return _i.apply(this,arguments)}function _i(){return(_i=(0,f.Z)(function*(y,p){return dn(y,"POST","/v1/accounts:lookup",p)})).apply(this,arguments)}function $i(y){if(y)try{const p=new Date(Number(y));if(!isNaN(p.getTime()))return p.toUTCString()}catch{}}function yn(){return(yn=(0,f.Z)(function*(y,p=!1){const m=(0,F.m9)(y),E=yield m.getIdToken(p),x=lt(E);H(x&&x.exp&&x.auth_time&&x.iat,m.auth,"internal-error");const k="object"==typeof x.firebase?x.firebase:void 0,q=k?.sign_in_provider;return{claims:x,token:E,authTime:$i(yt(x.auth_time)),issuedAtTime:$i(yt(x.iat)),expirationTime:$i(yt(x.exp)),signInProvider:q||null,signInSecondFactor:k?.sign_in_second_factor||null}})).apply(this,arguments)}function yt(y){return 1e3*Number(y)}function lt(y){var p;const[m,E,x]=y.split(".");if(void 0===m||void 0===E||void 0===x)return ut("JWT malformed, contained fewer than 3 sections"),null;try{const k=(0,F.tV)(E);return k?JSON.parse(k):(ut("Failed to decode base64 JWT payload"),null)}catch(k){return ut("Caught error parsing JWT payload as JSON",null===(p=k)||void 0===p?void 0:p.toString()),null}}function hr(y,p){return jn.apply(this,arguments)}function jn(){return(jn=(0,f.Z)(function*(y,p,m=!1){if(m)return p;try{return yield p}catch(E){throw E instanceof F.ZR&&ii(E)&&y.auth.currentUser===y&&(yield y.auth.signOut()),E}})).apply(this,arguments)}function ii({code:y}){return"auth/user-disabled"===y||"auth/user-token-expired"===y}class At{constructor(p){this.user=p,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){!this.isRunning||(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(p){var m;if(p){const E=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),E}{this.errorBackoff=3e4;const x=(null!==(m=this.user.stsTokenManager.expirationTime)&&void 0!==m?m:0)-Date.now()-3e5;return Math.max(0,x)}}schedule(p=!1){var m=this;if(!this.isRunning)return;const E=this.getInterval(p);this.timerId=setTimeout((0,f.Z)(function*(){yield m.iteration()}),E)}iteration(){var p=this;return(0,f.Z)(function*(){var m;try{yield p.user.getIdToken(!0)}catch(E){return void("auth/network-request-failed"===(null===(m=E)||void 0===m?void 0:m.code)&&p.schedule(!0))}p.schedule()})()}}class os{constructor(p,m){this.createdAt=p,this.lastLoginAt=m,this._initializeTime()}_initializeTime(){this.lastSignInTime=$i(this.lastLoginAt),this.creationTime=$i(this.createdAt)}_copy(p){this.createdAt=p.createdAt,this.lastLoginAt=p.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function rn(y){return Ri.apply(this,arguments)}function Ri(){return(Ri=(0,f.Z)(function*(y){var p;const m=y.auth,E=yield y.getIdToken(),x=yield hr(y,rr(m,{idToken:E}));H(x?.users.length,m,"internal-error");const k=x.users[0];y._notifyReloadListener(k);const q=null!==(p=k.providerUserInfo)&&void 0!==p&&p.length?tt(k.providerUserInfo):[],le=zr(y.providerData,q),wt=!!y.isAnonymous&&!(y.email&&k.passwordHash||le?.length),vt={uid:k.localId,displayName:k.displayName||null,photoURL:k.photoUrl||null,email:k.email||null,emailVerified:k.emailVerified||!1,phoneNumber:k.phoneNumber||null,tenantId:k.tenantId||null,providerData:le,metadata:new os(k.createdAt,k.lastLoginAt),isAnonymous:wt};Object.assign(y,vt)})).apply(this,arguments)}function ir(){return(ir=(0,f.Z)(function*(y){const p=(0,F.m9)(y);yield rn(p),yield p.auth._persistUserIfCurrent(p),p.auth._notifyListenersIfCurrent(p)})).apply(this,arguments)}function zr(y,p){return[...y.filter(E=>!p.some(x=>x.providerId===E.providerId)),...p]}function tt(y){return y.map(p=>{var{providerId:m}=p,E=(0,fe._T)(p,["providerId"]);return{providerId:m,uid:E.rawId||"",displayName:E.displayName||null,email:E.email||null,phoneNumber:E.phoneNumber||null,photoURL:E.photoUrl||null}})}function Xe(){return(Xe=(0,f.Z)(function*(y,p){const m=yield Ai(y,{},(0,f.Z)(function*(){const E=(0,F.xO)({grant_type:"refresh_token",refresh_token:p}).slice(1),{tokenApiHost:x,apiKey:k}=y.config,q=xi(y,x,"/v1/token",`key=${k}`),le=yield y._getAdditionalHeaders();return le["Content-Type"]="application/x-www-form-urlencoded",Qt.fetch()(q,{method:"POST",headers:le,body:E})}));return{accessToken:m.access_token,expiresIn:m.expires_in,refreshToken:m.refresh_token}})).apply(this,arguments)}class bt{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(p){H(p.idToken,"internal-error"),H(typeof p.idToken<"u","internal-error"),H(typeof p.refreshToken<"u","internal-error");const m="expiresIn"in p&&typeof p.expiresIn<"u"?Number(p.expiresIn):function ln(y){const p=lt(y);return H(p,"internal-error"),H(typeof p.exp<"u","internal-error"),H(typeof p.iat<"u","internal-error"),Number(p.exp)-Number(p.iat)}(p.idToken);this.updateTokensAndExpiration(p.idToken,p.refreshToken,m)}getToken(p,m=!1){var E=this;return(0,f.Z)(function*(){return H(!E.accessToken||E.refreshToken,p,"user-token-expired"),m||!E.accessToken||E.isExpired?E.refreshToken?(yield E.refresh(p,E.refreshToken),E.accessToken):null:E.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(p,m){var E=this;return(0,f.Z)(function*(){const{accessToken:x,refreshToken:k,expiresIn:q}=yield function Se(y,p){return Xe.apply(this,arguments)}(p,m);E.updateTokensAndExpiration(x,k,Number(q))})()}updateTokensAndExpiration(p,m,E){this.refreshToken=m||null,this.accessToken=p||null,this.expirationTime=Date.now()+1e3*E}static fromJSON(p,m){const{refreshToken:E,accessToken:x,expirationTime:k}=m,q=new bt;return E&&(H("string"==typeof E,"internal-error",{appName:p}),q.refreshToken=E),x&&(H("string"==typeof x,"internal-error",{appName:p}),q.accessToken=x),k&&(H("number"==typeof k,"internal-error",{appName:p}),q.expirationTime=k),q}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(p){this.accessToken=p.accessToken,this.refreshToken=p.refreshToken,this.expirationTime=p.expirationTime}_clone(){return Object.assign(new bt,this.toJSON())}_performRefresh(){return _e("not implemented")}}function Et(y,p){H("string"==typeof y||typeof y>"u","internal-error",{appName:p})}class Ft{constructor(p){var{uid:m,auth:E,stsTokenManager:x}=p,k=(0,fe._T)(p,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new At(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=m,this.auth=E,this.stsTokenManager=x,this.accessToken=x.accessToken,this.displayName=k.displayName||null,this.email=k.email||null,this.emailVerified=k.emailVerified||!1,this.phoneNumber=k.phoneNumber||null,this.photoURL=k.photoURL||null,this.isAnonymous=k.isAnonymous||!1,this.tenantId=k.tenantId||null,this.providerData=k.providerData?[...k.providerData]:[],this.metadata=new os(k.createdAt||void 0,k.lastLoginAt||void 0)}getIdToken(p){var m=this;return(0,f.Z)(function*(){const E=yield hr(m,m.stsTokenManager.getToken(m.auth,p));return H(E,m.auth,"internal-error"),m.accessToken!==E&&(m.accessToken=E,yield m.auth._persistUserIfCurrent(m),m.auth._notifyListenersIfCurrent(m)),E})()}getIdTokenResult(p){return function qn(y){return yn.apply(this,arguments)}(this,p)}reload(){return function an(y){return ir.apply(this,arguments)}(this)}_assign(p){this!==p&&(H(this.uid===p.uid,this.auth,"internal-error"),this.displayName=p.displayName,this.photoURL=p.photoURL,this.email=p.email,this.emailVerified=p.emailVerified,this.phoneNumber=p.phoneNumber,this.isAnonymous=p.isAnonymous,this.tenantId=p.tenantId,this.providerData=p.providerData.map(m=>Object.assign({},m)),this.metadata._copy(p.metadata),this.stsTokenManager._assign(p.stsTokenManager))}_clone(p){return new Ft(Object.assign(Object.assign({},this),{auth:p,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(p){H(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=p,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(p){this.reloadListener?this.reloadListener(p):this.reloadUserInfo=p}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(p,m=!1){var E=this;return(0,f.Z)(function*(){let x=!1;p.idToken&&p.idToken!==E.stsTokenManager.accessToken&&(E.stsTokenManager.updateFromServerResponse(p),x=!0),m&&(yield rn(E)),yield E.auth._persistUserIfCurrent(E),x&&E.auth._notifyListenersIfCurrent(E)})()}delete(){var p=this;return(0,f.Z)(function*(){const m=yield p.getIdToken();return yield hr(p,function zo(y,p){return Ye.apply(this,arguments)}(p.auth,{idToken:m})),p.stsTokenManager.clearRefreshToken(),p.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(p=>Object.assign({},p)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(p,m){var E,x,k,q,le,Le,Qe,wt;const vt=null!==(E=m.displayName)&&void 0!==E?E:void 0,yr=null!==(x=m.email)&&void 0!==x?x:void 0,Oi=null!==(k=m.phoneNumber)&&void 0!==k?k:void 0,Tp=null!==(q=m.photoURL)&&void 0!==q?q:void 0,nv=null!==(le=m.tenantId)&&void 0!==le?le:void 0,ud=null!==(Le=m._redirectEventId)&&void 0!==Le?Le:void 0,rv=null!==(Qe=m.createdAt)&&void 0!==Qe?Qe:void 0,iv=null!==(wt=m.lastLoginAt)&&void 0!==wt?wt:void 0,{uid:Pm,emailVerified:Om,isAnonymous:sv,providerData:Nh,stsTokenManager:ld}=m;H(Pm&&ld,p,"internal-error");const cd=bt.fromJSON(this.name,ld);H("string"==typeof Pm,p,"internal-error"),Et(vt,p.name),Et(yr,p.name),H("boolean"==typeof Om,p,"internal-error"),H("boolean"==typeof sv,p,"internal-error"),Et(Oi,p.name),Et(Tp,p.name),Et(nv,p.name),Et(ud,p.name),Et(rv,p.name),Et(iv,p.name);const Yi=new Ft({uid:Pm,auth:p,email:yr,emailVerified:Om,displayName:vt,isAnonymous:sv,photoURL:Tp,phoneNumber:Oi,tenantId:nv,stsTokenManager:cd,createdAt:rv,lastLoginAt:iv});return Nh&&Array.isArray(Nh)&&(Yi.providerData=Nh.map(Tu=>Object.assign({},Tu))),ud&&(Yi._redirectEventId=ud),Yi}static _fromIdTokenResponse(p,m,E=!1){return(0,f.Z)(function*(){const x=new bt;x.updateFromServerResponse(m);const k=new Ft({uid:m.localId,auth:p,stsTokenManager:x,isAnonymous:E});return yield rn(k),k})()}}const B=(()=>{class y{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,f.Z)(function*(){return!0})()}_set(m,E){var x=this;return(0,f.Z)(function*(){x.storage[m]=E})()}_get(m){var E=this;return(0,f.Z)(function*(){const x=E.storage[m];return void 0===x?null:x})()}_remove(m){var E=this;return(0,f.Z)(function*(){delete E.storage[m]})()}_addListener(m,E){}_removeListener(m,E){}}return y.type="NONE",y})();function Z(y,p,m){return`firebase:${y}:${p}:${m}`}class Ie{constructor(p,m,E){this.persistence=p,this.auth=m,this.userKey=E;const{config:x,name:k}=this.auth;this.fullUserKey=Z(this.userKey,x.apiKey,k),this.fullPersistenceKey=Z("persistence",x.apiKey,k),this.boundEventHandler=m._onStorageEvent.bind(m),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(p){return this.persistence._set(this.fullUserKey,p.toJSON())}getCurrentUser(){var p=this;return(0,f.Z)(function*(){const m=yield p.persistence._get(p.fullUserKey);return m?Ft._fromJSON(p.auth,m):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(p){var m=this;return(0,f.Z)(function*(){if(m.persistence===p)return;const E=yield m.getCurrentUser();return yield m.removeCurrentUser(),m.persistence=p,E?m.setCurrentUser(E):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(p,m,E="authUser"){return(0,f.Z)(function*(){if(!m.length)return new Ie(ie(B),p,E);const x=(yield Promise.all(m.map(function(){var Qe=(0,f.Z)(function*(wt){if(yield wt._isAvailable())return wt});return function(wt){return Qe.apply(this,arguments)}}()))).filter(Qe=>Qe);let k=x[0]||ie(B);const q=Z(E,p.config.apiKey,p.name);let le=null;for(const Qe of m)try{const wt=yield Qe._get(q);if(wt){const vt=Ft._fromJSON(p,wt);Qe!==k&&(le=vt),k=Qe;break}}catch{}const Le=x.filter(Qe=>Qe._shouldAllowMigration);return k._shouldAllowMigration&&Le.length?(k=Le[0],le&&(yield k._set(q,le.toJSON())),yield Promise.all(m.map(function(){var Qe=(0,f.Z)(function*(wt){if(wt!==k)try{yield wt._remove(q)}catch{}});return function(wt){return Qe.apply(this,arguments)}}())),new Ie(k,p,E)):new Ie(k,p,E)})()}}function J(y){const p=y.toLowerCase();if(p.includes("opera/")||p.includes("opr/")||p.includes("opios/"))return"Opera";if(mn(p))return"IEMobile";if(p.includes("msie")||p.includes("trident/"))return"IE";if(p.includes("edge/"))return"Edge";if(ze(p))return"Firefox";if(p.includes("silk/"))return"Silk";if(Ue(p))return"Blackberry";if(Ge(p))return"Webos";if(ht(p))return"Safari";if((p.includes("chrome/")||Jt(p))&&!p.includes("edge/"))return"Chrome";if(qt(p))return"Android";{const E=y.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===E?.length)return E[1]}return"Other"}function ze(y=(0,F.z$)()){return/firefox\//i.test(y)}function ht(y=(0,F.z$)()){const p=y.toLowerCase();return p.includes("safari/")&&!p.includes("chrome/")&&!p.includes("crios/")&&!p.includes("android")}function Jt(y=(0,F.z$)()){return/crios\//i.test(y)}function mn(y=(0,F.z$)()){return/iemobile/i.test(y)}function qt(y=(0,F.z$)()){return/android/i.test(y)}function Ue(y=(0,F.z$)()){return/blackberry/i.test(y)}function Ge(y=(0,F.z$)()){return/webos/i.test(y)}function Bt(y=(0,F.z$)()){return/iphone|ipad|ipod/i.test(y)||/macintosh/i.test(y)&&/mobile/i.test(y)}function co(y=(0,F.z$)()){return Bt(y)||qt(y)||Ge(y)||Ue(y)||/windows phone/i.test(y)||mn(y)}function Fs(y,p=[]){let m;switch(y){case"Browser":m=J((0,F.z$)());break;case"Worker":m=`${J((0,F.z$)())}-${y}`;break;default:m=y}const E=p.length?p.join(","):"FirebaseCore-web";return`${m}/JsCore/${ue.SDK_VERSION}/${E}`}class qo{constructor(p){this.auth=p,this.queue=[]}pushCallback(p,m){const E=k=>new Promise((q,le)=>{try{q(p(k))}catch(Le){le(Le)}});E.onAbort=m,this.queue.push(E);const x=this.queue.length-1;return()=>{this.queue[x]=()=>Promise.resolve()}}runMiddleware(p){var m=this;return(0,f.Z)(function*(){var E;if(m.auth.currentUser===p)return;const x=[];try{for(const k of m.queue)yield k(p),k.onAbort&&x.push(k.onAbort)}catch(k){x.reverse();for(const q of x)try{q()}catch{}throw m.auth._errorFactory.create("login-blocked",{originalMessage:null===(E=k)||void 0===E?void 0:E.message})}})()}}class Lt{constructor(p,m,E){this.app=p,this.heartbeatServiceProvider=m,this.config=E,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ho(this),this.idTokenSubscription=new ho(this),this.beforeStateQueue=new qo(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ye,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=p.name,this.clientVersion=E.sdkClientVersion}_initializeWithPersistence(p,m){var E=this;return m&&(this._popupRedirectResolver=ie(m)),this._initializationPromise=this.queue((0,f.Z)(function*(){var x,k;if(!E._deleted&&(E.persistenceManager=yield Ie.create(E,p),!E._deleted)){if(null!==(x=E._popupRedirectResolver)&&void 0!==x&&x._shouldInitProactively)try{yield E._popupRedirectResolver._initialize(E)}catch{}yield E.initializeCurrentUser(m),E.lastNotifiedUid=(null===(k=E.currentUser)||void 0===k?void 0:k.uid)||null,!E._deleted&&(E._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var p=this;return(0,f.Z)(function*(){if(p._deleted)return;const m=yield p.assertedPersistence.getCurrentUser();if(p.currentUser||m){if(p.currentUser&&m&&p.currentUser.uid===m.uid)return p._currentUser._assign(m),void(yield p.currentUser.getIdToken());yield p._updateCurrentUser(m,!0)}})()}initializeCurrentUser(p){var m=this;return(0,f.Z)(function*(){var E;const x=yield m.assertedPersistence.getCurrentUser();let k=x,q=!1;if(p&&m.config.authDomain){yield m.getOrInitRedirectPersistenceManager();const le=null===(E=m.redirectUser)||void 0===E?void 0:E._redirectEventId,Le=k?._redirectEventId,Qe=yield m.tryRedirectSignIn(p);(!le||le===Le)&&Qe?.user&&(k=Qe.user,q=!0)}if(!k)return m.directlySetCurrentUser(null);if(!k._redirectEventId){if(q)try{yield m.beforeStateQueue.runMiddleware(k)}catch(le){k=x,m._popupRedirectResolver._overrideRedirectResult(m,()=>Promise.reject(le))}return k?m.reloadAndSetCurrentUserOrClear(k):m.directlySetCurrentUser(null)}return H(m._popupRedirectResolver,m,"argument-error"),yield m.getOrInitRedirectPersistenceManager(),m.redirectUser&&m.redirectUser._redirectEventId===k._redirectEventId?m.directlySetCurrentUser(k):m.reloadAndSetCurrentUserOrClear(k)})()}tryRedirectSignIn(p){var m=this;return(0,f.Z)(function*(){let E=null;try{E=yield m._popupRedirectResolver._completeRedirectFn(m,p,!0)}catch{yield m._setRedirectUser(null)}return E})()}reloadAndSetCurrentUserOrClear(p){var m=this;return(0,f.Z)(function*(){var E;try{yield rn(p)}catch(x){if("auth/network-request-failed"!==(null===(E=x)||void 0===E?void 0:E.code))return m.directlySetCurrentUser(null)}return m.directlySetCurrentUser(p)})()}useDeviceLanguage(){this.languageCode=function Ze(){if(typeof navigator>"u")return null;const y=navigator;return y.languages&&y.languages[0]||y.language||null}()}_delete(){var p=this;return(0,f.Z)(function*(){p._deleted=!0})()}updateCurrentUser(p){var m=this;return(0,f.Z)(function*(){const E=p?(0,F.m9)(p):null;return E&&H(E.auth.config.apiKey===m.config.apiKey,m,"invalid-user-token"),m._updateCurrentUser(E&&E._clone(m))})()}_updateCurrentUser(p,m=!1){var E=this;return(0,f.Z)(function*(){if(!E._deleted)return p&&H(E.tenantId===p.tenantId,E,"tenant-id-mismatch"),m||(yield E.beforeStateQueue.runMiddleware(p)),E.queue((0,f.Z)(function*(){yield E.directlySetCurrentUser(p),E.notifyAuthListeners()}))})()}signOut(){var p=this;return(0,f.Z)(function*(){return yield p.beforeStateQueue.runMiddleware(null),(p.redirectPersistenceManager||p._popupRedirectResolver)&&(yield p._setRedirectUser(null)),p._updateCurrentUser(null,!0)})()}setPersistence(p){var m=this;return this.queue((0,f.Z)(function*(){yield m.assertedPersistence.setPersistence(ie(p))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(p){this._errorFactory=new F.LL("auth","Firebase",p())}onAuthStateChanged(p,m,E){return this.registerStateListener(this.authStateSubscription,p,m,E)}beforeAuthStateChanged(p,m){return this.beforeStateQueue.pushCallback(p,m)}onIdTokenChanged(p,m,E){return this.registerStateListener(this.idTokenSubscription,p,m,E)}toJSON(){var p;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(p=this._currentUser)||void 0===p?void 0:p.toJSON()}}_setRedirectUser(p,m){var E=this;return(0,f.Z)(function*(){const x=yield E.getOrInitRedirectPersistenceManager(m);return null===p?x.removeCurrentUser():x.setCurrentUser(p)})()}getOrInitRedirectPersistenceManager(p){var m=this;return(0,f.Z)(function*(){if(!m.redirectPersistenceManager){const E=p&&ie(p)||m._popupRedirectResolver;H(E,m,"argument-error"),m.redirectPersistenceManager=yield Ie.create(m,[ie(E._redirectPersistence)],"redirectUser"),m.redirectUser=yield m.redirectPersistenceManager.getCurrentUser()}return m.redirectPersistenceManager})()}_redirectUserForId(p){var m=this;return(0,f.Z)(function*(){var E,x;return m._isInitialized&&(yield m.queue((0,f.Z)(function*(){}))),(null===(E=m._currentUser)||void 0===E?void 0:E._redirectEventId)===p?m._currentUser:(null===(x=m.redirectUser)||void 0===x?void 0:x._redirectEventId)===p?m.redirectUser:null})()}_persistUserIfCurrent(p){var m=this;return(0,f.Z)(function*(){if(p===m.currentUser)return m.queue((0,f.Z)(function*(){return m.directlySetCurrentUser(p)}))})()}_notifyListenersIfCurrent(p){p===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var p,m;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const E=null!==(m=null===(p=this.currentUser)||void 0===p?void 0:p.uid)&&void 0!==m?m:null;this.lastNotifiedUid!==E&&(this.lastNotifiedUid=E,this.authStateSubscription.next(this.currentUser))}registerStateListener(p,m,E,x){if(this._deleted)return()=>{};const k="function"==typeof m?m:m.next.bind(m),q=this._isInitialized?Promise.resolve():this._initializationPromise;return H(q,this,"internal-error"),q.then(()=>k(this.currentUser)),"function"==typeof m?p.addObserver(m,E,x):p.addObserver(m)}directlySetCurrentUser(p){var m=this;return(0,f.Z)(function*(){m.currentUser&&m.currentUser!==p&&m._currentUser._stopProactiveRefresh(),p&&m.isProactiveRefreshEnabled&&p._startProactiveRefresh(),m.currentUser=p,p?yield m.assertedPersistence.setCurrentUser(p):yield m.assertedPersistence.removeCurrentUser()})()}queue(p){return this.operations=this.operations.then(p,p),this.operations}get assertedPersistence(){return H(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(p){!p||this.frameworks.includes(p)||(this.frameworks.push(p),this.frameworks.sort(),this.clientVersion=Fs(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var p=this;return(0,f.Z)(function*(){var m;const E={"X-Client-Version":p.clientVersion};p.app.options.appId&&(E["X-Firebase-gmpid"]=p.app.options.appId);const x=yield null===(m=p.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===m?void 0:m.getHeartbeatsHeader();return x&&(E["X-Firebase-Client"]=x),E})()}}function Sn(y){return(0,F.m9)(y)}class ho{constructor(p){this.auth=p,this.observer=null,this.addObserver=(0,F.ne)(m=>this.observer=m)}get next(){return H(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Gi(y){const p=y.indexOf(":");return p<0?"":y.substr(0,p+1)}function Ls(y){if(!y)return null;const p=Number(y);return isNaN(p)?null:p}class br{constructor(p,m){this.providerId=p,this.signInMethod=m}toJSON(){return _e("not implemented")}_getIdTokenResponse(p){return _e("not implemented")}_linkToIdToken(p,m){return _e("not implemented")}_getReauthenticationResolver(p){return _e("not implemented")}}function Zn(y,p){return $a.apply(this,arguments)}function $a(){return($a=(0,f.Z)(function*(y,p){return dn(y,"POST","/v1/accounts:resetPassword",Nt(y,p))})).apply(this,arguments)}function hn(y,p){return wc.apply(this,arguments)}function wc(){return(wc=(0,f.Z)(function*(y,p){return dn(y,"POST","/v1/accounts:update",p)})).apply(this,arguments)}function Ec(y,p){return fo.apply(this,arguments)}function fo(){return(fo=(0,f.Z)(function*(y,p){return dn(y,"POST","/v1/accounts:update",Nt(y,p))})).apply(this,arguments)}function po(){return(po=(0,f.Z)(function*(y,p){return Wr(y,"POST","/v1/accounts:signInWithPassword",Nt(y,p))})).apply(this,arguments)}function Us(y,p){return Mi.apply(this,arguments)}function Mi(){return(Mi=(0,f.Z)(function*(y,p){return dn(y,"POST","/v1/accounts:sendOobCode",Nt(y,p))})).apply(this,arguments)}function or(y,p){return Ic.apply(this,arguments)}function Ic(){return(Ic=(0,f.Z)(function*(y,p){return Us(y,p)})).apply(this,arguments)}function pr(y,p){return qr.apply(this,arguments)}function qr(){return(qr=(0,f.Z)(function*(y,p){return Us(y,p)})).apply(this,arguments)}function Yu(y,p){return Wa.apply(this,arguments)}function Wa(){return(Wa=(0,f.Z)(function*(y,p){return Us(y,p)})).apply(this,arguments)}function Cc(y,p){return Mr.apply(this,arguments)}function Mr(){return(Mr=(0,f.Z)(function*(y,p){return Us(y,p)})).apply(this,arguments)}function rh(){return(rh=(0,f.Z)(function*(y,p){return Wr(y,"POST","/v1/accounts:signInWithEmailLink",Nt(y,p))})).apply(this,arguments)}function bc(){return(bc=(0,f.Z)(function*(y,p){return Wr(y,"POST","/v1/accounts:signInWithEmailLink",Nt(y,p))})).apply(this,arguments)}class Dc extends br{constructor(p,m,E,x=null){super("password",E),this._email=p,this._password=m,this._tenantId=x}static _fromEmailAndPassword(p,m){return new Dc(p,m,"password")}static _fromEmailAndCode(p,m,E=null){return new Dc(p,m,"emailLink",E)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(p){const m="string"==typeof p?JSON.parse(p):p;if(m?.email&&m?.password){if("password"===m.signInMethod)return this._fromEmailAndPassword(m.email,m.password);if("emailLink"===m.signInMethod)return this._fromEmailAndCode(m.email,m.password,m.tenantId)}return null}_getIdTokenResponse(p){var m=this;return(0,f.Z)(function*(){switch(m.signInMethod){case"password":return function Ga(y,p){return po.apply(this,arguments)}(p,{returnSecureToken:!0,email:m._email,password:m._password});case"emailLink":return function Kf(y,p){return rh.apply(this,arguments)}(p,{email:m._email,oobCode:m._password});default:Re(p,"internal-error")}})()}_linkToIdToken(p,m){var E=this;return(0,f.Z)(function*(){switch(E.signInMethod){case"password":return hn(p,{idToken:m,returnSecureToken:!0,email:E._email,password:E._password});case"emailLink":return function Zf(y,p){return bc.apply(this,arguments)}(p,{idToken:m,email:E._email,oobCode:E._password});default:Re(p,"internal-error")}})()}_getReauthenticationResolver(p){return this._getIdTokenResponse(p)}}function ar(y,p){return ih.apply(this,arguments)}function ih(){return(ih=(0,f.Z)(function*(y,p){return Wr(y,"POST","/v1/accounts:signInWithIdp",Nt(y,p))})).apply(this,arguments)}class as extends br{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(p){const m=new as(p.providerId,p.signInMethod);return p.idToken||p.accessToken?(p.idToken&&(m.idToken=p.idToken),p.accessToken&&(m.accessToken=p.accessToken),p.nonce&&!p.pendingToken&&(m.nonce=p.nonce),p.pendingToken&&(m.pendingToken=p.pendingToken)):p.oauthToken&&p.oauthTokenSecret?(m.accessToken=p.oauthToken,m.secret=p.oauthTokenSecret):Re("argument-error"),m}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(p){const m="string"==typeof p?JSON.parse(p):p,{providerId:E,signInMethod:x}=m,k=(0,fe._T)(m,["providerId","signInMethod"]);if(!E||!x)return null;const q=new as(E,x);return q.idToken=k.idToken||void 0,q.accessToken=k.accessToken||void 0,q.secret=k.secret,q.nonce=k.nonce,q.pendingToken=k.pendingToken||null,q}_getIdTokenResponse(p){return ar(p,this.buildRequest())}_linkToIdToken(p,m){const E=this.buildRequest();return E.idToken=m,ar(p,E)}_getReauthenticationResolver(p){const m=this.buildRequest();return m.autoCreate=!1,ar(p,m)}buildRequest(){const p={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)p.pendingToken=this.pendingToken;else{const m={};this.idToken&&(m.id_token=this.idToken),this.accessToken&&(m.access_token=this.accessToken),this.secret&&(m.oauth_token_secret=this.secret),m.providerId=this.providerId,this.nonce&&!this.pendingToken&&(m.nonce=this.nonce),p.postBody=(0,F.xO)(m)}return p}}function hm(y,p){return sh.apply(this,arguments)}function sh(){return(sh=(0,f.Z)(function*(y,p){return dn(y,"POST","/v1/accounts:sendVerificationCode",Nt(y,p))})).apply(this,arguments)}function Bs(){return(Bs=(0,f.Z)(function*(y,p){return Wr(y,"POST","/v1/accounts:signInWithPhoneNumber",Nt(y,p))})).apply(this,arguments)}function oh(){return(oh=(0,f.Z)(function*(y,p){const m=yield Wr(y,"POST","/v1/accounts:signInWithPhoneNumber",Nt(y,p));if(m.temporaryProof)throw mi(y,"account-exists-with-different-credential",m);return m})).apply(this,arguments)}const pm={USER_NOT_FOUND:"user-not-found"};function ah(){return(ah=(0,f.Z)(function*(y,p){return Wr(y,"POST","/v1/accounts:signInWithPhoneNumber",Nt(y,Object.assign(Object.assign({},p),{operation:"REAUTH"})),pm)})).apply(this,arguments)}class js extends br{constructor(p){super("phone","phone"),this.params=p}static _fromVerification(p,m){return new js({verificationId:p,verificationCode:m})}static _fromTokenResponse(p,m){return new js({phoneNumber:p,temporaryProof:m})}_getIdTokenResponse(p){return function Tc(y,p){return Bs.apply(this,arguments)}(p,this._makeVerificationRequest())}_linkToIdToken(p,m){return function fm(y,p){return oh.apply(this,arguments)}(p,Object.assign({idToken:m},this._makeVerificationRequest()))}_getReauthenticationResolver(p){return function gm(y,p){return ah.apply(this,arguments)}(p,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:p,phoneNumber:m,verificationId:E,verificationCode:x}=this.params;return p&&m?{temporaryProof:p,phoneNumber:m}:{sessionInfo:E,code:x}}toJSON(){const p={providerId:this.providerId};return this.params.phoneNumber&&(p.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(p.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(p.verificationCode=this.params.verificationCode),this.params.verificationId&&(p.verificationId=this.params.verificationId),p}static fromJSON(p){"string"==typeof p&&(p=JSON.parse(p));const{verificationId:m,verificationCode:E,phoneNumber:x,temporaryProof:k}=p;return E||m||x||k?new js({verificationId:m,verificationCode:E,phoneNumber:x,temporaryProof:k}):null}}class Qu{constructor(p){var m,E,x,k,q,le;const Le=(0,F.zd)((0,F.pd)(p)),Qe=null!==(m=Le.apiKey)&&void 0!==m?m:null,wt=null!==(E=Le.oobCode)&&void 0!==E?E:null,vt=function uh(y){switch(y){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(x=Le.mode)&&void 0!==x?x:null);H(Qe&&wt&&vt,"argument-error"),this.apiKey=Qe,this.operation=vt,this.code=wt,this.continueUrl=null!==(k=Le.continueUrl)&&void 0!==k?k:null,this.languageCode=null!==(q=Le.languageCode)&&void 0!==q?q:null,this.tenantId=null!==(le=Le.tenantId)&&void 0!==le?le:null}static parseLink(p){const m=function lh(y){const p=(0,F.zd)((0,F.pd)(y)).link,m=p?(0,F.zd)((0,F.pd)(p)).deep_link_id:null,E=(0,F.zd)((0,F.pd)(y)).deep_link_id;return(E?(0,F.zd)((0,F.pd)(E)).link:null)||E||m||p||y}(p);try{return new Qu(m)}catch{return null}}}let Wi=(()=>{class y{constructor(){this.providerId=y.PROVIDER_ID}static credential(m,E){return Dc._fromEmailAndPassword(m,E)}static credentialWithLink(m,E){const x=Qu.parseLink(E);return H(x,"argument-error"),Dc._fromEmailAndCode(m,x.code,x.tenantId)}}return y.PROVIDER_ID="password",y.EMAIL_PASSWORD_SIGN_IN_METHOD="password",y.EMAIL_LINK_SIGN_IN_METHOD="emailLink",y})();class us{constructor(p){this.providerId=p,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(p){this.defaultLanguageCode=p}setCustomParameters(p){return this.customParameters=p,this}getCustomParameters(){return this.customParameters}}class ls extends us{constructor(){super(...arguments),this.scopes=[]}addScope(p){return this.scopes.includes(p)||this.scopes.push(p),this}getScopes(){return[...this.scopes]}}class go extends ls{static credentialFromJSON(p){const m="string"==typeof p?JSON.parse(p):p;return H("providerId"in m&&"signInMethod"in m,"argument-error"),as._fromParams(m)}credential(p){return this._credential(Object.assign(Object.assign({},p),{nonce:p.rawNonce}))}_credential(p){return H(p.idToken||p.accessToken,"argument-error"),as._fromParams(Object.assign(Object.assign({},p),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(p){return go.oauthCredentialFromTaggedObject(p)}static credentialFromError(p){return go.oauthCredentialFromTaggedObject(p.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:p}){if(!p)return null;const{oauthIdToken:m,oauthAccessToken:E,oauthTokenSecret:x,pendingToken:k,nonce:q,providerId:le}=p;if(!E&&!x&&!m&&!k||!le)return null;try{return new go(le)._credential({idToken:m,accessToken:E,nonce:q,pendingToken:k})}catch{return null}}}let za=(()=>{class y extends ls{constructor(){super("facebook.com")}static credential(m){return as._fromParams({providerId:y.PROVIDER_ID,signInMethod:y.FACEBOOK_SIGN_IN_METHOD,accessToken:m})}static credentialFromResult(m){return y.credentialFromTaggedObject(m)}static credentialFromError(m){return y.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m||!("oauthAccessToken"in m)||!m.oauthAccessToken)return null;try{return y.credential(m.oauthAccessToken)}catch{return null}}}return y.FACEBOOK_SIGN_IN_METHOD="facebook.com",y.PROVIDER_ID="facebook.com",y})(),Ju=(()=>{class y extends ls{constructor(){super("google.com"),this.addScope("profile")}static credential(m,E){return as._fromParams({providerId:y.PROVIDER_ID,signInMethod:y.GOOGLE_SIGN_IN_METHOD,idToken:m,accessToken:E})}static credentialFromResult(m){return y.credentialFromTaggedObject(m)}static credentialFromError(m){return y.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m)return null;const{oauthIdToken:E,oauthAccessToken:x}=m;if(!E&&!x)return null;try{return y.credential(E,x)}catch{return null}}}return y.GOOGLE_SIGN_IN_METHOD="google.com",y.PROVIDER_ID="google.com",y})(),Sc=(()=>{class y extends ls{constructor(){super("github.com")}static credential(m){return as._fromParams({providerId:y.PROVIDER_ID,signInMethod:y.GITHUB_SIGN_IN_METHOD,accessToken:m})}static credentialFromResult(m){return y.credentialFromTaggedObject(m)}static credentialFromError(m){return y.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m||!("oauthAccessToken"in m)||!m.oauthAccessToken)return null;try{return y.credential(m.oauthAccessToken)}catch{return null}}}return y.GITHUB_SIGN_IN_METHOD="github.com",y.PROVIDER_ID="github.com",y})();class qa extends br{constructor(p,m){super(p,p),this.pendingToken=m}_getIdTokenResponse(p){return ar(p,this.buildRequest())}_linkToIdToken(p,m){const E=this.buildRequest();return E.idToken=m,ar(p,E)}_getReauthenticationResolver(p){const m=this.buildRequest();return m.autoCreate=!1,ar(p,m)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(p){const m="string"==typeof p?JSON.parse(p):p,{providerId:E,signInMethod:x,pendingToken:k}=m;return E&&x&&k&&E===x?new qa(E,k):null}static _create(p,m){return new qa(p,m)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class yi extends us{constructor(p){H(p.startsWith("saml."),"argument-error"),super(p)}static credentialFromResult(p){return yi.samlCredentialFromTaggedObject(p)}static credentialFromError(p){return yi.samlCredentialFromTaggedObject(p.customData||{})}static credentialFromJSON(p){const m=qa.fromJSON(p);return H(m,"argument-error"),m}static samlCredentialFromTaggedObject({_tokenResponse:p}){if(!p)return null;const{pendingToken:m,providerId:E}=p;if(!m||!E)return null;try{return qa._create(E,m)}catch{return null}}}let oi=(()=>{class y extends ls{constructor(){super("twitter.com")}static credential(m,E){return as._fromParams({providerId:y.PROVIDER_ID,signInMethod:y.TWITTER_SIGN_IN_METHOD,oauthToken:m,oauthTokenSecret:E})}static credentialFromResult(m){return y.credentialFromTaggedObject(m)}static credentialFromError(m){return y.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m)return null;const{oauthAccessToken:E,oauthTokenSecret:x}=m;if(!E||!x)return null;try{return y.credential(E,x)}catch{return null}}}return y.TWITTER_SIGN_IN_METHOD="twitter.com",y.PROVIDER_ID="twitter.com",y})();function Ko(y,p){return ch.apply(this,arguments)}function ch(){return(ch=(0,f.Z)(function*(y,p){return Wr(y,"POST","/v1/accounts:signUp",Nt(y,p))})).apply(this,arguments)}class Dr{constructor(p){this.user=p.user,this.providerId=p.providerId,this._tokenResponse=p._tokenResponse,this.operationType=p.operationType}static _fromIdTokenResponse(p,m,E,x=!1){return(0,f.Z)(function*(){const k=yield Ft._fromIdTokenResponse(p,E,x),q=Jf(E);return new Dr({user:k,providerId:q,_tokenResponse:E,operationType:m})})()}static _forOperation(p,m,E){return(0,f.Z)(function*(){yield p._updateTokensIfNecessary(E,!0);const x=Jf(E);return new Dr({user:p,providerId:x,_tokenResponse:E,operationType:m})})()}}function Jf(y){return y.providerId?y.providerId:"phoneNumber"in y?"phone":null}function kn(){return(kn=(0,f.Z)(function*(y){var p;const m=Sn(y);if(yield m._initializationPromise,null!==(p=m.currentUser)&&void 0!==p&&p.isAnonymous)return new Dr({user:m.currentUser,providerId:null,operationType:"signIn"});const E=yield Ko(m,{returnSecureToken:!0}),x=yield Dr._fromIdTokenResponse(m,"signIn",E,!0);return yield m._updateCurrentUser(x.user),x})).apply(this,arguments)}class Xu extends F.ZR{constructor(p,m,E,x){var k;super(m.code,m.message),this.operationType=E,this.user=x,Object.setPrototypeOf(this,Xu.prototype),this.customData={appName:p.name,tenantId:null!==(k=p.tenantId)&&void 0!==k?k:void 0,_serverResponse:m.customData._serverResponse,operationType:E}}static _fromErrorAndOperation(p,m,E,x){return new Xu(p,m,E,x)}}function ep(y,p,m,E){return("reauthenticate"===p?m._getReauthenticationResolver(y):m._getIdTokenResponse(y)).catch(k=>{throw"auth/multi-factor-auth-required"===k.code?Xu._fromErrorAndOperation(y,k,p,E):k})}function vi(y){return new Set(y.map(({providerId:p})=>p).filter(p=>!!p))}function el(){return(el=(0,f.Z)(function*(y,p){const m=(0,F.m9)(y);yield Kt(!0,m,p);const{providerUserInfo:E}=yield Rr(m.auth,{idToken:yield m.getIdToken(),deleteProvider:[p]}),x=vi(E||[]);return m.providerData=m.providerData.filter(k=>x.has(k.providerId)),x.has("phone")||(m.phoneNumber=null),yield m.auth._persistUserIfCurrent(m),m})).apply(this,arguments)}function mo(y,p){return ds.apply(this,arguments)}function ds(){return(ds=(0,f.Z)(function*(y,p,m=!1){const E=yield hr(y,p._linkToIdToken(y.auth,yield y.getIdToken()),m);return Dr._forOperation(y,"link",E)})).apply(this,arguments)}function Kt(y,p,m){return tl.apply(this,arguments)}function tl(){return(tl=(0,f.Z)(function*(y,p,m){yield rn(p);const x=!1===y?"provider-already-linked":"no-such-provider";H(vi(p.providerData).has(m)===y,p.auth,x)})).apply(this,arguments)}function _o(y,p){return nl.apply(this,arguments)}function nl(){return(nl=(0,f.Z)(function*(y,p,m=!1){var E;const{auth:x}=y,k="reauthenticate";try{const q=yield hr(y,ep(x,k,p,y),m);H(q.idToken,x,"internal-error");const le=lt(q.idToken);H(le,x,"internal-error");const{sub:Le}=le;return H(y.uid===Le,x,"user-mismatch"),Dr._forOperation(y,k,q)}catch(q){throw"auth/user-not-found"===(null===(E=q)||void 0===E?void 0:E.code)&&Re(x,"user-mismatch"),q}})).apply(this,arguments)}function Ni(y,p){return rl.apply(this,arguments)}function rl(){return(rl=(0,f.Z)(function*(y,p,m=!1){const E="signIn",x=yield ep(y,E,p),k=yield Dr._fromIdTokenResponse(y,E,x);return m||(yield y._updateCurrentUser(k.user)),k})).apply(this,arguments)}function xn(y,p){return xt.apply(this,arguments)}function xt(){return(xt=(0,f.Z)(function*(y,p){return Ni(Sn(y),p)})).apply(this,arguments)}function il(y,p){return tp.apply(this,arguments)}function tp(){return(tp=(0,f.Z)(function*(y,p){const m=(0,F.m9)(y);return yield Kt(!1,m,p.providerId),mo(m,p)})).apply(this,arguments)}function sl(y,p){return ol.apply(this,arguments)}function ol(){return(ol=(0,f.Z)(function*(y,p){return _o((0,F.m9)(y),p)})).apply(this,arguments)}function Ac(y,p){return hs.apply(this,arguments)}function hs(){return(hs=(0,f.Z)(function*(y,p){return Wr(y,"POST","/v1/accounts:signInWithCustomToken",Nt(y,p))})).apply(this,arguments)}function Ka(){return(Ka=(0,f.Z)(function*(y,p){const m=Sn(y),E=yield Ac(m,{token:p,returnSecureToken:!0}),x=yield Dr._fromIdTokenResponse(m,"signIn",E);return yield m._updateCurrentUser(x.user),x})).apply(this,arguments)}class Ae{constructor(p,m){this.factorId=p,this.uid=m.mfaEnrollmentId,this.enrollmentTime=new Date(m.enrolledAt).toUTCString(),this.displayName=m.displayName}static _fromServerResponse(p,m){return"phoneInfo"in m?Wt._fromServerResponse(p,m):Re(p,"internal-error")}}class Wt extends Ae{constructor(p){super("phone",p),this.phoneNumber=p.phoneInfo}static _fromServerResponse(p,m){return new Wt(m)}}function al(y,p,m){var E;H((null===(E=m.url)||void 0===E?void 0:E.length)>0,y,"invalid-continue-uri"),H(typeof m.dynamicLinkDomain>"u"||m.dynamicLinkDomain.length>0,y,"invalid-dynamic-link-domain"),p.continueUrl=m.url,p.dynamicLinkDomain=m.dynamicLinkDomain,p.canHandleCodeInApp=m.handleCodeInApp,m.iOS&&(H(m.iOS.bundleId.length>0,y,"missing-ios-bundle-id"),p.iOSBundleId=m.iOS.bundleId),m.android&&(H(m.android.packageName.length>0,y,"missing-android-pkg-name"),p.androidInstallApp=m.android.installApp,p.androidMinimumVersionCode=m.android.minimumVersion,p.androidPackageName=m.android.packageName)}function Pn(){return(Pn=(0,f.Z)(function*(y,p,m){const E=(0,F.m9)(y),x={requestType:"PASSWORD_RESET",email:p};m&&al(E,x,m),yield pr(E,x)})).apply(this,arguments)}function Zo(){return(Zo=(0,f.Z)(function*(y,p,m){yield Zn((0,F.m9)(y),{oobCode:p,newPassword:m})})).apply(this,arguments)}function Za(){return(Za=(0,f.Z)(function*(y,p){yield Ec((0,F.m9)(y),{oobCode:p})})).apply(this,arguments)}function Ya(y,p){return Rc.apply(this,arguments)}function Rc(){return(Rc=(0,f.Z)(function*(y,p){const m=(0,F.m9)(y),E=yield Zn(m,{oobCode:p}),x=E.requestType;switch(H(x,m,"internal-error"),x){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":H(E.newEmail,m,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":H(E.mfaInfo,m,"internal-error");default:H(E.email,m,"internal-error")}let k=null;return E.mfaInfo&&(k=Ae._fromServerResponse(Sn(m),E.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===E.requestType?E.newEmail:E.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===E.requestType?E.email:E.newEmail)||null,multiFactorInfo:k},operation:x}})).apply(this,arguments)}function dh(){return(dh=(0,f.Z)(function*(y,p){const{data:m}=yield Ya((0,F.m9)(y),p);return m.email})).apply(this,arguments)}function On(){return(On=(0,f.Z)(function*(y,p,m){const E=Sn(y),x=yield Ko(E,{returnSecureToken:!0,email:p,password:m}),k=yield Dr._fromIdTokenResponse(E,"signIn",x);return yield E._updateCurrentUser(k.user),k})).apply(this,arguments)}function yo(){return(yo=(0,f.Z)(function*(y,p,m){const E=(0,F.m9)(y),x={requestType:"EMAIL_SIGNIN",email:p};H(m.handleCodeInApp,E,"argument-error"),m&&al(E,x,m),yield Yu(E,x)})).apply(this,arguments)}function Ja(){return(Ja=(0,f.Z)(function*(y,p,m){const E=(0,F.m9)(y),x=Wi.credentialWithLink(p,m||Pe());return H(x._tenantId===(E.tenantId||null),E,"tenant-id-mismatch"),xn(E,x)})).apply(this,arguments)}function _m(y,p){return kc.apply(this,arguments)}function kc(){return(kc=(0,f.Z)(function*(y,p){return dn(y,"POST","/v1/accounts:createAuthUri",Nt(y,p))})).apply(this,arguments)}function Xa(){return(Xa=(0,f.Z)(function*(y,p){const E={identifier:p,continueUri:dt()?Pe():"http://localhost"},{signinMethods:x}=yield _m((0,F.m9)(y),E);return x||[]})).apply(this,arguments)}function eu(){return(eu=(0,f.Z)(function*(y,p){const m=(0,F.m9)(y),x={requestType:"VERIFY_EMAIL",idToken:yield y.getIdToken()};p&&al(m.auth,x,p);const{email:k}=yield or(m.auth,x);k!==y.email&&(yield y.reload())})).apply(this,arguments)}function dl(){return(dl=(0,f.Z)(function*(y,p,m){const E=(0,F.m9)(y),k={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield y.getIdToken(),newEmail:p};m&&al(E.auth,k,m);const{email:q}=yield Cc(E.auth,k);q!==y.email&&(yield y.reload())})).apply(this,arguments)}function hl(y,p){return Fc.apply(this,arguments)}function Fc(){return(Fc=(0,f.Z)(function*(y,p){return dn(y,"POST","/v1/accounts:update",p)})).apply(this,arguments)}function Vc(){return(Vc=(0,f.Z)(function*(y,{displayName:p,photoURL:m}){if(void 0===p&&void 0===m)return;const E=(0,F.m9)(y),k={idToken:yield E.getIdToken(),displayName:p,photoUrl:m,returnSecureToken:!0},q=yield hr(E,hl(E.auth,k));E.displayName=q.displayName||null,E.photoURL=q.photoUrl||null;const le=E.providerData.find(({providerId:Le})=>"password"===Le);le&&(le.displayName=E.displayName,le.photoURL=E.photoURL),yield E._updateTokensIfNecessary(q)})).apply(this,arguments)}function wo(y,p,m){return fl.apply(this,arguments)}function fl(){return(fl=(0,f.Z)(function*(y,p,m){const{auth:E}=y,k={idToken:yield y.getIdToken(),returnSecureToken:!0};p&&(k.email=p),m&&(k.password=m);const q=yield hr(y,hn(E,k));yield y._updateTokensIfNecessary(q,!0)})).apply(this,arguments)}class ai{constructor(p,m,E={}){this.isNewUser=p,this.providerId=m,this.profile=E}}class bn extends ai{constructor(p,m,E,x){super(p,m,E),this.username=x}}class fh extends ai{constructor(p,m){super(p,"facebook.com",m)}}class Uc extends bn{constructor(p,m){super(p,"github.com",m,"string"==typeof m?.login?m?.login:null)}}class np extends ai{constructor(p,m){super(p,"google.com",m)}}class Bc extends bn{constructor(p,m,E){super(p,"twitter.com",m,E)}}function pl(y){const{user:p,_tokenResponse:m}=y;return p.isAnonymous&&!m?{providerId:null,isNewUser:!1,profile:null}:function ur(y){var p,m;if(!y)return null;const{providerId:E}=y,x=y.rawUserInfo?JSON.parse(y.rawUserInfo):{},k=y.isNewUser||"identitytoolkit#SignupNewUserResponse"===y.kind;if(!E&&y?.idToken){const q=null===(m=null===(p=lt(y.idToken))||void 0===p?void 0:p.firebase)||void 0===m?void 0:m.sign_in_provider;if(q)return new ai(k,"anonymous"!==q&&"custom"!==q?q:null)}if(!E)return null;switch(E){case"facebook.com":return new fh(k,x);case"github.com":return new Uc(k,x);case"google.com":return new np(k,x);case"twitter.com":return new Bc(k,x,y.screenName||null);case"custom":case"anonymous":return new ai(k,null);default:return new ai(k,E,x)}}(m)}class Io{constructor(p,m,E){this.type=p,this.credential=m,this.auth=E}static _fromIdtoken(p,m){return new Io("enroll",p,m)}static _fromMfaPendingCredential(p){return new Io("signin",p)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(p){var m,E;if(p?.multiFactorSession){if(null!==(m=p.multiFactorSession)&&void 0!==m&&m.pendingCredential)return Io._fromMfaPendingCredential(p.multiFactorSession.pendingCredential);if(null!==(E=p.multiFactorSession)&&void 0!==E&&E.idToken)return Io._fromIdtoken(p.multiFactorSession.idToken)}return null}}class ml{constructor(p,m,E){this.session=p,this.hints=m,this.signInResolver=E}static _fromError(p,m){const E=Sn(p),x=m.customData._serverResponse,k=(x.mfaInfo||[]).map(le=>Ae._fromServerResponse(E,le));H(x.mfaPendingCredential,E,"internal-error");const q=Io._fromMfaPendingCredential(x.mfaPendingCredential);return new ml(q,k,function(){var le=(0,f.Z)(function*(Le){const Qe=yield Le._process(E,q);delete x.mfaInfo,delete x.mfaPendingCredential;const wt=Object.assign(Object.assign({},x),{idToken:Qe.idToken,refreshToken:Qe.refreshToken});switch(m.operationType){case"signIn":const vt=yield Dr._fromIdTokenResponse(E,m.operationType,wt);return yield E._updateCurrentUser(vt.user),vt;case"reauthenticate":return H(m.user,E,"internal-error"),Dr._forOperation(m.user,m.operationType,wt);default:Re(E,"internal-error")}});return function(Le){return le.apply(this,arguments)}}())}resolveSignIn(p){var m=this;return(0,f.Z)(function*(){return m.signInResolver(p)})()}}function _l(y,p){return dn(y,"POST","/v2/accounts/mfaEnrollment:start",Nt(y,p))}class rp{constructor(p){this.user=p,this.enrolledFactors=[],p._onReload(m=>{m.mfaInfo&&(this.enrolledFactors=m.mfaInfo.map(E=>Ae._fromServerResponse(p.auth,E)))})}static _fromUser(p){return new rp(p)}getSession(){var p=this;return(0,f.Z)(function*(){return Io._fromIdtoken(yield p.user.getIdToken(),p.user.auth)})()}enroll(p,m){var E=this;return(0,f.Z)(function*(){const x=p,k=yield E.getSession(),q=yield hr(E.user,x._process(E.user.auth,k,m));return yield E.user._updateTokensIfNecessary(q),E.user.reload()})()}unenroll(p){var m=this;return(0,f.Z)(function*(){var E;const x="string"==typeof p?p:p.uid,k=yield m.user.getIdToken(),q=yield hr(m.user,function _h(y,p){return dn(y,"POST","/v2/accounts/mfaEnrollment:withdraw",Nt(y,p))}(m.user.auth,{idToken:k,mfaEnrollmentId:x}));m.enrolledFactors=m.enrolledFactors.filter(({uid:le})=>le!==x),yield m.user._updateTokensIfNecessary(q);try{yield m.user.reload()}catch(le){if("auth/user-token-expired"!==(null===(E=le)||void 0===E?void 0:E.code))throw le}})()}}const Jo=new WeakMap,Co="__sak";class vl{constructor(p,m){this.storageRetriever=p,this.type=m}_isAvailable(){try{return this.storage?(this.storage.setItem(Co,"1"),this.storage.removeItem(Co),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(p,m){return this.storage.setItem(p,JSON.stringify(m)),Promise.resolve()}_get(p){const m=this.storage.getItem(p);return Promise.resolve(m?JSON.parse(m):null)}_remove(p){return this.storage.removeItem(p),Promise.resolve()}get storage(){return this.storageRetriever()}}const nu=(()=>{class y extends vl{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(m,E)=>this.onStorageEvent(m,E),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function tu(){const y=(0,F.z$)();return ht(y)||Bt(y)}()&&function Cn(){try{return!(!window||window===window.top)}catch{return!1}}(),this.fallbackToPolling=co(),this._shouldAllowMigration=!0}forAllChangedKeys(m){for(const E of Object.keys(this.listeners)){const x=this.storage.getItem(E),k=this.localCache[E];x!==k&&m(E,k,x)}}onStorageEvent(m,E=!1){if(!m.key)return void this.forAllChangedKeys((le,Le,Qe)=>{this.notifyListeners(le,Qe)});const x=m.key;if(E?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const le=this.storage.getItem(x);if(m.newValue!==le)null!==m.newValue?this.storage.setItem(x,m.newValue):this.storage.removeItem(x);else if(this.localCache[x]===m.newValue&&!E)return}const k=()=>{const le=this.storage.getItem(x);!E&&this.localCache[x]===le||this.notifyListeners(x,le)},q=this.storage.getItem(x);!function sr(){return(0,F.w1)()&&10===document.documentMode}()||q===m.newValue||m.newValue===m.oldValue?k():setTimeout(k,10)}notifyListeners(m,E){this.localCache[m]=E;const x=this.listeners[m];if(x)for(const k of Array.from(x))k(E&&JSON.parse(E))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((m,E,x)=>{this.onStorageEvent(new StorageEvent("storage",{key:m,oldValue:E,newValue:x}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(m,E){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[m]||(this.listeners[m]=new Set,this.localCache[m]=this.storage.getItem(m)),this.listeners[m].add(E)}_removeListener(m,E){this.listeners[m]&&(this.listeners[m].delete(E),0===this.listeners[m].size&&delete this.listeners[m]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(m,E){var x=()=>super._set,k=this;return(0,f.Z)(function*(){yield x().call(k,m,E),k.localCache[m]=JSON.stringify(E)})()}_get(m){var E=()=>super._get,x=this;return(0,f.Z)(function*(){const k=yield E().call(x,m);return x.localCache[m]=JSON.stringify(k),k})()}_remove(m){var E=()=>super._remove,x=this;return(0,f.Z)(function*(){yield E().call(x,m),delete x.localCache[m]})()}}return y.type="LOCAL",y})(),qi=(()=>{class y extends vl{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(m,E){}_removeListener(m,E){}}return y.type="SESSION",y})();let wh=(()=>{class y{constructor(m){this.eventTarget=m,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(m){const E=this.receivers.find(k=>k.isListeningto(m));if(E)return E;const x=new y(m);return this.receivers.push(x),x}isListeningto(m){return this.eventTarget===m}handleEvent(m){var E=this;return(0,f.Z)(function*(){const x=m,{eventId:k,eventType:q,data:le}=x.data,Le=E.handlersMap[q];if(!Le?.size)return;x.ports[0].postMessage({status:"ack",eventId:k,eventType:q});const Qe=Array.from(Le).map(function(){var vt=(0,f.Z)(function*(yr){return yr(x.origin,le)});return function(yr){return vt.apply(this,arguments)}}()),wt=yield function iu(y){return Promise.all(y.map(function(){var p=(0,f.Z)(function*(m){try{return{fulfilled:!0,value:yield m}}catch(E){return{fulfilled:!1,reason:E}}});return function(m){return p.apply(this,arguments)}}()))}(Qe);x.ports[0].postMessage({status:"done",eventId:k,eventType:q,response:wt})})()}_subscribe(m,E){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[m]||(this.handlersMap[m]=new Set),this.handlersMap[m].add(E)}_unsubscribe(m,E){this.handlersMap[m]&&E&&this.handlersMap[m].delete(E),(!E||0===this.handlersMap[m].size)&&delete this.handlersMap[m],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return y.receivers=[],y})();function su(y="",p=10){let m="";for(let E=0;E<p;E++)m+=Math.floor(10*Math.random());return y+m}class jc{constructor(p){this.target=p,this.handlers=new Set}removeMessageHandler(p){p.messageChannel&&(p.messageChannel.port1.removeEventListener("message",p.onMessage),p.messageChannel.port1.close()),this.handlers.delete(p)}_send(p,m,E=50){var x=this;return(0,f.Z)(function*(){const k=typeof MessageChannel<"u"?new MessageChannel:null;if(!k)throw new Error("connection_unavailable");let q,le;return new Promise((Le,Qe)=>{const wt=su("",20);k.port1.start();const vt=setTimeout(()=>{Qe(new Error("unsupported_event"))},E);le={messageChannel:k,onMessage(yr){const Oi=yr;if(Oi.data.eventId===wt)switch(Oi.data.status){case"ack":clearTimeout(vt),q=setTimeout(()=>{Qe(new Error("timeout"))},3e3);break;case"done":clearTimeout(q),Le(Oi.data.response);break;default:clearTimeout(vt),clearTimeout(q),Qe(new Error("invalid_response"))}}},x.handlers.add(le),k.port1.addEventListener("message",le.onMessage),x.target.postMessage({eventType:p,eventId:wt,data:m},[k.port2])}).finally(()=>{le&&x.removeMessageHandler(le)})})()}}function Hn(){return window}function wl(){return typeof Hn().WorkerGlobalScope<"u"&&"function"==typeof Hn().importScripts}function ou(){return(ou=(0,f.Z)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const Gs="firebaseLocalStorageDb",Ws="firebaseLocalStorage",Hc="fbase_key";class Do{constructor(p){this.request=p}toPromise(){return new Promise((p,m)=>{this.request.addEventListener("success",()=>{p(this.request.result)}),this.request.addEventListener("error",()=>{m(this.request.error)})})}}function au(y,p){return y.transaction([Ws],p?"readwrite":"readonly").objectStore(Ws)}function ea(){const y=indexedDB.open(Gs,1);return new Promise((p,m)=>{y.addEventListener("error",()=>{m(y.error)}),y.addEventListener("upgradeneeded",()=>{const E=y.result;try{E.createObjectStore(Ws,{keyPath:Hc})}catch(x){m(x)}}),y.addEventListener("success",(0,f.Z)(function*(){const E=y.result;E.objectStoreNames.contains(Ws)?p(E):(E.close(),yield function Ih(){const y=indexedDB.deleteDatabase(Gs);return new Do(y).toPromise()}(),p(yield ea()))}))})}function ps(y,p,m){return $c.apply(this,arguments)}function $c(){return($c=(0,f.Z)(function*(y,p,m){const E=au(y,!0).put({[Hc]:p,value:m});return new Do(E).toPromise()})).apply(this,arguments)}function uu(){return(uu=(0,f.Z)(function*(y,p){const m=au(y,!1).get(p),E=yield new Do(m).toPromise();return void 0===E?null:E.value})).apply(this,arguments)}function To(y,p){const m=au(y,!0).delete(p);return new Do(m).toPromise()}const ta=(()=>{class y{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var m=this;return(0,f.Z)(function*(){return m.db||(m.db=yield ea()),m.db})()}_withRetries(m){var E=this;return(0,f.Z)(function*(){let x=0;for(;;)try{const k=yield E._openDb();return yield m(k)}catch(k){if(x++>3)throw k;E.db&&(E.db.close(),E.db=void 0)}})()}initializeServiceWorkerMessaging(){var m=this;return(0,f.Z)(function*(){return wl()?m.initializeReceiver():m.initializeSender()})()}initializeReceiver(){var m=this;return(0,f.Z)(function*(){m.receiver=wh._getInstance(function Il(){return wl()?self:null}()),m.receiver._subscribe("keyChanged",function(){var E=(0,f.Z)(function*(x,k){return{keyProcessed:(yield m._poll()).includes(k.key)}});return function(x,k){return E.apply(this,arguments)}}()),m.receiver._subscribe("ping",function(){var E=(0,f.Z)(function*(x,k){return["keyChanged"]});return function(x,k){return E.apply(this,arguments)}}())})()}initializeSender(){var m=this;return(0,f.Z)(function*(){var E,x;if(m.activeServiceWorker=yield function bo(){return ou.apply(this,arguments)}(),!m.activeServiceWorker)return;m.sender=new jc(m.activeServiceWorker);const k=yield m.sender._send("ping",{},800);!k||(null===(E=k[0])||void 0===E?void 0:E.fulfilled)&&(null===(x=k[0])||void 0===x?void 0:x.value.includes("keyChanged"))&&(m.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(m){var E=this;return(0,f.Z)(function*(){if(E.sender&&E.activeServiceWorker&&function El(){var y;return(null===(y=navigator?.serviceWorker)||void 0===y?void 0:y.controller)||null}()===E.activeServiceWorker)try{yield E.sender._send("keyChanged",{key:m},E.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,f.Z)(function*(){try{if(!indexedDB)return!1;const m=yield ea();return yield ps(m,Co,"1"),yield To(m,Co),!0}catch{}return!1})()}_withPendingWrite(m){var E=this;return(0,f.Z)(function*(){E.pendingWrites++;try{yield m()}finally{E.pendingWrites--}})()}_set(m,E){var x=this;return(0,f.Z)(function*(){return x._withPendingWrite((0,f.Z)(function*(){return yield x._withRetries(k=>ps(k,m,E)),x.localCache[m]=E,x.notifyServiceWorker(m)}))})()}_get(m){var E=this;return(0,f.Z)(function*(){const x=yield E._withRetries(k=>function Cl(y,p){return uu.apply(this,arguments)}(k,m));return E.localCache[m]=x,x})()}_remove(m){var E=this;return(0,f.Z)(function*(){return E._withPendingWrite((0,f.Z)(function*(){return yield E._withRetries(x=>To(x,m)),delete E.localCache[m],E.notifyServiceWorker(m)}))})()}_poll(){var m=this;return(0,f.Z)(function*(){const E=yield m._withRetries(q=>{const le=au(q,!1).getAll();return new Do(le).toPromise()});if(!E)return[];if(0!==m.pendingWrites)return[];const x=[],k=new Set;for(const{fbase_key:q,value:le}of E)k.add(q),JSON.stringify(m.localCache[q])!==JSON.stringify(le)&&(m.notifyListeners(q,le),x.push(q));for(const q of Object.keys(m.localCache))m.localCache[q]&&!k.has(q)&&(m.notifyListeners(q,null),x.push(q));return x})()}notifyListeners(m,E){this.localCache[m]=E;const x=this.listeners[m];if(x)for(const k of Array.from(x))k(E)}startPolling(){var m=this;this.stopPolling(),this.pollTimer=setInterval((0,f.Z)(function*(){return m._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(m,E){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[m]||(this.listeners[m]=new Set,this._get(m)),this.listeners[m].add(E)}_removeListener(m,E){this.listeners[m]&&(this.listeners[m].delete(E),0===this.listeners[m].size&&delete this.listeners[m]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return y.type="LOCAL",y})();function na(y,p){return dn(y,"POST","/v2/accounts/mfaSignIn:start",Nt(y,p))}function zs(){return(zs=(0,f.Z)(function*(y){return(yield dn(y,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function ia(y){return new Promise((p,m)=>{const E=document.createElement("script");E.setAttribute("src",y),E.onload=p,E.onerror=x=>{const k=we("internal-error");k.customData=x,m(k)},E.type="text/javascript",E.charset="UTF-8",function ra(){var y,p;return null!==(p=null===(y=document.getElementsByTagName("head"))||void 0===y?void 0:y[0])&&void 0!==p?p:document}().appendChild(E)})}function Tl(y){return`__${y}${Math.floor(1e6*Math.random())}`}const lu=1e12;class vn{constructor(p){this.auth=p,this.counter=lu,this._widgets=new Map}render(p,m){const E=this.counter;return this._widgets.set(E,new ym(p,this.auth.name,m||{})),this.counter++,E}reset(p){var m;const E=p||lu;null===(m=this._widgets.get(E))||void 0===m||m.delete(),this._widgets.delete(E)}getResponse(p){var m;return(null===(m=this._widgets.get(p||lu))||void 0===m?void 0:m.getResponse())||""}execute(p){var m=this;return(0,f.Z)(function*(){var E;return null===(E=m._widgets.get(p||lu))||void 0===E||E.execute(),""})()}}class ym{constructor(p,m,E){this.params=E,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const x="string"==typeof p?document.getElementById(p):p;H(x,"argument-error",{appName:m}),this.container=x,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function Fy(y){const p=[],m="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let E=0;E<y;E++)p.push(m.charAt(Math.floor(Math.random()*m.length)));return p.join("")}(50);const{callback:p,"expired-callback":m}=this.params;if(p)try{p(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,m)try{m()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const vm=Tl("rcb"),Ly=new cn(3e4,6e4);class ip{constructor(){var p;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(p=Hn().grecaptcha)||void 0===p||!p.render)}load(p,m=""){return H(function dI(y){return y.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(y)}(m),p,"argument-error"),this.shouldResolveImmediately(m)?Promise.resolve(Hn().grecaptcha):new Promise((E,x)=>{const k=Hn().setTimeout(()=>{x(we(p,"network-request-failed"))},Ly.get());Hn()[vm]=()=>{Hn().clearTimeout(k),delete Hn()[vm];const le=Hn().grecaptcha;if(!le)return void x(we(p,"internal-error"));const Le=le.render;le.render=(Qe,wt)=>{const vt=Le(Qe,wt);return this.counter++,vt},this.hostLanguage=m,E(le)},ia(`https://www.google.com/recaptcha/api.js??${(0,F.xO)({onload:vm,render:"explicit",hl:m})}`).catch(()=>{clearTimeout(k),x(we(p,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(p){var m;return!(null===(m=Hn().grecaptcha)||void 0===m||!m.render)&&(p===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class Wc{load(p){return(0,f.Z)(function*(){return new vn(p)})()}clearedOneInstance(){}}const Uy="recaptcha",By={theme:"light",type:"image"};class mr{constructor(p,m=Object.assign({},By),E){this.parameters=m,this.type=Uy,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Sn(E),this.isInvisible="invisible"===this.parameters.size,H(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const x="string"==typeof p?document.getElementById(p):p;H(x,this.auth,"argument-error"),this.container=x,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new Wc:new ip,this.validateStartingState()}verify(){var p=this;return(0,f.Z)(function*(){p.assertNotDestroyed();const m=yield p.render(),E=p.getAssertedRecaptcha();return E.getResponse(m)||new Promise(k=>{const q=le=>{!le||(p.tokenChangeListeners.delete(q),k(le))};p.tokenChangeListeners.add(q),p.isInvisible&&E.execute(m)})})()}render(){try{this.assertNotDestroyed()}catch(p){return Promise.reject(p)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(p=>{throw this.renderPromise=null,p})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(p=>{this.container.removeChild(p)})}validateStartingState(){H(!this.parameters.sitekey,this.auth,"argument-error"),H(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),H(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(p){return m=>{if(this.tokenChangeListeners.forEach(E=>E(m)),"function"==typeof p)p(m);else if("string"==typeof p){const E=Hn()[p];"function"==typeof E&&E(m)}}}assertNotDestroyed(){H(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var p=this;return(0,f.Z)(function*(){if(yield p.init(),!p.widgetId){let m=p.container;if(!p.isInvisible){const E=document.createElement("div");m.appendChild(E),m=E}p.widgetId=p.getAssertedRecaptcha().render(m,p.parameters)}return p.widgetId})()}init(){var p=this;return(0,f.Z)(function*(){H(dt()&&!wl(),p.auth,"internal-error"),yield function ms(){let y=null;return new Promise(p=>{"complete"!==document.readyState?(y=()=>p(),window.addEventListener("load",y)):p()}).catch(p=>{throw y&&window.removeEventListener("load",y),p})}(),p.recaptcha=yield p._recaptchaLoader.load(p.auth,p.auth.languageCode||void 0);const m=yield function ui(y){return zs.apply(this,arguments)}(p.auth);H(m,p.auth,"internal-error"),p.parameters.sitekey=m})()}getAssertedRecaptcha(){return H(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class zt{constructor(p,m){this.verificationId=p,this.onConfirmation=m}confirm(p){const m=js._fromVerification(this.verificationId,p);return this.onConfirmation(m)}}function Nr(){return(Nr=(0,f.Z)(function*(y,p,m){const E=Sn(y),x=yield pn(E,p,(0,F.m9)(m));return new zt(x,k=>xn(E,k))})).apply(this,arguments)}function li(){return(li=(0,f.Z)(function*(y,p,m){const E=(0,F.m9)(y);yield Kt(!1,E,"phone");const x=yield pn(E.auth,p,(0,F.m9)(m));return new zt(x,k=>il(E,k))})).apply(this,arguments)}function An(){return(An=(0,f.Z)(function*(y,p,m){const E=(0,F.m9)(y),x=yield pn(E.auth,p,(0,F.m9)(m));return new zt(x,k=>sl(E,k))})).apply(this,arguments)}function pn(y,p,m){return kr.apply(this,arguments)}function kr(){return(kr=(0,f.Z)(function*(y,p,m){var E;const x=yield m.verify();try{let k;if(H("string"==typeof x,y,"argument-error"),H(m.type===Uy,y,"argument-error"),k="string"==typeof p?{phoneNumber:p}:p,"session"in k){const q=k.session;if("phoneNumber"in k)return H("enroll"===q.type,y,"internal-error"),(yield _l(y,{idToken:q.credential,phoneEnrollmentInfo:{phoneNumber:k.phoneNumber,recaptchaToken:x}})).phoneSessionInfo.sessionInfo;{H("signin"===q.type,y,"internal-error");const le=(null===(E=k.multiFactorHint)||void 0===E?void 0:E.uid)||k.multiFactorUid;return H(le,y,"missing-multi-factor-info"),(yield na(y,{mfaPendingCredential:q.credential,mfaEnrollmentId:le,phoneSignInInfo:{recaptchaToken:x}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:q}=yield hm(y,{phoneNumber:k.phoneNumber,recaptchaToken:x});return q}}finally{m._reset()}})).apply(this,arguments)}function Sl(){return(Sl=(0,f.Z)(function*(y,p){yield mo((0,F.m9)(y),p)})).apply(this,arguments)}let cu=(()=>{class y{constructor(m){this.providerId=y.PROVIDER_ID,this.auth=Sn(m)}verifyPhoneNumber(m,E){return pn(this.auth,m,(0,F.m9)(E))}static credential(m,E){return js._fromVerification(m,E)}static credentialFromResult(m){return y.credentialFromTaggedObject(m)}static credentialFromError(m){return y.credentialFromTaggedObject(m.customData||{})}static credentialFromTaggedObject({_tokenResponse:m}){if(!m)return null;const{phoneNumber:E,temporaryProof:x}=m;return E&&x?js._fromTokenResponse(E,x):null}}return y.PROVIDER_ID="phone",y.PHONE_SIGN_IN_METHOD="phone",y})();function Pr(y,p){return p?ie(p):(H(y._popupRedirectResolver,y,"argument-error"),y._popupRedirectResolver)}class zc extends br{constructor(p){super("custom","custom"),this.params=p}_getIdTokenResponse(p){return ar(p,this._buildIdpRequest())}_linkToIdToken(p,m){return ar(p,this._buildIdpRequest(m))}_getReauthenticationResolver(p){return ar(p,this._buildIdpRequest())}_buildIdpRequest(p){const m={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return p&&(m.idToken=p),m}}function ci(y){return Ni(y.auth,new zc(y),y.bypassAuthState)}function du(y){const{auth:p,user:m}=y;return H(m,p,"internal-error"),_o(m,new zc(y),y.bypassAuthState)}function qs(y){return Al.apply(this,arguments)}function Al(){return(Al=(0,f.Z)(function*(y){const{auth:p,user:m}=y;return H(m,p,"internal-error"),mo(m,new zc(y),y.bypassAuthState)})).apply(this,arguments)}class oa{constructor(p,m,E,x,k=!1){this.auth=p,this.resolver=E,this.user=x,this.bypassAuthState=k,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(m)?m:[m]}execute(){var p=this;return new Promise(function(){var m=(0,f.Z)(function*(E,x){p.pendingPromise={resolve:E,reject:x};try{p.eventManager=yield p.resolver._initialize(p.auth),yield p.onExecution(),p.eventManager.registerConsumer(p)}catch(k){p.reject(k)}});return function(E,x){return m.apply(this,arguments)}}())}onAuthEvent(p){var m=this;return(0,f.Z)(function*(){const{urlResponse:E,sessionId:x,postBody:k,tenantId:q,error:le,type:Le}=p;if(le)return void m.reject(le);const Qe={auth:m.auth,requestUri:E,sessionId:x,tenantId:q||void 0,postBody:k||void 0,user:m.user,bypassAuthState:m.bypassAuthState};try{m.resolve(yield m.getIdpTask(Le)(Qe))}catch(wt){m.reject(wt)}})()}onError(p){this.reject(p)}getIdpTask(p){switch(p){case"signInViaPopup":case"signInViaRedirect":return ci;case"linkViaPopup":case"linkViaRedirect":return qs;case"reauthViaPopup":case"reauthViaRedirect":return du;default:Re(this.auth,"internal-error")}}resolve(p){K(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(p),this.unregisterAndCleanUp()}reject(p){K(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(p),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const aa=new cn(2e3,1e4);function xl(){return(xl=(0,f.Z)(function*(y,p,m){const E=Sn(y);Be(y,p,us);const x=Pr(E,m);return new Ao(E,"signInViaPopup",p,x).executeNotNull()})).apply(this,arguments)}function Ch(){return(Ch=(0,f.Z)(function*(y,p,m){const E=(0,F.m9)(y);Be(E.auth,p,us);const x=Pr(E.auth,m);return new Ao(E.auth,"reauthViaPopup",p,x,E).executeNotNull()})).apply(this,arguments)}function ua(){return(ua=(0,f.Z)(function*(y,p,m){const E=(0,F.m9)(y);Be(E.auth,p,us);const x=Pr(E.auth,m);return new Ao(E.auth,"linkViaPopup",p,x,E).executeNotNull()})).apply(this,arguments)}let Ao=(()=>{class y extends oa{constructor(m,E,x,k,q){super(m,E,k,q),this.provider=x,this.authWindow=null,this.pollId=null,y.currentPopupAction&&y.currentPopupAction.cancel(),y.currentPopupAction=this}executeNotNull(){var m=this;return(0,f.Z)(function*(){const E=yield m.execute();return H(E,m.auth,"internal-error"),E})()}onExecution(){var m=this;return(0,f.Z)(function*(){K(1===m.filter.length,"Popup operations only handle one event");const E=su();m.authWindow=yield m.resolver._openPopup(m.auth,m.provider,m.filter[0],E),m.authWindow.associatedEvent=E,m.resolver._originValidation(m.auth).catch(x=>{m.reject(x)}),m.resolver._isIframeWebStorageSupported(m.auth,x=>{x||m.reject(we(m.auth,"web-storage-unsupported"))}),m.pollUserCancellation()})()}get eventId(){var m;return(null===(m=this.authWindow)||void 0===m?void 0:m.associatedEvent)||null}cancel(){this.reject(we(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,y.currentPopupAction=null}pollUserCancellation(){const m=()=>{var E,x;this.pollId=null!==(x=null===(E=this.authWindow)||void 0===E?void 0:E.window)&&void 0!==x&&x.closed?window.setTimeout(()=>{this.pollId=null,this.reject(we(this.auth,"popup-closed-by-user"))},2e3):window.setTimeout(m,aa.get())};m()}}return y.currentPopupAction=null,y})();const Zr=new Map;class Rn extends oa{constructor(p,m,E=!1){super(p,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],m,void 0,E),this.eventId=null}execute(){var p=()=>super.execute,m=this;return(0,f.Z)(function*(){let E=Zr.get(m.auth._key());if(!E){try{const k=(yield function la(y,p){return Pi.apply(this,arguments)}(m.resolver,m.auth))?yield p().call(m):null;E=()=>Promise.resolve(k)}catch(x){E=()=>Promise.reject(x)}Zr.set(m.auth._key(),E)}return m.bypassAuthState||Zr.set(m.auth._key(),()=>Promise.resolve(null)),E()})()}onAuthEvent(p){var m=()=>super.onAuthEvent,E=this;return(0,f.Z)(function*(){if("signInViaRedirect"===p.type)return m().call(E,p);if("unknown"!==p.type){if(p.eventId){const x=yield E.auth._redirectUserForId(p.eventId);if(x)return E.user=x,m().call(E,p);E.resolve(null)}}else E.resolve(null)})()}onExecution(){return(0,f.Z)(function*(){})()}cleanUp(){}}function Pi(){return(Pi=(0,f.Z)(function*(y,p){const m=qc(p),E=vs(y);if(!(yield E._isAvailable()))return!1;const x="true"===(yield E._get(m));return yield E._remove(m),x})).apply(this,arguments)}function ca(y,p){return Zi.apply(this,arguments)}function Zi(){return(Zi=(0,f.Z)(function*(y,p){return vs(y)._set(qc(p),"true")})).apply(this,arguments)}function ys(y,p){Zr.set(y._key(),p)}function vs(y){return ie(y._redirectPersistence)}function qc(y){return Z("pendingRedirect",y.config.apiKey,y.name)}function b(){return(b=(0,f.Z)(function*(y,p,m){const E=Sn(y);Be(y,p,us);const x=Pr(E,m);return yield ca(x,E),x._openRedirect(E,p,"signInViaRedirect")})).apply(this,arguments)}function U(){return(U=(0,f.Z)(function*(y,p,m){const E=(0,F.m9)(y);Be(E.auth,p,us);const x=Pr(E.auth,m);yield ca(x,E.auth);const k=yield pt(E);return x._openRedirect(E.auth,p,"reauthViaRedirect",k)})).apply(this,arguments)}function xe(){return(xe=(0,f.Z)(function*(y,p,m){const E=(0,F.m9)(y);Be(E.auth,p,us);const x=Pr(E.auth,m);yield Kt(!1,E,p.providerId),yield ca(x,E.auth);const k=yield pt(E);return x._openRedirect(E.auth,p,"linkViaRedirect",k)})).apply(this,arguments)}function _t(){return(_t=(0,f.Z)(function*(y,p){return yield Sn(y)._initializationPromise,It(y,p,!1)})).apply(this,arguments)}function It(y,p){return kt.apply(this,arguments)}function kt(){return(kt=(0,f.Z)(function*(y,p,m=!1){const E=Sn(y),x=Pr(E,p),q=yield new Rn(E,x,m).execute();return q&&!m&&(delete q.user._redirectEventId,yield E._persistUserIfCurrent(q.user),yield E._setRedirectUser(null,p)),q})).apply(this,arguments)}function pt(y){return Dn.apply(this,arguments)}function Dn(){return(Dn=(0,f.Z)(function*(y){const p=su(`${y.uid}:::`);return y._redirectEventId=p,yield y.auth._setRedirectUser(y),yield y.auth._persistUserIfCurrent(y),p})).apply(this,arguments)}class da{constructor(p){this.auth=p,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(p){this.consumers.add(p),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,p)&&(this.sendToConsumer(this.queuedRedirectEvent,p),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(p){this.consumers.delete(p)}onEvent(p){if(this.hasEventBeenHandled(p))return!1;let m=!1;return this.consumers.forEach(E=>{this.isEventForConsumer(p,E)&&(m=!0,this.sendToConsumer(p,E),this.saveEventToCache(p))}),this.hasHandledPotentialRedirect||!function fu(y){switch(y.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return xo(y);default:return!1}}(p)||(this.hasHandledPotentialRedirect=!0,m||(this.queuedRedirectEvent=p,m=!0)),m}sendToConsumer(p,m){var E;if(p.error&&!xo(p)){const x=(null===(E=p.error.code)||void 0===E?void 0:E.split("auth/")[1])||"internal-error";m.onError(we(this.auth,x))}else m.onAuthEvent(p)}isEventForConsumer(p,m){const E=null===m.eventId||!!p.eventId&&p.eventId===m.eventId;return m.filter.includes(p.type)&&E}hasEventBeenHandled(p){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ks(p))}saveEventToCache(p){this.cachedEventUids.add(Ks(p)),this.lastProcessedEventTime=Date.now()}}function Ks(y){return[y.type,y.eventId,y.sessionId,y.tenantId].filter(p=>p).join("-")}function xo({type:y,error:p}){return"unknown"===y&&"auth/no-auth-event"===p?.code}function Ro(y){return Mo.apply(this,arguments)}function Mo(){return(Mo=(0,f.Z)(function*(y,p={}){return dn(y,"GET","/v1/projects",p)})).apply(this,arguments)}const ha=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,fa=/^https?/;function Zs(){return(Zs=(0,f.Z)(function*(y){if(y.config.emulator)return;const{authorizedDomains:p}=yield Ro(y);for(const m of p)try{if(ws(m))return}catch{}Re(y,"unauthorized-domain")})).apply(this,arguments)}function ws(y){const p=Pe(),{protocol:m,hostname:E}=new URL(p);if(y.startsWith("chrome-extension://")){const q=new URL(y);return""===q.hostname&&""===E?"chrome-extension:"===m&&y.replace("chrome-extension://","")===p.replace("chrome-extension://",""):"chrome-extension:"===m&&q.hostname===E}if(!fa.test(m))return!1;if(ha.test(y))return E===y;const x=y.replace(/\./g,"\\.");return new RegExp("^(.+\\."+x+"|"+x+")$","i").test(E)}const jy=new cn(3e4,6e4);function Kc(){const y=Hn().___jsl;if(y?.H)for(const p of Object.keys(y.H))if(y.H[p].r=y.H[p].r||[],y.H[p].L=y.H[p].L||[],y.H[p].r=[...y.H[p].L],y.CP)for(let m=0;m<y.CP.length;m++)y.CP[m]=null}let Zc=null;function Hy(y){return Zc=Zc||function bh(y){return new Promise((p,m)=>{var E,x,k;function q(){Kc(),gapi.load("gapi.iframes",{callback:()=>{p(gapi.iframes.getContext())},ontimeout:()=>{Kc(),m(we(y,"network-request-failed"))},timeout:jy.get()})}if(null!==(x=null===(E=Hn().gapi)||void 0===E?void 0:E.iframes)&&void 0!==x&&x.Iframe)p(gapi.iframes.getContext());else{if(null===(k=Hn().gapi)||void 0===k||!k.load){const le=Tl("iframefcb");return Hn()[le]=()=>{gapi.load?q():m(we(y,"network-request-failed"))},ia(`https://apis.google.com/js/api.js?onload=${le}`).catch(Le=>m(Le))}q()}}).catch(p=>{throw Zc=null,p})}(y),Zc}const Im=new cn(5e3,15e3),Yc={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ap=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Gy(y){const p=y.config;H(p.authDomain,y,"auth-domain-config-required");const m=p.emulator?In(p,"emulator/auth/iframe"):`https://${y.config.authDomain}/__/auth/iframe`,E={apiKey:p.apiKey,appName:y.name,v:ue.SDK_VERSION},x=ap.get(y.config.apiHost);x&&(E.eid=x);const k=y._getFrameworks();return k.length&&(E.fw=k.join(",")),`${m}?${(0,F.xO)(E).slice(1)}`}function pu(){return pu=(0,f.Z)(function*(y){const p=yield Hy(y),m=Hn().gapi;return H(m,y,"internal-error"),p.open({where:document.body,url:Gy(y),messageHandlersFilter:m.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Yc,dontclear:!0},E=>new Promise(function(){var x=(0,f.Z)(function*(k,q){yield E.restyle({setHideOnLeave:!1});const le=we(y,"network-request-failed"),Le=Hn().setTimeout(()=>{q(le)},Im.get());function Qe(){Hn().clearTimeout(Le),k(E)}E.ping(Qe).then(Qe,()=>{q(le)})});return function(k,q){return x.apply(this,arguments)}}()))}),pu.apply(this,arguments)}const lp={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Qc{constructor(p){this.window=p,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function pa(y,p,m,E,x,k){H(y.config.authDomain,y,"auth-domain-config-required"),H(y.config.apiKey,y,"invalid-api-key");const q={apiKey:y.config.apiKey,appName:y.name,authType:m,redirectUrl:E,v:ue.SDK_VERSION,eventId:x};if(p instanceof us){p.setDefaultLanguage(y.languageCode),q.providerId=p.providerId||"",(0,F.xb)(p.getCustomParameters())||(q.customParameters=JSON.stringify(p.getCustomParameters()));for(const[Le,Qe]of Object.entries(k||{}))q[Le]=Qe}if(p instanceof ls){const Le=p.getScopes().filter(Qe=>""!==Qe);Le.length>0&&(q.scopes=Le.join(","))}y.tenantId&&(q.tid=y.tenantId);const le=q;for(const Le of Object.keys(le))void 0===le[Le]&&delete le[Le];return`${function mu({config:y}){return y.emulator?In(y,"emulator/auth/handler"):`https://${y.authDomain}/__/auth/handler`}(y)}?${(0,F.xO)(le).slice(1)}`}const Th="webStorageSupport";class Ei extends class Yn{constructor(p){this.factorId=p}_process(p,m,E){switch(m.type){case"enroll":return this._finalizeEnroll(p,m.credential,E);case"signin":return this._finalizeSignIn(p,m.credential);default:return _e("unexpected MultiFactorSessionType")}}}{constructor(p){super("phone"),this.credential=p}static _fromCredential(p){return new Ei(p)}_finalizeEnroll(p,m,E){return function yl(y,p){return dn(y,"POST","/v2/accounts/mfaEnrollment:finalize",Nt(y,p))}(p,{idToken:m,displayName:E,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(p,m){return function Dl(y,p){return dn(y,"POST","/v2/accounts/mfaSignIn:finalize",Nt(y,p))}(p,{mfaPendingCredential:m,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let ga=(()=>{class y{constructor(){}static assertion(m){return Ei._fromCredential(m)}}return y.FACTOR_ID="phone",y})();var Xc="@firebase/auth",Tm="0.20.11";class hI{constructor(p){this.auth=p,this.internalListeners=new Map}getUid(){var p;return this.assertAuthConfigured(),(null===(p=this.auth.currentUser)||void 0===p?void 0:p.uid)||null}getToken(p){var m=this;return(0,f.Z)(function*(){return m.assertAuthConfigured(),yield m.auth._initializationPromise,m.auth.currentUser?{accessToken:yield m.auth.currentUser.getIdToken(p)}:null})()}addAuthTokenListener(p){if(this.assertAuthConfigured(),this.internalListeners.has(p))return;const m=this.auth.onIdTokenChanged(E=>{var x;p((null===(x=E)||void 0===x?void 0:x.stsTokenManager.accessToken)||null)});this.internalListeners.set(p,m),this.updateProactiveRefresh()}removeAuthTokenListener(p){this.assertAuthConfigured();const m=this.internalListeners.get(p);!m||(this.internalListeners.delete(p),m(),this.updateProactiveRefresh())}assertAuthConfigured(){H(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function yu(){return window}function Mt(){return(Mt=(0,f.Z)(function*(y,p,m){var E;const{BuildInfo:x}=yu();K(p.sessionId,"AuthEvent did not contain a session ID");const k=yield Ah(p.sessionId),q={};return Bt()?q.ibi=x.packageName:qt()?q.apn=x.packageName:Re(y,"operation-not-supported-in-this-environment"),x.displayName&&(q.appDisplayName=x.displayName),q.sessionId=k,pa(y,m,p.type,void 0,null!==(E=p.eventId)&&void 0!==E?E:void 0,q)})).apply(this,arguments)}function Sh(){return(Sh=(0,f.Z)(function*(y){const{BuildInfo:p}=yu(),m={};Bt()?m.iosBundleId=p.packageName:qt()?m.androidPackageName=p.packageName:Re(y,"operation-not-supported-in-this-environment"),yield Ro(y,m)})).apply(this,arguments)}function Am(){return(Am=(0,f.Z)(function*(y,p,m){const{cordova:E}=yu();let x=()=>{};try{yield new Promise((k,q)=>{let le=null;function Le(){var vt;k();const yr=null===(vt=E.plugins.browsertab)||void 0===vt?void 0:vt.close;"function"==typeof yr&&yr(),"function"==typeof m?.close&&m.close()}function Qe(){le||(le=window.setTimeout(()=>{q(we(y,"redirect-cancelled-by-user"))},2e3))}function wt(){"visible"===document?.visibilityState&&Qe()}p.addPassiveListener(Le),document.addEventListener("resume",Qe,!1),qt()&&document.addEventListener("visibilitychange",wt,!1),x=()=>{p.removePassiveListener(Le),document.removeEventListener("resume",Qe,!1),document.removeEventListener("visibilitychange",wt,!1),le&&window.clearTimeout(le)}})}finally{x()}})).apply(this,arguments)}function Ah(y){return kl.apply(this,arguments)}function kl(){return(kl=(0,f.Z)(function*(y){const p=qy(y),m=yield crypto.subtle.digest("SHA-256",p);return Array.from(new Uint8Array(m)).map(x=>x.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}function qy(y){if(K(/[0-9a-zA-Z]+/.test(y),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(y);const p=new ArrayBuffer(y.length),m=new Uint8Array(p);for(let E=0;E<y.length;E++)m[E]=y.charCodeAt(E);return m}(0,F.Pz)("authIdTokenMaxAge"),function di(y){(0,ue._registerComponent)(new ce.wA("auth",(p,{options:m})=>{const E=p.getProvider("app").getImmediate(),x=p.getProvider("heartbeat"),{apiKey:k,authDomain:q}=E.options;return((le,Le)=>{H(k&&!k.includes(":"),"invalid-api-key",{appName:le.name}),H(!q?.includes(":"),"argument-error",{appName:le.name});const Qe={apiKey:k,authDomain:q,clientPlatform:y,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Fs(y)},wt=new Lt(le,Le,Qe);return function Fe(y,p){const m=p?.persistence||[],E=(Array.isArray(m)?m:[m]).map(ie);p?.errorMap&&y._updateErrorMap(p.errorMap),y._initializeWithPersistence(E,p?.popupRedirectResolver)}(wt,m),wt})(E,x)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((p,m,E)=>{p.getProvider("auth-internal").initialize()})),(0,ue._registerComponent)(new ce.wA("auth-internal",p=>{const m=Sn(p.getProvider("auth").getImmediate());return new hI(m)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,ue.registerVersion)(Xc,Tm,function ma(y){switch(y){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(y)),(0,ue.registerVersion)(Xc,Tm,"esm2017")}("Browser");class Tr extends da{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(p=>{this.resolveInialized=p})}addPassiveListener(p){this.passiveListeners.add(p)}removePassiveListener(p){this.passiveListeners.delete(p)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(p){return this.resolveInialized(),this.passiveListeners.forEach(m=>m(p)),super.onEvent(p)}initialized(){var p=this;return(0,f.Z)(function*(){yield p.initPromise})()}}function xm(y){return mp.apply(this,arguments)}function mp(){return(mp=(0,f.Z)(function*(y){const p=yield yp()._get(Pl(y));return p&&(yield yp()._remove(Pl(y))),p})).apply(this,arguments)}function ed(){const y=[],p="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let m=0;m<20;m++){const E=Math.floor(Math.random()*p.length);y.push(p.charAt(E))}return y.join("")}function yp(){return ie(nu)}function Pl(y){return Z("authEvent",y.config.apiKey,y.name)}function td(y){if(!y?.includes("?"))return{};const[p,...m]=y.split("?");return(0,F.zd)(m.join("?"))}function Ol(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:we("no-auth-event")}}function Fl(){var y;return(null===(y=self?.location)||void 0===y?void 0:y.protocol)||null}function Po(y=(0,F.z$)()){return!("file:"!==Fl()&&"ionic:"!==Fl()&&"capacitor:"!==Fl()||!y.toLowerCase().match(/iphone|ipad|ipod|android/))}function Rh(){try{const y=self.localStorage,p=su();if(y)return y.setItem(p,"1"),y.removeItem(p),!function Mm(y=(0,F.z$)()){return function vp(){return(0,F.w1)()&&11===document?.documentMode}()||function nd(y=(0,F.z$)()){return/Edge\/\d+/.test(y)}(y)}()||(0,F.hl)()}catch{return Iu()&&(0,F.hl)()}return!1}function Iu(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function rd(){return(function pI(){return"http:"===Fl()||"https:"===Fl()}()||(0,F.ru)()||Po())&&!function Eu(){return(0,F.b$)()||(0,F.UG)()}()&&Rh()&&!Iu()}function id(){return Po()&&typeof document<"u"}function wp(){return(wp=(0,f.Z)(function*(){return!!id()&&new Promise(y=>{const p=setTimeout(()=>{y(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(p),y(!0)})})})).apply(this,arguments)}const Or={LOCAL:"local",NONE:"none",SESSION:"session"},Ll=H,va="persistence";function sd(y){return Vl.apply(this,arguments)}function Vl(){return(Vl=(0,f.Z)(function*(y){yield y._initializationPromise;const p=Cu(),m=Z(va,y.config.apiKey,y.name);p&&p.setItem(m,y._getPersistence())})).apply(this,arguments)}function Cu(){var y;try{return(null===(y=function Ep(){return typeof window<"u"?window:null}())||void 0===y?void 0:y.sessionStorage)||null}catch{return null}}const Mh=H;class lr{constructor(){this.browserResolver=ie(class dp{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=qi,this._completeRedirectFn=It,this._overrideRedirectResult=ys}_openPopup(p,m,E,x){var k=this;return(0,f.Z)(function*(){var q;K(null===(q=k.eventManagers[p._key()])||void 0===q?void 0:q.manager,"_initialize() not called before _openPopup()");const le=pa(p,m,E,Pe(),x);return function Jc(y,p,m,E=500,x=600){const k=Math.max((window.screen.availHeight-x)/2,0).toString(),q=Math.max((window.screen.availWidth-E)/2,0).toString();let le="";const Le=Object.assign(Object.assign({},lp),{width:E.toString(),height:x.toString(),top:k,left:q}),Qe=(0,F.z$)().toLowerCase();m&&(le=Jt(Qe)?"_blank":m),ze(Qe)&&(p=p||"http://localhost",Le.scrollbars="yes");const wt=Object.entries(Le).reduce((yr,[Oi,Tp])=>`${yr}${Oi}=${Tp},`,"");if(function si(y=(0,F.z$)()){var p;return Bt(y)&&!(null===(p=window.navigator)||void 0===p||!p.standalone)}(Qe)&&"_self"!==le)return function Ml(y,p){const m=document.createElement("a");m.href=y,m.target=p;const E=document.createEvent("MouseEvent");E.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),m.dispatchEvent(E)}(p||"",le),new Qc(null);const vt=window.open(p||"",le,wt);H(vt,y,"popup-blocked");try{vt.focus()}catch{}return new Qc(vt)}(p,le,su())})()}_openRedirect(p,m,E,x){var k=this;return(0,f.Z)(function*(){return yield k._originValidation(p),function ki(y){Hn().location.href=y}(pa(p,m,E,Pe(),x)),new Promise(()=>{})})()}_initialize(p){const m=p._key();if(this.eventManagers[m]){const{manager:x,promise:k}=this.eventManagers[m];return x?Promise.resolve(x):(K(k,"If manager is not set, promise should be"),k)}const E=this.initAndGetManager(p);return this.eventManagers[m]={promise:E},E.catch(()=>{delete this.eventManagers[m]}),E}initAndGetManager(p){var m=this;return(0,f.Z)(function*(){const E=yield function up(y){return pu.apply(this,arguments)}(p),x=new da(p);return E.register("authEvent",k=>(H(k?.authEvent,p,"invalid-auth-event"),{status:x.onEvent(k.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),m.eventManagers[p._key()]={manager:x},m.iframes[p._key()]=E,x})()}_isIframeWebStorageSupported(p,m){this.iframes[p._key()].send(Th,{type:Th},x=>{var k;const q=null===(k=x?.[0])||void 0===k?void 0:k[Th];void 0!==q&&m(!!q),Re(p,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(p){const m=p._key();return this.originValidationPromises[m]||(this.originValidationPromises[m]=function op(y){return Zs.apply(this,arguments)}(p)),this.originValidationPromises[m]}get _shouldInitProactively(){return co()||ht()||Bt()}}),this.cordovaResolver=ie(class ko{constructor(){this._redirectPersistence=qi,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=It,this._overrideRedirectResult=ys}_initialize(p){var m=this;return(0,f.Z)(function*(){const E=p._key();let x=m.eventManagers.get(E);return x||(x=new Tr(p),m.eventManagers.set(E,x),m.attachCallbackListeners(p,x)),x})()}_openPopup(p){Re(p,"operation-not-supported-in-this-environment")}_openRedirect(p,m,E,x){var k=this;return(0,f.Z)(function*(){!function No(y){var p,m,E,x,k,q,le,Le,Qe,wt;const vt=yu();H("function"==typeof(null===(p=vt?.universalLinks)||void 0===p?void 0:p.subscribe),y,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),H(typeof(null===(m=vt?.BuildInfo)||void 0===m?void 0:m.packageName)<"u",y,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),H("function"==typeof(null===(k=null===(x=null===(E=vt?.cordova)||void 0===E?void 0:E.plugins)||void 0===x?void 0:x.browsertab)||void 0===k?void 0:k.openUrl),y,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),H("function"==typeof(null===(Le=null===(le=null===(q=vt?.cordova)||void 0===q?void 0:q.plugins)||void 0===le?void 0:le.browsertab)||void 0===Le?void 0:Le.isAvailable),y,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),H("function"==typeof(null===(wt=null===(Qe=vt?.cordova)||void 0===Qe?void 0:Qe.InAppBrowser)||void 0===wt?void 0:wt.open),y,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(p);const q=yield k._initialize(p);yield q.initialized(),q.resetRedirect(),function Rl(){Zr.clear()}(),yield k._originValidation(p);const le=function ya(y,p,m=null){return{type:p,eventId:m,urlResponse:null,sessionId:ed(),postBody:null,tenantId:y.tenantId,error:we(y,"no-auth-event")}}(p,E,x);yield function gp(y,p){return yp()._set(Pl(y),p)}(p,le);const Le=yield function Es(y,p,m){return Mt.apply(this,arguments)}(p,le,m),Qe=yield function vu(y){const{cordova:p}=yu();return new Promise(m=>{p.plugins.browsertab.isAvailable(E=>{let x=null;E?p.plugins.browsertab.openUrl(y):x=p.InAppBrowser.open(y,function fr(y=(0,F.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(y)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(y)}()?"_blank":"_system","location=yes"),m(x)})})}(Le);return function fI(y,p,m){return Am.apply(this,arguments)}(p,q,Qe)})()}_isIframeWebStorageSupported(p,m){throw new Error("Method not implemented.")}_originValidation(p){const m=p._key();return this.originValidationPromises[m]||(this.originValidationPromises[m]=function Nl(y){return Sh.apply(this,arguments)}(p)),this.originValidationPromises[m]}attachCallbackListeners(p,m){const{universalLinks:E,handleOpenURL:x,BuildInfo:k}=yu(),q=setTimeout((0,f.Z)(function*(){yield xm(p),m.onEvent(Ol())}),500),le=function(){var wt=(0,f.Z)(function*(vt){clearTimeout(q);const yr=yield xm(p);let Oi=null;yr&&vt?.url&&(Oi=function _p(y,p){var m,E;const x=function Qn(y){const p=td(y),m=p.link?decodeURIComponent(p.link):void 0,E=td(m).link,x=p.deep_link_id?decodeURIComponent(p.deep_link_id):void 0;return td(x).link||x||E||m||y}(p);if(x.includes("/__/auth/callback")){const k=td(x),q=k.firebaseError?function Ky(y){try{return JSON.parse(y)}catch{return null}}(decodeURIComponent(k.firebaseError)):null,le=null===(E=null===(m=q?.code)||void 0===m?void 0:m.split("auth/"))||void 0===E?void 0:E[1],Le=le?we(le):null;return Le?{type:y.type,eventId:y.eventId,tenantId:y.tenantId,error:Le,urlResponse:null,sessionId:null,postBody:null}:{type:y.type,eventId:y.eventId,tenantId:y.tenantId,sessionId:y.sessionId,urlResponse:x,postBody:null}}return null}(yr,vt.url)),m.onEvent(Oi||Ol())});return function(yr){return wt.apply(this,arguments)}}();typeof E<"u"&&"function"==typeof E.subscribe&&E.subscribe(null,le);const Le=x,Qe=`${k.packageName.toLowerCase()}://`;yu().handleOpenURL=function(){var wt=(0,f.Z)(function*(vt){if(vt.toLowerCase().startsWith(Qe)&&le({url:vt}),"function"==typeof Le)try{Le(vt)}catch(yr){console.error(yr)}});return function(vt){return wt.apply(this,arguments)}}()}}),this.underlyingResolver=null,this._redirectPersistence=qi,this._completeRedirectFn=It,this._overrideRedirectResult=ys}_initialize(p){var m=this;return(0,f.Z)(function*(){return yield m.selectUnderlyingResolver(),m.assertedUnderlyingResolver._initialize(p)})()}_openPopup(p,m,E,x){var k=this;return(0,f.Z)(function*(){return yield k.selectUnderlyingResolver(),k.assertedUnderlyingResolver._openPopup(p,m,E,x)})()}_openRedirect(p,m,E,x){var k=this;return(0,f.Z)(function*(){return yield k.selectUnderlyingResolver(),k.assertedUnderlyingResolver._openRedirect(p,m,E,x)})()}_isIframeWebStorageSupported(p,m){this.assertedUnderlyingResolver._isIframeWebStorageSupported(p,m)}_originValidation(p){return this.assertedUnderlyingResolver._originValidation(p)}get _shouldInitProactively(){return id()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return Mh(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var p=this;return(0,f.Z)(function*(){if(p.underlyingResolver)return;const m=yield function gI(){return wp.apply(this,arguments)}();p.underlyingResolver=m?p.cordovaResolver:p.browserResolver})()}}function od(y){return y.unwrap()}function Jy(y){return Cp(y)}function Cp(y){const{_tokenResponse:p}=y instanceof F.ZR?y.customData:y;if(!p)return null;if(!(y instanceof F.ZR)&&"temporaryProof"in p&&"phoneNumber"in p)return cu.credentialFromResult(y);const m=p.providerId;if(!m||"password"===m)return null;let E;switch(m){case"google.com":E=Ju;break;case"facebook.com":E=za;break;case"github.com":E=Sc;break;case"twitter.com":E=oi;break;default:const{oauthIdToken:x,oauthAccessToken:k,oauthTokenSecret:q,pendingToken:le,nonce:Le}=p;return k||q||x||le?le?m.startsWith("saml.")?qa._create(m,le):as._fromParams({providerId:m,signInMethod:m,pendingToken:le,idToken:x,accessToken:k}):new go(m).credential({idToken:x,accessToken:k,rawNonce:Le}):null}return y instanceof F.ZR?E.credentialFromError(y):E.credentialFromResult(y)}function Ln(y,p){return p.catch(m=>{throw m instanceof F.ZR&&function Xy(y,p){var m,E;const x=null===(m=p.customData)||void 0===m?void 0:m._tokenResponse;if("auth/multi-factor-auth-required"===(null===(E=p)||void 0===E?void 0:E.code))p.resolver=new km(y,function Fn(y,p){var m;const E=(0,F.m9)(y),x=p;return H(p.customData.operationType,E,"argument-error"),H(null===(m=x.customData._serverResponse)||void 0===m?void 0:m.mfaPendingCredential,E,"argument-error"),ml._fromError(E,x)}(y,p));else if(x){const k=Cp(p),q=p;k&&(q.credential=k,q.tenantId=x.tenantId||void 0,q.email=x.email||void 0,q.phoneNumber=x.phoneNumber||void 0)}}(y,m),m}).then(m=>{const x=m.user;return{operationType:m.operationType,credential:Jy(m),additionalUserInfo:pl(m),user:Ys.getOrCreate(x)}})}function bu(y,p){return wa.apply(this,arguments)}function wa(){return(wa=(0,f.Z)(function*(y,p){const m=yield p;return{verificationId:m.verificationId,confirm:E=>Ln(y,m.confirm(E))}})).apply(this,arguments)}class km{constructor(p,m){this.resolver=m,this.auth=function Nm(y){return y.wrapped()}(p)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(p){return Ln(od(this.auth),this.resolver.resolveSignIn(p))}}class Ys{constructor(p){this._delegate=p,this.multiFactor=function Xo(y){const p=(0,F.m9)(y);return Jo.has(p)||Jo.set(p,rp._fromUser(p)),Jo.get(p)}(p)}static getOrCreate(p){return Ys.USER_MAP.has(p)||Ys.USER_MAP.set(p,new Ys(p)),Ys.USER_MAP.get(p)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(p){return this._delegate.getIdTokenResult(p)}getIdToken(p){return this._delegate.getIdToken(p)}linkAndRetrieveDataWithCredential(p){return this.linkWithCredential(p)}linkWithCredential(p){var m=this;return(0,f.Z)(function*(){return Ln(m.auth,il(m._delegate,p))})()}linkWithPhoneNumber(p,m){var E=this;return(0,f.Z)(function*(){return bu(E.auth,function fn(y,p,m){return li.apply(this,arguments)}(E._delegate,p,m))})()}linkWithPopup(p){var m=this;return(0,f.Z)(function*(){return Ln(m.auth,function sp(y,p,m){return ua.apply(this,arguments)}(m._delegate,p,lr))})()}linkWithRedirect(p){var m=this;return(0,f.Z)(function*(){return yield sd(Sn(m.auth)),function Q(y,p,m){return function oe(y,p,m){return xe.apply(this,arguments)}(y,p,m)}(m._delegate,p,lr)})()}reauthenticateAndRetrieveDataWithCredential(p){return this.reauthenticateWithCredential(p)}reauthenticateWithCredential(p){var m=this;return(0,f.Z)(function*(){return Ln(m.auth,sl(m._delegate,p))})()}reauthenticateWithPhoneNumber(p,m){return bu(this.auth,function _s(y,p,m){return An.apply(this,arguments)}(this._delegate,p,m))}reauthenticateWithPopup(p){return Ln(this.auth,function wm(y,p,m){return Ch.apply(this,arguments)}(this._delegate,p,lr))}reauthenticateWithRedirect(p){var m=this;return(0,f.Z)(function*(){return yield sd(Sn(m.auth)),function T(y,p,m){return function R(y,p,m){return U.apply(this,arguments)}(y,p,m)}(m._delegate,p,lr)})()}sendEmailVerification(p){return function Pc(y,p){return eu.apply(this,arguments)}(this._delegate,p)}unlink(p){var m=this;return(0,f.Z)(function*(){return yield function Kr(y,p){return el.apply(this,arguments)}(m._delegate,p),m})()}updateEmail(p){return function hh(y,p){return wo((0,F.m9)(y),p,null)}(this._delegate,p)}updatePassword(p){return function vo(y,p){return wo((0,F.m9)(y),null,p)}(this._delegate,p)}updatePhoneNumber(p){return function ft(y,p){return Sl.apply(this,arguments)}(this._delegate,p)}updateProfile(p){return function Lc(y,p){return Vc.apply(this,arguments)}(this._delegate,p)}verifyBeforeUpdateEmail(p,m){return function Oc(y,p,m){return dl.apply(this,arguments)}(this._delegate,p,m)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Ys.USER_MAP=new WeakMap;const Ea=H;let Du=(()=>{class y{constructor(m,E){if(this.app=m,E.isInitialized())return this._delegate=E.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:x}=m.options;Ea(x,"invalid-api-key",{appName:m.name}),Ea(x,"invalid-api-key",{appName:m.name});const k=typeof window<"u"?lr:void 0;this._delegate=E.initialize({options:{persistence:ev(x,m.name),popupRedirectResolver:k}}),this._delegate._updateErrorMap(Ce),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Ys.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(m){this._delegate.languageCode=m}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(m){this._delegate.tenantId=m}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(m,E){!function Zu(y,p,m){const E=Sn(y);H(E._canInitEmulator,E,"emulator-config-failed"),H(/^https?:\/\//.test(p),E,"invalid-emulator-scheme");const x=!!m?.disableWarnings,k=Gi(p),{host:q,port:le}=function Kn(y){const p=Gi(y),m=/(\/\/)?([^?#/]+)/.exec(y.substr(p.length));if(!m)return{host:"",port:null};const E=m[2].split("@").pop()||"",x=/^(\[[^\]]+\])(:|$)/.exec(E);if(x){const k=x[1];return{host:k,port:Ls(E.substr(k.length+1))}}{const[k,q]=E.split(":");return{host:k,port:Ls(q)}}}(p);E.config.emulator={url:`${k}//${q}${null===le?"":`:${le}`}/`},E.settings.appVerificationDisabledForTesting=!0,E.emulatorConfig=Object.freeze({host:q,port:le,protocol:k.replace(":",""),options:Object.freeze({disableWarnings:x})}),x||function Vs(){function y(){const p=document.createElement("p"),m=p.style;p.innerText="Running in emulator mode. Do not use with production credentials.",m.position="fixed",m.width="100%",m.backgroundColor="#ffffff",m.border=".1em solid #000000",m.color="#b50000",m.bottom="0px",m.left="0px",m.margin="0px",m.zIndex="10000",m.textAlign="center",p.classList.add("firebase-emulator-warning"),document.body.appendChild(p)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",y):y())}()}(this._delegate,m,E)}applyActionCode(m){return function wi(y,p){return Za.apply(this,arguments)}(this._delegate,m)}checkActionCode(m){return Ya(this._delegate,m)}confirmPasswordReset(m,E){return function ll(y,p,m){return Zo.apply(this,arguments)}(this._delegate,m,E)}createUserWithEmailAndPassword(m,E){var x=this;return(0,f.Z)(function*(){return Ln(x._delegate,function Qa(y,p,m){return On.apply(this,arguments)}(x._delegate,m,E))})()}fetchProvidersForEmail(m){return this.fetchSignInMethodsForEmail(m)}fetchSignInMethodsForEmail(m){return function cl(y,p){return Xa.apply(this,arguments)}(this._delegate,m)}isSignInWithEmailLink(m){return function fs(y,p){return"EMAIL_SIGNIN"===Qu.parseLink(p)?.operation}(0,m)}getRedirectResult(){var m=this;return(0,f.Z)(function*(){Ea(rd(),m._delegate,"operation-not-supported-in-this-environment");const E=yield function He(y,p){return _t.apply(this,arguments)}(m._delegate,lr);return E?Ln(m._delegate,Promise.resolve(E)):{credential:null,user:null}})()}addFrameworkForLogging(m){!function Zy(y,p){Sn(y)._logFramework(p)}(this._delegate,m)}onAuthStateChanged(m,E,x){const{next:k,error:q,complete:le}=bp(m,E,x);return this._delegate.onAuthStateChanged(k,q,le)}onIdTokenChanged(m,E,x){const{next:k,error:q,complete:le}=bp(m,E,x);return this._delegate.onIdTokenChanged(k,q,le)}sendSignInLinkToEmail(m,E){return function Nc(y,p,m){return yo.apply(this,arguments)}(this._delegate,m,E)}sendPasswordResetEmail(m,E){return function ul(y,p,m){return Pn.apply(this,arguments)}(this._delegate,m,E||void 0)}setPersistence(m){var E=this;return(0,f.Z)(function*(){let x;switch(function Qy(y,p){Ll(Object.values(Or).includes(p),y,"invalid-persistence-type"),(0,F.b$)()?Ll(p!==Or.SESSION,y,"unsupported-persistence-type"):(0,F.UG)()?Ll(p===Or.NONE,y,"unsupported-persistence-type"):Iu()?Ll(p===Or.NONE||p===Or.LOCAL&&(0,F.hl)(),y,"unsupported-persistence-type"):Ll(p===Or.NONE||Rh(),y,"unsupported-persistence-type")}(E._delegate,m),m){case Or.SESSION:x=qi;break;case Or.LOCAL:x=(yield ie(ta)._isAvailable())?ta:nu;break;case Or.NONE:x=B;break;default:return Re("argument-error",{appName:E._delegate.name})}return E._delegate.setPersistence(x)})()}signInAndRetrieveDataWithCredential(m){return this.signInWithCredential(m)}signInAnonymously(){return Ln(this._delegate,function Xf(y){return kn.apply(this,arguments)}(this._delegate))}signInWithCredential(m){return Ln(this._delegate,xn(this._delegate,m))}signInWithCustomToken(m){return Ln(this._delegate,function xc(y,p){return Ka.apply(this,arguments)}(this._delegate,m))}signInWithEmailAndPassword(m,E){return Ln(this._delegate,function zi(y,p,m){return xn((0,F.m9)(y),Wi.credential(p,m))}(this._delegate,m,E))}signInWithEmailLink(m,E){return Ln(this._delegate,function mm(y,p,m){return Ja.apply(this,arguments)}(this._delegate,m,E))}signInWithPhoneNumber(m,E){return bu(this._delegate,function it(y,p,m){return Nr.apply(this,arguments)}(this._delegate,m,E))}signInWithPopup(m){var E=this;return(0,f.Z)(function*(){return Ea(rd(),E._delegate,"operation-not-supported-in-this-environment"),Ln(E._delegate,function Ki(y,p,m){return xl.apply(this,arguments)}(E._delegate,m,lr))})()}signInWithRedirect(m){var E=this;return(0,f.Z)(function*(){return Ea(rd(),E._delegate,"operation-not-supported-in-this-environment"),yield sd(E._delegate),function $n(y,p,m){return function Em(y,p,m){return b.apply(this,arguments)}(y,p,m)}(E._delegate,m,lr)})()}updateCurrentUser(m){return this._delegate.updateCurrentUser(m)}verifyPasswordResetCode(m){return function Mc(y,p){return dh.apply(this,arguments)}(this._delegate,m)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return y.Persistence=Or,y})();function bp(y,p,m){let E=y;"function"!=typeof y&&({next:E,error:p,complete:m}=y);const x=E;return{next:q=>x(q&&Ys.getOrCreate(q)),error:p,complete:m}}function ev(y,p){const m=function Ip(y,p){const m=Cu();if(!m)return[];const E=Z(va,y,p);switch(m.getItem(E)){case Or.NONE:return[B];case Or.LOCAL:return[ta,qi];case Or.SESSION:return[qi];default:return[]}}(y,p);if(typeof self<"u"&&!m.includes(ta)&&m.push(ta),typeof window<"u")for(const E of[nu,qi])m.includes(E)||m.push(E);return m.includes(B)||m.push(B),m}class ad{constructor(){this.providerId="phone",this._delegate=new cu(od(te.Z.auth()))}static credential(p,m){return cu.credential(p,m)}verifyPhoneNumber(p,m){return this._delegate.verifyPhoneNumber(p,m)}unwrap(){return this._delegate}}ad.PHONE_SIGN_IN_METHOD=cu.PHONE_SIGN_IN_METHOD,ad.PROVIDER_ID=cu.PROVIDER_ID;const mI=H;class Dp{constructor(p,m,E=te.Z.app()){var x;mI(null===(x=E.options)||void 0===x?void 0:x.apiKey,"invalid-api-key",{appName:E.name}),this._delegate=new mr(p,m,E.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function tv(y){y.INTERNAL.registerComponent(new ce.wA("auth-compat",p=>{const m=p.getProvider("app-compat").getImmediate(),E=p.getProvider("auth");return new Du(m,E)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},EmailAuthProvider:Wi,FacebookAuthProvider:za,GithubAuthProvider:Sc,GoogleAuthProvider:Ju,OAuthProvider:go,SAMLAuthProvider:yi,PhoneAuthProvider:ad,PhoneMultiFactorGenerator:ga,RecaptchaVerifier:Dp,TwitterAuthProvider:oi,Auth:Du,AuthCredential:br,Error:F.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),y.registerVersion("@firebase/auth-compat","0.2.24")}(te.Z)},9751:(ct,Te,V)=>{V.d(Te,{y:()=>pe});var f=V(930),te=V(727),F=V(8822),ue=V(9635),se=V(2416),fe=V(576),ce=V(2806);let pe=(()=>{class Y{constructor(Me){Me&&(this._subscribe=Me)}lift(Me){const Ce=new Y;return Ce.source=this,Ce.operator=Me,Ce}subscribe(Me,Ce,rt){const ye=function G(Y){return Y&&Y instanceof f.Lv||function $(Y){return Y&&(0,fe.m)(Y.next)&&(0,fe.m)(Y.error)&&(0,fe.m)(Y.complete)}(Y)&&(0,te.Nn)(Y)}(Me)?Me:new f.Hp(Me,Ce,rt);return(0,ce.x)(()=>{const{operator:me,source:Je}=this;ye.add(me?me.call(ye,Je):Je?this._subscribe(ye):this._trySubscribe(ye))}),ye}_trySubscribe(Me){try{return this._subscribe(Me)}catch(Ce){Me.error(Ce)}}forEach(Me,Ce){return new(Ce=ge(Ce))((rt,ye)=>{const me=new f.Hp({next:Je=>{try{Me(Je)}catch(ut){ye(ut),me.unsubscribe()}},error:ye,complete:rt});this.subscribe(me)})}_subscribe(Me){var Ce;return null===(Ce=this.source)||void 0===Ce?void 0:Ce.subscribe(Me)}[F.L](){return this}pipe(...Me){return(0,ue.U)(Me)(this)}toPromise(Me){return new(Me=ge(Me))((Ce,rt)=>{let ye;this.subscribe(me=>ye=me,me=>rt(me),()=>Ce(ye))})}}return Y.create=Ve=>new Y(Ve),Y})();function ge(Y){var Ve;return null!==(Ve=Y??se.v.Promise)&&void 0!==Ve?Ve:Promise}},7579:(ct,Te,V)=>{V.d(Te,{x:()=>ce});var f=V(9751),te=V(727);const ue=(0,V(3888).d)(ge=>function(){ge(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var se=V(8737),fe=V(2806);let ce=(()=>{class ge extends f.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(G){const Y=new pe(this,this);return Y.operator=G,Y}_throwIfClosed(){if(this.closed)throw new ue}next(G){(0,fe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const Y of this.currentObservers)Y.next(G)}})}error(G){(0,fe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=G;const{observers:Y}=this;for(;Y.length;)Y.shift().error(G)}})}complete(){(0,fe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:G}=this;for(;G.length;)G.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var G;return(null===(G=this.observers)||void 0===G?void 0:G.length)>0}_trySubscribe(G){return this._throwIfClosed(),super._trySubscribe(G)}_subscribe(G){return this._throwIfClosed(),this._checkFinalizedStatuses(G),this._innerSubscribe(G)}_innerSubscribe(G){const{hasError:Y,isStopped:Ve,observers:Me}=this;return Y||Ve?te.Lc:(this.currentObservers=null,Me.push(G),new te.w0(()=>{this.currentObservers=null,(0,se.P)(Me,G)}))}_checkFinalizedStatuses(G){const{hasError:Y,thrownError:Ve,isStopped:Me}=this;Y?G.error(Ve):Me&&G.complete()}asObservable(){const G=new f.y;return G.source=this,G}}return ge.create=($,G)=>new pe($,G),ge})();class pe extends ce{constructor($,G){super(),this.destination=$,this.source=G}next($){var G,Y;null===(Y=null===(G=this.destination)||void 0===G?void 0:G.next)||void 0===Y||Y.call(G,$)}error($){var G,Y;null===(Y=null===(G=this.destination)||void 0===G?void 0:G.error)||void 0===Y||Y.call(G,$)}complete(){var $,G;null===(G=null===($=this.destination)||void 0===$?void 0:$.complete)||void 0===G||G.call($)}_subscribe($){var G,Y;return null!==(Y=null===(G=this.source)||void 0===G?void 0:G.subscribe($))&&void 0!==Y?Y:te.Lc}}},930:(ct,Te,V)=>{V.d(Te,{Hp:()=>rt,Lv:()=>Y});var f=V(576),te=V(727),F=V(2416),ue=V(7849),se=V(5032);const fe=ge("C",void 0,void 0);function ge(Re,we,be){return{kind:Re,value:we,error:be}}var $=V(3410),G=V(2806);class Y extends te.w0{constructor(we){super(),this.isStopped=!1,we?(this.destination=we,(0,te.Nn)(we)&&we.add(this)):this.destination=ut}static create(we,be,Be){return new rt(we,be,Be)}next(we){this.isStopped?Je(function pe(Re){return ge("N",Re,void 0)}(we),this):this._next(we)}error(we){this.isStopped?Je(function ce(Re){return ge("E",void 0,Re)}(we),this):(this.isStopped=!0,this._error(we))}complete(){this.isStopped?Je(fe,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(we){this.destination.next(we)}_error(we){try{this.destination.error(we)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Ve=Function.prototype.bind;function Me(Re,we){return Ve.call(Re,we)}class Ce{constructor(we){this.partialObserver=we}next(we){const{partialObserver:be}=this;if(be.next)try{be.next(we)}catch(Be){ye(Be)}}error(we){const{partialObserver:be}=this;if(be.error)try{be.error(we)}catch(Be){ye(Be)}else ye(we)}complete(){const{partialObserver:we}=this;if(we.complete)try{we.complete()}catch(be){ye(be)}}}class rt extends Y{constructor(we,be,Be){let je;if(super(),(0,f.m)(we)||!we)je={next:we??void 0,error:be??void 0,complete:Be??void 0};else{let H;this&&F.v.useDeprecatedNextContext?(H=Object.create(we),H.unsubscribe=()=>this.unsubscribe(),je={next:we.next&&Me(we.next,H),error:we.error&&Me(we.error,H),complete:we.complete&&Me(we.complete,H)}):je=we}this.destination=new Ce(je)}}function ye(Re){F.v.useDeprecatedSynchronousErrorHandling?(0,G.O)(Re):(0,ue.h)(Re)}function Je(Re,we){const{onStoppedNotification:be}=F.v;be&&$.z.setTimeout(()=>be(Re,we))}const ut={closed:!0,next:se.Z,error:function me(Re){throw Re},complete:se.Z}},727:(ct,Te,V)=>{V.d(Te,{Lc:()=>fe,w0:()=>se,Nn:()=>ce});var f=V(576);const F=(0,V(3888).d)(ge=>function(G){ge(this),this.message=G?`${G.length} errors occurred during unsubscription:\n${G.map((Y,Ve)=>`${Ve+1}) ${Y.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=G});var ue=V(8737);class se{constructor($){this.initialTeardown=$,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let $;if(!this.closed){this.closed=!0;const{_parentage:G}=this;if(G)if(this._parentage=null,Array.isArray(G))for(const Me of G)Me.remove(this);else G.remove(this);const{initialTeardown:Y}=this;if((0,f.m)(Y))try{Y()}catch(Me){$=Me instanceof F?Me.errors:[Me]}const{_finalizers:Ve}=this;if(Ve){this._finalizers=null;for(const Me of Ve)try{pe(Me)}catch(Ce){$=$??[],Ce instanceof F?$=[...$,...Ce.errors]:$.push(Ce)}}if($)throw new F($)}}add($){var G;if($&&$!==this)if(this.closed)pe($);else{if($ instanceof se){if($.closed||$._hasParent(this))return;$._addParent(this)}(this._finalizers=null!==(G=this._finalizers)&&void 0!==G?G:[]).push($)}}_hasParent($){const{_parentage:G}=this;return G===$||Array.isArray(G)&&G.includes($)}_addParent($){const{_parentage:G}=this;this._parentage=Array.isArray(G)?(G.push($),G):G?[G,$]:$}_removeParent($){const{_parentage:G}=this;G===$?this._parentage=null:Array.isArray(G)&&(0,ue.P)(G,$)}remove($){const{_finalizers:G}=this;G&&(0,ue.P)(G,$),$ instanceof se&&$._removeParent(this)}}se.EMPTY=(()=>{const ge=new se;return ge.closed=!0,ge})();const fe=se.EMPTY;function ce(ge){return ge instanceof se||ge&&"closed"in ge&&(0,f.m)(ge.remove)&&(0,f.m)(ge.add)&&(0,f.m)(ge.unsubscribe)}function pe(ge){(0,f.m)(ge)?ge():ge.unsubscribe()}},2416:(ct,Te,V)=>{V.d(Te,{v:()=>f});const f={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},515:(ct,Te,V)=>{V.d(Te,{E:()=>te});const te=new(V(9751).y)(se=>se.complete())},8996:(ct,Te,V)=>{V.d(Te,{D:()=>we});var f=V(8421),te=V(5363),F=V(9468),fe=V(9751),pe=V(2202),ge=V(576),$=V(9672);function Y(be,Be){if(!be)throw new Error("Iterable cannot be null");return new fe.y(je=>{(0,$.f)(je,Be,()=>{const H=be[Symbol.asyncIterator]();(0,$.f)(je,Be,()=>{H.next().then(_e=>{_e.done?je.complete():je.next(_e.value)})},0,!0)})})}var Ve=V(3670),Me=V(8239),Ce=V(1144),rt=V(6495),ye=V(2206),me=V(4532),Je=V(3260);function we(be,Be){return Be?function Re(be,Be){if(null!=be){if((0,Ve.c)(be))return function ue(be,Be){return(0,f.Xf)(be).pipe((0,F.R)(Be),(0,te.Q)(Be))}(be,Be);if((0,Ce.z)(be))return function ce(be,Be){return new fe.y(je=>{let H=0;return Be.schedule(function(){H===be.length?je.complete():(je.next(be[H++]),je.closed||this.schedule())})})}(be,Be);if((0,Me.t)(be))return function se(be,Be){return(0,f.Xf)(be).pipe((0,F.R)(Be),(0,te.Q)(Be))}(be,Be);if((0,ye.D)(be))return Y(be,Be);if((0,rt.T)(be))return function G(be,Be){return new fe.y(je=>{let H;return(0,$.f)(je,Be,()=>{H=be[pe.h](),(0,$.f)(je,Be,()=>{let _e,K;try{({value:_e,done:K}=H.next())}catch(X){return void je.error(X)}K?je.complete():je.next(_e)},0,!0)}),()=>(0,ge.m)(H?.return)&&H.return()})}(be,Be);if((0,Je.L)(be))return function ut(be,Be){return Y((0,Je.Q)(be),Be)}(be,Be)}throw(0,me.z)(be)}(be,Be):(0,f.Xf)(be)}},8421:(ct,Te,V)=>{V.d(Te,{Xf:()=>Ve});var f=V(655),te=V(1144),F=V(8239),ue=V(9751),se=V(3670),fe=V(2206),ce=V(4532),pe=V(6495),ge=V(3260),$=V(576),G=V(7849),Y=V(8822);function Ve(Re){if(Re instanceof ue.y)return Re;if(null!=Re){if((0,se.c)(Re))return function Me(Re){return new ue.y(we=>{const be=Re[Y.L]();if((0,$.m)(be.subscribe))return be.subscribe(we);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Re);if((0,te.z)(Re))return function Ce(Re){return new ue.y(we=>{for(let be=0;be<Re.length&&!we.closed;be++)we.next(Re[be]);we.complete()})}(Re);if((0,F.t)(Re))return function rt(Re){return new ue.y(we=>{Re.then(be=>{we.closed||(we.next(be),we.complete())},be=>we.error(be)).then(null,G.h)})}(Re);if((0,fe.D)(Re))return me(Re);if((0,pe.T)(Re))return function ye(Re){return new ue.y(we=>{for(const be of Re)if(we.next(be),we.closed)return;we.complete()})}(Re);if((0,ge.L)(Re))return function Je(Re){return me((0,ge.Q)(Re))}(Re)}throw(0,ce.z)(Re)}function me(Re){return new ue.y(we=>{(function ut(Re,we){var be,Be,je,H;return(0,f.mG)(this,void 0,void 0,function*(){try{for(be=(0,f.KL)(Re);!(Be=yield be.next()).done;)if(we.next(Be.value),we.closed)return}catch(_e){je={error:_e}}finally{try{Be&&!Be.done&&(H=be.return)&&(yield H.call(be))}finally{if(je)throw je.error}}we.complete()})})(Re,we).catch(be=>we.error(be))})}},6451:(ct,Te,V)=>{V.d(Te,{T:()=>fe});var f=V(8189),te=V(8421),F=V(515),ue=V(7669),se=V(8996);function fe(...ce){const pe=(0,ue.yG)(ce),ge=(0,ue._6)(ce,1/0),$=ce;return $.length?1===$.length?(0,te.Xf)($[0]):(0,f.J)(ge)((0,se.D)($,pe)):F.E}},5403:(ct,Te,V)=>{V.d(Te,{x:()=>te});var f=V(930);function te(ue,se,fe,ce,pe){return new F(ue,se,fe,ce,pe)}class F extends f.Lv{constructor(se,fe,ce,pe,ge,$){super(se),this.onFinalize=ge,this.shouldUnsubscribe=$,this._next=fe?function(G){try{fe(G)}catch(Y){se.error(Y)}}:super._next,this._error=pe?function(G){try{pe(G)}catch(Y){se.error(Y)}finally{this.unsubscribe()}}:super._error,this._complete=ce?function(){try{ce()}catch(G){se.error(G)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var se;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:fe}=this;super.unsubscribe(),!fe&&(null===(se=this.onFinalize)||void 0===se||se.call(this))}}}},4004:(ct,Te,V)=>{V.d(Te,{U:()=>F});var f=V(4482),te=V(5403);function F(ue,se){return(0,f.e)((fe,ce)=>{let pe=0;fe.subscribe((0,te.x)(ce,ge=>{ce.next(ue.call(se,ge,pe++))}))})}},8189:(ct,Te,V)=>{V.d(Te,{J:()=>F});var f=V(5577),te=V(4671);function F(ue=1/0){return(0,f.z)(te.y,ue)}},5577:(ct,Te,V)=>{V.d(Te,{z:()=>pe});var f=V(4004),te=V(8421),F=V(4482),ue=V(9672),se=V(5403),ce=V(576);function pe(ge,$,G=1/0){return(0,ce.m)($)?pe((Y,Ve)=>(0,f.U)((Me,Ce)=>$(Y,Me,Ve,Ce))((0,te.Xf)(ge(Y,Ve))),G):("number"==typeof $&&(G=$),(0,F.e)((Y,Ve)=>function fe(ge,$,G,Y,Ve,Me,Ce,rt){const ye=[];let me=0,Je=0,ut=!1;const Re=()=>{ut&&!ye.length&&!me&&$.complete()},we=Be=>me<Y?be(Be):ye.push(Be),be=Be=>{Me&&$.next(Be),me++;let je=!1;(0,te.Xf)(G(Be,Je++)).subscribe((0,se.x)($,H=>{Ve?.(H),Me?we(H):$.next(H)},()=>{je=!0},void 0,()=>{if(je)try{for(me--;ye.length&&me<Y;){const H=ye.shift();Ce?(0,ue.f)($,Ce,()=>be(H)):be(H)}Re()}catch(H){$.error(H)}}))};return ge.subscribe((0,se.x)($,we,()=>{ut=!0,Re()})),()=>{rt?.()}}(Y,Ve,ge,G)))}},5363:(ct,Te,V)=>{V.d(Te,{Q:()=>ue});var f=V(9672),te=V(4482),F=V(5403);function ue(se,fe=0){return(0,te.e)((ce,pe)=>{ce.subscribe((0,F.x)(pe,ge=>(0,f.f)(pe,se,()=>pe.next(ge),fe),()=>(0,f.f)(pe,se,()=>pe.complete(),fe),ge=>(0,f.f)(pe,se,()=>pe.error(ge),fe)))})}},3099:(ct,Te,V)=>{V.d(Te,{B:()=>se});var f=V(8421),te=V(7579),F=V(930),ue=V(4482);function se(ce={}){const{connector:pe=(()=>new te.x),resetOnError:ge=!0,resetOnComplete:$=!0,resetOnRefCountZero:G=!0}=ce;return Y=>{let Ve,Me,Ce,rt=0,ye=!1,me=!1;const Je=()=>{Me?.unsubscribe(),Me=void 0},ut=()=>{Je(),Ve=Ce=void 0,ye=me=!1},Re=()=>{const we=Ve;ut(),we?.unsubscribe()};return(0,ue.e)((we,be)=>{rt++,!me&&!ye&&Je();const Be=Ce=Ce??pe();be.add(()=>{rt--,0===rt&&!me&&!ye&&(Me=fe(Re,G))}),Be.subscribe(be),!Ve&&rt>0&&(Ve=new F.Hp({next:je=>Be.next(je),error:je=>{me=!0,Je(),Me=fe(ut,ge,je),Be.error(je)},complete:()=>{ye=!0,Je(),Me=fe(ut,$),Be.complete()}}),(0,f.Xf)(we).subscribe(Ve))})(Y)}}function fe(ce,pe,...ge){if(!0===pe)return void ce();if(!1===pe)return;const $=new F.Hp({next:()=>{$.unsubscribe(),ce()}});return pe(...ge).subscribe($)}},9468:(ct,Te,V)=>{V.d(Te,{R:()=>te});var f=V(4482);function te(F,ue=0){return(0,f.e)((se,fe)=>{fe.add(F.schedule(()=>se.subscribe(fe),ue))})}},8505:(ct,Te,V)=>{V.d(Te,{b:()=>se});var f=V(576),te=V(4482),F=V(5403),ue=V(4671);function se(fe,ce,pe){const ge=(0,f.m)(fe)||ce||pe?{next:fe,error:ce,complete:pe}:fe;return ge?(0,te.e)(($,G)=>{var Y;null===(Y=ge.subscribe)||void 0===Y||Y.call(ge);let Ve=!0;$.subscribe((0,F.x)(G,Me=>{var Ce;null===(Ce=ge.next)||void 0===Ce||Ce.call(ge,Me),G.next(Me)},()=>{var Me;Ve=!1,null===(Me=ge.complete)||void 0===Me||Me.call(ge),G.complete()},Me=>{var Ce;Ve=!1,null===(Ce=ge.error)||void 0===Ce||Ce.call(ge,Me),G.error(Me)},()=>{var Me,Ce;Ve&&(null===(Me=ge.unsubscribe)||void 0===Me||Me.call(ge)),null===(Ce=ge.finalize)||void 0===Ce||Ce.call(ge)}))}):ue.y}},4408:(ct,Te,V)=>{V.d(Te,{o:()=>se});var f=V(727);class te extends f.w0{constructor(ce,pe){super()}schedule(ce,pe=0){return this}}const F={setInterval(fe,ce,...pe){const{delegate:ge}=F;return ge?.setInterval?ge.setInterval(fe,ce,...pe):setInterval(fe,ce,...pe)},clearInterval(fe){const{delegate:ce}=F;return(ce?.clearInterval||clearInterval)(fe)},delegate:void 0};var ue=V(8737);class se extends te{constructor(ce,pe){super(ce,pe),this.scheduler=ce,this.work=pe,this.pending=!1}schedule(ce,pe=0){var ge;if(this.closed)return this;this.state=ce;const $=this.id,G=this.scheduler;return null!=$&&(this.id=this.recycleAsyncId(G,$,pe)),this.pending=!0,this.delay=pe,this.id=null!==(ge=this.id)&&void 0!==ge?ge:this.requestAsyncId(G,this.id,pe),this}requestAsyncId(ce,pe,ge=0){return F.setInterval(ce.flush.bind(ce,this),ge)}recycleAsyncId(ce,pe,ge=0){if(null!=ge&&this.delay===ge&&!1===this.pending)return pe;null!=pe&&F.clearInterval(pe)}execute(ce,pe){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const ge=this._execute(ce,pe);if(ge)return ge;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(ce,pe){let $,ge=!1;try{this.work(ce)}catch(G){ge=!0,$=G||new Error("Scheduled action threw falsy error")}if(ge)return this.unsubscribe(),$}unsubscribe(){if(!this.closed){const{id:ce,scheduler:pe}=this,{actions:ge}=pe;this.work=this.state=this.scheduler=null,this.pending=!1,(0,ue.P)(ge,this),null!=ce&&(this.id=this.recycleAsyncId(pe,ce,null)),this.delay=null,super.unsubscribe()}}}},7565:(ct,Te,V)=>{V.d(Te,{v:()=>F});var f=V(6063);class te{constructor(se,fe=te.now){this.schedulerActionCtor=se,this.now=fe}schedule(se,fe=0,ce){return new this.schedulerActionCtor(this,se).schedule(ce,fe)}}te.now=f.l.now;class F extends te{constructor(se,fe=te.now){super(se,fe),this.actions=[],this._active=!1}flush(se){const{actions:fe}=this;if(this._active)return void fe.push(se);let ce;this._active=!0;do{if(ce=se.execute(se.state,se.delay))break}while(se=fe.shift());if(this._active=!1,ce){for(;se=fe.shift();)se.unsubscribe();throw ce}}}},4986:(ct,Te,V)=>{V.d(Te,{z:()=>F});var f=V(4408);const F=new(V(7565).v)(f.o)},6063:(ct,Te,V)=>{V.d(Te,{l:()=>f});const f={now:()=>(f.delegate||Date).now(),delegate:void 0}},3410:(ct,Te,V)=>{V.d(Te,{z:()=>f});const f={setTimeout(te,F,...ue){const{delegate:se}=f;return se?.setTimeout?se.setTimeout(te,F,...ue):setTimeout(te,F,...ue)},clearTimeout(te){const{delegate:F}=f;return(F?.clearTimeout||clearTimeout)(te)},delegate:void 0}},2202:(ct,Te,V)=>{V.d(Te,{h:()=>te});const te=function f(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(ct,Te,V)=>{V.d(Te,{L:()=>f});const f="function"==typeof Symbol&&Symbol.observable||"@@observable"},7669:(ct,Te,V)=>{V.d(Te,{_6:()=>fe,jO:()=>ue,yG:()=>se});var f=V(576);function F(ce){return ce[ce.length-1]}function ue(ce){return(0,f.m)(F(ce))?ce.pop():void 0}function se(ce){return function te(ce){return ce&&(0,f.m)(ce.schedule)}(F(ce))?ce.pop():void 0}function fe(ce,pe){return"number"==typeof F(ce)?ce.pop():pe}},8737:(ct,Te,V)=>{function f(te,F){if(te){const ue=te.indexOf(F);0<=ue&&te.splice(ue,1)}}V.d(Te,{P:()=>f})},3888:(ct,Te,V)=>{function f(te){const ue=te(se=>{Error.call(se),se.stack=(new Error).stack});return ue.prototype=Object.create(Error.prototype),ue.prototype.constructor=ue,ue}V.d(Te,{d:()=>f})},2806:(ct,Te,V)=>{V.d(Te,{O:()=>ue,x:()=>F});var f=V(2416);let te=null;function F(se){if(f.v.useDeprecatedSynchronousErrorHandling){const fe=!te;if(fe&&(te={errorThrown:!1,error:null}),se(),fe){const{errorThrown:ce,error:pe}=te;if(te=null,ce)throw pe}}else se()}function ue(se){f.v.useDeprecatedSynchronousErrorHandling&&te&&(te.errorThrown=!0,te.error=se)}},9672:(ct,Te,V)=>{function f(te,F,ue,se=0,fe=!1){const ce=F.schedule(function(){ue(),fe?te.add(this.schedule(null,se)):this.unsubscribe()},se);if(te.add(ce),!fe)return ce}V.d(Te,{f:()=>f})},4671:(ct,Te,V)=>{function f(te){return te}V.d(Te,{y:()=>f})},1144:(ct,Te,V)=>{V.d(Te,{z:()=>f});const f=te=>te&&"number"==typeof te.length&&"function"!=typeof te},2206:(ct,Te,V)=>{V.d(Te,{D:()=>te});var f=V(576);function te(F){return Symbol.asyncIterator&&(0,f.m)(F?.[Symbol.asyncIterator])}},576:(ct,Te,V)=>{function f(te){return"function"==typeof te}V.d(Te,{m:()=>f})},3670:(ct,Te,V)=>{V.d(Te,{c:()=>F});var f=V(8822),te=V(576);function F(ue){return(0,te.m)(ue[f.L])}},6495:(ct,Te,V)=>{V.d(Te,{T:()=>F});var f=V(2202),te=V(576);function F(ue){return(0,te.m)(ue?.[f.h])}},8239:(ct,Te,V)=>{V.d(Te,{t:()=>te});var f=V(576);function te(F){return(0,f.m)(F?.then)}},3260:(ct,Te,V)=>{V.d(Te,{L:()=>ue,Q:()=>F});var f=V(655),te=V(576);function F(se){return(0,f.FC)(this,arguments,function*(){const ce=se.getReader();try{for(;;){const{value:pe,done:ge}=yield(0,f.qq)(ce.read());if(ge)return yield(0,f.qq)(void 0);yield yield(0,f.qq)(pe)}}finally{ce.releaseLock()}})}function ue(se){return(0,te.m)(se?.getReader)}},4482:(ct,Te,V)=>{V.d(Te,{A:()=>te,e:()=>F});var f=V(576);function te(ue){return(0,f.m)(ue?.lift)}function F(ue){return se=>{if(te(se))return se.lift(function(fe){try{return ue(fe,this)}catch(ce){this.error(ce)}});throw new TypeError("Unable to lift unknown Observable type")}}},5032:(ct,Te,V)=>{function f(){}V.d(Te,{Z:()=>f})},9635:(ct,Te,V)=>{V.d(Te,{U:()=>F,z:()=>te});var f=V(4671);function te(...ue){return F(ue)}function F(ue){return 0===ue.length?f.y:1===ue.length?ue[0]:function(fe){return ue.reduce((ce,pe)=>pe(ce),fe)}}},7849:(ct,Te,V)=>{V.d(Te,{h:()=>F});var f=V(2416),te=V(3410);function F(ue){te.z.setTimeout(()=>{const{onUnhandledError:se}=f.v;if(!se)throw ue;se(ue)})}},4532:(ct,Te,V)=>{function f(te){return new TypeError(`You provided ${null!==te&&"object"==typeof te?"an invalid object":`'${te}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}V.d(Te,{z:()=>f})},655:(ct,Te,V)=>{function ue(K,X){var ie={};for(var re in K)Object.prototype.hasOwnProperty.call(K,re)&&X.indexOf(re)<0&&(ie[re]=K[re]);if(null!=K&&"function"==typeof Object.getOwnPropertySymbols){var Fe=0;for(re=Object.getOwnPropertySymbols(K);Fe<re.length;Fe++)X.indexOf(re[Fe])<0&&Object.prototype.propertyIsEnumerable.call(K,re[Fe])&&(ie[re[Fe]]=K[re[Fe]])}return ie}function pe(K,X,ie,re){return new(ie||(ie=Promise))(function(Pe,dt){function tn(cn){try{Ze(re.next(cn))}catch(In){dt(In)}}function jt(cn){try{Ze(re.throw(cn))}catch(In){dt(In)}}function Ze(cn){cn.done?Pe(cn.value):function Fe(Pe){return Pe instanceof ie?Pe:new ie(function(dt){dt(Pe)})}(cn.value).then(tn,jt)}Ze((re=re.apply(K,X||[])).next())})}function ye(K){return this instanceof ye?(this.v=K,this):new ye(K)}function me(K,X,ie){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Fe,re=ie.apply(K,X||[]),Pe=[];return Fe={},dt("next"),dt("throw"),dt("return"),Fe[Symbol.asyncIterator]=function(){return this},Fe;function dt(Qt){re[Qt]&&(Fe[Qt]=function(nn){return new Promise(function($r,Nt){Pe.push([Qt,nn,$r,Nt])>1||tn(Qt,nn)})})}function tn(Qt,nn){try{!function jt(Qt){Qt.value instanceof ye?Promise.resolve(Qt.value.v).then(Ze,cn):In(Pe[0][2],Qt)}(re[Qt](nn))}catch($r){In(Pe[0][3],$r)}}function Ze(Qt){tn("next",Qt)}function cn(Qt){tn("throw",Qt)}function In(Qt,nn){Qt(nn),Pe.shift(),Pe.length&&tn(Pe[0][0],Pe[0][1])}}function ut(K){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ie,X=K[Symbol.asyncIterator];return X?X.call(K):(K=function Y(K){var X="function"==typeof Symbol&&Symbol.iterator,ie=X&&K[X],re=0;if(ie)return ie.call(K);if(K&&"number"==typeof K.length)return{next:function(){return K&&re>=K.length&&(K=void 0),{value:K&&K[re++],done:!K}}};throw new TypeError(X?"Object is not iterable.":"Symbol.iterator is not defined.")}(K),ie={},re("next"),re("throw"),re("return"),ie[Symbol.asyncIterator]=function(){return this},ie);function re(Pe){ie[Pe]=K[Pe]&&function(dt){return new Promise(function(tn,jt){!function Fe(Pe,dt,tn,jt){Promise.resolve(jt).then(function(Ze){Pe({value:Ze,done:tn})},dt)}(tn,jt,(dt=K[Pe](dt)).done,dt.value)})}}}V.d(Te,{FC:()=>me,KL:()=>ut,_T:()=>ue,mG:()=>pe,qq:()=>ye})},4650:(ct,Te,V)=>{V.d(Te,{$8M:()=>Dl,$Z:()=>Uv,AFp:()=>Jb,AaK:()=>pe,CHM:()=>al,CRH:()=>_f,CZH:()=>X_,CqO:()=>Aw,D6c:()=>cE,DdM:()=>m0,EJc:()=>Ag,EpF:()=>bd,F4k:()=>DC,FYo:()=>x,FiY:()=>He,G48:()=>dD,GfV:()=>Le,Gpc:()=>G,JOm:()=>Fi,KtG:()=>ul,LFG:()=>$n,LSH:()=>ko,Lbi:()=>eD,Lck:()=>d0,MAs:()=>bC,MMx:()=>V_,NdJ:()=>xw,OlP:()=>vn,Oqu:()=>A_,PXZ:()=>ni,Q6J:()=>m_,QGY:()=>Sw,QP$:()=>Jt,Qsj:()=>k,R0b:()=>Ts,RDi:()=>Gy,Rgc:()=>tc,SBq:()=>p,Sil:()=>es,Suo:()=>Ob,TTD:()=>ls,TgZ:()=>__,VKq:()=>Cb,W1O:()=>Lb,X6Q:()=>WA,XFs:()=>Ye,Xpm:()=>Se,Xts:()=>Eu,Y36:()=>Up,YKP:()=>c0,YNc:()=>ef,Yjl:()=>Ie,Yz7:()=>nn,Z0I:()=>ss,ZZ4:()=>oE,_Bn:()=>fg,_UZ:()=>Cd,_Vd:()=>Oo,_c5:()=>lE,_uU:()=>HC,aQg:()=>Ug,c2e:()=>ty,cJS:()=>Nt,cg1:()=>ku,dDg:()=>BA,dqk:()=>ln,eFA:()=>Y0,ekj:()=>Dd,eoX:()=>z0,f3M:()=>b,g9A:()=>sc,h0i:()=>Ma,hGG:()=>yD,hij:()=>x_,iGM:()=>T0,ifc:()=>lt,ip1:()=>U0,jDz:()=>f0,kL8:()=>og,lG2:()=>Z,lqb:()=>lr,lri:()=>aD,n5z:()=>gs,oAB:()=>Ft,oxw:()=>Nw,q4F:()=>Qe,qLn:()=>kh,qOj:()=>c_,qZA:()=>y_,rWj:()=>W0,sBO:()=>Df,sIi:()=>wd,s_b:()=>Eg,soG:()=>Sg,tb:()=>tD,tp0:()=>It,uIk:()=>p_,vHH:()=>Ce,vpe:()=>Pa,wAp:()=>Ct,xp6:()=>jI,z2F:()=>bf,zSh:()=>sd,zs3:()=>md});var f=V(7579),te=V(727),F=V(9751),ue=V(6451),se=V(3099);function fe(s){for(let o in s)if(s[o]===fe)return o;throw Error("Could not find renamed property on target object.")}function ce(s,o){for(const u in o)o.hasOwnProperty(u)&&!s.hasOwnProperty(u)&&(s[u]=o[u])}function pe(s){if("string"==typeof s)return s;if(Array.isArray(s))return"["+s.map(pe).join(", ")+"]";if(null==s)return""+s;if(s.overriddenName)return`${s.overriddenName}`;if(s.name)return`${s.name}`;const o=s.toString();if(null==o)return""+o;const u=o.indexOf("\n");return-1===u?o:o.substring(0,u)}function ge(s,o){return null==s||""===s?null===o?"":o:null==o||""===o?s:s+" "+o}const $=fe({__forward_ref__:fe});function G(s){return s.__forward_ref__=G,s.toString=function(){return pe(this())},s}function Y(s){return Ve(s)?s():s}function Ve(s){return"function"==typeof s&&s.hasOwnProperty($)&&s.__forward_ref__===G}class Ce extends Error{constructor(o,u){super(function rt(s,o){return`NG0${Math.abs(s)}${o?": "+o.trim():""}`}(o,u)),this.code=o}}function ye(s){return"string"==typeof s?s:null==s?"":String(s)}function we(s,o){throw new Ce(-201,!1)}function jt(s,o){null==s&&function Ze(s,o,u,c){throw new Error(`ASSERTION ERROR: ${s}`+(null==c?"":` [Expected=> ${u} ${c} ${o} <=Actual]`))}(o,s,null,"!=")}function nn(s){return{token:s.token,providedIn:s.providedIn||null,factory:s.factory,value:void 0}}function Nt(s){return{providers:s.providers||[],imports:s.imports||[]}}function dn(s){return Ai(s,xi)||Ai(s,mi)}function ss(s){return null!==dn(s)}function Ai(s,o){return s.hasOwnProperty(o)?s[o]:null}function Ps(s){return s&&(s.hasOwnProperty(ri)||s.hasOwnProperty(zo))?s[ri]:null}const xi=fe({\u0275prov:fe}),ri=fe({\u0275inj:fe}),mi=fe({ngInjectableDef:fe}),zo=fe({ngInjectorDef:fe});var Ye=(()=>((Ye=Ye||{})[Ye.Default=0]="Default",Ye[Ye.Host=1]="Host",Ye[Ye.Self=2]="Self",Ye[Ye.SkipSelf=4]="SkipSelf",Ye[Ye.Optional=8]="Optional",Ye))();let Rr;function rr(s){const o=Rr;return Rr=s,o}function _i(s,o,u){const c=dn(s);return c&&"root"==c.providedIn?void 0===c.value?c.value=c.factory():c.value:u&Ye.Optional?null:void 0!==o?o:void we(pe(s))}function Nn(s){return{toString:s}.toString()}var qn=(()=>((qn=qn||{})[qn.OnPush=0]="OnPush",qn[qn.Default=1]="Default",qn))(),lt=(()=>{return(s=lt||(lt={}))[s.Emulated=0]="Emulated",s[s.None=2]="None",s[s.ShadowDom=3]="ShadowDom",lt;var s})();const ln=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),ii={},At=[],os=fe({\u0275cmp:fe}),rn=fe({\u0275dir:fe}),Ri=fe({\u0275pipe:fe}),an=fe({\u0275mod:fe}),ir=fe({\u0275fac:fe}),zr=fe({__NG_ELEMENT_ID__:fe});let tt=0;function Se(s){return Nn(()=>{const u=!0===s.standalone,c={},h={type:s.type,providersResolver:null,decls:s.decls,vars:s.vars,factory:null,template:s.template||null,consts:s.consts||null,ngContentSelectors:s.ngContentSelectors,hostBindings:s.hostBindings||null,hostVars:s.hostVars||0,hostAttrs:s.hostAttrs||null,contentQueries:s.contentQueries||null,declaredInputs:c,inputs:null,outputs:null,exportAs:s.exportAs||null,onPush:s.changeDetection===qn.OnPush,directiveDefs:null,pipeDefs:null,standalone:u,dependencies:u&&s.dependencies||null,getStandaloneInjector:null,selectors:s.selectors||At,viewQuery:s.viewQuery||null,features:s.features||null,data:s.data||{},encapsulation:s.encapsulation||lt.Emulated,id:"c"+tt++,styles:s.styles||At,_:null,setInput:null,schemas:s.schemas||null,tView:null},g=s.dependencies,v=s.features;return h.inputs=B(s.inputs,c),h.outputs=B(s.outputs),v&&v.forEach(I=>I(h)),h.directiveDefs=g?()=>("function"==typeof g?g():g).map(bt).filter(Et):null,h.pipeDefs=g?()=>("function"==typeof g?g():g).map(ht).filter(Et):null,h})}function bt(s){return J(s)||ze(s)}function Et(s){return null!==s}function Ft(s){return Nn(()=>({type:s.type,bootstrap:s.bootstrap||At,declarations:s.declarations||At,imports:s.imports||At,exports:s.exports||At,transitiveCompileScopes:null,schemas:s.schemas||null,id:s.id||null}))}function B(s,o){if(null==s)return ii;const u={};for(const c in s)if(s.hasOwnProperty(c)){let h=s[c],g=h;Array.isArray(h)&&(g=h[1],h=h[0]),u[h]=c,o&&(o[h]=g)}return u}const Z=Se;function Ie(s){return{type:s.type,name:s.name,factory:null,pure:!1!==s.pure,standalone:!0===s.standalone,onDestroy:s.type.prototype.ngOnDestroy||null}}function J(s){return s[os]||null}function ze(s){return s[rn]||null}function ht(s){return s[Ri]||null}function Jt(s){const o=J(s)||ze(s)||ht(s);return null!==o&&o.standalone}function mn(s,o){const u=s[an]||null;if(!u&&!0===o)throw new Error(`Type ${pe(s)} does not have '\u0275mod' property.`);return u}function pr(s){return Array.isArray(s)&&"object"==typeof s[1]}function qr(s){return Array.isArray(s)&&!0===s[1]}function Yu(s){return 0!=(8&s.flags)}function Wa(s){return 2==(2&s.flags)}function Cc(s){return 1==(1&s.flags)}function Mr(s){return null!==s.template}function Kf(s){return 0!=(256&s[2])}function Wi(s,o){return s.hasOwnProperty(ir)?s[ir]:null}class us{constructor(o,u,c){this.previousValue=o,this.currentValue=u,this.firstChange=c}isFirstChange(){return this.firstChange}}function ls(){return go}function go(s){return s.type.prototype.ngOnChanges&&(s.setInput=Ju),za}function za(){const s=Qf(this),o=s?.current;if(o){const u=s.previous;if(u===ii)s.previous=o;else for(let c in o)u[c]=o[c];s.current=null,this.ngOnChanges(o)}}function Ju(s,o,u,c){const h=Qf(s)||function qa(s,o){return s[Sc]=o}(s,{previous:ii,current:null}),g=h.current||(h.current={}),v=h.previous,I=this.declaredInputs[u],C=v[I];g[I]=new us(C&&C.currentValue,o,v===ii),s[c]=o}ls.ngInherit=!0;const Sc="__ngSimpleChanges__";function Qf(s){return s[Sc]||null}function kn(s){for(;Array.isArray(s);)s=s[0];return s}function vi(s,o){return kn(o[s])}function Kr(s,o){return kn(o[s.index])}function mo(s,o){return s.data[o]}function Kt(s,o){const u=o[s];return pr(u)?u:u[0]}function _o(s){return 64==(64&s[2])}function Ni(s,o){return null==o?null:s[o]}function rl(s){s[18]=0}function xn(s,o){s[5]+=o;let u=s,c=s[3];for(;null!==c&&(1===o&&1===u[5]||-1===o&&0===u[5]);)c[5]+=o,u=c,c=c[3]}const xt={lFrame:Lc(null),bindingsEnabled:!0};function hs(){return xt.bindingsEnabled}function Ae(){return xt.lFrame.lView}function Wt(){return xt.lFrame.tView}function al(s){return xt.lFrame.contextLView=s,s[8]}function ul(s){return xt.lFrame.contextLView=null,s}function Pn(){let s=ll();for(;null!==s&&64===s.type;)s=s.parent;return s}function ll(){return xt.lFrame.currentTNode}function wi(s,o){const u=xt.lFrame;u.currentTNode=s,u.isParent=o}function Za(){return xt.lFrame.isParent}function On(){const s=xt.lFrame;let o=s.bindingRootIndex;return-1===o&&(o=s.bindingRootIndex=s.tView.bindingStartIndex),o}function yo(){return xt.lFrame.bindingIndex++}function _m(s,o){const u=xt.lFrame;u.bindingIndex=u.bindingRootIndex=s,cl(o)}function cl(s){xt.lFrame.currentDirectiveIndex=s}function Pc(){return xt.lFrame.currentQueryIndex}function eu(s){xt.lFrame.currentQueryIndex=s}function Oc(s){const o=s[1];return 2===o.type?o.declTNode:1===o.type?s[6]:null}function dl(s,o,u){if(u&Ye.SkipSelf){let h=o,g=s;for(;!(h=h.parent,null!==h||u&Ye.Host||(h=Oc(g),null===h||(g=g[15],10&h.type))););if(null===h)return!1;o=h,s=g}const c=xt.lFrame=Fc();return c.currentTNode=o,c.lView=s,!0}function hl(s){const o=Fc(),u=s[1];xt.lFrame=o,o.currentTNode=u.firstChild,o.lView=s,o.tView=u,o.contextLView=s,o.bindingIndex=u.bindingStartIndex,o.inI18n=!1}function Fc(){const s=xt.lFrame,o=null===s?null:s.child;return null===o?Lc(s):o}function Lc(s){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:s,child:null,inI18n:!1};return null!==s&&(s.child=o),o}function Vc(){const s=xt.lFrame;return xt.lFrame=s.parent,s.currentTNode=null,s.lView=null,s}const hh=Vc;function vo(){const s=Vc();s.isParent=!0,s.tView=null,s.selectedIndex=-1,s.contextLView=null,s.elementDepthCount=0,s.currentDirectiveIndex=-1,s.currentNamespace=null,s.bindingRootIndex=-1,s.bindingIndex=-1,s.currentQueryIndex=0}function ur(){return xt.lFrame.selectedIndex}function ai(s){xt.lFrame.selectedIndex=s}function bn(){const s=xt.lFrame;return mo(s.tView,s.selectedIndex)}function gl(s,o){for(let u=o.directiveStart,c=o.directiveEnd;u<c;u++){const g=s.data[u].type.prototype,{ngAfterContentInit:v,ngAfterContentChecked:I,ngAfterViewInit:C,ngAfterViewChecked:A,ngOnDestroy:N}=g;v&&(s.contentHooks||(s.contentHooks=[])).push(-u,v),I&&((s.contentHooks||(s.contentHooks=[])).push(u,I),(s.contentCheckHooks||(s.contentCheckHooks=[])).push(u,I)),C&&(s.viewHooks||(s.viewHooks=[])).push(-u,C),A&&((s.viewHooks||(s.viewHooks=[])).push(u,A),(s.viewCheckHooks||(s.viewCheckHooks=[])).push(u,A)),null!=N&&(s.destroyHooks||(s.destroyHooks=[])).push(u,N)}}function Eo(s,o,u){Qo(s,o,3,u)}function Yo(s,o,u,c){(3&s[2])===u&&Qo(s,o,u,c)}function gh(s,o){let u=s[2];(3&u)===o&&(u&=2047,u+=1,s[2]=u)}function Qo(s,o,u,c){const g=c??-1,v=o.length-1;let I=0;for(let C=void 0!==c?65535&s[18]:0;C<v;C++)if("number"==typeof o[C+1]){if(I=o[C],null!=c&&I>=c)break}else o[C]<0&&(s[18]+=65536),(I<g||-1==g)&&(mh(s,u,o,C),s[18]=(4294901760&s[18])+C+2),C++}function mh(s,o,u,c){const h=u[c]<0,g=u[c+1],I=s[h?-u[c]:u[c]];if(h){if(s[2]>>11<s[18]>>16&&(3&s[2])===o){s[2]+=2048;try{g.call(I)}finally{}}}else try{g.call(I)}finally{}}class $s{constructor(o,u,c){this.factory=o,this.resolving=!1,this.canSeeViewProviders=u,this.injectImpl=c}}function Xo(s,o,u){let c=0;for(;c<u.length;){const h=u[c];if("number"==typeof h){if(0!==h)break;c++;const g=u[c++],v=u[c++],I=u[c++];s.setAttribute(o,v,I,g)}else{const g=h,v=u[++c];vl(g)?s.setProperty(o,g,v):s.setAttribute(o,g,v),c++}}return c}function Co(s){return 3===s||4===s||6===s}function vl(s){return 64===s.charCodeAt(0)}function tu(s,o){if(null!==o&&0!==o.length)if(null===s||0===s.length)s=o.slice();else{let u=-1;for(let c=0;c<o.length;c++){const h=o[c];"number"==typeof h?u=h:0===u||yh(s,u,h,null,-1===u||2===u?o[++c]:null)}}return s}function yh(s,o,u,c,h){let g=0,v=s.length;if(-1===o)v=-1;else for(;g<s.length;){const I=s[g++];if("number"==typeof I){if(I===o){v=-1;break}if(I>o){v=g-1;break}}}for(;g<s.length;){const I=s[g];if("number"==typeof I)break;if(I===u){if(null===c)return void(null!==h&&(s[g+1]=h));if(c===s[g+1])return void(s[g+2]=h)}g++,null!==c&&g++,null!==h&&g++}-1!==v&&(s.splice(v,0,o),g=v+1),s.splice(g++,0,u),null!==c&&s.splice(g++,0,c),null!==h&&s.splice(g++,0,h)}function vh(s){return-1!==s}function gr(s){return 32767&s}function ru(s,o){let u=function nu(s){return s>>16}(s),c=o;for(;u>0;)c=c[15],u--;return c}let qi=!0;function iu(s){const o=qi;return qi=s,o}let Hn=0;const ki={};function bo(s,o){const u=El(s,o);if(-1!==u)return u;const c=o[1];c.firstCreatePass&&(s.injectorIndex=o.length,ou(c.data,s),ou(o,null),ou(c.blueprint,null));const h=Il(s,o),g=s.injectorIndex;if(vh(h)){const v=gr(h),I=ru(h,o),C=I[1].data;for(let A=0;A<8;A++)o[g+A]=I[v+A]|C[v+A]}return o[g+8]=h,g}function ou(s,o){s.push(0,0,0,0,0,0,0,0,o)}function El(s,o){return-1===s.injectorIndex||s.parent&&s.parent.injectorIndex===s.injectorIndex||null===o[s.injectorIndex+8]?-1:s.injectorIndex}function Il(s,o){if(s.parent&&-1!==s.parent.injectorIndex)return s.parent.injectorIndex;let u=0,c=null,h=o;for(;null!==h;){if(c=na(h),null===c)return-1;if(u++,h=h[15],-1!==c.injectorIndex)return c.injectorIndex|u<<16}return-1}function Gs(s,o,u){!function wl(s,o,u){let c;"string"==typeof u?c=u.charCodeAt(0)||0:u.hasOwnProperty(zr)&&(c=u[zr]),null==c&&(c=u[zr]=Hn++);const h=255&c;o.data[s+(h>>5)]|=1<<h}(s,o,u)}function Ws(s,o,u){if(u&Ye.Optional||void 0!==s)return s;we()}function Hc(s,o,u,c){if(u&Ye.Optional&&void 0===c&&(c=null),0==(u&(Ye.Self|Ye.Host))){const h=s[9],g=rr(void 0);try{return h?h.get(o,c,u&Ye.Optional):_i(o,c,u&Ye.Optional)}finally{rr(g)}}return Ws(c,0,u)}function Do(s,o,u,c=Ye.Default,h){if(null!==s){if(1024&o[2]){const v=function ta(s,o,u,c,h){let g=s,v=o;for(;null!==g&&null!==v&&1024&v[2]&&!(256&v[2]);){const I=au(g,v,u,c|Ye.Self,ki);if(I!==ki)return I;let C=g.parent;if(!C){const A=v[21];if(A){const N=A.get(u,ki,c);if(N!==ki)return N}C=na(v),v=v[15]}g=C}return h}(s,o,u,c,ki);if(v!==ki)return v}const g=au(s,o,u,c,ki);if(g!==ki)return g}return Hc(o,u,c,h)}function au(s,o,u,c,h){const g=function $c(s){if("string"==typeof s)return s.charCodeAt(0)||0;const o=s.hasOwnProperty(zr)?s[zr]:void 0;return"number"==typeof o?o>=0?255&o:Gc:o}(u);if("function"==typeof g){if(!dl(o,s,c))return c&Ye.Host?Ws(h,0,c):Hc(o,u,c,h);try{const v=g(c);if(null!=v||c&Ye.Optional)return v;we()}finally{hh()}}else if("number"==typeof g){let v=null,I=El(s,o),C=-1,A=c&Ye.Host?o[16][6]:null;for((-1===I||c&Ye.SkipSelf)&&(C=-1===I?Il(s,o):o[I+8],-1!==C&&uu(c,!1)?(v=o[1],I=gr(C),o=ru(C,o)):I=-1);-1!==I;){const N=o[1];if(Cl(g,I,N.data)){const L=Ih(I,o,u,v,c,A);if(L!==ki)return L}C=o[I+8],-1!==C&&uu(c,o[1].data[I+8]===A)&&Cl(g,I,o)?(v=N,I=gr(C),o=ru(C,o)):I=-1}}return h}function Ih(s,o,u,c,h,g){const v=o[1],I=v.data[s+8],N=ea(I,v,u,null==c?Wa(I)&&qi:c!=v&&0!=(3&I.type),h&Ye.Host&&g===I);return null!==N?ps(o,v,N,I):ki}function ea(s,o,u,c,h){const g=s.providerIndexes,v=o.data,I=1048575&g,C=s.directiveStart,N=g>>20,z=h?I+N:s.directiveEnd;for(let ne=c?I:I+N;ne<z;ne++){const Ee=v[ne];if(ne<C&&u===Ee||ne>=C&&Ee.type===u)return ne}if(h){const ne=v[C];if(ne&&Mr(ne)&&ne.type===u)return C}return null}function ps(s,o,u,c){let h=s[u];const g=o.data;if(function Io(s){return s instanceof $s}(h)){const v=h;v.resolving&&function Je(s,o){const u=o?`. Dependency path: ${o.join(" > ")} > ${s}`:"";throw new Ce(-200,`Circular dependency in DI detected for ${s}${u}`)}(function me(s){return"function"==typeof s?s.name||s.toString():"object"==typeof s&&null!=s&&"function"==typeof s.type?s.type.name||s.type.toString():ye(s)}(g[u]));const I=iu(v.canSeeViewProviders);v.resolving=!0;const C=v.injectImpl?rr(v.injectImpl):null;dl(s,c,Ye.Default);try{h=s[u]=v.factory(void 0,g,s,c),o.firstCreatePass&&u>=c.directiveStart&&function ph(s,o,u){const{ngOnChanges:c,ngOnInit:h,ngDoCheck:g}=o.type.prototype;if(c){const v=go(o);(u.preOrderHooks||(u.preOrderHooks=[])).push(s,v),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(s,v)}h&&(u.preOrderHooks||(u.preOrderHooks=[])).push(0-s,h),g&&((u.preOrderHooks||(u.preOrderHooks=[])).push(s,g),(u.preOrderCheckHooks||(u.preOrderCheckHooks=[])).push(s,g))}(u,g[u],o)}finally{null!==C&&rr(C),iu(I),v.resolving=!1,hh()}}return h}function Cl(s,o,u){return!!(u[o+(s>>5)]&1<<s)}function uu(s,o){return!(s&Ye.Self||s&Ye.Host&&o)}class To{constructor(o,u){this._tNode=o,this._lView=u}get(o,u,c){return Do(this._tNode,this._lView,o,c,u)}}function Gc(){return new To(Pn(),Ae())}function gs(s){return Nn(()=>{const o=s.prototype.constructor,u=o[ir]||bl(o),c=Object.prototype;let h=Object.getPrototypeOf(s.prototype).constructor;for(;h&&h!==c;){const g=h[ir]||bl(h);if(g&&g!==u)return g;h=Object.getPrototypeOf(h)}return g=>new g})}function bl(s){return Ve(s)?()=>{const o=bl(Y(s));return o&&o()}:Wi(s)}function na(s){const o=s[1],u=o.type;return 2===u?o.declTNode:1===u?s[6]:null}function Dl(s){return function Eh(s,o){if("class"===o)return s.classes;if("style"===o)return s.styles;const u=s.attrs;if(u){const c=u.length;let h=0;for(;h<c;){const g=u[h];if(Co(g))break;if(0===g)h+=2;else if("number"==typeof g)for(h++;h<c&&"string"==typeof u[h];)h++;else{if(g===o)return u[h+1];h+=2}}}return null}(Pn(),s)}const zs="__parameters__";function sa(s,o,u){return Nn(()=>{const c=function Tl(s){return function(...u){if(s){const c=s(...u);for(const h in c)this[h]=c[h]}}}(o);function h(...g){if(this instanceof h)return c.apply(this,g),this;const v=new h(...g);return I.annotation=v,I;function I(C,A,N){const L=C.hasOwnProperty(zs)?C[zs]:Object.defineProperty(C,zs,{value:[]})[zs];for(;L.length<=N;)L.push(null);return(L[N]=L[N]||[]).push(v),C}}return u&&(h.prototype=Object.create(u.prototype)),h.prototype.ngMetadataName=s,h.annotationCls=h,h})}class vn{constructor(o,u){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof u?this.__NG_ELEMENT_ID__=u:void 0!==u&&(this.\u0275prov=nn({token:this,providedIn:u.providedIn||"root",factory:u.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function fn(s,o){void 0===o&&(o=s);for(let u=0;u<s.length;u++){let c=s[u];Array.isArray(c)?(o===s&&(o=s.slice(0,u)),fn(c,o)):o!==s&&o.push(c)}return o}function li(s,o){s.forEach(u=>Array.isArray(u)?li(u,o):o(u))}function _s(s,o,u){o>=s.length?s.push(u):s.splice(o,0,u)}function An(s,o){return o>=s.length-1?s.pop():s.splice(o,1)[0]}function ci(s,o,u){let c=qs(s,o);return c>=0?s[1|c]=u:(c=~c,function Sl(s,o,u,c){let h=s.length;if(h==o)s.push(u,c);else if(1===h)s.push(c,s[0]),s[0]=u;else{for(h--,s.push(s[h-1],s[h]);h>o;)s[h]=s[h-2],h--;s[o]=u,s[o+1]=c}}(s,c,o,u)),c}function du(s,o){const u=qs(s,o);if(u>=0)return s[1|u]}function qs(s,o){return function oa(s,o,u){let c=0,h=s.length>>u;for(;h!==c;){const g=c+(h-c>>1),v=s[g<<u];if(o===v)return g<<u;v>o?h=g:c=g+1}return~(h<<u)}(s,o,1)}const Zr={},Rn="__NG_DI_FLAG__",la="ngTempTokenPath",ca=/\n/gm,Rl="__source";let ys;function vs(s){const o=ys;return ys=s,o}function qc(s,o=Ye.Default){if(void 0===ys)throw new Ce(-203,!1);return null===ys?_i(s,void 0,o):ys.get(s,o&Ye.Optional?null:void 0,o)}function $n(s,o=Ye.Default){return(function Os(){return Rr}()||qc)(Y(s),o)}function b(s,o=Ye.Default){return"number"!=typeof o&&(o=0|(o.optional&&8)|(o.host&&1)|(o.self&&2)|(o.skipSelf&&4)),$n(s,o)}function T(s){const o=[];for(let u=0;u<s.length;u++){const c=Y(s[u]);if(Array.isArray(c)){if(0===c.length)throw new Ce(900,!1);let h,g=Ye.Default;for(let v=0;v<c.length;v++){const I=c[v],C=U(I);"number"==typeof C?-1===C?h=I.token:g|=C:h=I}o.push($n(h,g))}else o.push($n(c))}return o}function R(s,o){return s[Rn]=o,s.prototype[Rn]=o,s}function U(s){return s[Rn]}const He=R(sa("Optional"),8),It=R(sa("SkipSelf"),4);let ap;function Gy(s){ap=s}class pa{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function Ei(s){return s instanceof pa?s.changingThisBreaksApplicationSecurity:s}const yu=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;var Qn=(()=>((Qn=Qn||{})[Qn.NONE=0]="NONE",Qn[Qn.HTML=1]="HTML",Qn[Qn.STYLE=2]="STYLE",Qn[Qn.SCRIPT=3]="SCRIPT",Qn[Qn.URL=4]="URL",Qn[Qn.RESOURCE_URL=5]="RESOURCE_URL",Qn))();function ko(s){const o=function Po(){const s=Ae();return s&&s[12]}();return o?o.sanitize(Qn.URL,s)||"":function ga(s,o){const u=function Xc(s){return s instanceof pa&&s.getTypeName()||null}(s);if(null!=u&&u!==o){if("ResourceURL"===u&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${u} (see https://g.co/ng/security#xss)`)}return u===o}(s,"URL")?Ei(s):function pp(s){return(s=String(s)).match(yu)?s:"unsafe:"+s}(ye(s))}const Eu=new vn("ENVIRONMENT_INITIALIZER"),vp=new vn("INJECTOR",-1),nd=new vn("INJECTOR_DEF_TYPES");class Mm{get(o,u=Zr){if(u===Zr){const c=new Error(`NullInjectorError: No provider for ${pe(o)}!`);throw c.name="NullInjectorError",c}return u}}function Rh(...s){return{\u0275providers:Iu(0,s)}}function Iu(s,...o){const u=[],c=new Set;let h;return li(o,g=>{const v=g;id(v,u,[],c)&&(h||(h=[]),h.push(v))}),void 0!==h&&rd(h,u),u}function rd(s,o){for(let u=0;u<s.length;u++){const{providers:h}=s[u];li(h,g=>{o.push(g)})}}function id(s,o,u,c){if(!(s=Y(s)))return!1;let h=null,g=Ps(s);const v=!g&&J(s);if(g||v){if(v&&!v.standalone)return!1;h=s}else{const C=s.ngModule;if(g=Ps(C),!g)return!1;h=C}const I=c.has(h);if(v){if(I)return!1;if(c.add(h),v.dependencies){const C="function"==typeof v.dependencies?v.dependencies():v.dependencies;for(const A of C)id(A,o,u,c)}}else{if(!g)return!1;{if(null!=g.imports&&!I){let A;c.add(h);try{li(g.imports,N=>{id(N,o,u,c)&&(A||(A=[]),A.push(N))})}finally{}void 0!==A&&rd(A,o)}if(!I){const A=Wi(h)||(()=>new h);o.push({provide:h,useFactory:A,deps:At},{provide:nd,useValue:h,multi:!0},{provide:Eu,useValue:()=>$n(h),multi:!0})}const C=g.providers;null==C||I||li(C,N=>{o.push(N)})}}return h!==s&&void 0!==s.providers}const wp=fe({provide:String,useValue:fe});function Ep(s){return null!==s&&"object"==typeof s&&wp in s}function va(s){return"function"==typeof s}const sd=new vn("Set Injector scope."),Vl={},Ip={};let Cu;function Mh(){return void 0===Cu&&(Cu=new Mm),Cu}class lr{}class od extends lr{constructor(o,u,c,h){super(),this.parent=u,this.source=c,this.scopes=h,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Ea(o,v=>this.processProvider(v)),this.records.set(vp,Ln(void 0,this)),h.has("environment")&&this.records.set(lr,Ln(void 0,this));const g=this.records.get(sd);null!=g&&"string"==typeof g.value&&this.scopes.add(g.value),this.injectorDefTypes=new Set(this.get(nd.multi,At,Ye.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const o of this._ngOnDestroyHooks)o.ngOnDestroy();for(const o of this._onDestroyHooks)o()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(o){this._onDestroyHooks.push(o)}runInContext(o){this.assertNotDestroyed();const u=vs(this),c=rr(void 0);try{return o()}finally{vs(u),rr(c)}}get(o,u=Zr,c=Ye.Default){this.assertNotDestroyed();const h=vs(this),g=rr(void 0);try{if(!(c&Ye.SkipSelf)){let I=this.records.get(o);if(void 0===I){const C=function km(s){return"function"==typeof s||"object"==typeof s&&s instanceof vn}(o)&&dn(o);I=C&&this.injectableDefInScope(C)?Ln(Nm(o),Vl):null,this.records.set(o,I)}if(null!=I)return this.hydrate(o,I)}return(c&Ye.Self?Mh():this.parent).get(o,u=c&Ye.Optional&&u===Zr?null:u)}catch(v){if("NullInjectorError"===v.name){if((v[la]=v[la]||[]).unshift(pe(o)),h)throw v;return function Q(s,o,u,c){const h=s[la];throw o[Rl]&&h.unshift(o[Rl]),s.message=function oe(s,o,u,c=null){s=s&&"\n"===s.charAt(0)&&"\u0275"==s.charAt(1)?s.slice(2):s;let h=pe(o);if(Array.isArray(o))h=o.map(pe).join(" -> ");else if("object"==typeof o){let g=[];for(let v in o)if(o.hasOwnProperty(v)){let I=o[v];g.push(v+":"+("string"==typeof I?JSON.stringify(I):pe(I)))}h=`{${g.join(", ")}}`}return`${u}${c?"("+c+")":""}[${h}]: ${s.replace(ca,"\n  ")}`}("\n"+s.message,h,u,c),s.ngTokenPath=h,s[la]=null,s}(v,o,"R3InjectorError",this.source)}throw v}finally{rr(g),vs(h)}}resolveInjectorInitializers(){const o=vs(this),u=rr(void 0);try{const c=this.get(Eu.multi,At,Ye.Self);for(const h of c)h()}finally{vs(o),rr(u)}}toString(){const o=[],u=this.records;for(const c of u.keys())o.push(pe(c));return`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ce(205,!1)}processProvider(o){let u=va(o=Y(o))?o:Y(o&&o.provide);const c=function Xy(s){return Ep(s)?Ln(void 0,s.useValue):Ln(Cp(s),Vl)}(o);if(va(o)||!0!==o.multi)this.records.get(u);else{let h=this.records.get(u);h||(h=Ln(void 0,Vl,!0),h.factory=()=>T(h.multi),this.records.set(u,h)),u=o,h.multi.push(o)}this.records.set(u,c)}hydrate(o,u){return u.value===Vl&&(u.value=Ip,u.value=u.factory()),"object"==typeof u.value&&u.value&&function wa(s){return null!==s&&"object"==typeof s&&"function"==typeof s.ngOnDestroy}(u.value)&&this._ngOnDestroyHooks.add(u.value),u.value}injectableDefInScope(o){if(!o.providedIn)return!1;const u=Y(o.providedIn);return"string"==typeof u?"any"===u||this.scopes.has(u):this.injectorDefTypes.has(u)}}function Nm(s){const o=dn(s),u=null!==o?o.factory:Wi(s);if(null!==u)return u;if(s instanceof vn)throw new Ce(204,!1);if(s instanceof Function)return function Jy(s){const o=s.length;if(o>0)throw function pn(s,o){const u=[];for(let c=0;c<s;c++)u.push(o);return u}(o,"?"),new Ce(204,!1);const u=function Gr(s){const o=s&&(s[xi]||s[mi]);if(o){const u=function Wr(s){if(s.hasOwnProperty("name"))return s.name;const o=(""+s).match(/^function\s*([^\s(]+)/);return null===o?"":o[1]}(s);return console.warn(`DEPRECATED: DI is instantiating a token "${u}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${u}" class.`),o}return null}(s);return null!==u?()=>u.factory(s):()=>new s}(s);throw new Ce(204,!1)}function Cp(s,o,u){let c;if(va(s)){const h=Y(s);return Wi(h)||Nm(h)}if(Ep(s))c=()=>Y(s.useValue);else if(function Ll(s){return!(!s||!s.useFactory)}(s))c=()=>s.useFactory(...T(s.deps||[]));else if(function Or(s){return!(!s||!s.useExisting)}(s))c=()=>$n(Y(s.useExisting));else{const h=Y(s&&(s.useClass||s.provide));if(!function bu(s){return!!s.deps}(s))return Wi(h)||Nm(h);c=()=>new h(...T(s.deps))}return c}function Ln(s,o,u=!1){return{factory:s,value:o,multi:u?[]:void 0}}function Ys(s){return!!s.\u0275providers}function Ea(s,o){for(const u of s)Array.isArray(u)?Ea(u,o):Ys(u)?Ea(u.\u0275providers,o):o(u)}class bp{}class Dp{resolveComponentFactory(o){throw function ev(s){const o=Error(`No component factory found for ${pe(s)}. Did you add it to @NgModule.entryComponents?`);return o.ngComponent=s,o}(o)}}let Oo=(()=>{class s{}return s.NULL=new Dp,s})();function tv(){return y(Pn(),Ae())}function y(s,o){return new p(Kr(s,o))}let p=(()=>{class s{constructor(u){this.nativeElement=u}}return s.__NG_ELEMENT_ID__=tv,s})();function m(s){return s instanceof p?s.nativeElement:s}class x{}let k=(()=>{class s{}return s.__NG_ELEMENT_ID__=()=>function q(){const s=Ae(),u=Kt(Pn().index,s);return(pr(u)?u:s)[11]}(),s})(),le=(()=>{class s{}return s.\u0275prov=nn({token:s,providedIn:"root",factory:()=>null}),s})();class Le{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const Qe=new Le("14.2.10"),wt={};function Fo(s){return s.ngOriginalError}class kh{constructor(){this._console=console}handleError(o){const u=this._findOriginalError(o);this._console.error("ERROR",o),u&&this._console.error("ORIGINAL ERROR",u)}_findOriginalError(o){let u=o&&Fo(o);for(;u&&Fo(u);)u=Fo(u);return u||null}}const dd=new Map;let YT=0;const Oh="__ngContext__";function Yr(s,o){pr(o)?(s[Oh]=o[20],function lv(s){dd.set(s[20],s)}(o)):s[Oh]=o}function Is(s){return s instanceof Function?s():s}var Fi=(()=>((Fi=Fi||{})[Fi.Important=1]="Important",Fi[Fi.DashCase=2]="DashCase",Fi))();function gv(s,o){return undefined(s,o)}function xp(s){const o=s[3];return qr(o)?o[3]:o}function mv(s){return bI(s[13])}function _v(s){return bI(s[4])}function bI(s){for(;null!==s&&!qr(s);)s=s[4];return s}function Lh(s,o,u,c,h){if(null!=c){let g,v=!1;qr(c)?g=c:pr(c)&&(v=!0,c=c[0]);const I=kn(c);0===s&&null!==u?null==h?SI(o,u,I):pd(o,u,I,h||null,!0):1===s&&null!==u?pd(o,u,I,h||null,!0):2===s?function MI(s,o,u){const c=kp(s,o);c&&function gS(s,o,u,c){s.removeChild(o,u,c)}(s,c,o,u)}(o,I,v):3===s&&o.destroyNode(I),null!=g&&function _S(s,o,u,c,h){const g=u[7];g!==kn(u)&&Lh(o,s,c,g,h);for(let I=10;I<u.length;I++){const C=u[I];Fp(C[1],C,s,o,c,g)}}(o,s,g,u,h)}}function yv(s,o,u){return s.createElement(o,u)}function DI(s,o){const u=s[9],c=u.indexOf(o),h=o[3];512&o[2]&&(o[2]&=-513,xn(h,-1)),u.splice(c,1)}function vv(s,o){if(s.length<=10)return;const u=10+o,c=s[u];if(c){const h=c[17];null!==h&&h!==s&&DI(h,c),o>0&&(s[u-1][4]=c[4]);const g=An(s,10+o);!function lS(s,o){Fp(s,o,o[11],2,null,null),o[0]=null,o[6]=null}(c[1],c);const v=g[19];null!==v&&v.detachView(g[1]),c[3]=null,c[4]=null,c[2]&=-65}return c}function wv(s,o){if(!(128&o[2])){const u=o[11];u.destroyNode&&Fp(s,o,u,3,null,null),function hS(s){let o=s[13];if(!o)return Ev(s[1],s);for(;o;){let u=null;if(pr(o))u=o[13];else{const c=o[10];c&&(u=c)}if(!u){for(;o&&!o[4]&&o!==s;)pr(o)&&Ev(o[1],o),o=o[3];null===o&&(o=s),pr(o)&&Ev(o[1],o),u=o&&o[4]}o=u}}(o)}}function Ev(s,o){if(!(128&o[2])){o[2]&=-65,o[2]|=128,function TI(s,o){let u;if(null!=s&&null!=(u=s.destroyHooks))for(let c=0;c<u.length;c+=2){const h=o[u[c]];if(!(h instanceof $s)){const g=u[c+1];if(Array.isArray(g))for(let v=0;v<g.length;v+=2){const I=h[g[v]],C=g[v+1];try{C.call(I)}finally{}}else try{g.call(h)}finally{}}}}(s,o),function Iv(s,o){const u=s.cleanup,c=o[7];let h=-1;if(null!==u)for(let g=0;g<u.length-1;g+=2)if("string"==typeof u[g]){const v=u[g+1],I="function"==typeof v?v(o):kn(o[v]),C=c[h=u[g+2]],A=u[g+3];"boolean"==typeof A?I.removeEventListener(u[g],C,A):A>=0?c[h=A]():c[h=-A].unsubscribe(),g+=2}else{const v=c[h=u[g+1]];u[g].call(v)}if(null!==c){for(let g=h+1;g<c.length;g++)(0,c[g])();o[7]=null}}(s,o),1===o[1].type&&o[11].destroy();const u=o[17];if(null!==u&&qr(o[3])){u!==o[3]&&DI(u,o);const c=o[19];null!==c&&c.detachView(s)}!function vI(s){dd.delete(s[20])}(o)}}function Bm(s,o,u){return function Np(s,o,u){let c=o;for(;null!==c&&40&c.type;)c=(o=c).parent;if(null===c)return u[0];if(2&c.flags){const h=s.data[c.directiveStart].encapsulation;if(h===lt.None||h===lt.Emulated)return null}return Kr(c,u)}(s,o.parent,u)}function pd(s,o,u,c,h){s.insertBefore(o,u,c,h)}function SI(s,o,u){s.appendChild(o,u)}function AI(s,o,u,c,h){null!==c?pd(s,o,u,c,h):SI(s,o,u)}function kp(s,o){return s.parentNode(o)}let bv=function Op(s,o,u){return 40&s.type?Kr(s,u):null};function jm(s,o,u,c){const h=Bm(s,c,o),g=o[11],I=function Pp(s,o,u){return bv(s,o,u)}(c.parent||o[6],c,o);if(null!=h)if(Array.isArray(u))for(let C=0;C<u.length;C++)AI(g,h,u[C],I,!1);else AI(g,h,u,I,!1)}function Hm(s,o){if(null!==o){const u=o.type;if(3&u)return Kr(o,s);if(4&u)return Tv(-1,s[o.index]);if(8&u){const c=o.child;if(null!==c)return Hm(s,c);{const h=s[o.index];return qr(h)?Tv(-1,h):kn(h)}}if(32&u)return gv(o,s)()||kn(s[o.index]);{const c=RI(s,o);return null!==c?Array.isArray(c)?c[0]:Hm(xp(s[16]),c):Hm(s,o.next)}}return null}function RI(s,o){return null!==o?s[16][6].projection[o.projection]:null}function Tv(s,o){const u=10+s+1;if(u<o.length){const c=o[u],h=c[1].firstChild;if(null!==h)return Hm(c,h)}return o[7]}function Uh(s,o,u,c,h,g,v){for(;null!=u;){const I=c[u.index],C=u.type;if(v&&0===o&&(I&&Yr(kn(I),c),u.flags|=4),64!=(64&u.flags))if(8&C)Uh(s,o,u.child,c,h,g,!1),Lh(o,s,h,I,g);else if(32&C){const A=gv(u,c);let N;for(;N=A();)Lh(o,s,h,N,g);Lh(o,s,h,I,g)}else 16&C?NI(s,o,c,u,h,g):Lh(o,s,h,I,g);u=v?u.projectionNext:u.next}}function Fp(s,o,u,c,h,g){Uh(u,c,s.firstChild,o,h,g,!1)}function NI(s,o,u,c,h,g){const v=u[16],C=v[6].projection[c.projection];if(Array.isArray(C))for(let A=0;A<C.length;A++)Lh(o,s,h,C[A],g);else Uh(s,o,C,v[3],h,g,!0)}function kI(s,o,u){s.setAttribute(o,"style",u)}function Sv(s,o,u){""===u?s.removeAttribute(o,"class"):s.setAttribute(o,"class",u)}function Av(s,o,u){let c=s.length;for(;;){const h=s.indexOf(o,u);if(-1===h)return h;if(0===h||s.charCodeAt(h-1)<=32){const g=o.length;if(h+g===c||s.charCodeAt(h+g)<=32)return h}u=h+1}}const xv="ng-template";function PI(s,o,u){let c=0;for(;c<s.length;){let h=s[c++];if(u&&"class"===h){if(h=s[c],-1!==Av(h.toLowerCase(),o,0))return!0}else if(1===h){for(;c<s.length&&"string"==typeof(h=s[c++]);)if(h.toLowerCase()===o)return!0;return!1}}return!1}function Rv(s){return 4===s.type&&s.value!==xv}function OI(s,o,u){return o===(4!==s.type||u?s.value:xv)}function FI(s,o,u){let c=4;const h=s.attrs||[],g=function ES(s){for(let o=0;o<s.length;o++)if(Co(s[o]))return o;return s.length}(h);let v=!1;for(let I=0;I<o.length;I++){const C=o[I];if("number"!=typeof C){if(!v)if(4&c){if(c=2|1&c,""!==C&&!OI(s,C,u)||""===C&&1===o.length){if(Lo(c))return!1;v=!0}}else{const A=8&c?C:o[++I];if(8&c&&null!==s.attrs){if(!PI(s.attrs,A,u)){if(Lo(c))return!1;v=!0}continue}const L=vS(8&c?"class":C,h,Rv(s),u);if(-1===L){if(Lo(c))return!1;v=!0;continue}if(""!==A){let z;z=L>g?"":h[L+1].toLowerCase();const ne=8&c?z:null;if(ne&&-1!==Av(ne,A,0)||2&c&&A!==z){if(Lo(c))return!1;v=!0}}}}else{if(!v&&!Lo(c)&&!Lo(C))return!1;if(v&&Lo(C))continue;v=!1,c=C|1&c}}return Lo(c)||v}function Lo(s){return 0==(1&s)}function vS(s,o,u,c){if(null===o)return-1;let h=0;if(c||!u){let g=!1;for(;h<o.length;){const v=o[h];if(v===s)return h;if(3===v||6===v)g=!0;else{if(1===v||2===v){let I=o[++h];for(;"string"==typeof I;)I=o[++h];continue}if(4===v)break;if(0===v){h+=4;continue}}h+=g?1:2}return-1}return function IS(s,o){let u=s.indexOf(4);if(u>-1)for(u++;u<s.length;){const c=s[u];if("number"==typeof c)return-1;if(c===o)return u;u++}return-1}(o,s)}function LI(s,o,u=!1){for(let c=0;c<o.length;c++)if(FI(s,o[c],u))return!0;return!1}function $m(s,o){return s?":not("+o.trim()+")":o}function UI(s){let o=s[0],u=1,c=2,h="",g=!1;for(;u<s.length;){let v=s[u];if("string"==typeof v)if(2&c){const I=s[++u];h+="["+v+(I.length>0?'="'+I+'"':"")+"]"}else 8&c?h+="."+v:4&c&&(h+=" "+v);else""!==h&&!Lo(v)&&(o+=$m(g,h),h=""),c=v,g=g||!Lo(c);u++}return""!==h&&(o+=$m(g,h)),o}const Vt={};function jI(s){HI(Wt(),Ae(),ur()+s,!1)}function HI(s,o,u,c){if(!c)if(3==(3&o[2])){const g=s.preOrderCheckHooks;null!==g&&Eo(o,g,u)}else{const g=s.preOrderHooks;null!==g&&Yo(o,g,0,u)}ai(u)}function zI(s,o=null,u=null,c){const h=qI(s,o,u,c);return h.resolveInjectorInitializers(),h}function qI(s,o=null,u=null,c,h=new Set){const g=[u||At,Rh(s)];return c=c||("object"==typeof s?void 0:pe(s)),new od(g,o||Mh(),c||null,h)}let md=(()=>{class s{static create(u,c){if(Array.isArray(u))return zI({name:""},c,u,"");{const h=u.name??"";return zI({name:h},u.parent,u.providers,h)}}}return s.THROW_IF_NOT_FOUND=Zr,s.NULL=new Mm,s.\u0275prov=nn({token:s,providedIn:"any",factory:()=>$n(vp)}),s.__NG_ELEMENT_ID__=-1,s})();function Up(s,o=Ye.Default){const u=Ae();return null===u?$n(s,o):Do(Pn(),u,Y(s),o)}function Uv(){throw new Error("invalid")}function Ym(s,o){return s<<17|o<<2}function Js(s){return s>>17&32767}function Bv(s){return 2|s}function Su(s){return(131068&s)>>2}function jv(s,o){return-131069&s|o<<2}function $v(s){return 1|s}function Hp(s,o){const u=s.contentQueries;if(null!==u)for(let c=0;c<u.length;c+=2){const h=u[c],g=u[c+1];if(-1!==g){const v=s.data[g];eu(h),v.contentQueries(2,o[g],g)}}}function _d(s,o,u,c,h,g,v,I,C,A,N){const L=o.blueprint.slice();return L[0]=h,L[2]=76|c,(null!==N||s&&1024&s[2])&&(L[2]|=1024),rl(L),L[3]=L[15]=s,L[8]=u,L[10]=v||s&&s[10],L[11]=I||s&&s[11],L[12]=C||s&&s[12]||null,L[9]=A||s&&s[9]||null,L[6]=g,L[20]=function QT(){return YT++}(),L[21]=N,L[16]=2==o.type?s[16]:L,L}function Li(s,o,u,c,h){let g=s.data[o];if(null===g)g=function $p(s,o,u,c,h){const g=ll(),v=Za(),C=s.data[o]=function FS(s,o,u,c,h,g){return{type:u,index:c,insertBeforeIndex:null,injectorIndex:o?o.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:h,attrs:g,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,v?g:g&&g.parent,u,o,c,h);return null===s.firstChild&&(s.firstChild=C),null!==g&&(v?null==g.child&&null!==C.parent&&(g.child=C):null===g.next&&(g.next=C)),C}(s,o,u,c,h),function mm(){return xt.lFrame.inI18n}()&&(g.flags|=64);else if(64&g.type){g.type=u,g.value=c,g.attrs=h;const v=function Zo(){const s=xt.lFrame,o=s.currentTNode;return s.isParent?o:o.parent}();g.injectorIndex=null===v?-1:v.injectorIndex}return wi(g,!0),g}function $h(s,o,u,c){if(0===u)return-1;const h=o.length;for(let g=0;g<u;g++)o.push(c),s.blueprint.push(c),s.data.push(null);return h}function Jv(s,o,u){hl(o);try{const c=s.viewQuery;null!==c&&gw(1,c,u);const h=s.template;null!==h&&Xv(s,o,h,1,u),s.firstCreatePass&&(s.firstCreatePass=!1),s.staticContentQueries&&Hp(s,o),s.staticViewQueries&&gw(2,s.viewQuery,u);const g=s.components;null!==g&&function Qv(s,o){for(let u=0;u<o.length;u++)o_(s,o[u])}(o,g)}catch(c){throw s.firstCreatePass&&(s.incompleteFirstPass=!0,s.firstCreatePass=!1),c}finally{o[2]&=-5,vo()}}function xu(s,o,u,c){const h=o[2];if(128!=(128&h)){hl(o);try{rl(o),function Nc(s){return xt.lFrame.bindingIndex=s}(s.bindingStartIndex),null!==u&&Xv(s,o,u,2,c);const v=3==(3&h);if(v){const A=s.preOrderCheckHooks;null!==A&&Eo(o,A,null)}else{const A=s.preOrderHooks;null!==A&&Yo(o,A,0,null),gh(o,0)}if(function hw(s){for(let o=mv(s);null!==o;o=_v(o)){if(!o[2])continue;const u=o[9];for(let c=0;c<u.length;c++){const h=u[c],g=h[3];0==(512&h[2])&&xn(g,1),h[2]|=512}}}(o),function dw(s){for(let o=mv(s);null!==o;o=_v(o))for(let u=10;u<o.length;u++){const c=o[u],h=c[1];_o(c)&&xu(h,c,h.template,c[8])}}(o),null!==s.contentQueries&&Hp(s,o),v){const A=s.contentCheckHooks;null!==A&&Eo(o,A)}else{const A=s.contentHooks;null!==A&&Yo(o,A,1),gh(o,1)}!function OS(s,o){const u=s.hostBindingOpCodes;if(null!==u)try{for(let c=0;c<u.length;c++){const h=u[c];if(h<0)ai(~h);else{const g=h,v=u[++c],I=u[++c];_m(v,g),I(2,o[g])}}}finally{ai(-1)}}(s,o);const I=s.components;null!==I&&function uC(s,o){for(let u=0;u<o.length;u++)Qr(s,o[u])}(o,I);const C=s.viewQuery;if(null!==C&&gw(2,C,c),v){const A=s.viewCheckHooks;null!==A&&Eo(o,A)}else{const A=s.viewHooks;null!==A&&Yo(o,A,2),gh(o,2)}!0===s.firstUpdatePass&&(s.firstUpdatePass=!1),o[2]&=-41,512&o[2]&&(o[2]&=-513,xn(o[3],-1))}finally{vo()}}}function Xv(s,o,u,c,h){const g=ur(),v=2&c;try{ai(-1),v&&o.length>22&&HI(s,o,22,!1),u(c,h)}finally{ai(g)}}function e_(s,o,u){!hs()||(function fC(s,o,u,c){const h=u.directiveStart,g=u.directiveEnd;s.firstCreatePass||bo(u,o),Yr(c,o);const v=u.initialInputs;for(let I=h;I<g;I++){const C=s.data[I],A=Mr(C);A&&US(o,u,C);const N=ps(o,s,I,u);Yr(N,o),null!==v&&cw(0,I-h,N,C,0,v),A&&(Kt(u.index,o)[8]=N)}}(s,o,u,Kr(u,o)),128==(128&u.flags)&&function pC(s,o,u){const c=u.directiveStart,h=u.directiveEnd,g=u.index,v=function kc(){return xt.lFrame.currentDirectiveIndex}();try{ai(g);for(let I=c;I<h;I++){const C=s.data[I],A=o[I];cl(I),(null!==C.hostBindings||0!==C.hostVars||null!==C.hostAttrs)&&Wp(C,A)}}finally{ai(-1),cl(v)}}(s,o,u))}function ew(s,o,u=Kr){const c=o.localNames;if(null!==c){let h=o.index+1;for(let g=0;g<c.length;g+=2){const v=c[g+1],I=-1===v?u(o,s):s[v];s[h++]=I}}}function tw(s){const o=s.tView;return null===o||o.incompleteFirstPass?s.tView=Gh(1,null,s.template,s.decls,s.vars,s.directiveDefs,s.pipeDefs,s.viewQuery,s.schemas,s.consts):o}function Gh(s,o,u,c,h,g,v,I,C,A){const N=22+c,L=N+h,z=function nw(s,o){const u=[];for(let c=0;c<o;c++)u.push(c<s?null:Vt);return u}(N,L),ne="function"==typeof A?A():A;return z[1]={type:s,blueprint:z,template:u,queries:null,viewQuery:I,declTNode:o,data:z.slice().fill(null,N),bindingStartIndex:N,expandoStartIndex:L,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof g?g():g,pipeRegistry:"function"==typeof v?v():v,firstChild:null,schemas:C,consts:ne,incompleteFirstPass:!1}}function cC(s,o,u,c){const h=u_(o);null===u?h.push(c):(h.push(u),s.firstCreatePass&&mC(s).push(c,h.length-1))}function t_(s,o,u){for(let c in s)if(s.hasOwnProperty(c)){const h=s[c];(u=null===u?{}:u).hasOwnProperty(c)?u[c].push(o,h):u[c]=[o,h]}return u}function iw(s,o){const c=o.directiveEnd,h=s.data,g=o.attrs,v=[];let I=null,C=null;for(let A=o.directiveStart;A<c;A++){const N=h[A],L=N.inputs,z=null===g||Rv(o)?null:gC(L,g);v.push(z),I=t_(L,A,I),C=t_(N.outputs,A,C)}null!==I&&(I.hasOwnProperty("class")&&(o.flags|=16),I.hasOwnProperty("style")&&(o.flags|=32)),o.initialInputs=v,o.inputs=I,o.outputs=C}function dC(s,o){const u=Kt(o,s);16&u[2]||(u[2]|=32)}function Wh(s,o,u,c){let h=!1;if(hs()){const g=function sw(s,o,u){const c=s.directiveRegistry;let h=null;if(c)for(let g=0;g<c.length;g++){const v=c[g];LI(u,v.selectors,!1)&&(h||(h=[]),Gs(bo(u,o),s,v.type),Mr(v)?(r_(s,u),h.unshift(v)):h.push(v))}return h}(s,o,u),v=null===c?null:{"":-1};if(null!==g){h=!0,uw(u,s.data.length,g.length);for(let N=0;N<g.length;N++){const L=g[N];L.providersResolver&&L.providersResolver(L)}let I=!1,C=!1,A=$h(s,o,g.length,null);for(let N=0;N<g.length;N++){const L=g[N];u.mergedAttrs=tu(u.mergedAttrs,L.hostAttrs),lw(s,u,o,A,L),aw(A,L,v),null!==L.contentQueries&&(u.flags|=8),(null!==L.hostBindings||null!==L.hostAttrs||0!==L.hostVars)&&(u.flags|=128);const z=L.type.prototype;!I&&(z.ngOnChanges||z.ngOnInit||z.ngDoCheck)&&((s.preOrderHooks||(s.preOrderHooks=[])).push(u.index),I=!0),!C&&(z.ngOnChanges||z.ngDoCheck)&&((s.preOrderCheckHooks||(s.preOrderCheckHooks=[])).push(u.index),C=!0),A++}iw(s,u)}v&&function ow(s,o,u){if(o){const c=s.localNames=[];for(let h=0;h<o.length;h+=2){const g=u[o[h+1]];if(null==g)throw new Ce(-301,!1);c.push(o[h],g)}}}(u,c,v)}return u.mergedAttrs=tu(u.mergedAttrs,u.attrs),h}function n_(s,o,u,c,h,g){const v=g.hostBindings;if(v){let I=s.hostBindingOpCodes;null===I&&(I=s.hostBindingOpCodes=[]);const C=~o.index;(function hC(s){let o=s.length;for(;o>0;){const u=s[--o];if("number"==typeof u&&u<0)return u}return 0})(I)!=C&&I.push(C),I.push(c,h,v)}}function Wp(s,o){null!==s.hostBindings&&s.hostBindings(1,o)}function r_(s,o){o.flags|=2,(s.components||(s.components=[])).push(o.index)}function aw(s,o,u){if(u){if(o.exportAs)for(let c=0;c<o.exportAs.length;c++)u[o.exportAs[c]]=s;Mr(o)&&(u[""]=s)}}function uw(s,o,u){s.flags|=1,s.directiveStart=o,s.directiveEnd=o+u,s.providerIndexes=o}function lw(s,o,u,c,h){s.data[c]=h;const g=h.factory||(h.factory=Wi(h.type)),v=new $s(g,Mr(h),Up);s.blueprint[c]=v,u[c]=v,n_(s,o,0,c,$h(s,u,h.hostVars,Vt),h)}function US(s,o,u){const c=Kr(o,s),h=tw(u),g=s[10],v=a_(s,_d(s,h,null,u.onPush?32:16,c,o,g,g.createRenderer(c,u),null,null,null));s[o.index]=v}function Vo(s,o,u,c,h,g){const v=Kr(s,o);!function i_(s,o,u,c,h,g,v){if(null==g)s.removeAttribute(o,h,u);else{const I=null==v?ye(g):v(g,c||"",h);s.setAttribute(o,h,I,u)}}(o[11],v,g,s.value,u,c,h)}function cw(s,o,u,c,h,g){const v=g[o];if(null!==v){const I=c.setInput;for(let C=0;C<v.length;){const A=v[C++],N=v[C++],L=v[C++];null!==I?c.setInput(u,L,A,N):u[N]=L}}}function gC(s,o){let u=null,c=0;for(;c<o.length;){const h=o[c];if(0!==h)if(5!==h){if("number"==typeof h)break;s.hasOwnProperty(h)&&(null===u&&(u=[]),u.push(h,s[h],o[c+1])),c+=2}else c+=2;else c+=4}return u}function s_(s,o,u,c){return new Array(s,!0,!1,o,null,0,c,u,null,null)}function Qr(s,o){const u=Kt(o,s);if(_o(u)){const c=u[1];48&u[2]?xu(c,u,c.template,u[8]):u[5]>0&&Vr(u)}}function Vr(s){for(let c=mv(s);null!==c;c=_v(c))for(let h=10;h<c.length;h++){const g=c[h];if(_o(g))if(512&g[2]){const v=g[1];xu(v,g,v.template,g[8])}else g[5]>0&&Vr(g)}const u=s[1].components;if(null!==u)for(let c=0;c<u.length;c++){const h=Kt(u[c],s);_o(h)&&h[5]>0&&Vr(h)}}function o_(s,o){const u=Kt(o,s),c=u[1];(function fw(s,o){for(let u=o.length;u<s.blueprint.length;u++)o.push(s.blueprint[u])})(c,u),Jv(c,u,u[8])}function a_(s,o){return s[13]?s[14][4]=o:s[13]=o,s[14]=o,o}function pw(s){for(;s;){s[2]|=32;const o=xp(s);if(Kf(s)&&!o)return s;s=o}return null}function zp(s,o,u,c=!0){const h=o[10];h.begin&&h.begin();try{xu(s,o,s.template,u)}catch(v){throw c&&mw(o,v),v}finally{h.end&&h.end()}}function gw(s,o,u){eu(0),o(s,u)}function u_(s){return s[7]||(s[7]=[])}function mC(s){return s.cleanup||(s.cleanup=[])}function mw(s,o){const u=s[9],c=u?u.get(kh,null):null;c&&c.handleError(o)}function _w(s,o,u,c,h){for(let g=0;g<u.length;){const v=u[g++],I=u[g++],C=o[v],A=s.data[v];null!==A.setInput?A.setInput(C,h,c,I):C[I]=h}}function zh(s,o,u){let c=u?s.styles:null,h=u?s.classes:null,g=0;if(null!==o)for(let v=0;v<o.length;v++){const I=o[v];"number"==typeof I?g=I:1==g?h=ge(h,I):2==g&&(c=ge(c,I+": "+o[++v]+";"))}u?s.styles=c:s.stylesWithoutHost=c,u?s.classes=h:s.classesWithoutHost=h}function qh(s,o,u,c,h=!1){for(;null!==u;){const g=o[u.index];if(null!==g&&c.push(kn(g)),qr(g))for(let I=10;I<g.length;I++){const C=g[I],A=C[1].firstChild;null!==A&&qh(C[1],C,A,c)}const v=u.type;if(8&v)qh(s,o,u.child,c);else if(32&v){const I=gv(u,o);let C;for(;C=I();)c.push(C)}else if(16&v){const I=RI(o,u);if(Array.isArray(I))c.push(...I);else{const C=xp(o[16]);qh(C[1],C,I,c,!0)}}u=h?u.projectionNext:u.next}return c}class Kh{constructor(o,u){this._lView=o,this._cdRefInjectingView=u,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const o=this._lView,u=o[1];return qh(u,o,u.firstChild,[])}get context(){return this._lView[8]}set context(o){this._lView[8]=o}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[3];if(qr(o)){const u=o[8],c=u?u.indexOf(this):-1;c>-1&&(vv(o,c),An(u,c))}this._attachedToViewContainer=!1}wv(this._lView[1],this._lView)}onDestroy(o){cC(this._lView[1],this._lView,null,o)}markForCheck(){pw(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){zp(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ce(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function dS(s,o){Fp(s,o,o[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new Ce(902,!1);this._appRef=o}}class jS extends Kh{constructor(o){super(o),this._view=o}detectChanges(){const o=this._view;zp(o[1],o,o[8],!1)}checkNoChanges(){}get context(){return null}}class yd extends Oo{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const u=J(o);return new Hl(u,this.ngModule)}}function yw(s){const o=[];for(let u in s)s.hasOwnProperty(u)&&o.push({propName:s[u],templateName:u});return o}class yC{constructor(o,u){this.injector=o,this.parentInjector=u}get(o,u,c){const h=this.injector.get(o,wt,c);return h!==wt||u===wt?h:this.parentInjector.get(o,u,c)}}class Hl extends bp{constructor(o,u){super(),this.componentDef=o,this.ngModule=u,this.componentType=o.type,this.selector=function BI(s){return s.map(UI).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!u}get inputs(){return yw(this.componentDef.inputs)}get outputs(){return yw(this.componentDef.outputs)}create(o,u,c,h){let g=(h=h||this.ngModule)instanceof lr?h:h?.injector;g&&null!==this.componentDef.getStandaloneInjector&&(g=this.componentDef.getStandaloneInjector(g)||g);const v=g?new yC(o,g):o,I=v.get(x,null);if(null===I)throw new Ce(407,!1);const C=v.get(le,null),A=I.createRenderer(null,this.componentDef),N=this.componentDef.selectors[0][0]||"div",L=c?function rw(s,o,u){return s.selectRootElement(o,u===lt.ShadowDom)}(A,c,this.componentDef.encapsulation):yv(A,N,function _C(s){const o=s.toLowerCase();return"svg"===o?"svg":"math"===o?"math":null}(N)),z=this.componentDef.onPush?288:272,ne=Gh(0,null,null,1,0,null,null,null,null,null),Ee=_d(null,ne,null,z,null,null,I,A,C,v,null);let Oe,We;hl(Ee);try{const st=function $S(s,o,u,c,h,g){const v=u[1];u[22]=s;const C=Li(v,22,2,"#host",null),A=C.mergedAttrs=o.hostAttrs;null!==A&&(zh(C,A,!0),null!==s&&(Xo(h,s,A),null!==C.classes&&Sv(h,s,C.classes),null!==C.styles&&kI(h,s,C.styles)));const N=c.createRenderer(s,o),L=_d(u,tw(o),null,o.onPush?32:16,u[22],C,c,N,g||null,null,null);return v.firstCreatePass&&(Gs(bo(C,u),v,o.type),r_(v,C),uw(C,u.length,1)),a_(u,L),u[22]=L}(L,this.componentDef,Ee,I,A);if(L)if(c)Xo(A,L,["ng-version",Qe.full]);else{const{attrs:mt,classes:De}=function EN(s){const o=[],u=[];let c=1,h=2;for(;c<s.length;){let g=s[c];if("string"==typeof g)2===h?""!==g&&o.push(g,s[++c]):8===h&&u.push(g);else{if(!Lo(h))break;h=g}c++}return{attrs:o,classes:u}}(this.componentDef.selectors[0]);mt&&Xo(A,L,mt),De&&De.length>0&&Sv(A,L,De.join(" "))}if(We=mo(ne,22),void 0!==u){const mt=We.projection=[];for(let De=0;De<this.ngContentSelectors.length;De++){const Dt=u[De];mt.push(null!=Dt?Array.from(Dt):null)}}Oe=function vd(s,o,u,c){const h=u[1],g=function VS(s,o,u){const c=Pn();s.firstCreatePass&&(u.providersResolver&&u.providersResolver(u),lw(s,c,o,$h(s,o,1,null),u),iw(s,c));const h=ps(o,s,c.directiveStart,c);Yr(h,o);const g=Kr(c,o);return g&&Yr(g,o),h}(h,u,o);if(s[8]=u[8]=g,null!==c)for(const I of c)I(g,o);if(o.contentQueries){const I=Pn();o.contentQueries(1,g,I.directiveStart)}const v=Pn();return!h.firstCreatePass||null===o.hostBindings&&null===o.hostAttrs||(ai(v.index),n_(u[1],v,0,v.directiveStart,v.directiveEnd,o),Wp(o,g)),g}(st,this.componentDef,Ee,[vC]),Jv(ne,Ee,null)}finally{vo()}return new Zh(this.componentType,Oe,y(We,Ee),Ee,We)}}class Zh extends class Du{}{constructor(o,u,c,h,g){super(),this.location=c,this._rootLView=h,this._tNode=g,this.instance=u,this.hostView=this.changeDetectorRef=new jS(h),this.componentType=o}setInput(o,u){const c=this._tNode.inputs;let h;if(null!==c&&(h=c[o])){const g=this._rootLView;_w(g[1],g,h,o,u),dC(g,this._tNode.index)}}get injector(){return new To(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}function vC(){const s=Pn();gl(Ae()[1],s)}function c_(s){let o=function qp(s){return Object.getPrototypeOf(s.prototype).constructor}(s.type),u=!0;const c=[s];for(;o;){let h;if(Mr(s))h=o.\u0275cmp||o.\u0275dir;else{if(o.\u0275cmp)throw new Ce(903,!1);h=o.\u0275dir}if(h){if(u){c.push(h);const v=s;v.inputs=d_(s.inputs),v.declaredInputs=d_(s.declaredInputs),v.outputs=d_(s.outputs);const I=h.hostBindings;I&&Zp(s,I);const C=h.viewQuery,A=h.contentQueries;if(C&&Vi(s,C),A&&wC(s,A),ce(s.inputs,h.inputs),ce(s.declaredInputs,h.declaredInputs),ce(s.outputs,h.outputs),Mr(h)&&h.data.animation){const N=s.data;N.animation=(N.animation||[]).concat(h.data.animation)}}const g=h.features;if(g)for(let v=0;v<g.length;v++){const I=g[v];I&&I.ngInherit&&I(s),I===c_&&(u=!1)}}o=Object.getPrototypeOf(o)}!function Kp(s){let o=0,u=null;for(let c=s.length-1;c>=0;c--){const h=s[c];h.hostVars=o+=h.hostVars,h.hostAttrs=tu(h.hostAttrs,u=tu(u,h.hostAttrs))}}(c)}function d_(s){return s===ii?{}:s===At?[]:s}function Vi(s,o){const u=s.viewQuery;s.viewQuery=u?(c,h)=>{o(c,h),u(c,h)}:o}function wC(s,o){const u=s.contentQueries;s.contentQueries=u?(c,h,g)=>{o(c,h,g),u(c,h,g)}:o}function Zp(s,o){const u=s.hostBindings;s.hostBindings=u?(c,h)=>{o(c,h),u(c,h)}:o}let Yp=null;function $l(){if(!Yp){const s=ln.Symbol;if(s&&s.iterator)Yp=s.iterator;else{const o=Object.getOwnPropertyNames(Map.prototype);for(let u=0;u<o.length;++u){const c=o[u];"entries"!==c&&"size"!==c&&Map.prototype[c]===Map.prototype.entries&&(Yp=c)}}}return Yp}function wd(s){return!!Yh(s)&&(Array.isArray(s)||!(s instanceof Map)&&$l()in s)}function Yh(s){return null!==s&&("function"==typeof s||"object"==typeof s)}function Uo(s,o,u){return s[o]=u}function Jr(s,o,u){return!Object.is(s[o],u)&&(s[o]=u,!0)}function p_(s,o,u,c){const h=Ae();return Jr(h,yo(),o)&&(Wt(),Vo(bn(),h,s,o,u,c)),p_}function ef(s,o,u,c,h,g,v,I){const C=Ae(),A=Wt(),N=s+22,L=A.firstCreatePass?function g_(s,o,u,c,h,g,v,I,C){const A=o.consts,N=Li(o,s,4,v||null,Ni(A,I));Wh(o,u,N,Ni(A,C)),gl(o,N);const L=N.tViews=Gh(2,N,c,h,g,o.directiveRegistry,o.pipeRegistry,null,o.schemas,A);return null!==o.queries&&(o.queries.template(o,N),L.queries=o.queries.embeddedTView(N)),N}(N,A,C,o,u,c,h,g,v):A.data[N];wi(L,!1);const z=C[11].createComment("");jm(A,C,z,L),Yr(z,C),a_(C,C[N]=s_(z,C,z,L)),Cc(L)&&e_(A,C,L),null!=v&&ew(C,L,I)}function bC(s){return function ds(s,o){return s[o]}(function Mc(){return xt.lFrame.contextLView}(),22+s)}function m_(s,o,u){const c=Ae();return Jr(c,yo(),o)&&function hi(s,o,u,c,h,g,v,I){const C=Kr(o,u);let N,A=o.inputs;!I&&null!=A&&(N=A[c])?(_w(s,u,N,c,h),Wa(o)&&dC(u,o.index)):3&o.type&&(c=function LS(s){return"class"===s?"className":"for"===s?"htmlFor":"formaction"===s?"formAction":"innerHtml"===s?"innerHTML":"readonly"===s?"readOnly":"tabindex"===s?"tabIndex":s}(c),h=null!=v?v(h,o.value||"",c):h,g.setProperty(C,c,h))}(Wt(),bn(),c,s,o,c[11],u,!1),m_}function Dw(s,o,u,c,h){const v=h?"class":"style";_w(s,u,o.inputs[v],v,c)}function __(s,o,u,c){const h=Ae(),g=Wt(),v=22+s,I=h[11],C=h[v]=yv(I,o,function pl(){return xt.lFrame.currentNamespace}()),A=g.firstCreatePass?function GS(s,o,u,c,h,g,v){const I=o.consts,A=Li(o,s,2,h,Ni(I,g));return Wh(o,u,A,Ni(I,v)),null!==A.attrs&&zh(A,A.attrs,!1),null!==A.mergedAttrs&&zh(A,A.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,A),A}(v,g,h,0,o,u,c):g.data[v];wi(A,!0);const N=A.mergedAttrs;null!==N&&Xo(I,C,N);const L=A.classes;null!==L&&Sv(I,C,L);const z=A.styles;return null!==z&&kI(I,C,z),64!=(64&A.flags)&&jm(g,h,C,A),0===function sl(){return xt.lFrame.elementDepthCount}()&&Yr(C,h),function ol(){xt.lFrame.elementDepthCount++}(),Cc(A)&&(e_(g,h,A),function Xm(s,o,u){if(Yu(o)){const h=o.directiveEnd;for(let g=o.directiveStart;g<h;g++){const v=s.data[g];v.contentQueries&&v.contentQueries(1,u[g],g)}}}(g,A,h)),null!==c&&ew(h,A),__}function y_(){let s=Pn();Za()?function Ya(){xt.lFrame.isParent=!1}():(s=s.parent,wi(s,!1));const o=s;!function Ac(){xt.lFrame.elementDepthCount--}();const u=Wt();return u.firstCreatePass&&(gl(u,s),Yu(s)&&u.queries.elementEnd(s)),null!=o.classesWithoutHost&&function yl(s){return 0!=(16&s.flags)}(o)&&Dw(u,o,Ae(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function _h(s){return 0!=(32&s.flags)}(o)&&Dw(u,o,Ae(),o.stylesWithoutHost,!1),y_}function Cd(s,o,u,c){return __(s,o,u,c),y_(),Cd}function bd(){return Ae()}function Sw(s){return!!s&&"function"==typeof s.then}function DC(s){return!!s&&"function"==typeof s.subscribe}const Aw=DC;function xw(s,o,u,c){const h=Ae(),g=Wt(),v=Pn();return function E_(s,o,u,c,h,g,v,I){const C=Cc(c),N=s.firstCreatePass&&mC(s),L=o[8],z=u_(o);let ne=!0;if(3&c.type||I){const We=Kr(c,o),st=I?I(We):We,mt=z.length,De=I?Xt=>I(kn(Xt[c.index])):c.index;let Dt=null;if(!I&&C&&(Dt=function TC(s,o,u,c){const h=s.cleanup;if(null!=h)for(let g=0;g<h.length-1;g+=2){const v=h[g];if(v===u&&h[g+1]===c){const I=o[7],C=h[g+2];return I.length>C?I[C]:null}"string"==typeof v&&(g+=2)}return null}(s,o,h,c.index)),null!==Dt)(Dt.__ngLastListenerFn__||Dt).__ngNextListenerFn__=g,Dt.__ngLastListenerFn__=g,ne=!1;else{g=Mw(c,o,L,g,!1);const Xt=u.listen(st,h,g);z.push(g,Xt),N&&N.push(h,De,mt,mt+1)}}else g=Mw(c,o,L,g,!1);const Ee=c.outputs;let Oe;if(ne&&null!==Ee&&(Oe=Ee[h])){const We=Oe.length;if(We)for(let st=0;st<We;st+=2){const En=o[Oe[st]][Oe[st+1]].subscribe(g),uc=z.length;z.push(g,En),N&&N.push(h,c.index,uc,-(uc+1))}}}(g,h,h[11],v,s,o,0,c),xw}function I_(s,o,u,c){try{return!1!==u(c)}catch(h){return mw(s,h),!1}}function Mw(s,o,u,c,h){return function g(v){if(v===Function)return c;pw(2&s.flags?Kt(s.index,o):o);let C=I_(o,0,c,v),A=g.__ngNextListenerFn__;for(;A;)C=I_(o,0,A,v)&&C,A=A.__ngNextListenerFn__;return h&&!1===C&&(v.preventDefault(),v.returnValue=!1),C}}function Nw(s=1){return function wo(s){return(xt.lFrame.contextLView=function fl(s,o){for(;s>0;)o=o[15],s--;return o}(s,xt.lFrame.contextLView))[8]}(s)}function xC(s,o,u,c,h){const g=s[u+1],v=null===o;let I=c?Js(g):Su(g),C=!1;for(;0!==I&&(!1===C||v);){const N=s[I+1];RC(s[I],o)&&(C=!0,s[I+1]=c?$v(N):Bv(N)),I=c?Js(N):Su(N)}C&&(s[u+1]=c?Bv(g):$v(g))}function RC(s,o){return null===s||null==o||(Array.isArray(s)?s[1]:s)===o||!(!Array.isArray(s)||"string"!=typeof o)&&qs(s,o)>=0}function Dd(s,o){return function io(s,o,u,c){const h=Ae(),g=Wt(),v=function fs(s){const o=xt.lFrame,u=o.bindingIndex;return o.bindingIndex=o.bindingIndex+s,u}(2);g.firstUpdatePass&&function jw(s,o,u,c){const h=s.data;if(null===h[u+1]){const g=h[ur()],v=function Bw(s,o){return o>=s.expandoStartIndex}(s,u);(function jC(s,o){return 0!=(s.flags&(o?16:32))})(g,c)&&null===o&&!v&&(o=!1),o=function Td(s,o,u,c){const h=function Xa(s){const o=xt.lFrame.currentDirectiveIndex;return-1===o?null:s[o]}(s);let g=c?o.residualClasses:o.residualStyles;if(null===h)0===(c?o.classBindings:o.styleBindings)&&(u=ql(u=T_(null,s,o,u,c),o.attrs,c),g=null);else{const v=o.directiveStylingLast;if(-1===v||s[v]!==h)if(u=T_(h,s,o,u,c),null===g){let C=function FC(s,o,u){const c=u?o.classBindings:o.styleBindings;if(0!==Su(c))return s[Js(c)]}(s,o,c);void 0!==C&&Array.isArray(C)&&(C=T_(null,s,o,C[1],c),C=ql(C,o.attrs,c),function LC(s,o,u,c){s[Js(u?o.classBindings:o.styleBindings)]=c}(s,o,c,C))}else g=function VC(s,o,u){let c;const h=o.directiveEnd;for(let g=1+o.directiveStylingLast;g<h;g++)c=ql(c,s[g].hostAttrs,u);return ql(c,o.attrs,u)}(s,o,c)}return void 0!==g&&(c?o.residualClasses=g:o.residualStyles=g),u}(h,g,o,c),function KS(s,o,u,c,h,g){let v=g?o.classBindings:o.styleBindings,I=Js(v),C=Su(v);s[c]=u;let N,A=!1;if(Array.isArray(u)){const L=u;N=L[1],(null===N||qs(L,N)>0)&&(A=!0)}else N=u;if(h)if(0!==C){const z=Js(s[I+1]);s[c+1]=Ym(z,I),0!==z&&(s[z+1]=jv(s[z+1],c)),s[I+1]=function NS(s,o){return 131071&s|o<<17}(s[I+1],c)}else s[c+1]=Ym(I,0),0!==I&&(s[I+1]=jv(s[I+1],c)),I=c;else s[c+1]=Ym(C,0),0===I?I=c:s[C+1]=jv(s[C+1],c),C=c;A&&(s[c+1]=Bv(s[c+1])),xC(s,N,c,!0),xC(s,N,c,!1),function ZS(s,o,u,c,h){const g=h?s.residualClasses:s.residualStyles;null!=g&&"string"==typeof o&&qs(g,o)>=0&&(u[c+1]=$v(u[c+1]))}(o,N,s,c,g),v=Ym(I,C),g?o.classBindings=v:o.styleBindings=v}(h,g,o,u,v,c)}}(g,s,v,c),o!==Vt&&Jr(h,v,o)&&function Sd(s,o,u,c,h,g,v,I){if(!(3&o.type))return;const C=s.data,A=C[I+1];S_(function Hv(s){return 1==(1&s)}(A)?BC(C,o,u,h,Su(A),v):void 0)||(S_(g)||function eC(s){return 2==(2&s)}(A)&&(g=BC(C,null,u,h,I,v)),function yS(s,o,u,c,h){if(o)h?s.addClass(u,c):s.removeClass(u,c);else{let g=-1===c.indexOf("-")?void 0:Fi.DashCase;null==h?s.removeStyle(u,c,g):("string"==typeof h&&h.endsWith("!important")&&(h=h.slice(0,-10),g|=Fi.Important),s.setStyle(u,c,h,g))}}(c,v,vi(ur(),u),h,g))}(g,g.data[ur()],h,h[11],s,h[v+1]=function $w(s,o){return null==s||("string"==typeof o?s+=o:"object"==typeof s&&(s=pe(Ei(s)))),s}(o,u),c,v)}(s,o,null,!0),Dd}function T_(s,o,u,c,h){let g=null;const v=u.directiveEnd;let I=u.directiveStylingLast;for(-1===I?I=u.directiveStart:I++;I<v&&(g=o[I],c=ql(c,g.hostAttrs,h),g!==s);)I++;return null!==s&&(u.directiveStylingLast=I),c}function ql(s,o,u){const c=u?1:2;let h=-1;if(null!==o)for(let g=0;g<o.length;g++){const v=o[g];"number"==typeof v?h=v:h===c&&(Array.isArray(s)||(s=void 0===s?[]:["",s]),ci(s,v,!!u||o[++g]))}return void 0===s?null:s}function BC(s,o,u,c,h,g){const v=null===o;let I;for(;h>0;){const C=s[h],A=Array.isArray(C),N=A?C[1]:C,L=null===N;let z=u[h+1];z===Vt&&(z=L?At:void 0);let ne=L?du(z,c):N===c?z:void 0;if(A&&!S_(ne)&&(ne=du(C,c)),S_(ne)&&(I=ne,v))return I;const Ee=s[h+1];h=v?Js(Ee):Su(Ee)}if(null!==o){let C=g?o.residualClasses:o.residualStyles;null!=C&&(I=du(C,c))}return I}function S_(s){return void 0!==s}function HC(s,o=""){const u=Ae(),c=Wt(),h=s+22,g=c.firstCreatePass?Li(c,h,1,o,null):c.data[h],v=u[h]=function Rp(s,o){return s.createText(o)}(u[11],o);jm(c,u,v,g),wi(g,!1)}function A_(s){return x_("",s,""),A_}function x_(s,o,u){const c=Ae(),h=function Jh(s,o,u,c){return Jr(s,yo(),u)?o+ye(u)+c:Vt}(c,s,o,u);return h!==Vt&&function to(s,o,u){const c=vi(o,s);!function Mp(s,o,u){s.setValue(o,u)}(s[11],c,u)}(c,ur(),h),x_}const Md=void 0;var qe=["en",[["a","p"],["AM","PM"],Md],[["AM","PM"],Md,Md],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Md,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Md,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Md,"{1} 'at' {0}",Md],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function cr(s){const u=Math.floor(Math.abs(s)),c=s.toString().replace(/^[^.]*\.?/,"").length;return 1===u&&0===c?1:5}];let Nu={};function ku(s){const o=function QC(s){return s.toLowerCase().replace(/_/g,"-")}(s);let u=YC(o);if(u)return u;const c=o.split("-")[0];if(u=YC(c),u)return u;if("en"===c)return qe;throw new Ce(701,!1)}function og(s){return ku(s)[Ct.PluralCase]}function YC(s){return s in Nu||(Nu[s]=ln.ng&&ln.ng.common&&ln.ng.common.locales&&ln.ng.common.locales[s]),Nu[s]}var Ct=(()=>((Ct=Ct||{})[Ct.LocaleId=0]="LocaleId",Ct[Ct.DayPeriodsFormat=1]="DayPeriodsFormat",Ct[Ct.DayPeriodsStandalone=2]="DayPeriodsStandalone",Ct[Ct.DaysFormat=3]="DaysFormat",Ct[Ct.DaysStandalone=4]="DaysStandalone",Ct[Ct.MonthsFormat=5]="MonthsFormat",Ct[Ct.MonthsStandalone=6]="MonthsStandalone",Ct[Ct.Eras=7]="Eras",Ct[Ct.FirstDayOfWeek=8]="FirstDayOfWeek",Ct[Ct.WeekendRange=9]="WeekendRange",Ct[Ct.DateFormat=10]="DateFormat",Ct[Ct.TimeFormat=11]="TimeFormat",Ct[Ct.DateTimeFormat=12]="DateTimeFormat",Ct[Ct.NumberSymbols=13]="NumberSymbols",Ct[Ct.NumberFormats=14]="NumberFormats",Ct[Ct.CurrencyCode=15]="CurrencyCode",Ct[Ct.CurrencySymbol=16]="CurrencySymbol",Ct[Ct.CurrencyName=17]="CurrencyName",Ct[Ct.Currencies=18]="Currencies",Ct[Ct.Directionality=19]="Directionality",Ct[Ct.PluralCase=20]="PluralCase",Ct[Ct.ExtraData=21]="ExtraData",Ct))();const Nd="en-US";let so=Nd;function F_(s,o,u,c,h){if(s=Y(s),Array.isArray(s))for(let g=0;g<s.length;g++)F_(s[g],o,u,c,h);else{const g=Wt(),v=Ae();let I=va(s)?s:Y(s.provide),C=Cp(s);const A=Pn(),N=1048575&A.providerIndexes,L=A.directiveStart,z=A.providerIndexes>>20;if(va(s)||!s.multi){const ne=new $s(C,h,Up),Ee=hg(I,o,h?N:N+z,L);-1===Ee?(Gs(bo(A,v),g,I),Jl(g,s,o.length),o.push(I),A.directiveStart++,A.directiveEnd++,h&&(A.providerIndexes+=1048576),u.push(ne),v.push(ne)):(u[Ee]=ne,v[Ee]=ne)}else{const ne=hg(I,o,N+z,L),Ee=hg(I,o,N,N+z),Oe=ne>=0&&u[ne],We=Ee>=0&&u[Ee];if(h&&!We||!h&&!Oe){Gs(bo(A,v),g,I);const st=function Ui(s,o,u,c,h){const g=new $s(s,u,Up);return g.multi=[],g.index=o,g.componentProviders=0,a0(g,h,c&&!u),g}(h?l0:u0,u.length,h,c,C);!h&&We&&(u[Ee].providerFactory=st),Jl(g,s,o.length,0),o.push(I),A.directiveStart++,A.directiveEnd++,h&&(A.providerIndexes+=1048576),u.push(st),v.push(st)}else Jl(g,s,ne>-1?ne:Ee,a0(u[h?Ee:ne],C,!h&&c));!h&&c&&We&&u[Ee].componentProviders++}}}function Jl(s,o,u,c){const h=va(o),g=function Qy(s){return!!s.useClass}(o);if(h||g){const C=(g?Y(o.useClass):o).prototype.ngOnDestroy;if(C){const A=s.destroyHooks||(s.destroyHooks=[]);if(!h&&o.multi){const N=A.indexOf(u);-1===N?A.push(u,[c,C]):A[N+1].push(c,C)}else A.push(u,C)}}}function a0(s,o,u){return u&&s.componentProviders++,s.multi.push(o)-1}function hg(s,o,u,c){for(let h=u;h<c;h++)if(o[h]===s)return h;return-1}function u0(s,o,u,c){return Xl(this.multi,[])}function l0(s,o,u,c){const h=this.multi;let g;if(this.providerFactory){const v=this.providerFactory.componentProviders,I=ps(u,u[1],this.providerFactory.index,c);g=I.slice(0,v),Xl(h,g);for(let C=v;C<I.length;C++)g.push(I[C])}else g=[],Xl(h,g);return g}function Xl(s,o){for(let u=0;u<s.length;u++)o.push((0,s[u])());return o}function fg(s,o=[]){return u=>{u.providersResolver=(c,h)=>function Lu(s,o,u){const c=Wt();if(c.firstCreatePass){const h=Mr(s);F_(u,c.data,c.blueprint,h,!0),F_(o,c.data,c.blueprint,h,!1)}}(c,h?h(s):s,o)}}class Ma{}class c0{}function d0(s,o){return new h0(s,o??null)}class h0 extends Ma{constructor(o,u){super(),this._parent=u,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new yd(this);const c=mn(o);this._bootstrapComponents=Is(c.bootstrap),this._r3Injector=qI(o,u,[{provide:Ma,useValue:this},{provide:Oo,useValue:this.componentFactoryResolver}],pe(o),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(o)}get injector(){return this._r3Injector}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(u=>u()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class L_ extends c0{constructor(o){super(),this.moduleType=o}create(o){return new h0(this.moduleType,o)}}class mA extends Ma{constructor(o,u,c){super(),this.componentFactoryResolver=new yd(this),this.instance=null;const h=new od([...o,{provide:Ma,useValue:this},{provide:Oo,useValue:this.componentFactoryResolver}],u||Mh(),c,new Set(["environment"]));this.injector=h,h.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(o){this.injector.onDestroy(o)}}function V_(s,o,u=null){return new mA(s,o,u).injector}let yb=(()=>{class s{constructor(u){this._injector=u,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(u){if(!u.standalone)return null;if(!this.cachedInjectors.has(u.id)){const c=Iu(0,u.type),h=c.length>0?V_([c],this._injector,`Standalone[${u.type.name}]`):null;this.cachedInjectors.set(u.id,h)}return this.cachedInjectors.get(u.id)}ngOnDestroy(){try{for(const u of this.cachedInjectors.values())null!==u&&u.destroy()}finally{this.cachedInjectors.clear()}}}return s.\u0275prov=nn({token:s,providedIn:"environment",factory:()=>new s($n(lr))}),s})();function f0(s){s.getStandaloneInjector=o=>o.get(yb).getOrCreateStandaloneInjector(s)}function m0(s,o,u){const c=On()+s,h=Ae();return h[c]===Vt?Uo(h,c,u?o.call(u):o()):function Jp(s,o){return s[o]}(h,c)}function Cb(s,o,u,c){return function j_(s,o,u,c,h,g){const v=o+u;return Jr(s,v,h)?Uo(s,v+1,g?c.call(g,h):c(h)):function Na(s,o){const u=s[o];return u===Vt?void 0:u}(s,v+1)}(Ae(),On(),s,o,u,c)}function y0(s){return o=>{setTimeout(s,void 0,o)}}const Pa=class _g extends f.x{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,u,c){let h=o,g=u||(()=>null),v=c;if(o&&"object"==typeof o){const C=o;h=C.next?.bind(C),g=C.error?.bind(C),v=C.complete?.bind(C)}this.__isAsync&&(g=y0(g),h&&(h=y0(h)),v&&(v=y0(v)));const I=super.subscribe({next:h,error:g,complete:v});return o instanceof te.w0&&o.add(I),I}};function Ht(){return this._results[$l()]()}class v0{constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const u=$l(),c=v0.prototype;c[u]||(c[u]=Ht)}get changes(){return this._changes||(this._changes=new Pa)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,u){return this._results.reduce(o,u)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,u){const c=this;c.dirty=!1;const h=fn(o);(this._changesDetected=!function Nr(s,o,u){if(s.length!==o.length)return!1;for(let c=0;c<s.length;c++){let h=s[c],g=o[c];if(u&&(h=u(h),g=u(g)),g!==h)return!1}return!0}(c._results,h,u))&&(c._results=h,c.length=h.length,c.last=h[this.length-1],c.first=h[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let tc=(()=>{class s{}return s.__NG_ELEMENT_ID__=H_,s})();const yg=tc,vg=class extends yg{constructor(o,u,c){super(),this._declarationLView=o,this._declarationTContainer=u,this.elementRef=c}createEmbeddedView(o,u){const c=this._declarationTContainer.tViews,h=_d(this._declarationLView,c,o,16,null,c.declTNode,null,null,null,null,u||null);h[17]=this._declarationLView[this._declarationTContainer.index];const v=this._declarationLView[19];return null!==v&&(h[19]=v.createEmbeddedView(c)),Jv(c,h,o),new Kh(h)}};function H_(){return wg(Pn(),Ae())}function wg(s,o){return 4&s.type?new vg(o,s,y(s,o)):null}let Eg=(()=>{class s{}return s.__NG_ELEMENT_ID__=Nb,s})();function Nb(){return kb(Pn(),Ae())}const wA=Eg,w0=class extends wA{constructor(o,u,c){super(),this._lContainer=o,this._hostTNode=u,this._hostLView=c}get element(){return y(this._hostTNode,this._hostLView)}get injector(){return new To(this._hostTNode,this._hostLView)}get parentInjector(){const o=Il(this._hostTNode,this._hostLView);if(vh(o)){const u=ru(o,this._hostLView),c=gr(o);return new To(u[1].data[c+8],u)}return new To(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const u=E0(this._lContainer);return null!==u&&u[o]||null}get length(){return this._lContainer.length-10}createEmbeddedView(o,u,c){let h,g;"number"==typeof c?h=c:null!=c&&(h=c.index,g=c.injector);const v=o.createEmbeddedView(u||{},g);return this.insert(v,h),v}createComponent(o,u,c,h,g){const v=o&&!function zt(s){return"function"==typeof s}(o);let I;if(v)I=u;else{const L=u||{};I=L.index,c=L.injector,h=L.projectableNodes,g=L.environmentInjector||L.ngModuleRef}const C=v?o:new Hl(J(o)),A=c||this.parentInjector;if(!g&&null==C.ngModule){const z=(v?A:this.parentInjector).get(lr,null);z&&(g=z)}const N=C.create(A,h,void 0,g);return this.insert(N.hostView,I),N}insert(o,u){const c=o._lView,h=c[1];if(function nl(s){return qr(s[3])}(c)){const N=this.indexOf(o);if(-1!==N)this.detach(N);else{const L=c[3],z=new w0(L,L[6],L[3]);z.detach(z.indexOf(o))}}const g=this._adjustIndex(u),v=this._lContainer;!function fS(s,o,u,c){const h=10+c,g=u.length;c>0&&(u[h-1][4]=o),c<g-10?(o[4]=u[h],_s(u,10+c,o)):(u.push(o),o[4]=null),o[3]=u;const v=o[17];null!==v&&u!==v&&function pS(s,o){const u=s[9];o[16]!==o[3][3][16]&&(s[2]=!0),null===u?s[9]=[o]:u.push(o)}(v,o);const I=o[19];null!==I&&I.insertView(s),o[2]|=64}(h,c,v,g);const I=Tv(g,v),C=c[11],A=kp(C,v[7]);return null!==A&&function cS(s,o,u,c,h,g){c[0]=h,c[6]=o,Fp(s,c,u,1,h,g)}(h,v[6],C,c,A,I),o.attachToViewContainerRef(),_s(I0(v),g,o),o}move(o,u){return this.insert(o,u)}indexOf(o){const u=E0(this._lContainer);return null!==u?u.indexOf(o):-1}remove(o){const u=this._adjustIndex(o,-1),c=vv(this._lContainer,u);c&&(An(I0(this._lContainer),u),wv(c[1],c))}detach(o){const u=this._adjustIndex(o,-1),c=vv(this._lContainer,u);return c&&null!=An(I0(this._lContainer),u)?new Kh(c):null}_adjustIndex(o,u=0){return o??this.length+u}};function E0(s){return s[8]}function I0(s){return s[8]||(s[8]=[])}function kb(s,o){let u;const c=o[s.index];if(qr(c))u=c;else{let h;if(8&s.type)h=kn(c);else{const g=o[11];h=g.createComment("");const v=Kr(s,o);pd(g,kp(g,v),h,function xI(s,o){return s.nextSibling(o)}(g,v),!1)}o[s.index]=u=s_(c,o,h,s),a_(o,u)}return new w0(u,s,o)}class C0{constructor(o){this.queryList=o,this.matches=null}clone(){return new C0(this.queryList)}setDirty(){this.queryList.setDirty()}}class xr{constructor(o=[]){this.queries=o}createEmbeddedView(o){const u=o.queries;if(null!==u){const c=null!==o.contentQueries?o.contentQueries[0]:u.length,h=[];for(let g=0;g<c;g++){const v=u.getByIndex(g);h.push(this.queries[v.indexInDeclarationView].clone())}return new xr(h)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let u=0;u<this.queries.length;u++)null!==R0(o,u).matches&&this.queries[u].setDirty()}}class $_{constructor(o,u,c=null){this.predicate=o,this.flags=u,this.read=c}}class G_{constructor(o=[]){this.queries=o}elementStart(o,u){for(let c=0;c<this.queries.length;c++)this.queries[c].elementStart(o,u)}elementEnd(o){for(let u=0;u<this.queries.length;u++)this.queries[u].elementEnd(o)}embeddedTView(o){let u=null;for(let c=0;c<this.length;c++){const h=null!==u?u.length:0,g=this.getByIndex(c).embeddedTView(o,h);g&&(g.indexInDeclarationView=c,null!==u?u.push(g):u=[g])}return null!==u?new G_(u):null}template(o,u){for(let c=0;c<this.queries.length;c++)this.queries[c].template(o,u)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class $d{constructor(o,u=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=u}elementStart(o,u){this.isApplyingToNode(u)&&this.matchTNode(o,u)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,u){this.elementStart(o,u)}embeddedTView(o,u){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,u),new $d(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const u=this._declarationNodeIndex;let c=o.parent;for(;null!==c&&8&c.type&&c.index!==u;)c=c.parent;return u===(null!==c?c.index:-1)}return this._appliesToNextNode}matchTNode(o,u){const c=this.metadata.predicate;if(Array.isArray(c))for(let h=0;h<c.length;h++){const g=c[h];this.matchTNodeWithReadOption(o,u,Oa(u,g)),this.matchTNodeWithReadOption(o,u,ea(u,o,g,!1,!1))}else c===tc?4&u.type&&this.matchTNodeWithReadOption(o,u,-1):this.matchTNodeWithReadOption(o,u,ea(u,o,c,!1,!1))}matchTNodeWithReadOption(o,u,c){if(null!==c){const h=this.metadata.read;if(null!==h)if(h===p||h===Eg||h===tc&&4&u.type)this.addMatch(u.index,-2);else{const g=ea(u,o,h,!1,!1);null!==g&&this.addMatch(u.index,g)}else this.addMatch(u.index,c)}}addMatch(o,u){null===this.matches?this.matches=[o,u]:this.matches.push(o,u)}}function Oa(s,o){const u=s.localNames;if(null!==u)for(let c=0;c<u.length;c+=2)if(u[c]===o)return u[c+1];return null}function Pb(s,o,u,c){return-1===u?function b0(s,o){return 11&s.type?y(s,o):4&s.type?wg(s,o):null}(o,s):-2===u?function Cg(s,o,u){return u===p?y(o,s):u===tc?wg(o,s):u===Eg?kb(o,s):void 0}(s,o,c):ps(s,s[1],u,o)}function D0(s,o,u,c){const h=o[19].queries[c];if(null===h.matches){const g=s.data,v=u.matches,I=[];for(let C=0;C<v.length;C+=2){const A=v[C];I.push(A<0?null:Pb(o,g[A],v[C+1],u.metadata.read))}h.matches=I}return h.matches}function W_(s,o,u,c){const h=s.queries.getByIndex(u),g=h.matches;if(null!==g){const v=D0(s,o,h,u);for(let I=0;I<g.length;I+=2){const C=g[I];if(C>0)c.push(v[I/2]);else{const A=g[I+1],N=o[-C];for(let L=10;L<N.length;L++){const z=N[L];z[17]===z[3]&&W_(z[1],z,A,c)}if(null!==N[9]){const L=N[9];for(let z=0;z<L.length;z++){const ne=L[z];W_(ne[1],ne,A,c)}}}}}return c}function T0(s){const o=Ae(),u=Wt(),c=Pc();eu(c+1);const h=R0(u,c);if(s.dirty&&function tl(s){return 4==(4&s[2])}(o)===(2==(2&h.metadata.flags))){if(null===h.matches)s.reset([]);else{const g=h.crossesNgTemplate?W_(u,o,c,[]):D0(u,o,h,c);s.reset(g,m),s.notifyOnChanges()}return!0}return!1}function Ob(s,o,u,c){const h=Wt();if(h.firstCreatePass){const g=Pn();(function A0(s,o,u){null===s.queries&&(s.queries=new G_),s.queries.track(new $d(o,u))})(h,new $_(o,u,c),g.index),function x0(s,o){const u=s.contentQueries||(s.contentQueries=[]);o!==(u.length?u[u.length-1]:-1)&&u.push(s.queries.length-1,o)}(h,s),2==(2&u)&&(h.staticContentQueries=!0)}!function Fb(s,o,u){const c=new v0(4==(4&u));cC(s,o,c,c.destroy),null===o[19]&&(o[19]=new xr),o[19].queries.push(new C0(c))}(h,Ae(),u)}function _f(){return function S0(s,o){return s[19].queries[o].queryList}(Ae(),Pc())}function R0(s,o){return s.queries.getByIndex(o)}function Lb(s,o){return wg(s,o)}function Fa(...s){}const U0=new vn("Application Initializer");let X_=(()=>{class s{constructor(u){this.appInits=u,this.resolve=Fa,this.reject=Fa,this.initialized=!1,this.done=!1,this.donePromise=new Promise((c,h)=>{this.resolve=c,this.reject=h})}runInitializers(){if(this.initialized)return;const u=[],c=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let h=0;h<this.appInits.length;h++){const g=this.appInits[h]();if(Sw(g))u.push(g);else if(Aw(g)){const v=new Promise((I,C)=>{g.subscribe({complete:I,error:C})});u.push(v)}}Promise.all(u).then(()=>{c()}).catch(h=>{this.reject(h)}),0===u.length&&c(),this.initialized=!0}}return s.\u0275fac=function(u){return new(u||s)($n(U0,8))},s.\u0275prov=nn({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const Jb=new vn("AppId",{providedIn:"root",factory:function Xb(){return`${Uu()}${Uu()}${Uu()}`}});function Uu(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const sc=new vn("Platform Initializer"),eD=new vn("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),tD=new vn("appBootstrapListener");let ty=(()=>{class s{log(u){console.log(u)}warn(u){console.warn(u)}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=nn({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();const Sg=new vn("LocaleId",{providedIn:"root",factory:()=>b(Sg,Ye.Optional|Ye.SkipSelf)||function FA(){return typeof $localize<"u"&&$localize.locale||Nd}()}),Ag=new vn("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class rD{constructor(o,u){this.ngModuleFactory=o,this.componentFactories=u}}let es=(()=>{class s{compileModuleSync(u){return new L_(u)}compileModuleAsync(u){return Promise.resolve(this.compileModuleSync(u))}compileModuleAndAllComponentsSync(u){const c=this.compileModuleSync(u),g=Is(mn(u).declarations).reduce((v,I)=>{const C=J(I);return C&&v.push(new Hl(C)),v},[]);return new rD(c,g)}compileModuleAndAllComponentsAsync(u){return Promise.resolve(this.compileModuleAndAllComponentsSync(u))}clearCache(){}clearCacheFor(u){}getModuleId(u){}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=nn({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const Wd=(()=>Promise.resolve(0))();function $0(s){typeof Zone>"u"?Wd.then(()=>{s&&s.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",s)}class Ts{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:u=!1,shouldCoalesceRunChangeDetection:c=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Pa(!1),this.onMicrotaskEmpty=new Pa(!1),this.onStable=new Pa(!1),this.onError=new Pa(!1),typeof Zone>"u")throw new Ce(908,!1);Zone.assertZonePatched();const h=this;if(h._nesting=0,h._outer=h._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const g=Zone.AsyncStackTaggingZoneSpec;h._inner=h._inner.fork(new g("Angular"))}Zone.TaskTrackingZoneSpec&&(h._inner=h._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(h._inner=h._inner.fork(Zone.longStackTraceZoneSpec)),h.shouldCoalesceEventChangeDetection=!c&&u,h.shouldCoalesceRunChangeDetection=c,h.lastRequestAnimationFrameId=-1,h.nativeRequestAnimationFrame=function If(){let s=ln.requestAnimationFrame,o=ln.cancelAnimationFrame;if(typeof Zone<"u"&&s&&o){const u=s[Zone.__symbol__("OriginalDelegate")];u&&(s=u);const c=o[Zone.__symbol__("OriginalDelegate")];c&&(o=c)}return{nativeRequestAnimationFrame:s,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function UA(s){const o=()=>{!function VA(s){s.isCheckStableRunning||-1!==s.lastRequestAnimationFrameId||(s.lastRequestAnimationFrameId=s.nativeRequestAnimationFrame.call(ln,()=>{s.fakeTopEventTask||(s.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{s.lastRequestAnimationFrameId=-1,G0(s),s.isCheckStableRunning=!0,iy(s),s.isCheckStableRunning=!1},void 0,()=>{},()=>{})),s.fakeTopEventTask.invoke()}),G0(s))}(s)};s._inner=s._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(u,c,h,g,v,I)=>{try{return sD(s),u.invokeTask(h,g,v,I)}finally{(s.shouldCoalesceEventChangeDetection&&"eventTask"===g.type||s.shouldCoalesceRunChangeDetection)&&o(),Rg(s)}},onInvoke:(u,c,h,g,v,I,C)=>{try{return sD(s),u.invoke(h,g,v,I,C)}finally{s.shouldCoalesceRunChangeDetection&&o(),Rg(s)}},onHasTask:(u,c,h,g)=>{u.hasTask(h,g),c===h&&("microTask"==g.change?(s._hasPendingMicrotasks=g.microTask,G0(s),iy(s)):"macroTask"==g.change&&(s.hasPendingMacrotasks=g.macroTask))},onHandleError:(u,c,h,g)=>(u.handleError(h,g),s.runOutsideAngular(()=>s.onError.emit(g)),!1)})}(h)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Ts.isInAngularZone())throw new Ce(909,!1)}static assertNotInAngularZone(){if(Ts.isInAngularZone())throw new Ce(909,!1)}run(o,u,c){return this._inner.run(o,u,c)}runTask(o,u,c,h){const g=this._inner,v=g.scheduleEventTask("NgZoneEvent: "+h,o,oc,Fa,Fa);try{return g.runTask(v,u,c)}finally{g.cancelTask(v)}}runGuarded(o,u,c){return this._inner.runGuarded(o,u,c)}runOutsideAngular(o){return this._outer.run(o)}}const oc={};function iy(s){if(0==s._nesting&&!s.hasPendingMicrotasks&&!s.isStable)try{s._nesting++,s.onMicrotaskEmpty.emit(null)}finally{if(s._nesting--,!s.hasPendingMicrotasks)try{s.runOutsideAngular(()=>s.onStable.emit(null))}finally{s.isStable=!0}}}function G0(s){s.hasPendingMicrotasks=!!(s._hasPendingMicrotasks||(s.shouldCoalesceEventChangeDetection||s.shouldCoalesceRunChangeDetection)&&-1!==s.lastRequestAnimationFrameId)}function sD(s){s._nesting++,s.isStable&&(s.isStable=!1,s.onUnstable.emit(null))}function Rg(s){s._nesting--,iy(s)}class oD{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Pa,this.onMicrotaskEmpty=new Pa,this.onStable=new Pa,this.onError=new Pa}run(o,u,c){return o.apply(u,c)}runGuarded(o,u,c){return o.apply(u,c)}runOutsideAngular(o){return o()}runTask(o,u,c,h){return o.apply(u,c)}}const aD=new vn(""),W0=new vn("");let qd,BA=(()=>{class s{constructor(u,c,h){this._ngZone=u,this.registry=c,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,qd||(function zd(s){qd=s}(h),h.addToWindow(c)),this._watchAngularEvents(),u.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Ts.assertNotInAngularZone(),$0(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())$0(()=>{for(;0!==this._callbacks.length;){let u=this._callbacks.pop();clearTimeout(u.timeoutId),u.doneCb(this._didWork)}this._didWork=!1});else{let u=this.getPendingTasks();this._callbacks=this._callbacks.filter(c=>!c.updateCb||!c.updateCb(u)||(clearTimeout(c.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(u=>({source:u.source,creationLocation:u.creationLocation,data:u.data})):[]}addCallback(u,c,h){let g=-1;c&&c>0&&(g=setTimeout(()=>{this._callbacks=this._callbacks.filter(v=>v.timeoutId!==g),u(this._didWork,this.getPendingTasks())},c)),this._callbacks.push({doneCb:u,timeoutId:g,updateCb:h})}whenStable(u,c,h){if(h&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(u,c,h),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(u){this.registry.registerApplication(u,this)}unregisterApplication(u){this.registry.unregisterApplication(u)}findProviders(u,c,h){return[]}}return s.\u0275fac=function(u){return new(u||s)($n(Ts),$n(z0),$n(W0))},s.\u0275prov=nn({token:s,factory:s.\u0275fac}),s})(),z0=(()=>{class s{constructor(){this._applications=new Map}registerApplication(u,c){this._applications.set(u,c)}unregisterApplication(u){this._applications.delete(u)}unregisterAllApplications(){this._applications.clear()}getTestability(u){return this._applications.get(u)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(u,c=!0){return qd?.findTestabilityInTree(this,u,c)??null}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275prov=nn({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})(),ju=null;const q0=new vn("AllowMultipleToken"),K0=new vn("PlatformDestroyListeners");class ni{constructor(o,u){this.name=o,this.token=u}}function Y0(s,o,u=[]){const c=`Platform: ${o}`,h=new vn(c);return(g=[])=>{let v=sy();if(!v||v.injector.get(q0,!1)){const I=[...u,...g,{provide:h,useValue:!0}];s?s(I):function HA(s){if(ju&&!ju.get(q0,!1))throw new Ce(400,!1);ju=s;const o=s.get(oy);(function uD(s){const o=s.get(sc,null);o&&o.forEach(u=>u())})(s)}(function Mg(s=[],o){return md.create({name:o,providers:[{provide:sd,useValue:"platform"},{provide:K0,useValue:new Set([()=>ju=null])},...s]})}(I,c))}return function GA(s){const o=sy();if(!o)throw new Ce(401,!1);return o}()}}function sy(){return ju?.get(oy)??null}let oy=(()=>{class s{constructor(u){this._injector=u,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(u,c){const h=function Cf(s,o){let u;return u="noop"===s?new oD:("zone.js"===s?void 0:s)||new Ts(o),u}(c?.ngZone,function ay(s){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!s||!s.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!s||!s.ngZoneRunCoalescing)||!1}}(c)),g=[{provide:Ts,useValue:h}];return h.run(()=>{const v=md.create({providers:g,parent:this.injector,name:u.moduleType.name}),I=u.create(v),C=I.injector.get(kh,null);if(!C)throw new Ce(402,!1);return h.runOutsideAngular(()=>{const A=h.onError.subscribe({next:N=>{C.handleError(N)}});I.onDestroy(()=>{kg(this._modules,I),A.unsubscribe()})}),function Ng(s,o,u){try{const c=u();return Sw(c)?c.catch(h=>{throw o.runOutsideAngular(()=>s.handleError(h)),h}):c}catch(c){throw o.runOutsideAngular(()=>s.handleError(c)),c}}(C,h,()=>{const A=I.injector.get(X_);return A.runInitializers(),A.donePromise.then(()=>(function XC(s){jt(s,"Expected localeId to be defined"),"string"==typeof s&&(so=s.toLowerCase().replace(/_/g,"-"))}(I.injector.get(Sg,Nd)||Nd),this._moduleDoBootstrap(I),I))})})}bootstrapModule(u,c=[]){const h=uy({},c);return function jA(s,o,u){const c=new L_(u);return Promise.resolve(c)}(0,0,u).then(g=>this.bootstrapModuleFactory(g,h))}_moduleDoBootstrap(u){const c=u.injector.get(bf);if(u._bootstrapComponents.length>0)u._bootstrapComponents.forEach(h=>c.bootstrap(h));else{if(!u.instance.ngDoBootstrap)throw new Ce(403,!1);u.instance.ngDoBootstrap(c)}this._modules.push(u)}onDestroy(u){this._destroyListeners.push(u)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ce(404,!1);this._modules.slice().forEach(c=>c.destroy()),this._destroyListeners.forEach(c=>c());const u=this._injector.get(K0,null);u&&(u.forEach(c=>c()),u.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return s.\u0275fac=function(u){return new(u||s)($n(md))},s.\u0275prov=nn({token:s,factory:s.\u0275fac,providedIn:"platform"}),s})();function uy(s,o){return Array.isArray(o)?o.reduce(uy,s):{...s,...o}}let bf=(()=>{class s{constructor(u,c,h){this._zone=u,this._injector=c,this._exceptionHandler=h,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const g=new F.y(I=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{I.next(this._stable),I.complete()})}),v=new F.y(I=>{let C;this._zone.runOutsideAngular(()=>{C=this._zone.onStable.subscribe(()=>{Ts.assertNotInAngularZone(),$0(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,I.next(!0))})})});const A=this._zone.onUnstable.subscribe(()=>{Ts.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{I.next(!1)}))});return()=>{C.unsubscribe(),A.unsubscribe()}});this.isStable=(0,ue.T)(g,v.pipe((0,se.B)()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(u,c){const h=u instanceof bp;if(!this._injector.get(X_).done)throw!h&&Jt(u),new Ce(405,false);let v;v=h?u:this._injector.get(Oo).resolveComponentFactory(u),this.componentTypes.push(v.componentType);const I=function Z0(s){return s.isBoundToModule}(v)?void 0:this._injector.get(Ma),A=v.create(md.NULL,[],c||v.selector,I),N=A.location.nativeElement,L=A.injector.get(aD,null);return L?.registerApplication(N),A.onDestroy(()=>{this.detachView(A.hostView),kg(this.components,A),L?.unregisterApplication(N)}),this._loadComponent(A),A}tick(){if(this._runningTick)throw new Ce(101,!1);try{this._runningTick=!0;for(let u of this._views)u.detectChanges()}catch(u){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(u))}finally{this._runningTick=!1}}attachView(u){const c=u;this._views.push(c),c.attachToAppRef(this)}detachView(u){const c=u;kg(this._views,c),c.detachFromAppRef()}_loadComponent(u){this.attachView(u.hostView),this.tick(),this.components.push(u),this._injector.get(tD,[]).concat(this._bootstrapListeners).forEach(h=>h(u))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(u=>u()),this._views.slice().forEach(u=>u.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(u){return this._destroyListeners.push(u),()=>kg(this._destroyListeners,u)}destroy(){if(this._destroyed)throw new Ce(406,!1);const u=this._injector;u.destroy&&!u.destroyed&&u.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return s.\u0275fac=function(u){return new(u||s)($n(Ts),$n(lr),$n(kh))},s.\u0275prov=nn({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();function kg(s,o){const u=s.indexOf(o);u>-1&&s.splice(u,1)}let Q0=!0,ly=!1;function WA(){return ly=!0,Q0}function dD(){if(ly)throw new Error("Cannot enable prod mode after platform setup.");Q0=!1}let Df=(()=>{class s{}return s.__NG_ELEMENT_ID__=Tf,s})();function Tf(s){return function J0(s,o,u){if(Wa(s)&&!u){const c=Kt(s.index,o);return new Kh(c,c)}return 47&s.type?new Kh(o[16],o):null}(Pn(),Ae(),16==(16&s))}class pD{constructor(){}supports(o){return wd(o)}create(o){return new dy(o)}}const gD=(s,o)=>o;class dy{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||gD}forEachItem(o){let u;for(u=this._itHead;null!==u;u=u._next)o(u)}forEachOperation(o){let u=this._itHead,c=this._removalsHead,h=0,g=null;for(;u||c;){const v=!c||u&&u.currentIndex<mD(c,h,g)?u:c,I=mD(v,h,g),C=v.currentIndex;if(v===c)h--,c=c._nextRemoved;else if(u=u._next,null==v.previousIndex)h++;else{g||(g=[]);const A=I-h,N=C-h;if(A!=N){for(let z=0;z<A;z++){const ne=z<g.length?g[z]:g[z]=0,Ee=ne+z;N<=Ee&&Ee<A&&(g[z]=ne+1)}g[v.previousIndex]=N-A}}I!==C&&o(v,I,C)}}forEachPreviousItem(o){let u;for(u=this._previousItHead;null!==u;u=u._nextPrevious)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachMovedItem(o){let u;for(u=this._movesHead;null!==u;u=u._nextMoved)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}forEachIdentityChange(o){let u;for(u=this._identityChangesHead;null!==u;u=u._nextIdentityChange)o(u)}diff(o){if(null==o&&(o=[]),!wd(o))throw new Ce(900,!1);return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let h,g,v,u=this._itHead,c=!1;if(Array.isArray(o)){this.length=o.length;for(let I=0;I<this.length;I++)g=o[I],v=this._trackByFn(I,g),null!==u&&Object.is(u.trackById,v)?(c&&(u=this._verifyReinsertion(u,g,v,I)),Object.is(u.item,g)||this._addIdentityChange(u,g)):(u=this._mismatch(u,g,v,I),c=!0),u=u._next}else h=0,function Ew(s,o){if(Array.isArray(s))for(let u=0;u<s.length;u++)o(s[u]);else{const u=s[$l()]();let c;for(;!(c=u.next()).done;)o(c.value)}}(o,I=>{v=this._trackByFn(h,I),null!==u&&Object.is(u.trackById,v)?(c&&(u=this._verifyReinsertion(u,I,v,h)),Object.is(u.item,I)||this._addIdentityChange(u,I)):(u=this._mismatch(u,I,v,h),c=!0),u=u._next,h++}),this.length=h;return this._truncate(u),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,u,c,h){let g;return null===o?g=this._itTail:(g=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._reinsertAfter(o,g,h)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(c,h))?(Object.is(o.item,u)||this._addIdentityChange(o,u),this._moveAfter(o,g,h)):o=this._addAfter(new Vg(u,c),g,h),o}_verifyReinsertion(o,u,c,h){let g=null===this._unlinkedRecords?null:this._unlinkedRecords.get(c,null);return null!==g?o=this._reinsertAfter(g,o._prev,h):o.currentIndex!=h&&(o.currentIndex=h,this._addToMoves(o,h)),o}_truncate(o){for(;null!==o;){const u=o._next;this._addToRemovals(this._unlink(o)),o=u}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,u,c){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const h=o._prevRemoved,g=o._nextRemoved;return null===h?this._removalsHead=g:h._nextRemoved=g,null===g?this._removalsTail=h:g._prevRemoved=h,this._insertAfter(o,u,c),this._addToMoves(o,c),o}_moveAfter(o,u,c){return this._unlink(o),this._insertAfter(o,u,c),this._addToMoves(o,c),o}_addAfter(o,u,c){return this._insertAfter(o,u,c),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,u,c){const h=null===u?this._itHead:u._next;return o._next=h,o._prev=u,null===h?this._itTail=o:h._prev=o,null===u?this._itHead=o:u._next=o,null===this._linkedRecords&&(this._linkedRecords=new sE),this._linkedRecords.put(o),o.currentIndex=c,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const u=o._prev,c=o._next;return null===u?this._itHead=c:u._next=c,null===c?this._itTail=u:c._prev=u,o}_addToMoves(o,u){return o.previousIndex===u||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new sE),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,u){return o.item=u,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class Vg{constructor(o,u){this.item=o,this.trackById=u,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class iE{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,u){let c;for(c=this._head;null!==c;c=c._nextDup)if((null===u||u<=c.currentIndex)&&Object.is(c.trackById,o))return c;return null}remove(o){const u=o._prevDup,c=o._nextDup;return null===u?this._head=c:u._nextDup=c,null===c?this._tail=u:c._prevDup=u,null===this._head}}class sE{constructor(){this.map=new Map}put(o){const u=o.trackById;let c=this.map.get(u);c||(c=new iE,this.map.set(u,c)),c.add(o)}get(o,u){const h=this.map.get(o);return h?h.get(o,u):null}remove(o){const u=o.trackById;return this.map.get(u).remove(o)&&this.map.delete(u),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function mD(s,o,u){const c=s.previousIndex;if(null===c)return c;let h=0;return u&&c<u.length&&(h=u[c]),c+o+h}class _D{constructor(){}supports(o){return o instanceof Map||Yh(o)}create(){return new QA}}class QA{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let u;for(u=this._mapHead;null!==u;u=u._next)o(u)}forEachPreviousItem(o){let u;for(u=this._previousMapHead;null!==u;u=u._nextPrevious)o(u)}forEachChangedItem(o){let u;for(u=this._changesHead;null!==u;u=u._nextChanged)o(u)}forEachAddedItem(o){let u;for(u=this._additionsHead;null!==u;u=u._nextAdded)o(u)}forEachRemovedItem(o){let u;for(u=this._removalsHead;null!==u;u=u._nextRemoved)o(u)}diff(o){if(o){if(!(o instanceof Map||Yh(o)))throw new Ce(900,!1)}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let u=this._mapHead;if(this._appendAfter=null,this._forEach(o,(c,h)=>{if(u&&u.key===h)this._maybeAddToChanges(u,c),this._appendAfter=u,u=u._next;else{const g=this._getOrCreateRecordForKey(h,c);u=this._insertBeforeOrAppend(u,g)}}),u){u._prev&&(u._prev._next=null),this._removalsHead=u;for(let c=u;null!==c;c=c._nextRemoved)c===this._mapHead&&(this._mapHead=null),this._records.delete(c.key),c._nextRemoved=c._next,c.previousValue=c.currentValue,c.currentValue=null,c._prev=null,c._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,u){if(o){const c=o._prev;return u._next=o,u._prev=c,o._prev=u,c&&(c._next=u),o===this._mapHead&&(this._mapHead=u),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=u,u._prev=this._appendAfter):this._mapHead=u,this._appendAfter=u,null}_getOrCreateRecordForKey(o,u){if(this._records.has(o)){const h=this._records.get(o);this._maybeAddToChanges(h,u);const g=h._prev,v=h._next;return g&&(g._next=v),v&&(v._prev=g),h._next=null,h._prev=null,h}const c=new JA(o);return this._records.set(o,c),c.currentValue=u,this._addToAdditions(c),c}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,u){Object.is(u,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=u,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,u){o instanceof Map?o.forEach(u):Object.keys(o).forEach(c=>u(o[c],c))}}class JA{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function hy(){return new oE([new pD])}let oE=(()=>{class s{constructor(u){this.factories=u}static create(u,c){if(null!=c){const h=c.factories.slice();u=u.concat(h)}return new s(u)}static extend(u){return{provide:s,useFactory:c=>s.create(u,c||hy()),deps:[[s,new It,new He]]}}find(u){const c=this.factories.find(h=>h.supports(u));if(null!=c)return c;throw new Ce(901,!1)}}return s.\u0275prov=nn({token:s,providedIn:"root",factory:hy}),s})();function Af(){return new Ug([new _D])}let Ug=(()=>{class s{constructor(u){this.factories=u}static create(u,c){if(c){const h=c.factories.slice();u=u.concat(h)}return new s(u)}static extend(u){return{provide:s,useFactory:c=>s.create(u,c||Af()),deps:[[s,new It,new He]]}}find(u){const c=this.factories.find(h=>h.supports(u));if(c)return c;throw new Ce(901,!1)}}return s.\u0275prov=nn({token:s,providedIn:"root",factory:Af}),s})();const lE=Y0(null,"core",[]);let yD=(()=>{class s{constructor(u){}}return s.\u0275fac=function(u){return new(u||s)($n(bf))},s.\u0275mod=Ft({type:s}),s.\u0275inj=Nt({}),s})();function cE(s){return"boolean"==typeof s?s:null!=s&&"false"!==s}},3942:(ct,Te,V)=>{V.d(Te,{Z:()=>Ce});var f=V(2090),te=V(4859),F=V(9681),ue=V(1877);class se{constructor(ye,me){this._delegate=ye,this.firebase=me,(0,F._addComponent)(ye,new te.wA("app-compat",()=>this,"PUBLIC")),this.container=ye.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(ye){this._delegate.automaticDataCollectionEnabled=ye}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(ye=>{this._delegate.checkDestroyed(),ye()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,F.deleteApp)(this._delegate)))}_getService(ye,me=F._DEFAULT_ENTRY_NAME){var Je;this._delegate.checkDestroyed();const ut=this._delegate.container.getProvider(ye);return!ut.isInitialized()&&"EXPLICIT"===(null===(Je=ut.getComponent())||void 0===Je?void 0:Je.instantiationMode)&&ut.initialize(),ut.getImmediate({identifier:me})}_removeServiceInstance(ye,me=F._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(ye).clearInstance(me)}_addComponent(ye){(0,F._addComponent)(this._delegate,ye)}_addOrOverwriteComponent(ye){(0,F._addOrOverwriteComponent)(this._delegate,ye)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const ce=new f.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),$=function ge(){const rt=function pe(rt){const ye={},me={__esModule:!0,initializeApp:function Re(je,H={}){const _e=F.initializeApp(je,H);if((0,f.r3)(ye,_e.name))return ye[_e.name];const K=new rt(_e,me);return ye[_e.name]=K,K},app:ut,registerVersion:F.registerVersion,setLogLevel:F.setLogLevel,onLog:F.onLog,apps:null,SDK_VERSION:F.SDK_VERSION,INTERNAL:{registerComponent:function be(je){const H=je.name,_e=H.replace("-compat","");if(F._registerComponent(je)&&"PUBLIC"===je.type){const K=(X=ut())=>{if("function"!=typeof X[_e])throw ce.create("invalid-app-argument",{appName:H});return X[_e]()};void 0!==je.serviceProps&&(0,f.ZB)(K,je.serviceProps),me[_e]=K,rt.prototype[_e]=function(...X){return this._getService.bind(this,H).apply(this,je.multipleInstances?X:[])}}return"PUBLIC"===je.type?me[_e]:null},removeApp:function Je(je){delete ye[je]},useAsService:function Be(je,H){return"serverAuth"===H?null:H},modularAPIs:F}};function ut(je){if(!(0,f.r3)(ye,je=je||F._DEFAULT_ENTRY_NAME))throw ce.create("no-app",{appName:je});return ye[je]}return me.default=me,Object.defineProperty(me,"apps",{get:function we(){return Object.keys(ye).map(je=>ye[je])}}),ut.App=rt,me}(se);return rt.INTERNAL=Object.assign(Object.assign({},rt.INTERNAL),{createFirebaseNamespace:ge,extendNamespace:function ye(me){(0,f.ZB)(rt,me)},createSubscribe:f.ne,ErrorFactory:f.LL,deepExtend:f.ZB}),rt}(),G=new ue.Yd("@firebase/app-compat");if((0,f.jU)()&&void 0!==self.firebase){G.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const rt=self.firebase.SDK_VERSION;rt&&rt.indexOf("LITE")>=0&&G.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const Ce=$;!function Me(rt){(0,F.registerVersion)("@firebase/app-compat","0.1.39",rt)}()},9681:(ct,Te,V)=>{V.r(Te),V.d(Te,{FirebaseError:()=>ue.ZR,SDK_VERSION:()=>Ps,_DEFAULT_ENTRY_NAME:()=>jt,_addComponent:()=>Qt,_addOrOverwriteComponent:()=>nn,_apps:()=>cn,_clearComponents:()=>ss,_components:()=>In,_getProvider:()=>Nt,_registerComponent:()=>$r,_removeServiceInstance:()=>dn,deleteApp:()=>zo,getApp:()=>ri,getApps:()=>mi,initializeApp:()=>xi,onLog:()=>Os,registerVersion:()=>Rr,setLogLevel:()=>rr});var f=V(5861),te=V(4859),F=V(1877),ue=V(2090),se=V(8766);class fe{constructor(Se){this.container=Se}getPlatformInfoString(){return this.container.getProviders().map(Xe=>{if(function ce(tt){return"VERSION"===tt.getComponent()?.type}(Xe)){const bt=Xe.getImmediate();return`${bt.library}/${bt.version}`}return null}).filter(Xe=>Xe).join(" ")}}const pe="@firebase/app",$=new F.Yd("@firebase/app"),jt="[DEFAULT]",Ze={[pe]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},cn=new Map,In=new Map;function Qt(tt,Se){try{tt.container.addComponent(Se)}catch(Xe){$.debug(`Component ${Se.name} failed to register with FirebaseApp ${tt.name}`,Xe)}}function nn(tt,Se){tt.container.addOrOverwriteComponent(Se)}function $r(tt){const Se=tt.name;if(In.has(Se))return $.debug(`There were multiple attempts to register component ${Se}.`),!1;In.set(Se,tt);for(const Xe of cn.values())Qt(Xe,tt);return!0}function Nt(tt,Se){const Xe=tt.container.getProvider("heartbeat").getImmediate({optional:!0});return Xe&&Xe.triggerHeartbeat(),tt.container.getProvider(Se)}function dn(tt,Se,Xe=jt){Nt(tt,Se).clearInstance(Xe)}function ss(){In.clear()}const Gr=new ue.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class Wr{constructor(Se,Xe,bt){this._isDeleted=!1,this._options=Object.assign({},Se),this._config=Object.assign({},Xe),this._name=Xe.name,this._automaticDataCollectionEnabled=Xe.automaticDataCollectionEnabled,this._container=bt,this.container.addComponent(new te.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Se){this.checkDestroyed(),this._automaticDataCollectionEnabled=Se}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(Se){this._isDeleted=Se}checkDestroyed(){if(this.isDeleted)throw Gr.create("app-deleted",{appName:this._name})}}const Ps="9.14.0";function xi(tt,Se={}){let Xe=tt;"object"!=typeof Se&&(Se={name:Se});const bt=Object.assign({name:jt,automaticDataCollectionEnabled:!1},Se),Et=bt.name;if("string"!=typeof Et||!Et)throw Gr.create("bad-app-name",{appName:String(Et)});if(Xe||(Xe=(0,ue.aH)()),!Xe)throw Gr.create("no-options");const Ft=cn.get(Et);if(Ft){if((0,ue.vZ)(Xe,Ft.options)&&(0,ue.vZ)(bt,Ft.config))return Ft;throw Gr.create("duplicate-app",{appName:Et})}const W=new te.H0(Et);for(const Z of In.values())W.addComponent(Z);const B=new Wr(Xe,bt,W);return cn.set(Et,B),B}function ri(tt=jt){const Se=cn.get(tt);if(!Se&&tt===jt)return xi();if(!Se)throw Gr.create("no-app",{appName:tt});return Se}function mi(){return Array.from(cn.values())}function zo(tt){return Ye.apply(this,arguments)}function Ye(){return(Ye=(0,f.Z)(function*(tt){const Se=tt.name;cn.has(Se)&&(cn.delete(Se),yield Promise.all(tt.container.getProviders().map(Xe=>Xe.delete())),tt.isDeleted=!0)})).apply(this,arguments)}function Rr(tt,Se,Xe){var bt;let Et=null!==(bt=Ze[tt])&&void 0!==bt?bt:tt;Xe&&(Et+=`-${Xe}`);const Ft=Et.match(/\s|\//),W=Se.match(/\s|\//);if(Ft||W){const B=[`Unable to register library "${Et}" with version "${Se}":`];return Ft&&B.push(`library name "${Et}" contains illegal characters (whitespace or "/")`),Ft&&W&&B.push("and"),W&&B.push(`version name "${Se}" contains illegal characters (whitespace or "/")`),void $.warn(B.join(" "))}$r(new te.wA(`${Et}-version`,()=>({library:Et,version:Se}),"VERSION"))}function Os(tt,Se){if(null!==tt&&"function"!=typeof tt)throw Gr.create("invalid-log-argument");(0,F.Am)(tt,Se)}function rr(tt){(0,F.Ub)(tt)}const Nn="firebase-heartbeat-store";let qn=null;function yn(){return qn||(qn=(0,se.X3)("firebase-heartbeat-database",1,{upgrade:(tt,Se)=>{0===Se&&tt.createObjectStore(Nn)}}).catch(tt=>{throw Gr.create("idb-open",{originalErrorMessage:tt.message})})),qn}function lt(){return(lt=(0,f.Z)(function*(tt){var Se;try{return(yield yn()).transaction(Nn).objectStore(Nn).get(jn(tt))}catch(Xe){if(Xe instanceof ue.ZR)$.warn(Xe.message);else{const bt=Gr.create("idb-get",{originalErrorMessage:null===(Se=Xe)||void 0===Se?void 0:Se.message});$.warn(bt.message)}}})).apply(this,arguments)}function ln(tt,Se){return hr.apply(this,arguments)}function hr(){return(hr=(0,f.Z)(function*(tt,Se){var Xe;try{const Et=(yield yn()).transaction(Nn,"readwrite");return yield Et.objectStore(Nn).put(Se,jn(tt)),Et.done}catch(bt){if(bt instanceof ue.ZR)$.warn(bt.message);else{const Et=Gr.create("idb-set",{originalErrorMessage:null===(Xe=bt)||void 0===Xe?void 0:Xe.message});$.warn(Et.message)}}})).apply(this,arguments)}function jn(tt){return`${tt.name}!${tt.options.appId}`}class os{constructor(Se){this.container=Se,this._heartbeatsCache=null;const Xe=this.container.getProvider("app").getImmediate();this._storage=new an(Xe),this._heartbeatsCachePromise=this._storage.read().then(bt=>(this._heartbeatsCache=bt,bt))}triggerHeartbeat(){var Se=this;return(0,f.Z)(function*(){const bt=Se.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),Et=rn();if(null===Se._heartbeatsCache&&(Se._heartbeatsCache=yield Se._heartbeatsCachePromise),Se._heartbeatsCache.lastSentHeartbeatDate!==Et&&!Se._heartbeatsCache.heartbeats.some(Ft=>Ft.date===Et))return Se._heartbeatsCache.heartbeats.push({date:Et,agent:bt}),Se._heartbeatsCache.heartbeats=Se._heartbeatsCache.heartbeats.filter(Ft=>{const W=new Date(Ft.date).valueOf();return Date.now()-W<=2592e6}),Se._storage.overwrite(Se._heartbeatsCache)})()}getHeartbeatsHeader(){var Se=this;return(0,f.Z)(function*(){if(null===Se._heartbeatsCache&&(yield Se._heartbeatsCachePromise),null===Se._heartbeatsCache||0===Se._heartbeatsCache.heartbeats.length)return"";const Xe=rn(),{heartbeatsToSend:bt,unsentEntries:Et}=function Ri(tt,Se=1024){const Xe=[];let bt=tt.slice();for(const Et of tt){const Ft=Xe.find(W=>W.agent===Et.agent);if(Ft){if(Ft.dates.push(Et.date),ir(Xe)>Se){Ft.dates.pop();break}}else if(Xe.push({agent:Et.agent,dates:[Et.date]}),ir(Xe)>Se){Xe.pop();break}bt=bt.slice(1)}return{heartbeatsToSend:Xe,unsentEntries:bt}}(Se._heartbeatsCache.heartbeats),Ft=(0,ue.L)(JSON.stringify({version:2,heartbeats:bt}));return Se._heartbeatsCache.lastSentHeartbeatDate=Xe,Et.length>0?(Se._heartbeatsCache.heartbeats=Et,yield Se._storage.overwrite(Se._heartbeatsCache)):(Se._heartbeatsCache.heartbeats=[],Se._storage.overwrite(Se._heartbeatsCache)),Ft})()}}function rn(){return(new Date).toISOString().substring(0,10)}class an{constructor(Se){this.app=Se,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,f.Z)(function*(){return!!(0,ue.hl)()&&(0,ue.eu)().then(()=>!0).catch(()=>!1)})()}read(){var Se=this;return(0,f.Z)(function*(){return(yield Se._canUseIndexedDBPromise)&&(yield function yt(tt){return lt.apply(this,arguments)}(Se.app))||{heartbeats:[]}})()}overwrite(Se){var Xe=this;return(0,f.Z)(function*(){var bt;if(yield Xe._canUseIndexedDBPromise){const Ft=yield Xe.read();return ln(Xe.app,{lastSentHeartbeatDate:null!==(bt=Se.lastSentHeartbeatDate)&&void 0!==bt?bt:Ft.lastSentHeartbeatDate,heartbeats:Se.heartbeats})}})()}add(Se){var Xe=this;return(0,f.Z)(function*(){var bt;if(yield Xe._canUseIndexedDBPromise){const Ft=yield Xe.read();return ln(Xe.app,{lastSentHeartbeatDate:null!==(bt=Se.lastSentHeartbeatDate)&&void 0!==bt?bt:Ft.lastSentHeartbeatDate,heartbeats:[...Ft.heartbeats,...Se.heartbeats]})}})()}}function ir(tt){return(0,ue.L)(JSON.stringify({version:2,heartbeats:tt})).length}!function zr(tt){$r(new te.wA("platform-logger",Se=>new fe(Se),"PRIVATE")),$r(new te.wA("heartbeat",Se=>new os(Se),"PRIVATE")),Rr(pe,"0.8.4",tt),Rr(pe,"0.8.4","esm2017"),Rr("fire-js","")}("")},4859:(ct,Te,V)=>{V.d(Te,{H0:()=>pe,wA:()=>F,zt:()=>se});var f=V(5861),te=V(2090);class F{constructor($,G,Y){this.name=$,this.instanceFactory=G,this.type=Y,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode($){return this.instantiationMode=$,this}setMultipleInstances($){return this.multipleInstances=$,this}setServiceProps($){return this.serviceProps=$,this}setInstanceCreatedCallback($){return this.onInstanceCreated=$,this}}const ue="[DEFAULT]";class se{constructor($,G){this.name=$,this.container=G,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get($){const G=this.normalizeInstanceIdentifier($);if(!this.instancesDeferred.has(G)){const Y=new te.BH;if(this.instancesDeferred.set(G,Y),this.isInitialized(G)||this.shouldAutoInitialize())try{const Ve=this.getOrInitializeService({instanceIdentifier:G});Ve&&Y.resolve(Ve)}catch{}}return this.instancesDeferred.get(G).promise}getImmediate($){var G;const Y=this.normalizeInstanceIdentifier($?.identifier),Ve=null!==(G=$?.optional)&&void 0!==G&&G;if(!this.isInitialized(Y)&&!this.shouldAutoInitialize()){if(Ve)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:Y})}catch(Me){if(Ve)return null;throw Me}}getComponent(){return this.component}setComponent($){if($.name!==this.name)throw Error(`Mismatching Component ${$.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=$,this.shouldAutoInitialize()){if(function ce(ge){return"EAGER"===ge.instantiationMode}($))try{this.getOrInitializeService({instanceIdentifier:ue})}catch{}for(const[G,Y]of this.instancesDeferred.entries()){const Ve=this.normalizeInstanceIdentifier(G);try{const Me=this.getOrInitializeService({instanceIdentifier:Ve});Y.resolve(Me)}catch{}}}}clearInstance($=ue){this.instancesDeferred.delete($),this.instancesOptions.delete($),this.instances.delete($)}delete(){var $=this;return(0,f.Z)(function*(){const G=Array.from($.instances.values());yield Promise.all([...G.filter(Y=>"INTERNAL"in Y).map(Y=>Y.INTERNAL.delete()),...G.filter(Y=>"_delete"in Y).map(Y=>Y._delete())])})()}isComponentSet(){return null!=this.component}isInitialized($=ue){return this.instances.has($)}getOptions($=ue){return this.instancesOptions.get($)||{}}initialize($={}){const{options:G={}}=$,Y=this.normalizeInstanceIdentifier($.instanceIdentifier);if(this.isInitialized(Y))throw Error(`${this.name}(${Y}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const Ve=this.getOrInitializeService({instanceIdentifier:Y,options:G});for(const[Me,Ce]of this.instancesDeferred.entries())Y===this.normalizeInstanceIdentifier(Me)&&Ce.resolve(Ve);return Ve}onInit($,G){var Y;const Ve=this.normalizeInstanceIdentifier(G),Me=null!==(Y=this.onInitCallbacks.get(Ve))&&void 0!==Y?Y:new Set;Me.add($),this.onInitCallbacks.set(Ve,Me);const Ce=this.instances.get(Ve);return Ce&&$(Ce,Ve),()=>{Me.delete($)}}invokeOnInitCallbacks($,G){const Y=this.onInitCallbacks.get(G);if(Y)for(const Ve of Y)try{Ve($,G)}catch{}}getOrInitializeService({instanceIdentifier:$,options:G={}}){let Y=this.instances.get($);if(!Y&&this.component&&(Y=this.component.instanceFactory(this.container,{instanceIdentifier:(ge=$,ge===ue?void 0:ge),options:G}),this.instances.set($,Y),this.instancesOptions.set($,G),this.invokeOnInitCallbacks(Y,$),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,$,Y)}catch{}var ge;return Y||null}normalizeInstanceIdentifier($=ue){return this.component?this.component.multipleInstances?$:ue:$}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class pe{constructor($){this.name=$,this.providers=new Map}addComponent($){const G=this.getProvider($.name);if(G.isComponentSet())throw new Error(`Component ${$.name} has already been registered with ${this.name}`);G.setComponent($)}addOrOverwriteComponent($){this.getProvider($.name).isComponentSet()&&this.providers.delete($.name),this.addComponent($)}getProvider($){if(this.providers.has($))return this.providers.get($);const G=new se($,this);return this.providers.set($,G),G}getProviders(){return Array.from(this.providers.values())}}},1877:(ct,Te,V)=>{V.d(Te,{Am:()=>ge,Ub:()=>pe,Yd:()=>ce,in:()=>te});const f=[];var te=(()=>{return($=te||(te={}))[$.DEBUG=0]="DEBUG",$[$.VERBOSE=1]="VERBOSE",$[$.INFO=2]="INFO",$[$.WARN=3]="WARN",$[$.ERROR=4]="ERROR",$[$.SILENT=5]="SILENT",te;var $})();const F={debug:te.DEBUG,verbose:te.VERBOSE,info:te.INFO,warn:te.WARN,error:te.ERROR,silent:te.SILENT},ue=te.INFO,se={[te.DEBUG]:"log",[te.VERBOSE]:"log",[te.INFO]:"info",[te.WARN]:"warn",[te.ERROR]:"error"},fe=($,G,...Y)=>{if(G<$.logLevel)return;const Ve=(new Date).toISOString(),Me=se[G];if(!Me)throw new Error(`Attempted to log a message with an invalid logType (value: ${G})`);console[Me](`[${Ve}]  ${$.name}:`,...Y)};class ce{constructor(G){this.name=G,this._logLevel=ue,this._logHandler=fe,this._userLogHandler=null,f.push(this)}get logLevel(){return this._logLevel}set logLevel(G){if(!(G in te))throw new TypeError(`Invalid value "${G}" assigned to \`logLevel\``);this._logLevel=G}setLogLevel(G){this._logLevel="string"==typeof G?F[G]:G}get logHandler(){return this._logHandler}set logHandler(G){if("function"!=typeof G)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=G}get userLogHandler(){return this._userLogHandler}set userLogHandler(G){this._userLogHandler=G}debug(...G){this._userLogHandler&&this._userLogHandler(this,te.DEBUG,...G),this._logHandler(this,te.DEBUG,...G)}log(...G){this._userLogHandler&&this._userLogHandler(this,te.VERBOSE,...G),this._logHandler(this,te.VERBOSE,...G)}info(...G){this._userLogHandler&&this._userLogHandler(this,te.INFO,...G),this._logHandler(this,te.INFO,...G)}warn(...G){this._userLogHandler&&this._userLogHandler(this,te.WARN,...G),this._logHandler(this,te.WARN,...G)}error(...G){this._userLogHandler&&this._userLogHandler(this,te.ERROR,...G),this._logHandler(this,te.ERROR,...G)}}function pe($){f.forEach(G=>{G.setLogLevel($)})}function ge($,G){for(const Y of f){let Ve=null;G&&G.level&&(Ve=F[G.level]),Y.userLogHandler=null===$?null:(Me,Ce,...rt)=>{const ye=rt.map(me=>{if(null==me)return null;if("string"==typeof me)return me;if("number"==typeof me||"boolean"==typeof me)return me.toString();if(me instanceof Error)return me.message;try{return JSON.stringify(me)}catch{return null}}).filter(me=>me).join(" ");Ce>=(Ve??Me.logLevel)&&$({level:te[Ce].toLowerCase(),message:ye,args:rt,type:Me.name})}}}},8766:(ct,Te,V)=>{V.d(Te,{Lj:()=>Re,X3:()=>ut});var f=V(5861);let F,ue;const ce=new WeakMap,pe=new WeakMap,ge=new WeakMap,$=new WeakMap,G=new WeakMap;let Me={get(H,_e,K){if(H instanceof IDBTransaction){if("done"===_e)return pe.get(H);if("objectStoreNames"===_e)return H.objectStoreNames||ge.get(H);if("store"===_e)return K.objectStoreNames[1]?void 0:K.objectStore(K.objectStoreNames[0])}return me(H[_e])},set:(H,_e,K)=>(H[_e]=K,!0),has:(H,_e)=>H instanceof IDBTransaction&&("done"===_e||"store"===_e)||_e in H};function ye(H){return"function"==typeof H?function rt(H){return H!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function fe(){return ue||(ue=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(H)?function(..._e){return H.apply(Je(this),_e),me(ce.get(this))}:function(..._e){return me(H.apply(Je(this),_e))}:function(_e,...K){const X=H.call(Je(this),_e,...K);return ge.set(X,_e.sort?_e.sort():[_e]),me(X)}}(H):(H instanceof IDBTransaction&&function Ve(H){if(pe.has(H))return;const _e=new Promise((K,X)=>{const ie=()=>{H.removeEventListener("complete",re),H.removeEventListener("error",Fe),H.removeEventListener("abort",Fe)},re=()=>{K(),ie()},Fe=()=>{X(H.error||new DOMException("AbortError","AbortError")),ie()};H.addEventListener("complete",re),H.addEventListener("error",Fe),H.addEventListener("abort",Fe)});pe.set(H,_e)}(H),((H,_e)=>_e.some(K=>H instanceof K))(H,function se(){return F||(F=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(H,Me):H)}function me(H){if(H instanceof IDBRequest)return function Y(H){const _e=new Promise((K,X)=>{const ie=()=>{H.removeEventListener("success",re),H.removeEventListener("error",Fe)},re=()=>{K(me(H.result)),ie()},Fe=()=>{X(H.error),ie()};H.addEventListener("success",re),H.addEventListener("error",Fe)});return _e.then(K=>{K instanceof IDBCursor&&ce.set(K,H)}).catch(()=>{}),G.set(_e,H),_e}(H);if($.has(H))return $.get(H);const _e=ye(H);return _e!==H&&($.set(H,_e),G.set(_e,H)),_e}const Je=H=>G.get(H);function ut(H,_e,{blocked:K,upgrade:X,blocking:ie,terminated:re}={}){const Fe=indexedDB.open(H,_e),Pe=me(Fe);return X&&Fe.addEventListener("upgradeneeded",dt=>{X(me(Fe.result),dt.oldVersion,dt.newVersion,me(Fe.transaction))}),K&&Fe.addEventListener("blocked",()=>K()),Pe.then(dt=>{re&&dt.addEventListener("close",()=>re()),ie&&dt.addEventListener("versionchange",()=>ie())}).catch(()=>{}),Pe}function Re(H,{blocked:_e}={}){const K=indexedDB.deleteDatabase(H);return _e&&K.addEventListener("blocked",()=>_e()),me(K).then(()=>{})}const we=["get","getKey","getAll","getAllKeys","count"],be=["put","add","delete","clear"],Be=new Map;function je(H,_e){if(!(H instanceof IDBDatabase)||_e in H||"string"!=typeof _e)return;if(Be.get(_e))return Be.get(_e);const K=_e.replace(/FromIndex$/,""),X=_e!==K,ie=be.includes(K);if(!(K in(X?IDBIndex:IDBObjectStore).prototype)||!ie&&!we.includes(K))return;const re=function(){var Fe=(0,f.Z)(function*(Pe,...dt){const tn=this.transaction(Pe,ie?"readwrite":"readonly");let jt=tn.store;return X&&(jt=jt.index(dt.shift())),(yield Promise.all([jt[K](...dt),ie&&tn.done]))[0]});return function(dt){return Fe.apply(this,arguments)}}();return Be.set(_e,re),re}!function Ce(H){Me=H(Me)}(H=>({...H,get:(_e,K,X)=>je(_e,K)||H.get(_e,K,X),has:(_e,K)=>!!je(_e,K)||H.has(_e,K)}))},5861:(ct,Te,V)=>{function f(F,ue,se,fe,ce,pe,ge){try{var $=F[pe](ge),G=$.value}catch(Y){return void se(Y)}$.done?ue(G):Promise.resolve(G).then(fe,ce)}function te(F){return function(){var ue=this,se=arguments;return new Promise(function(fe,ce){var pe=F.apply(ue,se);function ge(G){f(pe,fe,ce,ge,$,"next",G)}function $(G){f(pe,fe,ce,ge,$,"throw",G)}ge(void 0)})}}V.d(Te,{Z:()=>te})}},ct=>{ct(ct.s=4435)}]);